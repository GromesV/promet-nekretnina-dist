var hO=Object.defineProperty;var dO=(t,e,i)=>e in t?hO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var Mg=(t,e,i)=>(dO(t,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();function ki(){}function Ye(t,e){for(const i in e)t[i]=e[i];return t}function wA(t){return t()}function vv(){return Object.create(null)}function vn(t){t.forEach(wA)}function k0(t){return typeof t=="function"}function Ci(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function fO(t){return Object.keys(t).length===0}function O0(t,...e){if(t==null){for(const n of e)n(void 0);return ki}const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function mO(t){let e;return O0(t,i=>e=i)(),e}function Ln(t,e,i){t.$$.on_destroy.push(O0(e,i))}function $i(t,e,i,n){if(t){const s=AA(t,e,i,n);return t[0](s)}}function AA(t,e,i,n){return t[1]&&n?Ye(i.ctx.slice(),t[1](n(e))):i.ctx}function en(t,e,i,n){if(t[2]&&n){const s=t[2](n(i));if(e.dirty===void 0)return s;if(typeof s=="object"){const l=[],c=Math.max(e.dirty.length,s.length);for(let r=0;r<c;r+=1)l[r]=e.dirty[r]|s[r];return l}return e.dirty|s}return e.dirty}function tn(t,e,i,n,s,l){if(s){const c=AA(e,i,n,l);t.p(c,s)}}function nn(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let n=0;n<i;n++)e[n]=-1;return e}return-1}function fi(t){const e={};for(const i in t)i[0]!=="$"&&(e[i]=t[i]);return e}function Ut(t,e){const i={};e=new Set(e);for(const n in t)!e.has(n)&&n[0]!=="$"&&(i[n]=t[n]);return i}function hu(t){const e={};for(const i in t)e[i]=!0;return e}function Lm(t,e,i){return t.set(i),e}function Ze(t,e){t.appendChild(e)}function Se(t,e,i){t.insertBefore(e,i||null)}function Te(t){t.parentNode&&t.parentNode.removeChild(t)}function pO(t,e){for(let i=0;i<t.length;i+=1)t[i]&&t[i].d(e)}function nt(t){return document.createElement(t)}function Ji(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function gi(t){return document.createTextNode(t)}function Et(){return gi(" ")}function Mn(){return gi("")}function ut(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function pp(t){return function(e){return e.preventDefault(),t.call(this,e)}}function iu(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function je(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}const gO=["width","height"];function ui(t,e){const i=Object.getOwnPropertyDescriptors(t.__proto__);for(const n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:i[n]&&i[n].set&&gO.indexOf(n)===-1?t[n]=e[n]:je(t,n,e[n])}function Pn(t,e){for(const i in e)je(t,i,e[i])}function _O(t){return Array.from(t.childNodes)}function Si(t,e){e=""+e,t.data!==e&&(t.data=e)}function Pm(t,e){t.value=e??""}function Ml(t,e,i,n){i==null?t.style.removeProperty(e):t.style.setProperty(e,i,n?"important":"")}function $(t,e,i){t.classList.toggle(e,!!i)}function yO(t,e,{bubbles:i=!1,cancelable:n=!1}={}){return new CustomEvent(t,{detail:e,bubbles:i,cancelable:n})}function yh(t,e){return new t(e)}let qd;function Bd(t){qd=t}function Dh(){if(!qd)throw new Error("Function called outside component initialization");return qd}function Pl(t){Dh().$$.on_mount.push(t)}function Rh(t){Dh().$$.after_update.push(t)}function EA(t){Dh().$$.on_destroy.push(t)}function co(){const t=Dh();return(e,i,{cancelable:n=!1}={})=>{const s=t.$$.callbacks[e];if(s){const l=yO(e,i,{cancelable:n});return s.slice().forEach(c=>{c.call(t,l)}),!l.defaultPrevented}return!0}}function uf(t,e){return Dh().$$.context.set(t,e),e}function Ec(t){return Dh().$$.context.get(t)}function At(t,e){const i=t.$$.callbacks[e.type];i&&i.slice().forEach(n=>n.call(this,e))}const th=[],sn=[];let ch=[];const w_=[],vO=Promise.resolve();let A_=!1;function bO(){A_||(A_=!0,vO.then(TA))}function Zd(t){ch.push(t)}function Va(t){w_.push(t)}const Dg=new Set;let Uu=0;function TA(){if(Uu!==0)return;const t=qd;do{try{for(;Uu<th.length;){const e=th[Uu];Uu++,Bd(e),xO(e.$$)}}catch(e){throw th.length=0,Uu=0,e}for(Bd(null),th.length=0,Uu=0;sn.length;)sn.pop()();for(let e=0;e<ch.length;e+=1){const i=ch[e];Dg.has(i)||(Dg.add(i),i())}ch.length=0}while(th.length);for(;w_.length;)w_.pop()();A_=!1,Dg.clear(),Bd(t)}function xO(t){if(t.fragment!==null){t.update(),vn(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Zd)}}function wO(t){const e=[],i=[];ch.forEach(n=>t.indexOf(n)===-1?e.push(n):i.push(n)),i.forEach(n=>n()),ch=e}const _m=new Set;let Qc;function Ai(){Qc={r:0,c:[],p:Qc}}function Ei(){Qc.r||vn(Qc.c),Qc=Qc.p}function ae(t,e){t&&t.i&&(_m.delete(t),t.i(e))}function pe(t,e,i,n){if(t&&t.o){if(_m.has(t))return;_m.add(t),Qc.c.push(()=>{_m.delete(t),n&&(i&&t.d(1),n())}),t.o(e)}else n&&n()}function Ks(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function du(t,e){pe(t,1,1,()=>{e.delete(t.key)})}function fu(t,e,i,n,s,l,c,r,f,m,y,b){let E=t.length,S=l.length,D=E;const R={};for(;D--;)R[t[D].key]=D;const z=[],H=new Map,K=new Map,W=[];for(D=S;D--;){const ue=b(s,l,D),ve=i(ue);let _e=c.get(ve);_e?n&&W.push(()=>_e.p(ue,e)):(_e=m(ve,ue),_e.c()),H.set(ve,z[D]=_e),ve in R&&K.set(ve,Math.abs(D-R[ve]))}const se=new Set,Y=new Set;function ne(ue){ae(ue,1),ue.m(r,y),c.set(ue.key,ue),y=ue.first,S--}for(;E&&S;){const ue=z[S-1],ve=t[E-1],_e=ue.key,oe=ve.key;ue===ve?(y=ue.first,E--,S--):H.has(oe)?!c.has(_e)||se.has(_e)?ne(ue):Y.has(oe)?E--:K.get(_e)>K.get(oe)?(Y.add(_e),ne(ue)):(se.add(oe),E--):(f(ve,c),E--)}for(;E--;){const ue=t[E];H.has(ue.key)||f(ue,c)}for(;S;)ne(z[S-1]);return vn(W),z}function Ni(t,e){const i={},n={},s={$$scope:1};let l=t.length;for(;l--;){const c=t[l],r=e[l];if(r){for(const f in c)f in r||(n[f]=1);for(const f in r)s[f]||(i[f]=r[f],s[f]=1);t[l]=r}else for(const f in c)s[f]=1}for(const c in n)c in i||(i[c]=void 0);return i}function hf(t){return typeof t=="object"&&t!==null?t:{}}function Fa(t,e,i){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=i,i(t.$$.ctx[n]))}function Mt(t){t&&t.c()}function Ot(t,e,i){const{fragment:n,after_update:s}=t.$$;n&&n.m(e,i),Zd(()=>{const l=t.$$.on_mount.map(wA).filter(k0);t.$$.on_destroy?t.$$.on_destroy.push(...l):vn(l),t.$$.on_mount=[]}),s.forEach(Zd)}function Ct(t,e){const i=t.$$;i.fragment!==null&&(wO(i.after_update),vn(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function AO(t,e){t.$$.dirty[0]===-1&&(th.push(t),bO(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Di(t,e,i,n,s,l,c=null,r=[-1]){const f=qd;Bd(t);const m=t.$$={fragment:null,ctx:[],props:l,update:ki,not_equal:s,bound:vv(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:vv(),dirty:r,skip_bound:!1,root:e.target||f.$$.root};c&&c(m.root);let y=!1;if(m.ctx=i?i(t,e.props||{},(b,E,...S)=>{const D=S.length?S[0]:E;return m.ctx&&s(m.ctx[b],m.ctx[b]=D)&&(!m.skip_bound&&m.bound[b]&&m.bound[b](D),y&&AO(t,b)),E}):[],m.update(),y=!0,vn(m.before_update),m.fragment=n?n(m.ctx):!1,e.target){if(e.hydrate){const b=_O(e.target);m.fragment&&m.fragment.l(b),b.forEach(Te)}else m.fragment&&m.fragment.c();e.intro&&ae(t.$$.fragment),Ot(t,e.target,e.anchor),TA()}Bd(f)}class Ri{constructor(){Mg(this,"$$");Mg(this,"$$set")}$destroy(){Ct(this,1),this.$destroy=ki}$on(e,i){if(!k0(i))return ki;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const s=n.indexOf(i);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!fO(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const EO="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(EO);const ju=[];function ym(t,e){return{subscribe:Ur(t,e).subscribe}}function Ur(t,e=ki){let i;const n=new Set;function s(r){if(Ci(t,r)&&(t=r,i)){const f=!ju.length;for(const m of n)m[1](),ju.push(m,t);if(f){for(let m=0;m<ju.length;m+=2)ju[m][0](ju[m+1]);ju.length=0}}}function l(r){s(r(t))}function c(r,f=ki){const m=[r,f];return n.add(m),n.size===1&&(i=e(s,l)||ki),r(t),()=>{n.delete(m),n.size===0&&i&&(i(),i=null)}}return{set:s,update:l,subscribe:c}}function Xf(t,e,i){const n=!Array.isArray(t),s=n?[t]:t;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const l=e.length<2;return ym(i,(c,r)=>{let f=!1;const m=[];let y=0,b=ki;const E=()=>{if(y)return;b();const D=e(n?m[0]:m,c,r);l?c(D):b=k0(D)?D:ki},S=s.map((D,R)=>O0(D,z=>{m[R]=z,y&=~(1<<R),f&&E()},()=>{y|=1<<R}));return f=!0,E(),function(){vn(S),b(),f=!1}})}function bv(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function TO(t){let e,i,n=t[1]&&bv(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M22 16L12 26 10.6 24.6 19.2 16 10.6 7.4 12 6z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=bv(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function SO(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class SA extends Ri{constructor(e){super(),Di(this,e,SO,TO,Ci,{size:0,title:1})}}function IO(t){let e,i,n,s=[t[2]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=nt("div"),ui(e,l),$(e,"bx--skeleton",!0),$(e,"bx--btn",!0),$(e,"bx--btn--field",t[1]==="field"),$(e,"bx--btn--sm",t[1]==="small"),$(e,"bx--btn--lg",t[1]==="lg"),$(e,"bx--btn--xl",t[1]==="xl")},m(c,r){Se(c,e,r),i||(n=[ut(e,"click",t[7]),ut(e,"mouseover",t[8]),ut(e,"mouseenter",t[9]),ut(e,"mouseleave",t[10])],i=!0)},p(c,r){ui(e,l=Ni(s,[r&4&&c[2]])),$(e,"bx--skeleton",!0),$(e,"bx--btn",!0),$(e,"bx--btn--field",c[1]==="field"),$(e,"bx--btn--sm",c[1]==="small"),$(e,"bx--btn--lg",c[1]==="lg"),$(e,"bx--btn--xl",c[1]==="xl")},d(c){c&&Te(e),i=!1,vn(n)}}}function kO(t){let e,i="",n,s,l,c,r=[{href:t[0]},{rel:s=t[2].target==="_blank"?"noopener noreferrer":void 0},{role:"button"},t[2]],f={};for(let m=0;m<r.length;m+=1)f=Ye(f,r[m]);return{c(){e=nt("a"),n=gi(i),ui(e,f),$(e,"bx--skeleton",!0),$(e,"bx--btn",!0),$(e,"bx--btn--field",t[1]==="field"),$(e,"bx--btn--sm",t[1]==="small"),$(e,"bx--btn--lg",t[1]==="lg"),$(e,"bx--btn--xl",t[1]==="xl")},m(m,y){Se(m,e,y),Ze(e,n),l||(c=[ut(e,"click",t[3]),ut(e,"mouseover",t[4]),ut(e,"mouseenter",t[5]),ut(e,"mouseleave",t[6])],l=!0)},p(m,y){ui(e,f=Ni(r,[y&1&&{href:m[0]},y&4&&s!==(s=m[2].target==="_blank"?"noopener noreferrer":void 0)&&{rel:s},{role:"button"},y&4&&m[2]])),$(e,"bx--skeleton",!0),$(e,"bx--btn",!0),$(e,"bx--btn--field",m[1]==="field"),$(e,"bx--btn--sm",m[1]==="small"),$(e,"bx--btn--lg",m[1]==="lg"),$(e,"bx--btn--xl",m[1]==="xl")},d(m){m&&Te(e),l=!1,vn(c)}}}function OO(t){let e;function i(l,c){return l[0]?kO:IO}let n=i(t),s=n(t);return{c(){s.c(),e=Mn()},m(l,c){s.m(l,c),Se(l,e,c)},p(l,[c]){n===(n=i(l))&&s?s.p(l,c):(s.d(1),s=n(l),s&&(s.c(),s.m(e.parentNode,e)))},i:ki,o:ki,d(l){l&&Te(e),s.d(l)}}}function CO(t,e,i){const n=["href","size"];let s=Ut(e,n),{href:l=void 0}=e,{size:c="default"}=e;function r(R){At.call(this,t,R)}function f(R){At.call(this,t,R)}function m(R){At.call(this,t,R)}function y(R){At.call(this,t,R)}function b(R){At.call(this,t,R)}function E(R){At.call(this,t,R)}function S(R){At.call(this,t,R)}function D(R){At.call(this,t,R)}return t.$$set=R=>{e=Ye(Ye({},e),fi(R)),i(2,s=Ut(e,n)),"href"in R&&i(0,l=R.href),"size"in R&&i(1,c=R.size)},[l,c,s,r,f,m,y,b,E,S,D]}class MO extends Ri{constructor(e){super(),Di(this,e,CO,OO,Ci,{href:0,size:1})}}const DO=t=>({props:t[0]&512}),xv=t=>({props:t[9]});function RO(t){let e,i,n,s,l,c,r=t[8]&&wv(t);const f=t[19].default,m=$i(f,t,t[18],null);var y=t[2];function b(D,R){return{props:{"aria-hidden":"true",class:"bx--btn__icon",style:D[8]?"margin-left: 0":void 0,"aria-label":D[3]}}}y&&(n=yh(y,b(t)));let E=[t[9]],S={};for(let D=0;D<E.length;D+=1)S=Ye(S,E[D]);return{c(){e=nt("button"),r&&r.c(),i=Et(),m&&m.c(),n&&Mt(n.$$.fragment),ui(e,S)},m(D,R){Se(D,e,R),r&&r.m(e,null),Ze(e,i),m&&m.m(e,null),n&&Ot(n,e,null),e.autofocus&&e.focus(),t[33](e),s=!0,l||(c=[ut(e,"click",t[24]),ut(e,"mouseover",t[25]),ut(e,"mouseenter",t[26]),ut(e,"mouseleave",t[27])],l=!0)},p(D,R){if(D[8]?r?r.p(D,R):(r=wv(D),r.c(),r.m(e,i)):r&&(r.d(1),r=null),m&&m.p&&(!s||R[0]&262144)&&tn(m,f,D,D[18],s?en(f,D[18],R,null):nn(D[18]),null),R[0]&4&&y!==(y=D[2])){if(n){Ai();const z=n;pe(z.$$.fragment,1,0,()=>{Ct(z,1)}),Ei()}y?(n=yh(y,b(D)),Mt(n.$$.fragment),ae(n.$$.fragment,1),Ot(n,e,null)):n=null}else if(y){const z={};R[0]&256&&(z.style=D[8]?"margin-left: 0":void 0),R[0]&8&&(z["aria-label"]=D[3]),n.$set(z)}ui(e,S=Ni(E,[R[0]&512&&D[9]]))},i(D){s||(ae(m,D),n&&ae(n.$$.fragment,D),s=!0)},o(D){pe(m,D),n&&pe(n.$$.fragment,D),s=!1},d(D){D&&Te(e),r&&r.d(),m&&m.d(D),n&&Ct(n),t[33](null),l=!1,vn(c)}}}function LO(t){let e,i,n,s,l,c,r=t[8]&&Av(t);const f=t[19].default,m=$i(f,t,t[18],null);var y=t[2];function b(D,R){return{props:{"aria-hidden":"true",class:"bx--btn__icon","aria-label":D[3]}}}y&&(n=yh(y,b(t)));let E=[t[9]],S={};for(let D=0;D<E.length;D+=1)S=Ye(S,E[D]);return{c(){e=nt("a"),r&&r.c(),i=Et(),m&&m.c(),n&&Mt(n.$$.fragment),ui(e,S)},m(D,R){Se(D,e,R),r&&r.m(e,null),Ze(e,i),m&&m.m(e,null),n&&Ot(n,e,null),t[32](e),s=!0,l||(c=[ut(e,"click",t[20]),ut(e,"mouseover",t[21]),ut(e,"mouseenter",t[22]),ut(e,"mouseleave",t[23])],l=!0)},p(D,R){if(D[8]?r?r.p(D,R):(r=Av(D),r.c(),r.m(e,i)):r&&(r.d(1),r=null),m&&m.p&&(!s||R[0]&262144)&&tn(m,f,D,D[18],s?en(f,D[18],R,null):nn(D[18]),null),R[0]&4&&y!==(y=D[2])){if(n){Ai();const z=n;pe(z.$$.fragment,1,0,()=>{Ct(z,1)}),Ei()}y?(n=yh(y,b(D)),Mt(n.$$.fragment),ae(n.$$.fragment,1),Ot(n,e,null)):n=null}else if(y){const z={};R[0]&8&&(z["aria-label"]=D[3]),n.$set(z)}ui(e,S=Ni(E,[R[0]&512&&D[9]]))},i(D){s||(ae(m,D),n&&ae(n.$$.fragment,D),s=!0)},o(D){pe(m,D),n&&pe(n.$$.fragment,D),s=!1},d(D){D&&Te(e),r&&r.d(),m&&m.d(D),n&&Ct(n),t[32](null),l=!1,vn(c)}}}function PO(t){let e;const i=t[19].default,n=$i(i,t,t[18],xv);return{c(){n&&n.c()},m(s,l){n&&n.m(s,l),e=!0},p(s,l){n&&n.p&&(!e||l[0]&262656)&&tn(n,i,s,s[18],e?en(i,s[18],l,DO):nn(s[18]),xv)},i(s){e||(ae(n,s),e=!0)},o(s){pe(n,s),e=!1},d(s){n&&n.d(s)}}}function NO(t){let e,i;const n=[{href:t[7]},{size:t[1]},t[10],{style:t[8]&&"width: 3rem;"}];let s={};for(let l=0;l<n.length;l+=1)s=Ye(s,n[l]);return e=new MO({props:s}),e.$on("click",t[28]),e.$on("mouseover",t[29]),e.$on("mouseenter",t[30]),e.$on("mouseleave",t[31]),{c(){Mt(e.$$.fragment)},m(l,c){Ot(e,l,c),i=!0},p(l,c){const r=c[0]&1410?Ni(n,[c[0]&128&&{href:l[7]},c[0]&2&&{size:l[1]},c[0]&1024&&hf(l[10]),c[0]&256&&{style:l[8]&&"width: 3rem;"}]):{};e.$set(r)},i(l){i||(ae(e.$$.fragment,l),i=!0)},o(l){pe(e.$$.fragment,l),i=!1},d(l){Ct(e,l)}}}function wv(t){let e,i;return{c(){e=nt("span"),i=gi(t[3]),$(e,"bx--assistive-text",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&8&&Si(i,n[3])},d(n){n&&Te(e)}}}function Av(t){let e,i;return{c(){e=nt("span"),i=gi(t[3]),$(e,"bx--assistive-text",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&8&&Si(i,n[3])},d(n){n&&Te(e)}}}function zO(t){let e,i,n,s;const l=[NO,PO,LO,RO],c=[];function r(f,m){return f[5]?0:f[4]?1:f[7]&&!f[6]?2:3}return e=r(t),i=c[e]=l[e](t),{c(){i.c(),n=Mn()},m(f,m){c[e].m(f,m),Se(f,n,m),s=!0},p(f,m){let y=e;e=r(f),e===y?c[e].p(f,m):(Ai(),pe(c[y],1,1,()=>{c[y]=null}),Ei(),i=c[e],i?i.p(f,m):(i=c[e]=l[e](f),i.c()),ae(i,1),i.m(n.parentNode,n))},i(f){s||(ae(i),s=!0)},o(f){pe(i),s=!1},d(f){f&&Te(n),c[e].d(f)}}}function BO(t,e,i){let n,s;const l=["kind","size","expressive","isSelected","icon","iconDescription","tooltipAlignment","tooltipPosition","as","skeleton","disabled","href","tabindex","type","ref"];let c=Ut(e,l),{$$slots:r={},$$scope:f}=e;const m=hu(r);let{kind:y="primary"}=e,{size:b="default"}=e,{expressive:E=!1}=e,{isSelected:S=!1}=e,{icon:D=void 0}=e,{iconDescription:R=void 0}=e,{tooltipAlignment:z="center"}=e,{tooltipPosition:H="bottom"}=e,{as:K=!1}=e,{skeleton:W=!1}=e,{disabled:se=!1}=e,{href:Y=void 0}=e,{tabindex:ne="0"}=e,{type:ue="button"}=e,{ref:ve=null}=e;const _e=Ec("ComposedModal");function oe(qe){At.call(this,t,qe)}function Be(qe){At.call(this,t,qe)}function mt(qe){At.call(this,t,qe)}function Le(qe){At.call(this,t,qe)}function rt(qe){At.call(this,t,qe)}function tt(qe){At.call(this,t,qe)}function We(qe){At.call(this,t,qe)}function Ve(qe){At.call(this,t,qe)}function St(qe){At.call(this,t,qe)}function zt(qe){At.call(this,t,qe)}function mi(qe){At.call(this,t,qe)}function vt(qe){At.call(this,t,qe)}function pt(qe){sn[qe?"unshift":"push"](()=>{ve=qe,i(0,ve)})}function Pt(qe){sn[qe?"unshift":"push"](()=>{ve=qe,i(0,ve)})}return t.$$set=qe=>{e=Ye(Ye({},e),fi(qe)),i(10,c=Ut(e,l)),"kind"in qe&&i(11,y=qe.kind),"size"in qe&&i(1,b=qe.size),"expressive"in qe&&i(12,E=qe.expressive),"isSelected"in qe&&i(13,S=qe.isSelected),"icon"in qe&&i(2,D=qe.icon),"iconDescription"in qe&&i(3,R=qe.iconDescription),"tooltipAlignment"in qe&&i(14,z=qe.tooltipAlignment),"tooltipPosition"in qe&&i(15,H=qe.tooltipPosition),"as"in qe&&i(4,K=qe.as),"skeleton"in qe&&i(5,W=qe.skeleton),"disabled"in qe&&i(6,se=qe.disabled),"href"in qe&&i(7,Y=qe.href),"tabindex"in qe&&i(16,ne=qe.tabindex),"type"in qe&&i(17,ue=qe.type),"ref"in qe&&i(0,ve=qe.ref),"$$scope"in qe&&i(18,f=qe.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&_e&&ve&&_e.declareRef(ve),t.$$.dirty[0]&4&&i(8,n=D&&!m.default),i(9,s={type:Y&&!se?void 0:ue,tabindex:ne,disabled:se===!0?!0:void 0,href:Y,"aria-pressed":n&&y==="ghost"&&!Y?S:void 0,...c,class:["bx--btn",E&&"bx--btn--expressive",(b==="small"&&!E||b==="sm"&&!E||b==="small"&&!E)&&"bx--btn--sm",b==="field"&&!E||b==="md"&&!E&&"bx--btn--md",b==="field"&&"bx--btn--field",b==="small"&&"bx--btn--sm",b==="lg"&&"bx--btn--lg",b==="xl"&&"bx--btn--xl",y&&`bx--btn--${y}`,se&&"bx--btn--disabled",n&&"bx--btn--icon-only",n&&"bx--tooltip__trigger",n&&"bx--tooltip--a11y",n&&H&&`bx--btn--icon-only--${H}`,n&&z&&`bx--tooltip--align-${z}`,n&&S&&y==="ghost"&&"bx--btn--selected",c.class].filter(Boolean).join(" ")})},[ve,b,D,R,K,W,se,Y,n,s,c,y,E,S,z,H,ne,ue,f,r,oe,Be,mt,Le,rt,tt,We,Ve,St,zt,mi,vt,pt,Pt]}class nu extends Ri{constructor(e){super(),Di(this,e,BO,zO,Ci,{kind:11,size:1,expressive:12,isSelected:13,icon:2,iconDescription:3,tooltipAlignment:14,tooltipPosition:15,as:4,skeleton:5,disabled:6,href:7,tabindex:16,type:17,ref:0},null,[-1,-1])}}function VO(t){let e,i,n,s,l=[t[0]],c={};for(let r=0;r<l.length;r+=1)c=Ye(c,l[r]);return{c(){e=nt("div"),i=nt("span"),$(i,"bx--checkbox-label-text",!0),$(i,"bx--skeleton",!0),ui(e,c),$(e,"bx--form-item",!0),$(e,"bx--checkbox-wrapper",!0),$(e,"bx--checkbox-label",!0)},m(r,f){Se(r,e,f),Ze(e,i),n||(s=[ut(e,"click",t[1]),ut(e,"mouseover",t[2]),ut(e,"mouseenter",t[3]),ut(e,"mouseleave",t[4])],n=!0)},p(r,[f]){ui(e,c=Ni(l,[f&1&&r[0]])),$(e,"bx--form-item",!0),$(e,"bx--checkbox-wrapper",!0),$(e,"bx--checkbox-label",!0)},i:ki,o:ki,d(r){r&&Te(e),n=!1,vn(s)}}}function FO(t,e,i){const n=[];let s=Ut(e,n);function l(m){At.call(this,t,m)}function c(m){At.call(this,t,m)}function r(m){At.call(this,t,m)}function f(m){At.call(this,t,m)}return t.$$set=m=>{e=Ye(Ye({},e),fi(m)),i(0,s=Ut(e,n))},[s,l,c,r,f]}class UO extends Ri{constructor(e){super(),Di(this,e,FO,VO,Ci,{})}}const jO=t=>({}),Ev=t=>({});function GO(t){let e,i,n,s,l,c,r,f;const m=t[19].labelText,y=$i(m,t,t[18],Ev),b=y||KO(t);let E=[t[16]],S={};for(let D=0;D<E.length;D+=1)S=Ye(S,E[D]);return{c(){e=nt("div"),i=nt("input"),n=Et(),s=nt("label"),l=nt("span"),b&&b.c(),je(i,"type","checkbox"),i.value=t[4],i.checked=t[0],i.disabled=t[9],je(i,"id",t[13]),i.indeterminate=t[5],je(i,"name",t[12]),i.required=t[7],i.readOnly=t[8],$(i,"bx--checkbox",!0),$(l,"bx--checkbox-label-text",!0),$(l,"bx--visually-hidden",t[11]),je(s,"for",t[13]),je(s,"title",t[2]),$(s,"bx--checkbox-label",!0),ui(e,S),$(e,"bx--form-item",!0),$(e,"bx--checkbox-wrapper",!0)},m(D,R){Se(D,e,R),Ze(e,i),t[30](i),Ze(e,n),Ze(e,s),Ze(s,l),b&&b.m(l,null),t[32](l),c=!0,r||(f=[ut(i,"change",t[31]),ut(i,"change",t[24]),ut(i,"blur",t[25]),ut(e,"click",t[20]),ut(e,"mouseover",t[21]),ut(e,"mouseenter",t[22]),ut(e,"mouseleave",t[23])],r=!0)},p(D,R){(!c||R[0]&16)&&(i.value=D[4]),(!c||R[0]&1)&&(i.checked=D[0]),(!c||R[0]&512)&&(i.disabled=D[9]),(!c||R[0]&8192)&&je(i,"id",D[13]),(!c||R[0]&32)&&(i.indeterminate=D[5]),(!c||R[0]&4096)&&je(i,"name",D[12]),(!c||R[0]&128)&&(i.required=D[7]),(!c||R[0]&256)&&(i.readOnly=D[8]),y?y.p&&(!c||R[0]&262144)&&tn(y,m,D,D[18],c?en(m,D[18],R,jO):nn(D[18]),Ev):b&&b.p&&(!c||R[0]&1024)&&b.p(D,c?R:[-1,-1]),(!c||R[0]&2048)&&$(l,"bx--visually-hidden",D[11]),(!c||R[0]&8192)&&je(s,"for",D[13]),(!c||R[0]&4)&&je(s,"title",D[2]),ui(e,S=Ni(E,[R[0]&65536&&D[16]])),$(e,"bx--form-item",!0),$(e,"bx--checkbox-wrapper",!0)},i(D){c||(ae(b,D),c=!0)},o(D){pe(b,D),c=!1},d(D){D&&Te(e),t[30](null),b&&b.d(D),t[32](null),r=!1,vn(f)}}}function HO(t){let e,i;const n=[t[16]];let s={};for(let l=0;l<n.length;l+=1)s=Ye(s,n[l]);return e=new UO({props:s}),e.$on("click",t[26]),e.$on("mouseover",t[27]),e.$on("mouseenter",t[28]),e.$on("mouseleave",t[29]),{c(){Mt(e.$$.fragment)},m(l,c){Ot(e,l,c),i=!0},p(l,c){const r=c[0]&65536?Ni(n,[hf(l[16])]):{};e.$set(r)},i(l){i||(ae(e.$$.fragment,l),i=!0)},o(l){pe(e.$$.fragment,l),i=!1},d(l){Ct(e,l)}}}function KO(t){let e;return{c(){e=gi(t[10])},m(i,n){Se(i,e,n)},p(i,n){n[0]&1024&&Si(e,i[10])},d(i){i&&Te(e)}}}function qO(t){let e,i,n,s;const l=[HO,GO],c=[];function r(f,m){return f[6]?0:1}return e=r(t),i=c[e]=l[e](t),{c(){i.c(),n=Mn()},m(f,m){c[e].m(f,m),Se(f,n,m),s=!0},p(f,m){let y=e;e=r(f),e===y?c[e].p(f,m):(Ai(),pe(c[y],1,1,()=>{c[y]=null}),Ei(),i=c[e],i?i.p(f,m):(i=c[e]=l[e](f),i.c()),ae(i,1),i.m(n.parentNode,n))},i(f){s||(ae(i),s=!0)},o(f){pe(i),s=!1},d(f){f&&Te(n),c[e].d(f)}}}function ZO(t,e,i){let n,s;const l=["value","checked","group","indeterminate","skeleton","required","readonly","disabled","labelText","hideLabel","name","title","id","ref"];let c=Ut(e,l),{$$slots:r={},$$scope:f}=e,{value:m=""}=e,{checked:y=!1}=e,{group:b=void 0}=e,{indeterminate:E=!1}=e,{skeleton:S=!1}=e,{required:D=!1}=e,{readonly:R=!1}=e,{disabled:z=!1}=e,{labelText:H=""}=e,{hideLabel:K=!1}=e,{name:W=""}=e,{title:se=void 0}=e,{id:Y="ccs-"+Math.random().toString(36)}=e,{ref:ne=null}=e;const ue=co();let ve=null;function _e(pt){At.call(this,t,pt)}function oe(pt){At.call(this,t,pt)}function Be(pt){At.call(this,t,pt)}function mt(pt){At.call(this,t,pt)}function Le(pt){At.call(this,t,pt)}function rt(pt){At.call(this,t,pt)}function tt(pt){At.call(this,t,pt)}function We(pt){At.call(this,t,pt)}function Ve(pt){At.call(this,t,pt)}function St(pt){At.call(this,t,pt)}function zt(pt){sn[pt?"unshift":"push"](()=>{ne=pt,i(3,ne)})}const mi=()=>{n?i(1,b=b.includes(m)?b.filter(pt=>pt!==m):[...b,m]):i(0,y=!y)};function vt(pt){sn[pt?"unshift":"push"](()=>{ve=pt,i(14,ve)})}return t.$$set=pt=>{e=Ye(Ye({},e),fi(pt)),i(16,c=Ut(e,l)),"value"in pt&&i(4,m=pt.value),"checked"in pt&&i(0,y=pt.checked),"group"in pt&&i(1,b=pt.group),"indeterminate"in pt&&i(5,E=pt.indeterminate),"skeleton"in pt&&i(6,S=pt.skeleton),"required"in pt&&i(7,D=pt.required),"readonly"in pt&&i(8,R=pt.readonly),"disabled"in pt&&i(9,z=pt.disabled),"labelText"in pt&&i(10,H=pt.labelText),"hideLabel"in pt&&i(11,K=pt.hideLabel),"name"in pt&&i(12,W=pt.name),"title"in pt&&i(2,se=pt.title),"id"in pt&&i(13,Y=pt.id),"ref"in pt&&i(3,ne=pt.ref),"$$scope"in pt&&i(18,f=pt.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&2&&i(15,n=Array.isArray(b)),t.$$.dirty[0]&32787&&i(0,y=n?b.includes(m):y),t.$$.dirty[0]&1&&ue("check",y),t.$$.dirty[0]&16384&&i(17,s=(ve==null?void 0:ve.offsetWidth)<(ve==null?void 0:ve.scrollWidth)),t.$$.dirty[0]&147460&&i(2,se=!se&&s?ve==null?void 0:ve.innerText:se)},[y,b,se,ne,m,E,S,D,R,z,H,K,W,Y,ve,n,c,s,f,r,_e,oe,Be,mt,Le,rt,tt,We,Ve,St,zt,mi,vt]}class E_ extends Ri{constructor(e){super(),Di(this,e,ZO,qO,Ci,{value:4,checked:0,group:1,indeterminate:5,skeleton:6,required:7,readonly:8,disabled:9,labelText:10,hideLabel:11,name:12,title:2,id:13,ref:3},null,[-1,-1])}}function WO(t){let e,i,n,s,l,c,r,f,m,y=[{type:"checkbox"},{checked:n=t[2]?!1:t[1]},{indeterminate:t[2]},{id:t[4]},t[5],{"aria-checked":s=t[2]?void 0:t[1]}],b={};for(let E=0;E<y.length;E+=1)b=Ye(b,y[E]);return{c(){e=nt("div"),i=nt("input"),l=Et(),c=nt("label"),ui(i,b),$(i,"bx--checkbox",!0),je(c,"for",t[4]),je(c,"title",t[3]),je(c,"aria-label",r=t[6]["aria-label"]),$(c,"bx--checkbox-label",!0),$(e,"bx--checkbox--inline",!0)},m(E,S){Se(E,e,S),Ze(e,i),i.autofocus&&i.focus(),t[8](i),Ze(e,l),Ze(e,c),f||(m=ut(i,"change",t[7]),f=!0)},p(E,[S]){ui(i,b=Ni(y,[{type:"checkbox"},S&6&&n!==(n=E[2]?!1:E[1])&&{checked:n},S&4&&{indeterminate:E[2]},S&16&&{id:E[4]},S&32&&E[5],S&6&&s!==(s=E[2]?void 0:E[1])&&{"aria-checked":s}])),$(i,"bx--checkbox",!0),S&16&&je(c,"for",E[4]),S&8&&je(c,"title",E[3]),S&64&&r!==(r=E[6]["aria-label"])&&je(c,"aria-label",r)},i:ki,o:ki,d(E){E&&Te(e),t[8](null),f=!1,m()}}}function YO(t,e,i){const n=["checked","indeterminate","title","id","ref"];let s=Ut(e,n),{checked:l=!1}=e,{indeterminate:c=!1}=e,{title:r=void 0}=e,{id:f="ccs-"+Math.random().toString(36)}=e,{ref:m=null}=e;function y(E){At.call(this,t,E)}function b(E){sn[E?"unshift":"push"](()=>{m=E,i(0,m)})}return t.$$set=E=>{i(6,e=Ye(Ye({},e),fi(E))),i(5,s=Ut(e,n)),"checked"in E&&i(1,l=E.checked),"indeterminate"in E&&i(2,c=E.indeterminate),"title"in E&&i(3,r=E.title),"id"in E&&i(4,f=E.id),"ref"in E&&i(0,m=E.ref)},e=fi(e),[m,l,c,r,f,s,e,y,b]}class IA extends Ri{constructor(e){super(),Di(this,e,YO,WO,Ci,{checked:1,indeterminate:2,title:3,id:4,ref:0})}}function Tv(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function JO(t){let e,i,n=t[1]&&Tv(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M12 8L22 16 12 24z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=Tv(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function XO(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class QO extends Ri{constructor(e){super(),Di(this,e,XO,JO,Ci,{size:0,title:1})}}const $O=QO;function Sv(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function eC(t){let e,i,n,s=t[1]&&Sv(t),l=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],c={};for(let r=0;r<l.length;r+=1)c=Ye(c,l[r]);return{c(){e=Ji("svg"),s&&s.c(),i=Ji("path"),n=Ji("path"),je(i,"d","M16,2C8.3,2,2,8.3,2,16s6.3,14,14,14s14-6.3,14-14C30,8.3,23.7,2,16,2z M14.9,8h2.2v11h-2.2V8z M16,25	c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22c0.8,0,1.5,0.7,1.5,1.5S16.8,25,16,25z"),je(n,"fill","none"),je(n,"d","M17.5,23.5c0,0.8-0.7,1.5-1.5,1.5c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22	C16.8,22,17.5,22.7,17.5,23.5z M17.1,8h-2.2v11h2.2V8z"),je(n,"data-icon-path","inner-path"),je(n,"opacity","0"),Pn(e,c)},m(r,f){Se(r,e,f),s&&s.m(e,null),Ze(e,i),Ze(e,n)},p(r,[f]){r[1]?s?s.p(r,f):(s=Sv(r),s.c(),s.m(e,i)):s&&(s.d(1),s=null),Pn(e,c=Ni(l,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},f&1&&{width:r[0]},f&1&&{height:r[0]},f&4&&r[2],f&8&&r[3]]))},i:ki,o:ki,d(r){r&&Te(e),s&&s.d()}}}function tC(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class mu extends Ri{constructor(e){super(),Di(this,e,tC,eC,Ci,{size:0,title:1})}}function Iv(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function iC(t){let e,i,n,s,l=t[1]&&Iv(t),c=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],r={};for(let f=0;f<c.length;f+=1)r=Ye(r,c[f]);return{c(){e=Ji("svg"),l&&l.c(),i=Ji("path"),n=Ji("path"),s=Ji("path"),je(i,"fill","none"),je(i,"d","M16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Zm-1.125-5h2.25V12h-2.25Z"),je(i,"data-icon-path","inner-path"),je(n,"d","M16.002,6.1714h-.004L4.6487,27.9966,4.6506,28H27.3494l.0019-.0034ZM14.875,12h2.25v9h-2.25ZM16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Z"),je(s,"d","M29,30H3a1,1,0,0,1-.8872-1.4614l13-25a1,1,0,0,1,1.7744,0l13,25A1,1,0,0,1,29,30ZM4.6507,28H27.3493l.002-.0033L16.002,6.1714h-.004L4.6487,27.9967Z"),Pn(e,r)},m(f,m){Se(f,e,m),l&&l.m(e,null),Ze(e,i),Ze(e,n),Ze(e,s)},p(f,[m]){f[1]?l?l.p(f,m):(l=Iv(f),l.c(),l.m(e,i)):l&&(l.d(1),l=null),Pn(e,r=Ni(c,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},m&1&&{width:f[0]},m&1&&{height:f[0]},m&4&&f[2],m&8&&f[3]]))},i:ki,o:ki,d(f){f&&Te(e),l&&l.d()}}}function nC(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class df extends Ri{constructor(e){super(),Di(this,e,nC,iC,Ci,{size:0,title:1})}}function kv(t){let e,i;return{c(){e=nt("div"),i=gi(t[6]),$(e,"bx--form-requirement",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&64&&Si(i,n[6])},d(n){n&&Te(e)}}}function Ov(t){let e,i;return{c(){e=nt("div"),i=gi(t[8]),$(e,"bx--form-requirement",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&256&&Si(i,n[8])},d(n){n&&Te(e)}}}function rC(t){let e,i,n,s,l,c,r,f;const m=t[11].default,y=$i(m,t,t[10],null);let b=[{role:"listbox"},{tabindex:"-1"},{"data-invalid":i=t[5]||void 0},t[9]],E={};for(let R=0;R<b.length;R+=1)E=Ye(E,b[R]);let S=t[5]&&kv(t),D=!t[5]&&t[7]&&Ov(t);return{c(){e=nt("div"),y&&y.c(),n=Et(),S&&S.c(),s=Et(),D&&D.c(),l=Mn(),ui(e,E),$(e,"bx--list-box",!0),$(e,"bx--list-box--sm",t[0]==="sm"),$(e,"bx--list-box--xl",t[0]==="xl"),$(e,"bx--list-box--inline",t[1]==="inline"),$(e,"bx--list-box--disabled",t[4]),$(e,"bx--list-box--expanded",t[2]),$(e,"bx--list-box--light",t[3]),$(e,"bx--list-box--warning",!t[5]&&t[7])},m(R,z){Se(R,e,z),y&&y.m(e,null),Se(R,n,z),S&&S.m(R,z),Se(R,s,z),D&&D.m(R,z),Se(R,l,z),c=!0,r||(f=[ut(e,"keydown",t[12]),ut(e,"keydown",sC),ut(e,"click",pp(t[13]))],r=!0)},p(R,[z]){y&&y.p&&(!c||z&1024)&&tn(y,m,R,R[10],c?en(m,R[10],z,null):nn(R[10]),null),ui(e,E=Ni(b,[{role:"listbox"},{tabindex:"-1"},(!c||z&32&&i!==(i=R[5]||void 0))&&{"data-invalid":i},z&512&&R[9]])),$(e,"bx--list-box",!0),$(e,"bx--list-box--sm",R[0]==="sm"),$(e,"bx--list-box--xl",R[0]==="xl"),$(e,"bx--list-box--inline",R[1]==="inline"),$(e,"bx--list-box--disabled",R[4]),$(e,"bx--list-box--expanded",R[2]),$(e,"bx--list-box--light",R[3]),$(e,"bx--list-box--warning",!R[5]&&R[7]),R[5]?S?S.p(R,z):(S=kv(R),S.c(),S.m(s.parentNode,s)):S&&(S.d(1),S=null),!R[5]&&R[7]?D?D.p(R,z):(D=Ov(R),D.c(),D.m(l.parentNode,l)):D&&(D.d(1),D=null)},i(R){c||(ae(y,R),c=!0)},o(R){pe(y,R),c=!1},d(R){R&&(Te(e),Te(n),Te(s),Te(l)),y&&y.d(R),S&&S.d(R),D&&D.d(R),r=!1,vn(f)}}}const sC=t=>{t.key==="Escape"&&t.stopPropagation()};function aC(t,e,i){const n=["size","type","open","light","disabled","invalid","invalidText","warn","warnText"];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e,{size:r=void 0}=e,{type:f="default"}=e,{open:m=!1}=e,{light:y=!1}=e,{disabled:b=!1}=e,{invalid:E=!1}=e,{invalidText:S=""}=e,{warn:D=!1}=e,{warnText:R=""}=e;function z(K){At.call(this,t,K)}function H(K){At.call(this,t,K)}return t.$$set=K=>{e=Ye(Ye({},e),fi(K)),i(9,s=Ut(e,n)),"size"in K&&i(0,r=K.size),"type"in K&&i(1,f=K.type),"open"in K&&i(2,m=K.open),"light"in K&&i(3,y=K.light),"disabled"in K&&i(4,b=K.disabled),"invalid"in K&&i(5,E=K.invalid),"invalidText"in K&&i(6,S=K.invalidText),"warn"in K&&i(7,D=K.warn),"warnText"in K&&i(8,R=K.warnText),"$$scope"in K&&i(10,c=K.$$scope)},[r,f,m,y,b,E,S,D,R,s,c,l,z,H]}class oC extends Ri{constructor(e){super(),Di(this,e,aC,rC,Ci,{size:0,type:1,open:2,light:3,disabled:4,invalid:5,invalidText:6,warn:7,warnText:8})}}const kA=oC;function lC(t){let e,i,n,s,l,c,r,f;const m=t[11].default,y=$i(m,t,t[10],null);let b=[{role:t[2]},{"aria-expanded":t[6]},{"aria-owns":i=t[6]&&t[5]||void 0},{"aria-controls":n=t[6]&&t[5]||void 0},{"aria-disabled":t[1]},{"aria-label":s=t[6]?t[4]("close"):t[4]("open")},{tabindex:l=t[1]?"-1":t[3]},t[7]],E={};for(let S=0;S<b.length;S+=1)E=Ye(E,b[S]);return{c(){e=nt("div"),y&&y.c(),ui(e,E),$(e,"bx--list-box__field",!0)},m(S,D){Se(S,e,D),y&&y.m(e,null),t[19](e),c=!0,r||(f=[ut(e,"click",t[12]),ut(e,"mouseover",t[13]),ut(e,"mouseenter",t[14]),ut(e,"mouseleave",t[15]),ut(e,"keydown",iu(t[16])),ut(e,"focus",t[17]),ut(e,"blur",t[18])],r=!0)},p(S,[D]){y&&y.p&&(!c||D&1024)&&tn(y,m,S,S[10],c?en(m,S[10],D,null):nn(S[10]),null),ui(e,E=Ni(b,[(!c||D&4)&&{role:S[2]},(!c||D&64)&&{"aria-expanded":S[6]},(!c||D&96&&i!==(i=S[6]&&S[5]||void 0))&&{"aria-owns":i},(!c||D&96&&n!==(n=S[6]&&S[5]||void 0))&&{"aria-controls":n},(!c||D&2)&&{"aria-disabled":S[1]},(!c||D&80&&s!==(s=S[6]?S[4]("close"):S[4]("open")))&&{"aria-label":s},(!c||D&10&&l!==(l=S[1]?"-1":S[3]))&&{tabindex:l},D&128&&S[7]])),$(e,"bx--list-box__field",!0)},i(S){c||(ae(y,S),c=!0)},o(S){pe(y,S),c=!1},d(S){S&&Te(e),y&&y.d(S),t[19](null),r=!1,vn(f)}}}function cC(t,e,i){let n,s;const l=["disabled","role","tabindex","translationIds","translateWithId","id","ref"];let c=Ut(e,l),{$$slots:r={},$$scope:f}=e,{disabled:m=!1}=e,{role:y="combobox"}=e,{tabindex:b="-1"}=e;const E={close:"close",open:"open"};let{translateWithId:S=oe=>z[oe]}=e,{id:D="ccs-"+Math.random().toString(36)}=e,{ref:R=null}=e;const z={[E.close]:"Close menu",[E.open]:"Open menu"},H=Ec("MultiSelect");function K(oe){At.call(this,t,oe)}function W(oe){At.call(this,t,oe)}function se(oe){At.call(this,t,oe)}function Y(oe){At.call(this,t,oe)}function ne(oe){At.call(this,t,oe)}function ue(oe){At.call(this,t,oe)}function ve(oe){At.call(this,t,oe)}function _e(oe){sn[oe?"unshift":"push"](()=>{R=oe,i(0,R)})}return t.$$set=oe=>{i(22,e=Ye(Ye({},e),fi(oe))),i(7,c=Ut(e,l)),"disabled"in oe&&i(1,m=oe.disabled),"role"in oe&&i(2,y=oe.role),"tabindex"in oe&&i(3,b=oe.tabindex),"translateWithId"in oe&&i(4,S=oe.translateWithId),"id"in oe&&i(9,D=oe.id),"ref"in oe&&i(0,R=oe.ref),"$$scope"in oe&&i(10,f=oe.$$scope)},t.$$.update=()=>{t.$$.dirty&1&&H&&R&&H.declareRef({key:"field",ref:R}),i(6,n=e["aria-expanded"]),t.$$.dirty&512&&i(5,s=`menu-${D}`)},e=fi(e),[R,m,y,b,S,s,n,c,E,D,f,r,K,W,se,Y,ne,ue,ve,_e]}class uC extends Ri{constructor(e){super(),Di(this,e,cC,lC,Ci,{disabled:1,role:2,tabindex:3,translationIds:8,translateWithId:4,id:9,ref:0})}get translationIds(){return this.$$.ctx[8]}}const hC=uC;function dC(t){let e,i,n,s,l;const c=t[4].default,r=$i(c,t,t[3],null);let f=[{role:"listbox"},{id:i="menu-"+t[1]},t[2]],m={};for(let y=0;y<f.length;y+=1)m=Ye(m,f[y]);return{c(){e=nt("div"),r&&r.c(),ui(e,m),$(e,"bx--list-box__menu",!0)},m(y,b){Se(y,e,b),r&&r.m(e,null),t[6](e),n=!0,s||(l=ut(e,"scroll",t[5]),s=!0)},p(y,[b]){r&&r.p&&(!n||b&8)&&tn(r,c,y,y[3],n?en(c,y[3],b,null):nn(y[3]),null),ui(e,m=Ni(f,[{role:"listbox"},(!n||b&2&&i!==(i="menu-"+y[1]))&&{id:i},b&4&&y[2]])),$(e,"bx--list-box__menu",!0)},i(y){n||(ae(r,y),n=!0)},o(y){pe(r,y),n=!1},d(y){y&&Te(e),r&&r.d(y),t[6](null),s=!1,l()}}}function fC(t,e,i){const n=["id","ref"];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e,{id:r="ccs-"+Math.random().toString(36)}=e,{ref:f=null}=e;function m(b){At.call(this,t,b)}function y(b){sn[b?"unshift":"push"](()=>{f=b,i(0,f)})}return t.$$set=b=>{e=Ye(Ye({},e),fi(b)),i(2,s=Ut(e,n)),"id"in b&&i(1,r=b.id),"ref"in b&&i(0,f=b.ref),"$$scope"in b&&i(3,c=b.$$scope)},[f,r,s,c,l,m,y]}class mC extends Ri{constructor(e){super(),Di(this,e,fC,dC,Ci,{id:1,ref:0})}}const OA=mC;function Cv(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function pC(t){let e,i,n=t[1]&&Cv(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M16 22L6 12 7.4 10.6 16 19.2 24.6 10.6 26 12z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=Cv(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function gC(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class _C extends Ri{constructor(e){super(),Di(this,e,gC,pC,Ci,{size:0,title:1})}}const C0=_C;function yC(t){let e,i,n,s,l;i=new C0({props:{"aria-label":t[1],title:t[1]}});let c=[t[2]],r={};for(let f=0;f<c.length;f+=1)r=Ye(r,c[f]);return{c(){e=nt("div"),Mt(i.$$.fragment),ui(e,r),$(e,"bx--list-box__menu-icon",!0),$(e,"bx--list-box__menu-icon--open",t[0])},m(f,m){Se(f,e,m),Ot(i,e,null),n=!0,s||(l=ut(e,"click",pp(t[6])),s=!0)},p(f,[m]){const y={};m&2&&(y["aria-label"]=f[1]),m&2&&(y.title=f[1]),i.$set(y),ui(e,r=Ni(c,[m&4&&f[2]])),$(e,"bx--list-box__menu-icon",!0),$(e,"bx--list-box__menu-icon--open",f[0])},i(f){n||(ae(i.$$.fragment,f),n=!0)},o(f){pe(i.$$.fragment,f),n=!1},d(f){f&&Te(e),Ct(i),s=!1,l()}}}function vC(t,e,i){let n,s;const l=["open","translationIds","translateWithId"];let c=Ut(e,l),{open:r=!1}=e;const f={close:"close",open:"open"};let{translateWithId:m=E=>y[E]}=e;const y={[f.close]:"Close menu",[f.open]:"Open menu"};function b(E){At.call(this,t,E)}return t.$$set=E=>{e=Ye(Ye({},e),fi(E)),i(2,c=Ut(e,l)),"open"in E&&i(0,r=E.open),"translateWithId"in E&&i(4,m=E.translateWithId)},t.$$.update=()=>{t.$$.dirty&1&&i(5,n=r?f.close:f.open),t.$$.dirty&48&&i(1,s=(m==null?void 0:m(n))??y[n])},[r,s,c,f,m,n,b]}class bC extends Ri{constructor(e){super(),Di(this,e,vC,yC,Ci,{open:0,translationIds:3,translateWithId:4})}get translationIds(){return this.$$.ctx[3]}}const M0=bC;function xC(t){let e,i,n,s,l,c;const r=t[8].default,f=$i(r,t,t[7],null);let m=[{role:"option"},{tabindex:"-1"},{"aria-selected":t[0]},{disabled:n=t[2]?!0:void 0},t[5]],y={};for(let b=0;b<m.length;b+=1)y=Ye(y,m[b]);return{c(){e=nt("div"),i=nt("div"),f&&f.c(),je(i,"title",t[4]),$(i,"bx--list-box__menu-item__option",!0),ui(e,y),$(e,"bx--list-box__menu-item",!0),$(e,"bx--list-box__menu-item--active",t[0]),$(e,"bx--list-box__menu-item--highlighted",t[1]||t[0])},m(b,E){Se(b,e,E),Ze(e,i),f&&f.m(i,null),t[12](i),s=!0,l||(c=[ut(e,"click",t[9]),ut(e,"mouseenter",t[10]),ut(e,"mouseleave",t[11])],l=!0)},p(b,[E]){f&&f.p&&(!s||E&128)&&tn(f,r,b,b[7],s?en(r,b[7],E,null):nn(b[7]),null),(!s||E&16)&&je(i,"title",b[4]),ui(e,y=Ni(m,[{role:"option"},{tabindex:"-1"},(!s||E&1)&&{"aria-selected":b[0]},(!s||E&4&&n!==(n=b[2]?!0:void 0))&&{disabled:n},E&32&&b[5]])),$(e,"bx--list-box__menu-item",!0),$(e,"bx--list-box__menu-item--active",b[0]),$(e,"bx--list-box__menu-item--highlighted",b[1]||b[0])},i(b){s||(ae(f,b),s=!0)},o(b){pe(f,b),s=!1},d(b){b&&Te(e),f&&f.d(b),t[12](null),l=!1,vn(c)}}}function wC(t,e,i){let n,s;const l=["active","highlighted","disabled"];let c=Ut(e,l),{$$slots:r={},$$scope:f}=e,{active:m=!1}=e,{highlighted:y=!1}=e,{disabled:b=!1}=e,E=null;function S(H){At.call(this,t,H)}function D(H){At.call(this,t,H)}function R(H){At.call(this,t,H)}function z(H){sn[H?"unshift":"push"](()=>{E=H,i(3,E)})}return t.$$set=H=>{e=Ye(Ye({},e),fi(H)),i(5,c=Ut(e,l)),"active"in H&&i(0,m=H.active),"highlighted"in H&&i(1,y=H.highlighted),"disabled"in H&&i(2,b=H.disabled),"$$scope"in H&&i(7,f=H.$$scope)},t.$$.update=()=>{t.$$.dirty&8&&i(6,n=(E==null?void 0:E.offsetWidth)<(E==null?void 0:E.scrollWidth)),t.$$.dirty&72&&i(4,s=n?E==null?void 0:E.innerText:void 0),t.$$.dirty&10&&y&&E&&!E.matches(":hover")&&E.scrollIntoView({block:"nearest"})},[m,y,b,E,s,c,n,f,r,S,D,R,z]}class AC extends Ri{constructor(e){super(),Di(this,e,wC,xC,Ci,{active:0,highlighted:1,disabled:2})}}const CA=AC;function Mv(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function EC(t){let e,i,n=t[1]&&Mv(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=Mv(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function TC(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class SC extends Ri{constructor(e){super(),Di(this,e,TC,EC,Ci,{size:0,title:1})}}const Lh=SC;function IC(t){let e,i,n,s,l,c,r,f=t[1]!==void 0&&Dv(t);n=new Lh({});let m=[{role:"button"},{"aria-label":t[4]},{title:t[4]},{tabindex:s=t[2]?"-1":"0"},t[6]],y={};for(let b=0;b<m.length;b+=1)y=Ye(y,m[b]);return{c(){e=nt("div"),f&&f.c(),i=Et(),Mt(n.$$.fragment),ui(e,y),$(e,"bx--list-box__selection",!0),$(e,"bx--tag--filter",t[1]),$(e,"bx--list-box__selection--multi",t[1])},m(b,E){Se(b,e,E),f&&f.m(e,null),Ze(e,i),Ot(n,e,null),t[12](e),l=!0,c||(r=[ut(e,"click",iu(pp(t[13]))),ut(e,"keydown",iu(t[14]))],c=!0)},p(b,E){b[1]!==void 0?f?f.p(b,E):(f=Dv(b),f.c(),f.m(e,i)):f&&(f.d(1),f=null),ui(e,y=Ni(m,[{role:"button"},(!l||E&16)&&{"aria-label":b[4]},(!l||E&16)&&{title:b[4]},(!l||E&4&&s!==(s=b[2]?"-1":"0"))&&{tabindex:s},E&64&&b[6]])),$(e,"bx--list-box__selection",!0),$(e,"bx--tag--filter",b[1]),$(e,"bx--list-box__selection--multi",b[1])},i(b){l||(ae(n.$$.fragment,b),l=!0)},o(b){pe(n.$$.fragment,b),l=!1},d(b){b&&Te(e),f&&f.d(),Ct(n),t[12](null),c=!1,vn(r)}}}function kC(t){let e,i,n,s,l,c,r,f,m,y;return c=new Lh({}),{c(){e=nt("div"),i=nt("span"),n=gi(t[1]),s=Et(),l=nt("div"),Mt(c.$$.fragment),je(i,"title",t[1]),$(i,"bx--tag__label",!0),je(l,"role","button"),je(l,"tabindex",r=t[2]?-1:0),je(l,"disabled",t[2]),je(l,"aria-label",t[3].clearAll),je(l,"title",t[4]),$(l,"bx--tag__close-icon",!0),$(e,"bx--tag",!0),$(e,"bx--tag--filter",!0),$(e,"bx--tag--high-contrast",!0),$(e,"bx--tag--disabled",t[2])},m(b,E){Se(b,e,E),Ze(e,i),Ze(i,n),Ze(e,s),Ze(e,l),Ot(c,l,null),t[9](l),f=!0,m||(y=[ut(l,"click",iu(pp(t[10]))),ut(l,"keydown",iu(t[11]))],m=!0)},p(b,E){(!f||E&2)&&Si(n,b[1]),(!f||E&2)&&je(i,"title",b[1]),(!f||E&4&&r!==(r=b[2]?-1:0))&&je(l,"tabindex",r),(!f||E&4)&&je(l,"disabled",b[2]),(!f||E&16)&&je(l,"title",b[4]),(!f||E&4)&&$(e,"bx--tag--disabled",b[2])},i(b){f||(ae(c.$$.fragment,b),f=!0)},o(b){pe(c.$$.fragment,b),f=!1},d(b){b&&Te(e),Ct(c),t[9](null),m=!1,vn(y)}}}function Dv(t){let e;return{c(){e=gi(t[1])},m(i,n){Se(i,e,n)},p(i,n){n&2&&Si(e,i[1])},d(i){i&&Te(e)}}}function OC(t){let e,i,n,s;const l=[kC,IC],c=[];function r(f,m){return f[1]!==void 0?0:1}return e=r(t),i=c[e]=l[e](t),{c(){i.c(),n=Mn()},m(f,m){c[e].m(f,m),Se(f,n,m),s=!0},p(f,[m]){let y=e;e=r(f),e===y?c[e].p(f,m):(Ai(),pe(c[y],1,1,()=>{c[y]=null}),Ei(),i=c[e],i?i.p(f,m):(i=c[e]=l[e](f),i.c()),ae(i,1),i.m(n.parentNode,n))},i(f){s||(ae(i),s=!0)},o(f){pe(i),s=!1},d(f){f&&Te(n),c[e].d(f)}}}function CC(t,e,i){let n,s;const l=["selectionCount","disabled","translationIds","translateWithId","ref"];let c=Ut(e,l),{selectionCount:r=void 0}=e,{disabled:f=!1}=e;const m={clearAll:"clearAll",clearSelection:"clearSelection"};let{translateWithId:y=Y=>E[Y]}=e,{ref:b=null}=e;const E={[m.clearAll]:"Clear all selected items",[m.clearSelection]:"Clear selected item"},S=co(),D=Ec("MultiSelect");function R(Y){sn[Y?"unshift":"push"](()=>{b=Y,i(0,b)})}const z=Y=>{f||S("clear",Y)},H=Y=>{!f&&Y.key==="Enter"&&S("clear",Y)};function K(Y){sn[Y?"unshift":"push"](()=>{b=Y,i(0,b)})}const W=Y=>{f||S("clear",Y)},se=Y=>{!f&&Y.key==="Enter"&&S("clear",Y)};return t.$$set=Y=>{e=Ye(Ye({},e),fi(Y)),i(6,c=Ut(e,l)),"selectionCount"in Y&&i(1,r=Y.selectionCount),"disabled"in Y&&i(2,f=Y.disabled),"translateWithId"in Y&&i(7,y=Y.translateWithId),"ref"in Y&&i(0,b=Y.ref)},t.$$.update=()=>{t.$$.dirty&1&&D&&b&&D.declareRef({key:"selection",ref:b}),t.$$.dirty&2&&i(8,n=r?m.clearAll:m.clearSelection),t.$$.dirty&384&&i(4,s=(y==null?void 0:y(n))??E[n])},[b,r,f,m,s,S,c,y,n,R,z,H,K,W,se]}class MC extends Ri{constructor(e){super(),Di(this,e,CC,OC,Ci,{selectionCount:1,disabled:2,translationIds:3,translateWithId:7,ref:0})}get translationIds(){return this.$$.ctx[3]}}const MA=MC,T_=new Set,DA=Ur(0),Rv=()=>DA.set([...T_].filter(t=>mO(t)).length),DC=t=>Pl(()=>{T_.add(t);const e=t.subscribe(Rv);return()=>{e(),T_.delete(t),Rv()}});DA.subscribe(t=>{typeof document<"u"&&document.body.classList.toggle("bx--body--with-modal-open",t>0)});const RC=t=>({}),Lv=t=>({});function Pv(t){let e,i;const n=t[20].labelText,s=$i(n,t,t[19],Lv),l=s||LC(t);return{c(){e=nt("span"),l&&l.c(),$(e,"bx--visually-hidden",t[7])},m(c,r){Se(c,e,r),l&&l.m(e,null),i=!0},p(c,r){s?s.p&&(!i||r&524288)&&tn(s,n,c,c[19],i?en(n,c[19],r,RC):nn(c[19]),Lv):l&&l.p&&(!i||r&64)&&l.p(c,i?r:-1),(!i||r&128)&&$(e,"bx--visually-hidden",c[7])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function LC(t){let e;return{c(){e=gi(t[6])},m(i,n){Se(i,e,n)},p(i,n){n&64&&Si(e,i[6])},d(i){i&&Te(e)}}}function PC(t){let e,i,n,s,l,c,r,f,m,y,b,E=(t[6]||t[17].labelText)&&Pv(t),S=[t[16]],D={};for(let R=0;R<S.length;R+=1)D=Ye(D,S[R]);return{c(){e=nt("div"),i=nt("input"),l=Et(),c=nt("label"),r=nt("span"),f=Et(),E&&E.c(),je(i,"type","radio"),je(i,"id",t[8]),je(i,"name",n=t[10]??t[9]),i.checked=t[0],i.disabled=t[3],i.required=s=t[11]??t[4],i.value=t[2],$(i,"bx--radio-button",!0),$(r,"bx--radio-button__appearance",!0),je(c,"for",t[8]),$(c,"bx--radio-button__label",!0),ui(e,D),$(e,"bx--radio-button-wrapper",!0),$(e,"bx--radio-button-wrapper--label-left",t[5]==="left")},m(R,z){Se(R,e,z),Ze(e,i),t[22](i),Ze(e,l),Ze(e,c),Ze(c,r),Ze(c,f),E&&E.m(c,null),m=!0,y||(b=[ut(i,"change",t[21]),ut(i,"change",t[23])],y=!0)},p(R,[z]){(!m||z&256)&&je(i,"id",R[8]),(!m||z&1536&&n!==(n=R[10]??R[9]))&&je(i,"name",n),(!m||z&1)&&(i.checked=R[0]),(!m||z&8)&&(i.disabled=R[3]),(!m||z&2064&&s!==(s=R[11]??R[4]))&&(i.required=s),(!m||z&4)&&(i.value=R[2]),R[6]||R[17].labelText?E?(E.p(R,z),z&131136&&ae(E,1)):(E=Pv(R),E.c(),ae(E,1),E.m(c,null)):E&&(Ai(),pe(E,1,1,()=>{E=null}),Ei()),(!m||z&256)&&je(c,"for",R[8]),ui(e,D=Ni(S,[z&65536&&R[16]])),$(e,"bx--radio-button-wrapper",!0),$(e,"bx--radio-button-wrapper--label-left",R[5]==="left")},i(R){m||(ae(E),m=!0)},o(R){pe(E),m=!1},d(R){R&&Te(e),t[22](null),E&&E.d(),y=!1,vn(b)}}}function NC(t,e,i){const n=["value","checked","disabled","required","labelPosition","labelText","hideLabel","id","name","ref"];let s=Ut(e,n),l,c,r,{$$slots:f={},$$scope:m}=e;const y=hu(f);let{value:b=""}=e,{checked:E=!1}=e,{disabled:S=!1}=e,{required:D=!1}=e,{labelPosition:R="right"}=e,{labelText:z=""}=e,{hideLabel:H=!1}=e,{id:K="ccs-"+Math.random().toString(36)}=e,{name:W=void 0}=e,{ref:se=null}=e;const{add:Y,update:ne,selectedValue:ue,groupName:ve,groupRequired:_e}=Ec("RadioButtonGroup")??{groupName:ym(void 0),groupRequired:ym(void 0),selectedValue:ym(E?b:void 0)};Ln(t,ue,Le=>i(18,l=Le)),Ln(t,ve,Le=>i(10,c=Le)),Ln(t,_e,Le=>i(11,r=Le)),Y&&Y({id:K,checked:E,disabled:S,value:b});function oe(Le){At.call(this,t,Le)}function Be(Le){sn[Le?"unshift":"push"](()=>{se=Le,i(1,se)})}const mt=()=>{ne&&ne(b)};return t.$$set=Le=>{e=Ye(Ye({},e),fi(Le)),i(16,s=Ut(e,n)),"value"in Le&&i(2,b=Le.value),"checked"in Le&&i(0,E=Le.checked),"disabled"in Le&&i(3,S=Le.disabled),"required"in Le&&i(4,D=Le.required),"labelPosition"in Le&&i(5,R=Le.labelPosition),"labelText"in Le&&i(6,z=Le.labelText),"hideLabel"in Le&&i(7,H=Le.hideLabel),"id"in Le&&i(8,K=Le.id),"name"in Le&&i(9,W=Le.name),"ref"in Le&&i(1,se=Le.ref),"$$scope"in Le&&i(19,m=Le.$$scope)},t.$$.update=()=>{t.$$.dirty&262148&&i(0,E=l===b)},[E,se,b,S,D,R,z,H,K,W,c,r,ne,ue,ve,_e,s,y,l,m,f,oe,Be,mt]}class zC extends Ri{constructor(e){super(),Di(this,e,NC,PC,Ci,{value:2,checked:0,disabled:3,required:4,labelPosition:5,labelText:6,hideLabel:7,id:8,name:9,ref:1})}}const BC=zC;function VC(t){let e,i;const n=t[8].default,s=$i(n,t,t[7],null);let l=[t[6],{style:t[5]}],c={};for(let r=0;r<l.length;r+=1)c=Ye(c,l[r]);return{c(){e=nt("table"),s&&s.c(),ui(e,c),$(e,"bx--data-table",!0),$(e,"bx--data-table--compact",t[0]==="compact"),$(e,"bx--data-table--short",t[0]==="short"),$(e,"bx--data-table--tall",t[0]==="tall"),$(e,"bx--data-table--md",t[0]==="medium"),$(e,"bx--data-table--sort",t[3]),$(e,"bx--data-table--zebra",t[1]),$(e,"bx--data-table--static",t[2]),$(e,"bx--data-table--sticky-header",t[4])},m(r,f){Se(r,e,f),s&&s.m(e,null),i=!0},p(r,f){s&&s.p&&(!i||f&128)&&tn(s,n,r,r[7],i?en(n,r[7],f,null):nn(r[7]),null),ui(e,c=Ni(l,[f&64&&r[6],(!i||f&32)&&{style:r[5]}])),$(e,"bx--data-table",!0),$(e,"bx--data-table--compact",r[0]==="compact"),$(e,"bx--data-table--short",r[0]==="short"),$(e,"bx--data-table--tall",r[0]==="tall"),$(e,"bx--data-table--md",r[0]==="medium"),$(e,"bx--data-table--sort",r[3]),$(e,"bx--data-table--zebra",r[1]),$(e,"bx--data-table--static",r[2]),$(e,"bx--data-table--sticky-header",r[4])},i(r){i||(ae(s,r),i=!0)},o(r){pe(s,r),i=!1},d(r){r&&Te(e),s&&s.d(r)}}}function FC(t){let e,i,n;const s=t[8].default,l=$i(s,t,t[7],null);let c=[t[6]],r={};for(let f=0;f<c.length;f+=1)r=Ye(r,c[f]);return{c(){e=nt("section"),i=nt("table"),l&&l.c(),je(i,"style",t[5]),$(i,"bx--data-table",!0),$(i,"bx--data-table--compact",t[0]==="compact"),$(i,"bx--data-table--short",t[0]==="short"),$(i,"bx--data-table--tall",t[0]==="tall"),$(i,"bx--data-table--md",t[0]==="medium"),$(i,"bx--data-table--sort",t[3]),$(i,"bx--data-table--zebra",t[1]),$(i,"bx--data-table--static",t[2]),$(i,"bx--data-table--sticky-header",t[4]),ui(e,r),$(e,"bx--data-table_inner-container",!0)},m(f,m){Se(f,e,m),Ze(e,i),l&&l.m(i,null),n=!0},p(f,m){l&&l.p&&(!n||m&128)&&tn(l,s,f,f[7],n?en(s,f[7],m,null):nn(f[7]),null),(!n||m&32)&&je(i,"style",f[5]),(!n||m&1)&&$(i,"bx--data-table--compact",f[0]==="compact"),(!n||m&1)&&$(i,"bx--data-table--short",f[0]==="short"),(!n||m&1)&&$(i,"bx--data-table--tall",f[0]==="tall"),(!n||m&1)&&$(i,"bx--data-table--md",f[0]==="medium"),(!n||m&8)&&$(i,"bx--data-table--sort",f[3]),(!n||m&2)&&$(i,"bx--data-table--zebra",f[1]),(!n||m&4)&&$(i,"bx--data-table--static",f[2]),(!n||m&16)&&$(i,"bx--data-table--sticky-header",f[4]),ui(e,r=Ni(c,[m&64&&f[6]])),$(e,"bx--data-table_inner-container",!0)},i(f){n||(ae(l,f),n=!0)},o(f){pe(l,f),n=!1},d(f){f&&Te(e),l&&l.d(f)}}}function UC(t){let e,i,n,s;const l=[FC,VC],c=[];function r(f,m){return f[4]?0:1}return e=r(t),i=c[e]=l[e](t),{c(){i.c(),n=Mn()},m(f,m){c[e].m(f,m),Se(f,n,m),s=!0},p(f,[m]){let y=e;e=r(f),e===y?c[e].p(f,m):(Ai(),pe(c[y],1,1,()=>{c[y]=null}),Ei(),i=c[e],i?i.p(f,m):(i=c[e]=l[e](f),i.c()),ae(i,1),i.m(n.parentNode,n))},i(f){s||(ae(i),s=!0)},o(f){pe(i),s=!1},d(f){f&&Te(n),c[e].d(f)}}}function jC(t,e,i){const n=["size","zebra","useStaticWidth","sortable","stickyHeader","tableStyle"];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e,{size:r=void 0}=e,{zebra:f=!1}=e,{useStaticWidth:m=!1}=e,{sortable:y=!1}=e,{stickyHeader:b=!1}=e,{tableStyle:E=void 0}=e;return t.$$set=S=>{e=Ye(Ye({},e),fi(S)),i(6,s=Ut(e,n)),"size"in S&&i(0,r=S.size),"zebra"in S&&i(1,f=S.zebra),"useStaticWidth"in S&&i(2,m=S.useStaticWidth),"sortable"in S&&i(3,y=S.sortable),"stickyHeader"in S&&i(4,b=S.stickyHeader),"tableStyle"in S&&i(5,E=S.tableStyle),"$$scope"in S&&i(7,c=S.$$scope)},[r,f,m,y,b,E,s,c,l]}let GC=class extends Ri{constructor(e){super(),Di(this,e,jC,UC,Ci,{size:0,zebra:1,useStaticWidth:2,sortable:3,stickyHeader:4,tableStyle:5})}};const HC=GC;function KC(t){let e,i;const n=t[2].default,s=$i(n,t,t[1],null);let l=[{"aria-live":"polite"},t[0]],c={};for(let r=0;r<l.length;r+=1)c=Ye(c,l[r]);return{c(){e=nt("tbody"),s&&s.c(),ui(e,c)},m(r,f){Se(r,e,f),s&&s.m(e,null),i=!0},p(r,[f]){s&&s.p&&(!i||f&2)&&tn(s,n,r,r[1],i?en(n,r[1],f,null):nn(r[1]),null),ui(e,c=Ni(l,[{"aria-live":"polite"},f&1&&r[0]]))},i(r){i||(ae(s,r),i=!0)},o(r){pe(s,r),i=!1},d(r){r&&Te(e),s&&s.d(r)}}}function qC(t,e,i){const n=[];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e;return t.$$set=r=>{e=Ye(Ye({},e),fi(r)),i(0,s=Ut(e,n)),"$$scope"in r&&i(1,c=r.$$scope)},[s,c,l]}class ZC extends Ri{constructor(e){super(),Di(this,e,qC,KC,Ci,{})}}function WC(t){let e,i,n,s;const l=t[2].default,c=$i(l,t,t[1],null);let r=[t[0]],f={};for(let m=0;m<r.length;m+=1)f=Ye(f,r[m]);return{c(){e=nt("td"),c&&c.c(),ui(e,f)},m(m,y){Se(m,e,y),c&&c.m(e,null),i=!0,n||(s=[ut(e,"click",t[3]),ut(e,"mouseover",t[4]),ut(e,"mouseenter",t[5]),ut(e,"mouseleave",t[6])],n=!0)},p(m,[y]){c&&c.p&&(!i||y&2)&&tn(c,l,m,m[1],i?en(l,m[1],y,null):nn(m[1]),null),ui(e,f=Ni(r,[y&1&&m[0]]))},i(m){i||(ae(c,m),i=!0)},o(m){pe(c,m),i=!1},d(m){m&&Te(e),c&&c.d(m),n=!1,vn(s)}}}function YC(t,e,i){const n=[];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e;function r(b){At.call(this,t,b)}function f(b){At.call(this,t,b)}function m(b){At.call(this,t,b)}function y(b){At.call(this,t,b)}return t.$$set=b=>{e=Ye(Ye({},e),fi(b)),i(0,s=Ut(e,n)),"$$scope"in b&&i(1,c=b.$$scope)},[s,c,l,r,f,m,y]}class JC extends Ri{constructor(e){super(),Di(this,e,YC,WC,Ci,{})}}const D0=JC;function Nv(t){let e,i,n,s,l,c;return{c(){e=nt("div"),i=nt("h4"),n=gi(t[0]),s=Et(),l=nt("p"),c=gi(t[1]),$(i,"bx--data-table-header__title",!0),$(l,"bx--data-table-header__description",!0),$(e,"bx--data-table-header",!0)},m(r,f){Se(r,e,f),Ze(e,i),Ze(i,n),Ze(e,s),Ze(e,l),Ze(l,c)},p(r,f){f&1&&Si(n,r[0]),f&2&&Si(c,r[1])},d(r){r&&Te(e)}}}function XC(t){let e,i,n,s=t[0]&&Nv(t);const l=t[6].default,c=$i(l,t,t[5],null);let r=[t[4]],f={};for(let m=0;m<r.length;m+=1)f=Ye(f,r[m]);return{c(){e=nt("div"),s&&s.c(),i=Et(),c&&c.c(),ui(e,f),$(e,"bx--data-table-container",!0),$(e,"bx--data-table-container--static",t[3]),$(e,"bx--data-table--max-width",t[2])},m(m,y){Se(m,e,y),s&&s.m(e,null),Ze(e,i),c&&c.m(e,null),n=!0},p(m,[y]){m[0]?s?s.p(m,y):(s=Nv(m),s.c(),s.m(e,i)):s&&(s.d(1),s=null),c&&c.p&&(!n||y&32)&&tn(c,l,m,m[5],n?en(l,m[5],y,null):nn(m[5]),null),ui(e,f=Ni(r,[y&16&&m[4]])),$(e,"bx--data-table-container",!0),$(e,"bx--data-table-container--static",m[3]),$(e,"bx--data-table--max-width",m[2])},i(m){n||(ae(c,m),n=!0)},o(m){pe(c,m),n=!1},d(m){m&&Te(e),s&&s.d(),c&&c.d(m)}}}function QC(t,e,i){const n=["title","description","stickyHeader","useStaticWidth"];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e,{title:r=""}=e,{description:f=""}=e,{stickyHeader:m=!1}=e,{useStaticWidth:y=!1}=e;return t.$$set=b=>{e=Ye(Ye({},e),fi(b)),i(4,s=Ut(e,n)),"title"in b&&i(0,r=b.title),"description"in b&&i(1,f=b.description),"stickyHeader"in b&&i(2,m=b.stickyHeader),"useStaticWidth"in b&&i(3,y=b.useStaticWidth),"$$scope"in b&&i(5,c=b.$$scope)},[r,f,m,y,s,c,l]}class $C extends Ri{constructor(e){super(),Di(this,e,QC,XC,Ci,{title:0,description:1,stickyHeader:2,useStaticWidth:3})}}function eM(t){let e,i,n,s;const l=t[2].default,c=$i(l,t,t[1],null);let r=[t[0]],f={};for(let m=0;m<r.length;m+=1)f=Ye(f,r[m]);return{c(){e=nt("thead"),c&&c.c(),ui(e,f)},m(m,y){Se(m,e,y),c&&c.m(e,null),i=!0,n||(s=[ut(e,"click",t[3]),ut(e,"mouseover",t[4]),ut(e,"mouseenter",t[5]),ut(e,"mouseleave",t[6])],n=!0)},p(m,[y]){c&&c.p&&(!i||y&2)&&tn(c,l,m,m[1],i?en(l,m[1],y,null):nn(m[1]),null),ui(e,f=Ni(r,[y&1&&m[0]]))},i(m){i||(ae(c,m),i=!0)},o(m){pe(c,m),i=!1},d(m){m&&Te(e),c&&c.d(m),n=!1,vn(s)}}}function tM(t,e,i){const n=[];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e;function r(b){At.call(this,t,b)}function f(b){At.call(this,t,b)}function m(b){At.call(this,t,b)}function y(b){At.call(this,t,b)}return t.$$set=b=>{e=Ye(Ye({},e),fi(b)),i(0,s=Ut(e,n)),"$$scope"in b&&i(1,c=b.$$scope)},[s,c,l,r,f,m,y]}class iM extends Ri{constructor(e){super(),Di(this,e,tM,eM,Ci,{})}}function zv(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function nM(t){let e,i,n=t[1]&&zv(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M16 4L6 14 7.41 15.41 15 7.83 15 28 17 28 17 7.83 24.59 15.41 26 14 16 4z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=zv(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function rM(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class sM extends Ri{constructor(e){super(),Di(this,e,rM,nM,Ci,{size:0,title:1})}}const aM=sM;function Bv(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function oM(t){let e,i,n=t[1]&&Bv(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M27.6 20.6L24 24.2 24 4 22 4 22 24.2 18.4 20.6 17 22 23 28 29 22zM9 4L3 10 4.4 11.4 8 7.8 8 28 10 28 10 7.8 13.6 11.4 15 10z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=Bv(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function lM(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class cM extends Ri{constructor(e){super(),Di(this,e,lM,oM,Ci,{size:0,title:1})}}const uM=cM;function hM(t){let e,i,n,s,l;const c=t[9].default,r=$i(c,t,t[8],null);let f=[{scope:t[3]},{"data-header":t[4]},t[6]],m={};for(let y=0;y<f.length;y+=1)m=Ye(m,f[y]);return{c(){e=nt("th"),i=nt("div"),r&&r.c(),$(i,"bx--table-header-label",!0),ui(e,m)},m(y,b){Se(y,e,b),Ze(e,i),r&&r.m(i,null),n=!0,s||(l=[ut(e,"click",t[14]),ut(e,"mouseover",t[15]),ut(e,"mouseenter",t[16]),ut(e,"mouseleave",t[17])],s=!0)},p(y,b){r&&r.p&&(!n||b&256)&&tn(r,c,y,y[8],n?en(c,y[8],b,null):nn(y[8]),null),ui(e,m=Ni(f,[(!n||b&8)&&{scope:y[3]},(!n||b&16)&&{"data-header":y[4]},b&64&&y[6]]))},i(y){n||(ae(r,y),n=!0)},o(y){pe(r,y),n=!1},d(y){y&&Te(e),r&&r.d(y),s=!1,vn(l)}}}function dM(t){let e,i,n,s,l,c,r,f,m,y,b;const E=t[9].default,S=$i(E,t,t[8],null);l=new aM({props:{size:20,"aria-label":t[5],class:"bx--table-sort__icon"}}),r=new uM({props:{size:20,"aria-label":t[5],class:"bx--table-sort__icon-unsorted"}});let D=[{"aria-sort":f=t[2]?t[1]:"none"},{scope:t[3]},{"data-header":t[4]},t[6]],R={};for(let z=0;z<D.length;z+=1)R=Ye(R,D[z]);return{c(){e=nt("th"),i=nt("button"),n=nt("div"),S&&S.c(),s=Et(),Mt(l.$$.fragment),c=Et(),Mt(r.$$.fragment),$(n,"bx--table-header-label",!0),je(i,"type","button"),$(i,"bx--table-sort",!0),$(i,"bx--table-sort--active",t[2]),$(i,"bx--table-sort--ascending",t[2]&&t[1]==="descending"),ui(e,R)},m(z,H){Se(z,e,H),Ze(e,i),Ze(i,n),S&&S.m(n,null),Ze(i,s),Ot(l,i,null),Ze(i,c),Ot(r,i,null),m=!0,y||(b=[ut(i,"click",t[13]),ut(e,"mouseover",t[10]),ut(e,"mouseenter",t[11]),ut(e,"mouseleave",t[12])],y=!0)},p(z,H){S&&S.p&&(!m||H&256)&&tn(S,E,z,z[8],m?en(E,z[8],H,null):nn(z[8]),null);const K={};H&32&&(K["aria-label"]=z[5]),l.$set(K);const W={};H&32&&(W["aria-label"]=z[5]),r.$set(W),(!m||H&4)&&$(i,"bx--table-sort--active",z[2]),(!m||H&6)&&$(i,"bx--table-sort--ascending",z[2]&&z[1]==="descending"),ui(e,R=Ni(D,[(!m||H&6&&f!==(f=z[2]?z[1]:"none"))&&{"aria-sort":f},(!m||H&8)&&{scope:z[3]},(!m||H&16)&&{"data-header":z[4]},H&64&&z[6]]))},i(z){m||(ae(S,z),ae(l.$$.fragment,z),ae(r.$$.fragment,z),m=!0)},o(z){pe(S,z),pe(l.$$.fragment,z),pe(r.$$.fragment,z),m=!1},d(z){z&&Te(e),S&&S.d(z),Ct(l),Ct(r),y=!1,vn(b)}}}function fM(t){let e,i,n,s;const l=[dM,hM],c=[];function r(f,m){return f[0]?0:1}return e=r(t),i=c[e]=l[e](t),{c(){i.c(),n=Mn()},m(f,m){c[e].m(f,m),Se(f,n,m),s=!0},p(f,[m]){let y=e;e=r(f),e===y?c[e].p(f,m):(Ai(),pe(c[y],1,1,()=>{c[y]=null}),Ei(),i=c[e],i?i.p(f,m):(i=c[e]=l[e](f),i.c()),ae(i,1),i.m(n.parentNode,n))},i(f){s||(ae(i),s=!0)},o(f){pe(i),s=!1},d(f){f&&Te(n),c[e].d(f)}}}function mM(t,e,i){let n;const s=["sortable","sortDirection","active","scope","translateWithId","id"];let l=Ut(e,s),{$$slots:c={},$$scope:r}=e,{sortable:f=!1}=e,{sortDirection:m="none"}=e,{active:y=!1}=e,{scope:b="col"}=e,{translateWithId:E=()=>""}=e,{id:S="ccs-"+Math.random().toString(36)}=e;function D(ne){At.call(this,t,ne)}function R(ne){At.call(this,t,ne)}function z(ne){At.call(this,t,ne)}function H(ne){At.call(this,t,ne)}function K(ne){At.call(this,t,ne)}function W(ne){At.call(this,t,ne)}function se(ne){At.call(this,t,ne)}function Y(ne){At.call(this,t,ne)}return t.$$set=ne=>{e=Ye(Ye({},e),fi(ne)),i(6,l=Ut(e,s)),"sortable"in ne&&i(0,f=ne.sortable),"sortDirection"in ne&&i(1,m=ne.sortDirection),"active"in ne&&i(2,y=ne.active),"scope"in ne&&i(3,b=ne.scope),"translateWithId"in ne&&i(7,E=ne.translateWithId),"id"in ne&&i(4,S=ne.id),"$$scope"in ne&&i(8,r=ne.$$scope)},t.$$.update=()=>{t.$$.dirty&128&&i(5,n=E())},[f,m,y,b,S,n,l,E,r,c,D,R,z,H,K,W,se,Y]}class pM extends Ri{constructor(e){super(),Di(this,e,mM,fM,Ci,{sortable:0,sortDirection:1,active:2,scope:3,translateWithId:7,id:4})}}const gM=pM;function _M(t){let e,i,n,s;const l=t[2].default,c=$i(l,t,t[1],null);let r=[t[0]],f={};for(let m=0;m<r.length;m+=1)f=Ye(f,r[m]);return{c(){e=nt("tr"),c&&c.c(),ui(e,f)},m(m,y){Se(m,e,y),c&&c.m(e,null),i=!0,n||(s=[ut(e,"click",t[3]),ut(e,"mouseover",t[4]),ut(e,"mouseenter",t[5]),ut(e,"mouseleave",t[6])],n=!0)},p(m,[y]){c&&c.p&&(!i||y&2)&&tn(c,l,m,m[1],i?en(l,m[1],y,null):nn(m[1]),null),ui(e,f=Ni(r,[y&1&&m[0]]))},i(m){i||(ae(c,m),i=!0)},o(m){pe(c,m),i=!1},d(m){m&&Te(e),c&&c.d(m),n=!1,vn(s)}}}function yM(t,e,i){const n=[];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e;function r(b){At.call(this,t,b)}function f(b){At.call(this,t,b)}function m(b){At.call(this,t,b)}function y(b){At.call(this,t,b)}return t.$$set=b=>{e=Ye(Ye({},e),fi(b)),i(0,s=Ut(e,n)),"$$scope"in b&&i(1,c=b.$$scope)},[s,c,l,r,f,m,y]}class RA extends Ri{constructor(e){super(),Di(this,e,yM,_M,Ci,{})}}function Vv(t,e,i){const n=t.slice();return n[66]=e[i],n[68]=i,n}const vM=t=>({row:t[0]&201850880}),Fv=t=>({row:t[66]});function Uv(t,e,i){const n=t.slice();return n[69]=e[i],n[71]=i,n}const bM=t=>({row:t[0]&201850880,cell:t[0]&470286336,rowIndex:t[0]&201850880,cellIndex:t[0]&470286336}),jv=t=>({row:t[66],cell:t[69],rowIndex:t[68],cellIndex:t[71]}),xM=t=>({row:t[0]&201850880,cell:t[0]&470286336,rowIndex:t[0]&201850880,cellIndex:t[0]&470286336}),Gv=t=>({row:t[66],cell:t[69],rowIndex:t[68],cellIndex:t[71]});function Hv(t,e,i){const n=t.slice();return n[72]=e[i],n}const wM=t=>({header:t[0]&64}),Kv=t=>({header:t[72]}),AM=t=>({}),qv=t=>({}),EM=t=>({}),Zv=t=>({});function Wv(t){let e,i,n,s=(t[8]||t[38].title)&&Yv(t),l=(t[9]||t[38].description)&&Jv(t);return{c(){e=nt("div"),s&&s.c(),i=Et(),l&&l.c(),$(e,"bx--data-table-header",!0)},m(c,r){Se(c,e,r),s&&s.m(e,null),Ze(e,i),l&&l.m(e,null),n=!0},p(c,r){c[8]||c[38].title?s?(s.p(c,r),r[0]&256|r[1]&128&&ae(s,1)):(s=Yv(c),s.c(),ae(s,1),s.m(e,i)):s&&(Ai(),pe(s,1,1,()=>{s=null}),Ei()),c[9]||c[38].description?l?(l.p(c,r),r[0]&512|r[1]&128&&ae(l,1)):(l=Jv(c),l.c(),ae(l,1),l.m(e,null)):l&&(Ai(),pe(l,1,1,()=>{l=null}),Ei())},i(c){n||(ae(s),ae(l),n=!0)},o(c){pe(s),pe(l),n=!1},d(c){c&&Te(e),s&&s.d(),l&&l.d()}}}function Yv(t){let e,i;const n=t[48].title,s=$i(n,t,t[62],Zv),l=s||TM(t);return{c(){e=nt("h4"),l&&l.c(),$(e,"bx--data-table-header__title",!0)},m(c,r){Se(c,e,r),l&&l.m(e,null),i=!0},p(c,r){s?s.p&&(!i||r[2]&1)&&tn(s,n,c,c[62],i?en(n,c[62],r,EM):nn(c[62]),Zv):l&&l.p&&(!i||r[0]&256)&&l.p(c,i?r:[-1,-1,-1])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function TM(t){let e;return{c(){e=gi(t[8])},m(i,n){Se(i,e,n)},p(i,n){n[0]&256&&Si(e,i[8])},d(i){i&&Te(e)}}}function Jv(t){let e,i;const n=t[48].description,s=$i(n,t,t[62],qv),l=s||SM(t);return{c(){e=nt("p"),l&&l.c(),$(e,"bx--data-table-header__description",!0)},m(c,r){Se(c,e,r),l&&l.m(e,null),i=!0},p(c,r){s?s.p&&(!i||r[2]&1)&&tn(s,n,c,c[62],i?en(n,c[62],r,AM):nn(c[62]),qv):l&&l.p&&(!i||r[0]&512)&&l.p(c,i?r:[-1,-1,-1])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function SM(t){let e;return{c(){e=gi(t[9])},m(i,n){Se(i,e,n)},p(i,n){n[0]&512&&Si(e,i[9])},d(i){i&&Te(e)}}}function Xv(t){let e,i,n,s=t[12]&&Qv(t);return{c(){e=nt("th"),s&&s.c(),je(e,"scope","col"),je(e,"data-previous-value",i=t[22]?"collapsed":void 0),$(e,"bx--table-expand",!0)},m(l,c){Se(l,e,c),s&&s.m(e,null),n=!0},p(l,c){l[12]?s?(s.p(l,c),c[0]&4096&&ae(s,1)):(s=Qv(l),s.c(),ae(s,1),s.m(e,null)):s&&(Ai(),pe(s,1,1,()=>{s=null}),Ei()),(!n||c[0]&4194304&&i!==(i=l[22]?"collapsed":void 0))&&je(e,"data-previous-value",i)},i(l){n||(ae(s),n=!0)},o(l){pe(s),n=!1},d(l){l&&Te(e),s&&s.d()}}}function Qv(t){let e,i,n,s,l;return i=new SA({props:{class:"bx--table-expand__svg"}}),{c(){e=nt("button"),Mt(i.$$.fragment),je(e,"type","button"),$(e,"bx--table-expand__button",!0)},m(c,r){Se(c,e,r),Ot(i,e,null),n=!0,s||(l=ut(e,"click",t[49]),s=!0)},p:ki,i(c){n||(ae(i.$$.fragment,c),n=!0)},o(c){pe(i.$$.fragment,c),n=!1},d(c){c&&Te(e),Ct(i),s=!1,l()}}}function $v(t){let e;return{c(){e=nt("th"),je(e,"scope","col")},m(i,n){Se(i,e,n)},d(i){i&&Te(e)}}}function eb(t){let e,i,n,s;function l(r){t[50](r)}let c={"aria-label":"Select all rows",checked:t[30],indeterminate:t[29]};return t[24]!==void 0&&(c.ref=t[24]),i=new IA({props:c}),sn.push(()=>Fa(i,"ref",l)),i.$on("change",t[51]),{c(){e=nt("th"),Mt(i.$$.fragment),je(e,"scope","col"),$(e,"bx--table-column-checkbox",!0)},m(r,f){Se(r,e,f),Ot(i,e,null),s=!0},p(r,f){const m={};f[0]&1073741824&&(m.checked=r[30]),f[0]&536870912&&(m.indeterminate=r[29]),!n&&f[0]&16777216&&(n=!0,m.ref=r[24],Va(()=>n=!1)),i.$set(m)},i(r){s||(ae(i.$$.fragment,r),s=!0)},o(r){pe(i.$$.fragment,r),s=!1},d(r){r&&Te(e),Ct(i)}}}function IM(t){let e,i;function n(){return t[52](t[72])}return e=new gM({props:{id:t[72].key,style:t[36](t[72]),sortable:t[11]&&t[72].sort!==!1,sortDirection:t[0]===t[72].key?t[1]:"none",active:t[0]===t[72].key,$$slots:{default:[CM]},$$scope:{ctx:t}}}),e.$on("click",n),{c(){Mt(e.$$.fragment)},m(s,l){Ot(e,s,l),i=!0},p(s,l){t=s;const c={};l[0]&64&&(c.id=t[72].key),l[0]&64&&(c.style=t[36](t[72])),l[0]&2112&&(c.sortable=t[11]&&t[72].sort!==!1),l[0]&67&&(c.sortDirection=t[0]===t[72].key?t[1]:"none"),l[0]&65&&(c.active=t[0]===t[72].key),l[0]&64|l[2]&1&&(c.$$scope={dirty:l,ctx:t}),e.$set(c)},i(s){i||(ae(e.$$.fragment,s),i=!0)},o(s){pe(e.$$.fragment,s),i=!1},d(s){Ct(e,s)}}}function kM(t){let e,i;return{c(){e=nt("th"),je(e,"scope","col"),je(e,"style",i=t[36](t[72]))},m(n,s){Se(n,e,s)},p(n,s){s[0]&64&&i!==(i=n[36](n[72]))&&je(e,"style",i)},i:ki,o:ki,d(n){n&&Te(e)}}}function OM(t){let e=t[72].value+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p(n,s){s[0]&64&&e!==(e=n[72].value+"")&&Si(i,e)},d(n){n&&Te(i)}}}function CM(t){let e,i;const n=t[48]["cell-header"],s=$i(n,t,t[62],Kv),l=s||OM(t);return{c(){l&&l.c(),e=Et()},m(c,r){l&&l.m(c,r),Se(c,e,r),i=!0},p(c,r){s?s.p&&(!i||r[0]&64|r[2]&1)&&tn(s,n,c,c[62],i?en(n,c[62],r,wM):nn(c[62]),Kv):l&&l.p&&(!i||r[0]&64)&&l.p(c,i?r:[-1,-1,-1])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function tb(t,e){let i,n,s,l,c;const r=[kM,IM],f=[];function m(y,b){return y[72].empty?0:1}return n=m(e),s=f[n]=r[n](e),{key:t,first:null,c(){i=Mn(),s.c(),l=Mn(),this.first=i},m(y,b){Se(y,i,b),f[n].m(y,b),Se(y,l,b),c=!0},p(y,b){e=y;let E=n;n=m(e),n===E?f[n].p(e,b):(Ai(),pe(f[E],1,1,()=>{f[E]=null}),Ei(),s=f[n],s?s.p(e,b):(s=f[n]=r[n](e),s.c()),ae(s,1),s.m(l.parentNode,l))},i(y){c||(ae(s),c=!0)},o(y){pe(s),c=!1},d(y){y&&(Te(i),Te(l)),f[n].d(y)}}}function MM(t){let e,i,n,s=[],l=new Map,c,r,f=t[4]&&Xv(t),m=t[5]&&!t[15]&&$v(),y=t[15]&&!t[14]&&eb(t),b=Ks(t[6]);const E=S=>S[72].key;for(let S=0;S<b.length;S+=1){let D=Hv(t,b,S),R=E(D);l.set(R,s[S]=tb(R,D))}return{c(){f&&f.c(),e=Et(),m&&m.c(),i=Et(),y&&y.c(),n=Et();for(let S=0;S<s.length;S+=1)s[S].c();c=Mn()},m(S,D){f&&f.m(S,D),Se(S,e,D),m&&m.m(S,D),Se(S,i,D),y&&y.m(S,D),Se(S,n,D);for(let R=0;R<s.length;R+=1)s[R]&&s[R].m(S,D);Se(S,c,D),r=!0},p(S,D){S[4]?f?(f.p(S,D),D[0]&16&&ae(f,1)):(f=Xv(S),f.c(),ae(f,1),f.m(e.parentNode,e)):f&&(Ai(),pe(f,1,1,()=>{f=null}),Ei()),S[5]&&!S[15]?m||(m=$v(),m.c(),m.m(i.parentNode,i)):m&&(m.d(1),m=null),S[15]&&!S[14]?y?(y.p(S,D),D[0]&49152&&ae(y,1)):(y=eb(S),y.c(),ae(y,1),y.m(n.parentNode,n)):y&&(Ai(),pe(y,1,1,()=>{y=null}),Ei()),D[0]&2115|D[1]&46|D[2]&1&&(b=Ks(S[6]),Ai(),s=fu(s,D,E,1,S,b,l,c.parentNode,du,tb,c,Hv),Ei())},i(S){if(!r){ae(f),ae(y);for(let D=0;D<b.length;D+=1)ae(s[D]);r=!0}},o(S){pe(f),pe(y);for(let D=0;D<s.length;D+=1)pe(s[D]);r=!1},d(S){S&&(Te(e),Te(i),Te(n),Te(c)),f&&f.d(S),m&&m.d(S),y&&y.d(S);for(let D=0;D<s.length;D+=1)s[D].d(S)}}}function DM(t){let e,i;return e=new RA({props:{$$slots:{default:[MM]},$$scope:{ctx:t}}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s[0]&1634785407|s[1]&2|s[2]&1&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function ib(t){let e,i;return e=new D0({props:{class:"bx--table-expand",headers:"expand","data-previous-value":!t[13].includes(t[66].id)&&t[31][t[66].id]?"collapsed":void 0,$$slots:{default:[RM]},$$scope:{ctx:t}}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s[0]&201859072|s[1]&1&&(l["data-previous-value"]=!n[13].includes(n[66].id)&&n[31][n[66].id]?"collapsed":void 0),s[0]&201859076|s[1]&1|s[2]&1&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function nb(t){let e,i,n,s,l,c;i=new SA({props:{class:"bx--table-expand__svg"}});function r(){return t[53](t[66])}return{c(){e=nt("button"),Mt(i.$$.fragment),je(e,"type","button"),je(e,"aria-label",n=t[31][t[66].id]?"Collapse current row":"Expand current row"),$(e,"bx--table-expand__button",!0)},m(f,m){Se(f,e,m),Ot(i,e,null),s=!0,l||(c=ut(e,"click",iu(r)),l=!0)},p(f,m){t=f,(!s||m[0]&201850880|m[1]&1&&n!==(n=t[31][t[66].id]?"Collapse current row":"Expand current row"))&&je(e,"aria-label",n)},i(f){s||(ae(i.$$.fragment,f),s=!0)},o(f){pe(i.$$.fragment,f),s=!1},d(f){f&&Te(e),Ct(i),l=!1,c()}}}function RM(t){let e=!t[13].includes(t[66].id),i,n,s=e&&nb(t);return{c(){s&&s.c(),i=Mn()},m(l,c){s&&s.m(l,c),Se(l,i,c),n=!0},p(l,c){c[0]&201859072&&(e=!l[13].includes(l[66].id)),e?s?(s.p(l,c),c[0]&201859072&&ae(s,1)):(s=nb(l),s.c(),ae(s,1),s.m(i.parentNode,i)):s&&(Ai(),pe(s,1,1,()=>{s=null}),Ei())},i(l){n||(ae(s),n=!0)},o(l){pe(s),n=!1},d(l){l&&Te(i),s&&s.d(l)}}}function rb(t){let e,i=!t[16].includes(t[66].id),n,s=i&&sb(t);return{c(){e=nt("td"),s&&s.c(),$(e,"bx--table-column-checkbox",!0),$(e,"bx--table-column-radio",t[14])},m(l,c){Se(l,e,c),s&&s.m(e,null),n=!0},p(l,c){c[0]&201916416&&(i=!l[16].includes(l[66].id)),i?s?(s.p(l,c),c[0]&201916416&&ae(s,1)):(s=sb(l),s.c(),ae(s,1),s.m(e,null)):s&&(Ai(),pe(s,1,1,()=>{s=null}),Ei()),(!n||c[0]&16384)&&$(e,"bx--table-column-radio",l[14])},i(l){n||(ae(s),n=!0)},o(l){pe(s),n=!1},d(l){l&&Te(e),s&&s.d()}}}function sb(t){let e,i,n,s;const l=[PM,LM],c=[];function r(f,m){return f[14]?0:1}return e=r(t),i=c[e]=l[e](t),{c(){i.c(),n=Mn()},m(f,m){c[e].m(f,m),Se(f,n,m),s=!0},p(f,m){let y=e;e=r(f),e===y?c[e].p(f,m):(Ai(),pe(c[y],1,1,()=>{c[y]=null}),Ei(),i=c[e],i?i.p(f,m):(i=c[e]=l[e](f),i.c()),ae(i,1),i.m(n.parentNode,n))},i(f){s||(ae(i),s=!0)},o(f){pe(i),s=!1},d(f){f&&Te(n),c[e].d(f)}}}function LM(t){let e,i;function n(){return t[55](t[66])}return e=new IA({props:{name:"select-row-"+t[66].id,checked:t[3].includes(t[66].id)}}),e.$on("change",n),{c(){Mt(e.$$.fragment)},m(s,l){Ot(e,s,l),i=!0},p(s,l){t=s;const c={};l[0]&201850880&&(c.name="select-row-"+t[66].id),l[0]&201850888&&(c.checked=t[3].includes(t[66].id)),e.$set(c)},i(s){i||(ae(e.$$.fragment,s),i=!0)},o(s){pe(e.$$.fragment,s),i=!1},d(s){Ct(e,s)}}}function PM(t){let e,i;function n(){return t[54](t[66])}return e=new BC({props:{name:"select-row-"+t[66].id,checked:t[3].includes(t[66].id)}}),e.$on("change",n),{c(){Mt(e.$$.fragment)},m(s,l){Ot(e,s,l),i=!0},p(s,l){t=s;const c={};l[0]&201850880&&(c.name="select-row-"+t[66].id),l[0]&201850888&&(c.checked=t[3].includes(t[66].id)),e.$set(c)},i(s){i||(ae(e.$$.fragment,s),i=!0)},o(s){pe(e.$$.fragment,s),i=!1},d(s){Ct(e,s)}}}function NM(t){let e,i;function n(){return t[56](t[66],t[69])}return e=new D0({props:{$$slots:{default:[VM]},$$scope:{ctx:t}}}),e.$on("click",n),{c(){Mt(e.$$.fragment)},m(s,l){Ot(e,s,l),i=!0},p(s,l){t=s;const c={};l[0]&470286336|l[2]&1&&(c.$$scope={dirty:l,ctx:t}),e.$set(c)},i(s){i||(ae(e.$$.fragment,s),i=!0)},o(s){pe(e.$$.fragment,s),i=!1},d(s){Ct(e,s)}}}function zM(t){let e,i,n;const s=t[48].cell,l=$i(s,t,t[62],Gv),c=l||FM(t);return{c(){e=nt("td"),c&&c.c(),i=Et(),$(e,"bx--table-column-menu",t[6][t[71]].columnMenu)},m(r,f){Se(r,e,f),c&&c.m(e,null),Ze(e,i),n=!0},p(r,f){l?l.p&&(!n||f[0]&470286336|f[2]&1)&&tn(l,s,r,r[62],n?en(s,r[62],f,xM):nn(r[62]),Gv):c&&c.p&&(!n||f[0]&470286336)&&c.p(r,n?f:[-1,-1,-1]),(!n||f[0]&470286400)&&$(e,"bx--table-column-menu",r[6][r[71]].columnMenu)},i(r){n||(ae(c,r),n=!0)},o(r){pe(c,r),n=!1},d(r){r&&Te(e),c&&c.d(r)}}}function BM(t){let e=(t[69].display?t[69].display(t[69].value,t[66]):t[69].value)+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p(n,s){s[0]&470286336&&e!==(e=(n[69].display?n[69].display(n[69].value,n[66]):n[69].value)+"")&&Si(i,e)},d(n){n&&Te(i)}}}function VM(t){let e,i;const n=t[48].cell,s=$i(n,t,t[62],jv),l=s||BM(t);return{c(){l&&l.c(),e=Et()},m(c,r){l&&l.m(c,r),Se(c,e,r),i=!0},p(c,r){s?s.p&&(!i||r[0]&470286336|r[2]&1)&&tn(s,n,c,c[62],i?en(n,c[62],r,bM):nn(c[62]),jv):l&&l.p&&(!i||r[0]&470286336)&&l.p(c,i?r:[-1,-1,-1])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function FM(t){let e=(t[69].display?t[69].display(t[69].value,t[66]):t[69].value)+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p(n,s){s[0]&470286336&&e!==(e=(n[69].display?n[69].display(n[69].value,n[66]):n[69].value)+"")&&Si(i,e)},d(n){n&&Te(i)}}}function ab(t,e){let i,n,s,l,c;const r=[zM,NM],f=[];function m(y,b){return y[6][y[71]].empty?0:1}return n=m(e),s=f[n]=r[n](e),{key:t,first:null,c(){i=Mn(),s.c(),l=Mn(),this.first=i},m(y,b){Se(y,i,b),f[n].m(y,b),Se(y,l,b),c=!0},p(y,b){e=y;let E=n;n=m(e),n===E?f[n].p(e,b):(Ai(),pe(f[E],1,1,()=>{f[E]=null}),Ei(),s=f[n],s?s.p(e,b):(s=f[n]=r[n](e),s.c()),ae(s,1),s.m(l.parentNode,l))},i(y){c||(ae(s),c=!0)},o(y){pe(s),c=!1},d(y){y&&(Te(i),Te(l)),f[n].d(y)}}}function UM(t){let e,i,n=[],s=new Map,l,c,r=t[4]&&ib(t),f=t[5]&&rb(t),m=Ks(t[28][t[66].id]);const y=b=>b[69].key;for(let b=0;b<m.length;b+=1){let E=Uv(t,m,b),S=y(E);s.set(S,n[b]=ab(S,E))}return{c(){r&&r.c(),e=Et(),f&&f.c(),i=Et();for(let b=0;b<n.length;b+=1)n[b].c();l=Mn()},m(b,E){r&&r.m(b,E),Se(b,e,E),f&&f.m(b,E),Se(b,i,E);for(let S=0;S<n.length;S+=1)n[S]&&n[S].m(b,E);Se(b,l,E),c=!0},p(b,E){b[4]?r?(r.p(b,E),E[0]&16&&ae(r,1)):(r=ib(b),r.c(),ae(r,1),r.m(e.parentNode,e)):r&&(Ai(),pe(r,1,1,()=>{r=null}),Ei()),b[5]?f?(f.p(b,E),E[0]&32&&ae(f,1)):(f=rb(b),f.c(),ae(f,1),f.m(i.parentNode,i)):f&&(Ai(),pe(f,1,1,()=>{f=null}),Ei()),E[0]&470286400|E[1]&8|E[2]&1&&(m=Ks(b[28][b[66].id]),Ai(),n=fu(n,E,y,1,b,m,s,l.parentNode,du,ab,l,Uv),Ei())},i(b){if(!c){ae(r),ae(f);for(let E=0;E<m.length;E+=1)ae(n[E]);c=!0}},o(b){pe(r),pe(f);for(let E=0;E<n.length;E+=1)pe(n[E]);c=!1},d(b){b&&(Te(e),Te(i),Te(l)),r&&r.d(b),f&&f.d(b);for(let E=0;E<n.length;E+=1)n[E].d(b)}}}function ob(t){let e,i=t[31][t[66].id]&&!t[13].includes(t[66].id),n,s,l,c,r=i&&lb(t);function f(){return t[60](t[66])}function m(){return t[61](t[66])}return{c(){e=nt("tr"),r&&r.c(),n=Et(),je(e,"data-child-row",""),$(e,"bx--expandable-row",!0)},m(y,b){Se(y,e,b),r&&r.m(e,null),Ze(e,n),s=!0,l||(c=[ut(e,"mouseenter",f),ut(e,"mouseleave",m)],l=!0)},p(y,b){t=y,b[0]&201859072|b[1]&1&&(i=t[31][t[66].id]&&!t[13].includes(t[66].id)),i?r?(r.p(t,b),b[0]&201859072|b[1]&1&&ae(r,1)):(r=lb(t),r.c(),ae(r,1),r.m(e,n)):r&&(Ai(),pe(r,1,1,()=>{r=null}),Ei())},i(y){s||(ae(r),s=!0)},o(y){pe(r),s=!1},d(y){y&&Te(e),r&&r.d(),l=!1,vn(c)}}}function lb(t){let e,i;return e=new D0({props:{colspan:t[5]?t[6].length+2:t[6].length+1,$$slots:{default:[jM]},$$scope:{ctx:t}}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s[0]&96&&(l.colspan=n[5]?n[6].length+2:n[6].length+1),s[0]&201850880|s[2]&1&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function jM(t){let e,i;const n=t[48]["expanded-row"],s=$i(n,t,t[62],Fv);return{c(){e=nt("div"),s&&s.c(),$(e,"bx--child-row-inner-container",!0)},m(l,c){Se(l,e,c),s&&s.m(e,null),i=!0},p(l,c){s&&s.p&&(!i||c[0]&201850880|c[2]&1)&&tn(s,n,l,l[62],i?en(n,l[62],c,vM):nn(l[62]),Fv)},i(l){i||(ae(s,l),i=!0)},o(l){pe(s,l),i=!1},d(l){l&&Te(e),s&&s.d(l)}}}function cb(t,e){let i,n,s,l,c;function r(...b){return e[57](e[66],...b)}function f(){return e[58](e[66])}function m(){return e[59](e[66])}n=new RA({props:{"data-row":e[66].id,"data-parent-row":e[4]?!0:void 0,class:(e[3].includes(e[66].id)?"bx--data-table--selected":"")+" "+(e[31][e[66].id]?"bx--expandable-row":"")+" "+(e[4]?"bx--parent-row":"")+" "+(e[4]&&e[23]===e[66].id?"bx--expandable-row--hover":""),$$slots:{default:[UM]},$$scope:{ctx:e}}}),n.$on("click",r),n.$on("mouseenter",f),n.$on("mouseleave",m);let y=e[4]&&ob(e);return{key:t,first:null,c(){i=Mn(),Mt(n.$$.fragment),s=Et(),y&&y.c(),l=Mn(),this.first=i},m(b,E){Se(b,i,E),Ot(n,b,E),Se(b,s,E),y&&y.m(b,E),Se(b,l,E),c=!0},p(b,E){e=b;const S={};E[0]&201850880&&(S["data-row"]=e[66].id),E[0]&16&&(S["data-parent-row"]=e[4]?!0:void 0),E[0]&210239512|E[1]&1&&(S.class=(e[3].includes(e[66].id)?"bx--data-table--selected":"")+" "+(e[31][e[66].id]?"bx--expandable-row":"")+" "+(e[4]?"bx--parent-row":"")+" "+(e[4]&&e[23]===e[66].id?"bx--expandable-row--hover":"")),E[0]&470376572|E[1]&1|E[2]&1&&(S.$$scope={dirty:E,ctx:e}),n.$set(S),e[4]?y?(y.p(e,E),E[0]&16&&ae(y,1)):(y=ob(e),y.c(),ae(y,1),y.m(l.parentNode,l)):y&&(Ai(),pe(y,1,1,()=>{y=null}),Ei())},i(b){c||(ae(n.$$.fragment,b),ae(y),c=!0)},o(b){pe(n.$$.fragment,b),pe(y),c=!1},d(b){b&&(Te(i),Te(s),Te(l)),Ct(n,b),y&&y.d(b)}}}function GM(t){let e=[],i=new Map,n,s,l=Ks(t[19]?t[26]:t[27]);const c=r=>r[66].id;for(let r=0;r<l.length;r+=1){let f=Vv(t,l,r),m=c(f);i.set(m,e[r]=cb(m,f))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();n=Mn()},m(r,f){for(let m=0;m<e.length;m+=1)e[m]&&e[m].m(r,f);Se(r,n,f),s=!0},p(r,f){f[0]&478765180|f[1]&9|f[2]&1&&(l=Ks(r[19]?r[26]:r[27]),Ai(),e=fu(e,f,c,1,r,l,i,n.parentNode,du,cb,n,Vv),Ei())},i(r){if(!s){for(let f=0;f<l.length;f+=1)ae(e[f]);s=!0}},o(r){for(let f=0;f<e.length;f+=1)pe(e[f]);s=!1},d(r){r&&Te(n);for(let f=0;f<e.length;f+=1)e[f].d(r)}}}function HM(t){let e,i,n,s;return e=new iM({props:{$$slots:{default:[DM]},$$scope:{ctx:t}}}),n=new ZC({props:{$$slots:{default:[GM]},$$scope:{ctx:t}}}),{c(){Mt(e.$$.fragment),i=Et(),Mt(n.$$.fragment)},m(l,c){Ot(e,l,c),Se(l,i,c),Ot(n,l,c),s=!0},p(l,c){const r={};c[0]&1634785407|c[1]&2|c[2]&1&&(r.$$scope={dirty:c,ctx:l}),e.$set(r);const f={};c[0]&478765180|c[1]&1|c[2]&1&&(f.$$scope={dirty:c,ctx:l}),n.$set(f)},i(l){s||(ae(e.$$.fragment,l),ae(n.$$.fragment,l),s=!0)},o(l){pe(e.$$.fragment,l),pe(n.$$.fragment,l),s=!1},d(l){l&&Te(i),Ct(e,l),Ct(n,l)}}}function KM(t){let e,i,n,s,l=(t[8]||t[38].title||t[9]||t[38].description)&&Wv(t);const c=t[48].default,r=$i(c,t,t[62],null);return n=new HC({props:{zebra:t[10],size:t[7],stickyHeader:t[17],sortable:t[11],useStaticWidth:t[18],tableStyle:t[25]&&"table-layout: fixed",$$slots:{default:[HM]},$$scope:{ctx:t}}}),{c(){l&&l.c(),e=Et(),r&&r.c(),i=Et(),Mt(n.$$.fragment)},m(f,m){l&&l.m(f,m),Se(f,e,m),r&&r.m(f,m),Se(f,i,m),Ot(n,f,m),s=!0},p(f,m){f[8]||f[38].title||f[9]||f[38].description?l?(l.p(f,m),m[0]&768|m[1]&128&&ae(l,1)):(l=Wv(f),l.c(),ae(l,1),l.m(e.parentNode,e)):l&&(Ai(),pe(l,1,1,()=>{l=null}),Ei()),r&&r.p&&(!s||m[2]&1)&&tn(r,c,f,f[62],s?en(c,f[62],m,null):nn(f[62]),null);const y={};m[0]&1024&&(y.zebra=f[10]),m[0]&128&&(y.size=f[7]),m[0]&131072&&(y.stickyHeader=f[17]),m[0]&2048&&(y.sortable=f[11]),m[0]&262144&&(y.useStaticWidth=f[18]),m[0]&33554432&&(y.tableStyle=f[25]&&"table-layout: fixed"),m[0]&2113534079|m[1]&3|m[2]&1&&(y.$$scope={dirty:m,ctx:f}),n.$set(y)},i(f){s||(ae(l),ae(r,f),ae(n.$$.fragment,f),s=!0)},o(f){pe(l),pe(r,f),pe(n.$$.fragment,f),s=!1},d(f){f&&(Te(e),Te(i)),l&&l.d(f),r&&r.d(f),Ct(n,f)}}}function qM(t){let e,i;const n=[{useStaticWidth:t[18]},t[37]];let s={$$slots:{default:[KM]},$$scope:{ctx:t}};for(let l=0;l<n.length;l+=1)s=Ye(s,n[l]);return e=new $C({props:s}),{c(){Mt(e.$$.fragment)},m(l,c){Ot(e,l,c),i=!0},p(l,c){const r=c[0]&262144|c[1]&64?Ni(n,[c[0]&262144&&{useStaticWidth:l[18]},c[1]&64&&hf(l[37])]):{};c[0]&2147483647|c[1]&131|c[2]&1&&(r.$$scope={dirty:c,ctx:l}),e.$set(r)},i(l){i||(ae(e.$$.fragment,l),i=!0)},o(l){pe(e.$$.fragment,l),i=!1},d(l){Ct(e,l)}}}function ZM(t,e,i){let n,s,l,c,r,f,m,y,b,E,S,D,R,z,H,K;const W=["headers","rows","size","title","description","zebra","sortable","sortKey","sortDirection","expandable","batchExpansion","expandedRowIds","nonExpandableRowIds","radio","selectable","batchSelection","selectedRowIds","nonSelectableRowIds","stickyHeader","useStaticWidth","pageSize","page"];let se=Ut(e,W),Y,{$$slots:ne={},$$scope:ue}=e;const ve=hu(ne);let{headers:_e=[]}=e,{rows:oe=[]}=e,{size:Be=void 0}=e,{title:mt=""}=e,{description:Le=""}=e,{zebra:rt=!1}=e,{sortable:tt=!1}=e,{sortKey:We=null}=e,{sortDirection:Ve="none"}=e,{expandable:St=!1}=e,{batchExpansion:zt=!1}=e,{expandedRowIds:mi=[]}=e,{nonExpandableRowIds:vt=[]}=e,{radio:pt=!1}=e,{selectable:Pt=!1}=e,{batchSelection:qe=!1}=e,{selectedRowIds:Ht=[]}=e,{nonSelectableRowIds:lt=[]}=e,{stickyHeader:Gt=!1}=e,{useStaticWidth:Mi=!1}=e,{pageSize:bt=0}=e,{page:ze=0}=e;const $t={none:"ascending",ascending:"descending",descending:"none"},dt=co(),_t=Ur(!1),ni=Ur(oe);Ln(t,ni,Qe=>i(47,Y=Qe));const Wi=(Qe,Ki)=>Ki in Qe?Qe[Ki]:Ki.split(/[\.\[\]\'\"]/).filter(Gi=>Gi).reduce((Gi,Lt)=>Gi&&typeof Gi=="object"?Gi[Lt]:Gi,Qe);uf("DataTable",{batchSelectedIds:_t,tableRows:ni,resetSelectedRowIds:()=>{i(30,f=!1),i(3,Ht=[]),zi&&i(24,zi.checked=!1,zi)}});let ct=!1,et=null,zi=null;const zn=(Qe,Ki,Gi)=>Ki&&Gi?Qe.slice((Ki-1)*Gi,Ki*Gi):Qe,Xe=Qe=>{const Ki=[Qe.width&&`width: ${Qe.width}`,Qe.minWidth&&`min-width: ${Qe.minWidth}`].filter(Boolean);if(Ki.length!==0)return Ki.join(";")},On=()=>{i(22,ct=!ct),i(2,mi=ct?c:[]),dt("click:header--expand",{expanded:ct})};function Rt(Qe){zi=Qe,i(24,zi)}const Xi=Qe=>{if(dt("click:header--select",{indeterminate:m,selected:!m&&Qe.target.checked}),m){Qe.target.checked=!1,i(30,f=!1),i(3,Ht=[]);return}Qe.target.checked?i(3,Ht=r):i(3,Ht=[])},Ui=Qe=>{if(dt("click",{header:Qe}),Qe.sort===!1)dt("click:header",{header:Qe});else{let Ki=We===Qe.key?Ve:"none";i(1,Ve=$t[Ki]),i(0,We=Ve==="none"?null:n[Qe.key]),dt("click:header",{header:Qe,sortDirection:Ve})}},Gn=Qe=>{const Ki=!!s[Qe.id];i(2,mi=Ki?mi.filter(Gi=>Gi!==Qe.id):[...mi,Qe.id]),dt("click:row--expand",{row:Qe,expanded:!Ki})},mr=Qe=>{i(3,Ht=[Qe.id]),dt("click:row--select",{row:Qe,selected:!0})},vr=Qe=>{Ht.includes(Qe.id)?(i(3,Ht=Ht.filter(Ki=>Ki!==Qe.id)),dt("click:row--select",{row:Qe,selected:!1})):(i(3,Ht=[...Ht,Qe.id]),dt("click:row--select",{row:Qe,selected:!0}))},jr=(Qe,Ki)=>{dt("click",{row:Qe,cell:Ki}),dt("click:cell",Ki)},Cr=(Qe,{target:Ki})=>{[...Ki.classList].some(Gi=>/^bx--(overflow-menu|checkbox|radio-button)/.test(Gi))||(dt("click",{row:Qe}),dt("click:row",Qe))},lr=Qe=>{dt("mouseenter:row",Qe)},Hn=Qe=>{dt("mouseleave:row",Qe)},Nt=Qe=>{vt.includes(Qe.id)||i(23,et=Qe.id)},Qi=Qe=>{vt.includes(Qe.id)||i(23,et=null)};return t.$$set=Qe=>{e=Ye(Ye({},e),fi(Qe)),i(37,se=Ut(e,W)),"headers"in Qe&&i(6,_e=Qe.headers),"rows"in Qe&&i(39,oe=Qe.rows),"size"in Qe&&i(7,Be=Qe.size),"title"in Qe&&i(8,mt=Qe.title),"description"in Qe&&i(9,Le=Qe.description),"zebra"in Qe&&i(10,rt=Qe.zebra),"sortable"in Qe&&i(11,tt=Qe.sortable),"sortKey"in Qe&&i(0,We=Qe.sortKey),"sortDirection"in Qe&&i(1,Ve=Qe.sortDirection),"expandable"in Qe&&i(4,St=Qe.expandable),"batchExpansion"in Qe&&i(12,zt=Qe.batchExpansion),"expandedRowIds"in Qe&&i(2,mi=Qe.expandedRowIds),"nonExpandableRowIds"in Qe&&i(13,vt=Qe.nonExpandableRowIds),"radio"in Qe&&i(14,pt=Qe.radio),"selectable"in Qe&&i(5,Pt=Qe.selectable),"batchSelection"in Qe&&i(15,qe=Qe.batchSelection),"selectedRowIds"in Qe&&i(3,Ht=Qe.selectedRowIds),"nonSelectableRowIds"in Qe&&i(16,lt=Qe.nonSelectableRowIds),"stickyHeader"in Qe&&i(17,Gt=Qe.stickyHeader),"useStaticWidth"in Qe&&i(18,Mi=Qe.useStaticWidth),"pageSize"in Qe&&i(40,bt=Qe.pageSize),"page"in Qe&&i(41,ze=Qe.page),"$$scope"in Qe&&i(62,ue=Qe.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&64&&i(32,n=_e.reduce((Qe,Ki)=>({...Qe,[Ki.key]:Ki.key}),{})),t.$$.dirty[0]&4&&i(31,s=mi.reduce((Qe,Ki)=>({...Qe,[Ki]:!0}),{})),t.$$.dirty[0]&8&&_t.set(Ht),t.$$.dirty[0]&64&&i(45,y=_e.map(({key:Qe})=>Qe)),t.$$.dirty[0]&64|t.$$.dirty[1]&16640&&i(28,b=oe.reduce((Qe,Ki)=>(Qe[Ki.id]=y.map((Gi,Lt)=>({key:Gi,value:Wi(Ki,Gi),display:_e[Lt].display})),Qe),{})),t.$$.dirty[1]&256&&Lm(ni,Y=oe,Y),t.$$.dirty[1]&65536&&i(46,l=Y.map(Qe=>Qe.id)),t.$$.dirty[0]&8192|t.$$.dirty[1]&32768&&i(20,c=l.filter(Qe=>!vt.includes(Qe))),t.$$.dirty[0]&65536|t.$$.dirty[1]&32768&&i(21,r=l.filter(Qe=>!lt.includes(Qe))),t.$$.dirty[0]&2097160&&i(30,f=r.length>0&&Ht.length===r.length),t.$$.dirty[0]&2097160&&i(29,m=Ht.length>0&&Ht.length<r.length),t.$$.dirty[0]&1052676&&zt&&(i(4,St=!0),i(22,ct=mi.length===c.length)),t.$$.dirty[0]&49152&&(pt||qe)&&i(5,Pt=!0),t.$$.dirty[1]&65536&&i(42,E=[...Y]),t.$$.dirty[0]&2&&i(43,S=Ve==="ascending"),t.$$.dirty[0]&2049&&i(19,D=tt&&We!=null),t.$$.dirty[0]&65&&i(44,R=_e.find(Qe=>Qe.key===We)),t.$$.dirty[0]&524291|t.$$.dirty[1]&77824&&D&&(Ve==="none"?i(42,E=Y):i(42,E=[...Y].sort((Qe,Ki)=>{const Gi=Wi(S?Qe:Ki,We),Lt=Wi(S?Ki:Qe,We);return R!=null&&R.sort?R.sort(Gi,Lt):typeof Gi=="number"&&typeof Lt=="number"?Gi-Lt:[Gi,Lt].every(Bi=>!Bi&&Bi!==0)?0:!Gi&&Gi!==0?S?1:-1:!Lt&&Lt!==0?S?-1:1:Gi.toString().localeCompare(Lt.toString(),"en",{numeric:!0})}))),t.$$.dirty[1]&67072&&i(27,z=zn(Y,ze,bt)),t.$$.dirty[1]&3584&&i(26,H=zn(E,ze,bt)),t.$$.dirty[0]&64&&i(25,K=_e.some(Qe=>Qe.width||Qe.minWidth))},[We,Ve,mi,Ht,St,Pt,_e,Be,mt,Le,rt,tt,zt,vt,pt,qe,lt,Gt,Mi,D,c,r,ct,et,zi,K,H,z,b,m,f,s,n,$t,dt,ni,Xe,se,ve,oe,bt,ze,E,S,R,y,l,Y,ne,On,Rt,Xi,Ui,Gn,mr,vr,jr,Cr,lr,Hn,Nt,Qi,ue]}class WM extends Ri{constructor(e){super(),Di(this,e,ZM,qM,Ci,{headers:6,rows:39,size:7,title:8,description:9,zebra:10,sortable:11,sortKey:0,sortDirection:1,expandable:4,batchExpansion:12,expandedRowIds:2,nonExpandableRowIds:13,radio:14,selectable:5,batchSelection:15,selectedRowIds:3,nonSelectableRowIds:16,stickyHeader:17,useStaticWidth:18,pageSize:40,page:41},null,[-1,-1,-1])}}const YM=WM;function JM(t){let e,i;const n=t[4].default,s=$i(n,t,t[3],null);let l=[{"aria-label":"data table toolbar"},t[2]],c={};for(let r=0;r<l.length;r+=1)c=Ye(c,l[r]);return{c(){e=nt("section"),s&&s.c(),ui(e,c),$(e,"bx--table-toolbar",!0),$(e,"bx--table-toolbar--small",t[0]==="sm"),$(e,"bx--table-toolbar--normal",t[0]==="default"),Ml(e,"z-index",1)},m(r,f){Se(r,e,f),s&&s.m(e,null),t[5](e),i=!0},p(r,[f]){s&&s.p&&(!i||f&8)&&tn(s,n,r,r[3],i?en(n,r[3],f,null):nn(r[3]),null),ui(e,c=Ni(l,[{"aria-label":"data table toolbar"},f&4&&r[2]])),$(e,"bx--table-toolbar",!0),$(e,"bx--table-toolbar--small",r[0]==="sm"),$(e,"bx--table-toolbar--normal",r[0]==="default"),Ml(e,"z-index",1)},i(r){i||(ae(s,r),i=!0)},o(r){pe(s,r),i=!1},d(r){r&&Te(e),s&&s.d(r),t[5](null)}}}function XM(t,e,i){const n=["size"];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e,{size:r="default"}=e,f=null;const m=Ur(!1);uf("Toolbar",{overflowVisible:m,setOverflowVisible:b=>{m.set(b),f&&i(1,f.style.overflow=b?"visible":"inherit",f)}});function y(b){sn[b?"unshift":"push"](()=>{f=b,i(1,f)})}return t.$$set=b=>{e=Ye(Ye({},e),fi(b)),i(2,s=Ut(e,n)),"size"in b&&i(0,r=b.size),"$$scope"in b&&i(3,c=b.$$scope)},[r,f,s,c,l,y]}class QM extends Ri{constructor(e){super(),Di(this,e,XM,JM,Ci,{size:0})}}function $M(t){let e,i;const n=t[1].default,s=$i(n,t,t[0],null);return{c(){e=nt("div"),s&&s.c(),$(e,"bx--toolbar-content",!0)},m(l,c){Se(l,e,c),s&&s.m(e,null),i=!0},p(l,[c]){s&&s.p&&(!i||c&1)&&tn(s,n,l,l[0],i?en(n,l[0],c,null):nn(l[0]),null)},i(l){i||(ae(s,l),i=!0)},o(l){pe(s,l),i=!1},d(l){l&&Te(e),s&&s.d(l)}}}function e3(t,e,i){let{$$slots:n={},$$scope:s}=e;return t.$$set=l=>{"$$scope"in l&&i(0,s=l.$$scope)},[s,n]}class t3 extends Ri{constructor(e){super(),Di(this,e,e3,$M,Ci,{})}}const i3="modulepreload",n3=function(t){return"/"+t},ub={},ru=function(e,i,n){let s=Promise.resolve();if(i&&i.length>0){const l=document.getElementsByTagName("link");s=Promise.all(i.map(c=>{if(c=n3(c),c in ub)return;ub[c]=!0;const r=c.endsWith(".css"),f=r?'[rel="stylesheet"]':"";if(!!n)for(let b=l.length-1;b>=0;b--){const E=l[b];if(E.href===c&&(!r||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${f}`))return;const y=document.createElement("link");if(y.rel=r?"stylesheet":i3,r||(y.as="script",y.crossOrigin=""),y.href=c,document.head.appendChild(y),r)return new Promise((b,E)=>{y.addEventListener("load",b),y.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${c}`)))})}))}return s.then(()=>e()).catch(l=>{const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l})},Rg=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],uh={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:t=>typeof console<"u"&&console.warn(t),getWeek:t=>{const e=new Date(t.getTime());e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var i=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-i.getTime())/864e5-3+(i.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},Wd={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:t=>{const e=t%100;if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},ya=(t,e=2)=>`000${t}`.slice(e*-1),ro=t=>t===!0?1:0;function hb(t,e){let i;return function(){clearTimeout(i),i=setTimeout(()=>t.apply(this,arguments),e)}}const Lg=t=>t instanceof Array?t:[t];function aa(t,e,i){if(i===!0)return t.classList.add(e);t.classList.remove(e)}function Un(t,e,i){const n=window.document.createElement(t);return e=e||"",i=i||"",n.className=e,i!==void 0&&(n.textContent=i),n}function Qf(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function LA(t,e){if(e(t))return t;if(t.parentNode)return LA(t.parentNode,e)}function $f(t,e){const i=Un("div","numInputWrapper"),n=Un("input","numInput "+t),s=Un("span","arrowUp"),l=Un("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?n.type="number":(n.type="text",n.pattern="\\d*"),e!==void 0)for(const c in e)n.setAttribute(c,e[c]);return i.appendChild(n),i.appendChild(s),i.appendChild(l),i}function Ra(t){try{return typeof t.composedPath=="function"?t.composedPath()[0]:t.target}catch{return t.target}}const Pg=()=>{},Nm=(t,e,i)=>i.months[e?"shorthand":"longhand"][t],r3={D:Pg,F:function(t,e,i){t.setMonth(i.months.longhand.indexOf(e))},G:(t,e)=>{t.setHours(parseFloat(e))},H:(t,e)=>{t.setHours(parseFloat(e))},J:(t,e)=>{t.setDate(parseFloat(e))},K:(t,e,i)=>{t.setHours(t.getHours()%12+12*ro(new RegExp(i.amPM[1],"i").test(e)))},M:function(t,e,i){t.setMonth(i.months.shorthand.indexOf(e))},S:(t,e)=>{t.setSeconds(parseFloat(e))},U:(t,e)=>new Date(parseFloat(e)*1e3),W:function(t,e,i){const n=parseInt(e),s=new Date(t.getFullYear(),0,2+(n-1)*7,0,0,0,0);return s.setDate(s.getDate()-s.getDay()+i.firstDayOfWeek),s},Y:(t,e)=>{t.setFullYear(parseFloat(e))},Z:(t,e)=>new Date(e),d:(t,e)=>{t.setDate(parseFloat(e))},h:(t,e)=>{t.setHours(parseFloat(e))},i:(t,e)=>{t.setMinutes(parseFloat(e))},j:(t,e)=>{t.setDate(parseFloat(e))},l:Pg,m:(t,e)=>{t.setMonth(parseFloat(e)-1)},n:(t,e)=>{t.setMonth(parseFloat(e)-1)},s:(t,e)=>{t.setSeconds(parseFloat(e))},u:(t,e)=>new Date(parseFloat(e)),w:Pg,y:(t,e)=>{t.setFullYear(2e3+parseFloat(e))}},S_={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},Vd={Z:t=>t.toISOString(),D:function(t,e,i){return e.weekdays.shorthand[Vd.w(t,e,i)]},F:function(t,e,i){return Nm(Vd.n(t,e,i)-1,!1,e)},G:function(t,e,i){return ya(Vd.h(t,e,i))},H:t=>ya(t.getHours()),J:function(t,e){return e.ordinal!==void 0?t.getDate()+e.ordinal(t.getDate()):t.getDate()},K:(t,e)=>e.amPM[ro(t.getHours()>11)],M:function(t,e){return Nm(t.getMonth(),!0,e)},S:t=>ya(t.getSeconds()),U:t=>t.getTime()/1e3,W:function(t,e,i){return i.getWeek(t)},Y:t=>ya(t.getFullYear(),4),d:t=>ya(t.getDate()),h:t=>t.getHours()%12?t.getHours()%12:12,i:t=>ya(t.getMinutes()),j:t=>t.getDate(),l:function(t,e){return e.weekdays.longhand[t.getDay()]},m:t=>ya(t.getMonth()+1),n:t=>t.getMonth()+1,s:t=>t.getSeconds(),u:t=>t.getTime(),w:t=>t.getDay(),y:t=>String(t.getFullYear()).substring(2)},PA=({config:t=uh,l10n:e=Wd,isMobile:i=!1})=>(n,s,l)=>{const c=l||e;return t.formatDate!==void 0&&!i?t.formatDate(n,s,c):s.split("").map((r,f,m)=>Vd[r]&&m[f-1]!=="\\"?Vd[r](n,c,t):r!=="\\"?r:"").join("")},I_=({config:t=uh,l10n:e=Wd})=>(i,n,s,l)=>{if(i!==0&&!i)return;const c=l||e;let r;const f=i;if(i instanceof Date)r=new Date(i.getTime());else if(typeof i!="string"&&i.toFixed!==void 0)r=new Date(i);else if(typeof i=="string"){const m=n||(t||uh).dateFormat,y=String(i).trim();if(y==="today")r=new Date,s=!0;else if(/Z$/.test(y)||/GMT$/.test(y))r=new Date(i);else if(t&&t.parseDate)r=t.parseDate(i,m);else{r=!t||!t.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0));let b,E=[];for(let S=0,D=0,R="";S<m.length;S++){const z=m[S],H=z==="\\",K=m[S-1]==="\\"||H;if(S_[z]&&!K){R+=S_[z];const W=new RegExp(R).exec(i);W&&(b=!0)&&E[z!=="Y"?"push":"unshift"]({fn:r3[z],val:W[++D]})}else H||(R+=".");E.forEach(({fn:W,val:se})=>r=W(r,se,c)||r)}r=b?r:void 0}}if(!(r instanceof Date&&!isNaN(r.getTime()))){t.errorHandler(new Error(`Invalid date provided: ${f}`));return}return s===!0&&r.setHours(0,0,0,0),r};function Na(t,e,i=!0){return i!==!1?new Date(t.getTime()).setHours(0,0,0,0)-new Date(e.getTime()).setHours(0,0,0,0):t.getTime()-e.getTime()}const s3=(t,e,i)=>t>Math.min(e,i)&&t<Math.max(e,i),a3={DAY:864e5};function Ng(t){let e=t.defaultHour,i=t.defaultMinute,n=t.defaultSeconds;if(t.minDate!==void 0){const s=t.minDate.getHours(),l=t.minDate.getMinutes(),c=t.minDate.getSeconds();e<s&&(e=s),e===s&&i<l&&(i=l),e===s&&i===l&&n<c&&(n=t.minDate.getSeconds())}if(t.maxDate!==void 0){const s=t.maxDate.getHours(),l=t.maxDate.getMinutes();e=Math.min(e,s),e===s&&(i=Math.min(l,i)),e===s&&i===l&&(n=t.maxDate.getSeconds())}return{hours:e,minutes:i,seconds:n}}typeof Object.assign!="function"&&(Object.assign=function(t,...e){if(!t)throw TypeError("Cannot convert undefined or null to object");for(const i of e)i&&Object.keys(i).forEach(n=>t[n]=i[n]);return t});const o3=300;function l3(t,e){const i={config:Object.assign(Object.assign({},uh),Qr.defaultConfig),l10n:Wd};i.parseDate=I_({config:i.config,l10n:i.l10n}),i._handlers=[],i.pluginElements=[],i.loadedPlugins=[],i._bind=D,i._setHoursFromDate=b,i._positionCalendar=zi,i.changeMonth=mi,i.changeYear=lt,i.clear=vt,i.close=pt,i._createElement=Un,i.destroy=Pt,i.isEnabled=Gt,i.jumpToDate=H,i.open=_t,i.redraw=On,i.set=Gn,i.setDate=vr,i.toggle=Nt;function n(){i.utils={getDaysInMonth(Q=i.currentMonth,ge=i.currentYear){return Q===1&&(ge%4===0&&ge%100!==0||ge%400===0)?29:i.l10n.daysInMonth[Q]}}}function s(){i.element=i.input=t,i.isOpen=!1,Wi(),et(),lr(),Cr(),n(),i.isMobile||se(),z(),(i.selectedDates.length||i.config.noCalendar)&&(i.config.enableTime&&b(i.config.noCalendar?i.latestSelectedDateObj:void 0),ii(!1)),c();const Q=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!i.isMobile&&Q&&zi(),Qi("onReady")}function l(Q){return Q.bind(i)}function c(){const Q=i.config;Q.weekNumbers===!1&&Q.showMonths===1||Q.noCalendar!==!0&&window.requestAnimationFrame(function(){if(i.calendarContainer!==void 0&&(i.calendarContainer.style.visibility="hidden",i.calendarContainer.style.display="block"),i.daysContainer!==void 0){const ge=(i.days.offsetWidth+1)*Q.showMonths;i.daysContainer.style.width=ge+"px",i.calendarContainer.style.width=ge+(i.weekWrapper!==void 0?i.weekWrapper.offsetWidth:0)+"px",i.calendarContainer.style.removeProperty("visibility"),i.calendarContainer.style.removeProperty("display")}})}function r(Q){if(i.selectedDates.length===0){const Z=i.config.minDate===void 0||Na(new Date,i.config.minDate)>=0?new Date:new Date(i.config.minDate.getTime()),V=Ng(i.config);Z.setHours(V.hours,V.minutes,V.seconds,Z.getMilliseconds()),i.selectedDates=[Z],i.latestSelectedDateObj=Z}Q!==void 0&&Q.type!=="blur"&&st(Q);const ge=i._input.value;y(),ii(),i._input.value!==ge&&i._debouncedChange()}function f(Q,ge){return Q%12+12*ro(ge===i.l10n.amPM[1])}function m(Q){switch(Q%24){case 0:case 12:return 12;default:return Q%12}}function y(){if(i.hourElement===void 0||i.minuteElement===void 0)return;let Q=(parseInt(i.hourElement.value.slice(-2),10)||0)%24,ge=(parseInt(i.minuteElement.value,10)||0)%60,Z=i.secondElement!==void 0?(parseInt(i.secondElement.value,10)||0)%60:0;i.amPM!==void 0&&(Q=f(Q,i.amPM.textContent));const V=i.config.minTime!==void 0||i.config.minDate&&i.minDateHasTime&&i.latestSelectedDateObj&&Na(i.latestSelectedDateObj,i.config.minDate,!0)===0;if(i.config.maxTime!==void 0||i.config.maxDate&&i.maxDateHasTime&&i.latestSelectedDateObj&&Na(i.latestSelectedDateObj,i.config.maxDate,!0)===0){const J=i.config.maxTime!==void 0?i.config.maxTime:i.config.maxDate;Q=Math.min(Q,J.getHours()),Q===J.getHours()&&(ge=Math.min(ge,J.getMinutes())),ge===J.getMinutes()&&(Z=Math.min(Z,J.getSeconds()))}if(V){const J=i.config.minTime!==void 0?i.config.minTime:i.config.minDate;Q=Math.max(Q,J.getHours()),Q===J.getHours()&&ge<J.getMinutes()&&(ge=J.getMinutes()),ge===J.getMinutes()&&(Z=Math.max(Z,J.getSeconds()))}E(Q,ge,Z)}function b(Q){const ge=Q||i.latestSelectedDateObj;ge&&E(ge.getHours(),ge.getMinutes(),ge.getSeconds())}function E(Q,ge,Z){i.latestSelectedDateObj!==void 0&&i.latestSelectedDateObj.setHours(Q%24,ge,Z||0,0),!(!i.hourElement||!i.minuteElement||i.isMobile)&&(i.hourElement.value=ya(i.config.time_24hr?Q:(12+Q)%12+12*ro(Q%12===0)),i.minuteElement.value=ya(ge),i.amPM!==void 0&&(i.amPM.textContent=i.l10n.amPM[ro(Q>=12)]),i.secondElement!==void 0&&(i.secondElement.value=ya(Z)))}function S(Q){const ge=Ra(Q),Z=parseInt(ge.value)+(Q.delta||0);(Z/1e3>1||Q.key==="Enter"&&!/[^\d]/.test(Z.toString()))&&lt(Z)}function D(Q,ge,Z,V){if(ge instanceof Array)return ge.forEach(q=>D(Q,q,Z,V));if(Q instanceof Array)return Q.forEach(q=>D(q,ge,Z,V));Q.addEventListener(ge,Z,V),i._handlers.push({remove:()=>Q.removeEventListener(ge,Z)})}function R(){Qi("onChange")}function z(){if(i.config.wrap&&["open","close","toggle","clear"].forEach(ge=>{Array.prototype.forEach.call(i.element.querySelectorAll(`[data-${ge}]`),Z=>D(Z,"click",i[ge]))}),i.isMobile){Hn();return}const Q=hb(dt,50);if(i._debouncedChange=hb(R,o3),i.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&D(i.daysContainer,"mouseover",ge=>{i.config.mode==="range"&&$t(Ra(ge))}),D(window.document.body,"keydown",ze),!i.config.inline&&!i.config.static&&D(window,"resize",Q),window.ontouchstart!==void 0?D(window.document,"touchstart",Ht):D(window.document,"mousedown",Ht),D(window.document,"focus",Ht,{capture:!0}),i.config.clickOpens===!0&&(D(i._input,"focus",i.open),D(i._input,"click",i.open)),i.daysContainer!==void 0&&(D(i.monthNav,"click",Bn),D(i.monthNav,["keyup","increment"],S),D(i.daysContainer,"click",Xi)),i.timeContainer!==void 0&&i.minuteElement!==void 0&&i.hourElement!==void 0){const ge=Z=>Ra(Z).select();D(i.timeContainer,["increment"],r),D(i.timeContainer,"blur",r,{capture:!0}),D(i.timeContainer,"click",K),D([i.hourElement,i.minuteElement],["focus","click"],ge),i.secondElement!==void 0&&D(i.secondElement,"focus",()=>i.secondElement&&i.secondElement.select()),i.amPM!==void 0&&D(i.amPM,"click",Z=>{r(Z),R()})}i.config.allowInput&&D(i._input,"blur",bt)}function H(Q,ge){const Z=Q!==void 0?i.parseDate(Q):i.latestSelectedDateObj||(i.config.minDate&&i.config.minDate>i.now?i.config.minDate:i.config.maxDate&&i.config.maxDate<i.now?i.config.maxDate:i.now),V=i.currentYear,q=i.currentMonth;try{Z!==void 0&&(i.currentYear=Z.getFullYear(),i.currentMonth=Z.getMonth())}catch(J){J.message="Invalid date supplied: "+Z,i.config.errorHandler(J)}ge&&i.currentYear!==V&&(Qi("onYearChange"),mt()),ge&&(i.currentYear!==V||i.currentMonth!==q)&&Qi("onMonthChange"),i.redraw()}function K(Q){const ge=Ra(Q);~ge.className.indexOf("arrow")&&W(Q,ge.classList.contains("arrowUp")?1:-1)}function W(Q,ge,Z){const V=Q&&Ra(Q),q=Z||V&&V.parentNode&&V.parentNode.firstChild,J=Qe("increment");J.delta=ge,q&&q.dispatchEvent(J)}function se(){const Q=window.document.createDocumentFragment();if(i.calendarContainer=Un("div","flatpickr-calendar"),i.calendarContainer.tabIndex=-1,!i.config.noCalendar){if(Q.appendChild(tt()),i.innerContainer=Un("div","flatpickr-innerContainer"),i.config.weekNumbers){const{weekWrapper:Z,weekNumbers:V}=zt();i.innerContainer.appendChild(Z),i.weekNumbers=V,i.weekWrapper=Z}i.rContainer=Un("div","flatpickr-rContainer"),i.rContainer.appendChild(Ve()),i.daysContainer||(i.daysContainer=Un("div","flatpickr-days"),i.daysContainer.tabIndex=-1),Be(),i.rContainer.appendChild(i.daysContainer),i.innerContainer.appendChild(i.rContainer),Q.appendChild(i.innerContainer)}i.config.enableTime&&Q.appendChild(We()),aa(i.calendarContainer,"rangeMode",i.config.mode==="range"),aa(i.calendarContainer,"animate",i.config.animate===!0),aa(i.calendarContainer,"multiMonth",i.config.showMonths>1),i.calendarContainer.appendChild(Q);const ge=i.config.appendTo!==void 0&&i.config.appendTo.nodeType!==void 0;if((i.config.inline||i.config.static)&&(i.calendarContainer.classList.add(i.config.inline?"inline":"static"),i.config.inline&&(!ge&&i.element.parentNode?i.element.parentNode.insertBefore(i.calendarContainer,i._input.nextSibling):i.config.appendTo!==void 0&&i.config.appendTo.appendChild(i.calendarContainer)),i.config.static)){const Z=Un("div","flatpickr-wrapper");i.element.parentNode&&i.element.parentNode.insertBefore(Z,i.element),Z.appendChild(i.element),i.altInput&&Z.appendChild(i.altInput),Z.appendChild(i.calendarContainer)}!i.config.static&&!i.config.inline&&(i.config.appendTo!==void 0?i.config.appendTo:window.document.body).appendChild(i.calendarContainer)}function Y(Q,ge,Z,V){const q=Gt(ge,!0),J=Un("span","flatpickr-day "+Q,ge.getDate().toString());return J.dateObj=ge,J.$i=V,J.setAttribute("aria-label",i.formatDate(ge,i.config.ariaDateFormat)),Q.indexOf("hidden")===-1&&Na(ge,i.now)===0&&(i.todayDateElem=J,J.classList.add("today"),J.setAttribute("aria-current","date")),q?(J.tabIndex=-1,Ki(ge)&&(J.classList.add("selected"),i.selectedDateElem=J,i.config.mode==="range"&&(aa(J,"startRange",i.selectedDates[0]&&Na(ge,i.selectedDates[0],!0)===0),aa(J,"endRange",i.selectedDates[1]&&Na(ge,i.selectedDates[1],!0)===0),Q==="nextMonthDay"&&J.classList.add("inRange")))):J.classList.add("flatpickr-disabled"),i.config.mode==="range"&&Gi(ge)&&!Ki(ge)&&J.classList.add("inRange"),i.weekNumbers&&i.config.showMonths===1&&Q!=="prevMonthDay"&&Z%7===1&&i.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+i.config.getWeek(ge)+"</span>"),Qi("onDayCreate",J),J}function ne(Q){Q.focus(),i.config.mode==="range"&&$t(Q)}function ue(Q){const ge=Q>0?0:i.config.showMonths-1,Z=Q>0?i.config.showMonths:-1;for(let V=ge;V!=Z;V+=Q){const q=i.daysContainer.children[V],J=Q>0?0:q.children.length-1,le=Q>0?q.children.length:-1;for(let ce=J;ce!=le;ce+=Q){const Oe=q.children[ce];if(Oe.className.indexOf("hidden")===-1&&Gt(Oe.dateObj))return Oe}}}function ve(Q,ge){const Z=Q.className.indexOf("Month")===-1?Q.dateObj.getMonth():i.currentMonth,V=ge>0?i.config.showMonths:-1,q=ge>0?1:-1;for(let J=Z-i.currentMonth;J!=V;J+=q){const le=i.daysContainer.children[J],ce=Z-i.currentMonth===J?Q.$i+ge:ge<0?le.children.length-1:0,Oe=le.children.length;for(let Ae=ce;Ae>=0&&Ae<Oe&&Ae!=(ge>0?Oe:-1);Ae+=q){const ye=le.children[Ae];if(ye.className.indexOf("hidden")===-1&&Gt(ye.dateObj)&&Math.abs(Q.$i-Ae)>=Math.abs(ge))return ne(ye)}}i.changeMonth(q),_e(ue(q),0)}function _e(Q,ge){const Z=Mi(document.activeElement||document.body),V=Q!==void 0?Q:Z?document.activeElement:i.selectedDateElem!==void 0&&Mi(i.selectedDateElem)?i.selectedDateElem:i.todayDateElem!==void 0&&Mi(i.todayDateElem)?i.todayDateElem:ue(ge>0?1:-1);V===void 0?i._input.focus():Z?ve(V,ge):ne(V)}function oe(Q,ge){const Z=(new Date(Q,ge,1).getDay()-i.l10n.firstDayOfWeek+7)%7,V=i.utils.getDaysInMonth((ge-1+12)%12,Q),q=i.utils.getDaysInMonth(ge,Q),J=window.document.createDocumentFragment(),le=i.config.showMonths>1,ce=le?"prevMonthDay hidden":"prevMonthDay",Oe=le?"nextMonthDay hidden":"nextMonthDay";let Ae=V+1-Z,ye=0;for(;Ae<=V;Ae++,ye++)J.appendChild(Y(ce,new Date(Q,ge-1,Ae),Ae,ye));for(Ae=1;Ae<=q;Ae++,ye++)J.appendChild(Y("",new Date(Q,ge,Ae),Ae,ye));for(let ot=q+1;ot<=42-Z&&(i.config.showMonths===1||ye%7!==0);ot++,ye++)J.appendChild(Y(Oe,new Date(Q,ge+1,ot%q),ot,ye));const Ce=Un("div","dayContainer");return Ce.appendChild(J),Ce}function Be(){if(i.daysContainer===void 0)return;Qf(i.daysContainer),i.weekNumbers&&Qf(i.weekNumbers);const Q=document.createDocumentFragment();for(let ge=0;ge<i.config.showMonths;ge++){const Z=new Date(i.currentYear,i.currentMonth,1);Z.setMonth(i.currentMonth+ge),Q.appendChild(oe(Z.getFullYear(),Z.getMonth()))}i.daysContainer.appendChild(Q),i.days=i.daysContainer.firstChild,i.config.mode==="range"&&i.selectedDates.length===1&&$t()}function mt(){if(i.config.showMonths>1||i.config.monthSelectorType!=="dropdown")return;const Q=function(ge){return i.config.minDate!==void 0&&i.currentYear===i.config.minDate.getFullYear()&&ge<i.config.minDate.getMonth()?!1:!(i.config.maxDate!==void 0&&i.currentYear===i.config.maxDate.getFullYear()&&ge>i.config.maxDate.getMonth())};i.monthsDropdownContainer.tabIndex=-1,i.monthsDropdownContainer.innerHTML="";for(let ge=0;ge<12;ge++){if(!Q(ge))continue;const Z=Un("option","flatpickr-monthDropdown-month");Z.value=new Date(i.currentYear,ge).getMonth().toString(),Z.textContent=Nm(ge,i.config.shorthandCurrentMonth,i.l10n),Z.tabIndex=-1,i.currentMonth===ge&&(Z.selected=!0),i.monthsDropdownContainer.appendChild(Z)}}function Le(){const Q=Un("div","flatpickr-month"),ge=window.document.createDocumentFragment();let Z;i.config.showMonths>1||i.config.monthSelectorType==="static"?Z=Un("span","cur-month"):(i.monthsDropdownContainer=Un("select","flatpickr-monthDropdown-months"),i.monthsDropdownContainer.setAttribute("aria-label",i.l10n.monthAriaLabel),D(i.monthsDropdownContainer,"change",le=>{const ce=Ra(le),Oe=parseInt(ce.value,10);i.changeMonth(Oe-i.currentMonth),Qi("onMonthChange")}),mt(),Z=i.monthsDropdownContainer);const V=$f("cur-year",{tabindex:"-1"}),q=V.getElementsByTagName("input")[0];q.setAttribute("aria-label",i.l10n.yearAriaLabel),i.config.minDate&&q.setAttribute("min",i.config.minDate.getFullYear().toString()),i.config.maxDate&&(q.setAttribute("max",i.config.maxDate.getFullYear().toString()),q.disabled=!!i.config.minDate&&i.config.minDate.getFullYear()===i.config.maxDate.getFullYear());const J=Un("div","flatpickr-current-month");return J.appendChild(Z),J.appendChild(V),ge.appendChild(J),Q.appendChild(ge),{container:Q,yearElement:q,monthElement:Z}}function rt(){Qf(i.monthNav),i.monthNav.appendChild(i.prevMonthNav),i.config.showMonths&&(i.yearElements=[],i.monthElements=[]);for(let Q=i.config.showMonths;Q--;){const ge=Le();i.yearElements.push(ge.yearElement),i.monthElements.push(ge.monthElement),i.monthNav.appendChild(ge.container)}i.monthNav.appendChild(i.nextMonthNav)}function tt(){return i.monthNav=Un("div","flatpickr-months"),i.yearElements=[],i.monthElements=[],i.prevMonthNav=Un("span","flatpickr-prev-month"),i.prevMonthNav.innerHTML=i.config.prevArrow,i.nextMonthNav=Un("span","flatpickr-next-month"),i.nextMonthNav.innerHTML=i.config.nextArrow,rt(),Object.defineProperty(i,"_hidePrevMonthArrow",{get:()=>i.__hidePrevMonthArrow,set(Q){i.__hidePrevMonthArrow!==Q&&(aa(i.prevMonthNav,"flatpickr-disabled",Q),i.__hidePrevMonthArrow=Q)}}),Object.defineProperty(i,"_hideNextMonthArrow",{get:()=>i.__hideNextMonthArrow,set(Q){i.__hideNextMonthArrow!==Q&&(aa(i.nextMonthNav,"flatpickr-disabled",Q),i.__hideNextMonthArrow=Q)}}),i.currentYearElement=i.yearElements[0],Lt(),i.monthNav}function We(){i.calendarContainer.classList.add("hasTime"),i.config.noCalendar&&i.calendarContainer.classList.add("noCalendar");const Q=Ng(i.config);i.timeContainer=Un("div","flatpickr-time"),i.timeContainer.tabIndex=-1;const ge=Un("span","flatpickr-time-separator",":"),Z=$f("flatpickr-hour",{"aria-label":i.l10n.hourAriaLabel});i.hourElement=Z.getElementsByTagName("input")[0];const V=$f("flatpickr-minute",{"aria-label":i.l10n.minuteAriaLabel});if(i.minuteElement=V.getElementsByTagName("input")[0],i.hourElement.tabIndex=i.minuteElement.tabIndex=-1,i.hourElement.value=ya(i.latestSelectedDateObj?i.latestSelectedDateObj.getHours():i.config.time_24hr?Q.hours:m(Q.hours)),i.minuteElement.value=ya(i.latestSelectedDateObj?i.latestSelectedDateObj.getMinutes():Q.minutes),i.hourElement.setAttribute("step",i.config.hourIncrement.toString()),i.minuteElement.setAttribute("step",i.config.minuteIncrement.toString()),i.hourElement.setAttribute("min",i.config.time_24hr?"0":"1"),i.hourElement.setAttribute("max",i.config.time_24hr?"23":"12"),i.hourElement.setAttribute("maxlength","2"),i.minuteElement.setAttribute("min","0"),i.minuteElement.setAttribute("max","59"),i.minuteElement.setAttribute("maxlength","2"),i.timeContainer.appendChild(Z),i.timeContainer.appendChild(ge),i.timeContainer.appendChild(V),i.config.time_24hr&&i.timeContainer.classList.add("time24hr"),i.config.enableSeconds){i.timeContainer.classList.add("hasSeconds");const q=$f("flatpickr-second");i.secondElement=q.getElementsByTagName("input")[0],i.secondElement.value=ya(i.latestSelectedDateObj?i.latestSelectedDateObj.getSeconds():Q.seconds),i.secondElement.setAttribute("step",i.minuteElement.getAttribute("step")),i.secondElement.setAttribute("min","0"),i.secondElement.setAttribute("max","59"),i.secondElement.setAttribute("maxlength","2"),i.timeContainer.appendChild(Un("span","flatpickr-time-separator",":")),i.timeContainer.appendChild(q)}return i.config.time_24hr||(i.amPM=Un("span","flatpickr-am-pm",i.l10n.amPM[ro((i.latestSelectedDateObj?i.hourElement.value:i.config.defaultHour)>11)]),i.amPM.title=i.l10n.toggleTitle,i.amPM.tabIndex=-1,i.timeContainer.appendChild(i.amPM)),i.timeContainer}function Ve(){i.weekdayContainer?Qf(i.weekdayContainer):i.weekdayContainer=Un("div","flatpickr-weekdays");for(let Q=i.config.showMonths;Q--;){const ge=Un("div","flatpickr-weekdaycontainer");i.weekdayContainer.appendChild(ge)}return St(),i.weekdayContainer}function St(){if(!i.weekdayContainer)return;const Q=i.l10n.firstDayOfWeek;let ge=[...i.l10n.weekdays.shorthand];Q>0&&Q<ge.length&&(ge=[...ge.splice(Q,ge.length),...ge.splice(0,Q)]);for(let Z=i.config.showMonths;Z--;)i.weekdayContainer.children[Z].innerHTML=`
      <span class='flatpickr-weekday'>
        ${ge.join("</span><span class='flatpickr-weekday'>")}
      </span>
      `}function zt(){i.calendarContainer.classList.add("hasWeeks");const Q=Un("div","flatpickr-weekwrapper");Q.appendChild(Un("span","flatpickr-weekday",i.l10n.weekAbbreviation));const ge=Un("div","flatpickr-weeks");return Q.appendChild(ge),{weekWrapper:Q,weekNumbers:ge}}function mi(Q,ge=!0){const Z=ge?Q:Q-i.currentMonth;Z<0&&i._hidePrevMonthArrow===!0||Z>0&&i._hideNextMonthArrow===!0||(i.currentMonth+=Z,(i.currentMonth<0||i.currentMonth>11)&&(i.currentYear+=i.currentMonth>11?1:-1,i.currentMonth=(i.currentMonth+12)%12,Qi("onYearChange"),mt()),Be(),Qi("onMonthChange"),Lt())}function vt(Q=!0,ge=!0){if(i.input.value="",i.altInput!==void 0&&(i.altInput.value=""),i.mobileInput!==void 0&&(i.mobileInput.value=""),i.selectedDates=[],i.latestSelectedDateObj=void 0,ge===!0&&(i.currentYear=i._initialDate.getFullYear(),i.currentMonth=i._initialDate.getMonth()),i.config.enableTime===!0){const{hours:Z,minutes:V,seconds:q}=Ng(i.config);E(Z,V,q)}i.redraw(),Q&&Qi("onChange")}function pt(){i.isOpen=!1,i.isMobile||(i.calendarContainer!==void 0&&i.calendarContainer.classList.remove("open"),i._input!==void 0&&i._input.classList.remove("active")),Qi("onClose")}function Pt(){i.config!==void 0&&Qi("onDestroy");for(let Q=i._handlers.length;Q--;)i._handlers[Q].remove();if(i._handlers=[],i.mobileInput)i.mobileInput.parentNode&&i.mobileInput.parentNode.removeChild(i.mobileInput),i.mobileInput=void 0;else if(i.calendarContainer&&i.calendarContainer.parentNode)if(i.config.static&&i.calendarContainer.parentNode){const Q=i.calendarContainer.parentNode;if(Q.lastChild&&Q.removeChild(Q.lastChild),Q.parentNode){for(;Q.firstChild;)Q.parentNode.insertBefore(Q.firstChild,Q);Q.parentNode.removeChild(Q)}}else i.calendarContainer.parentNode.removeChild(i.calendarContainer);i.altInput&&(i.input.type="text",i.altInput.parentNode&&i.altInput.parentNode.removeChild(i.altInput),delete i.altInput),i.input&&(i.input.type=i.input._type,i.input.classList.remove("flatpickr-input"),i.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(Q=>{try{delete i[Q]}catch{}})}function qe(Q){return i.config.appendTo&&i.config.appendTo.contains(Q)?!0:i.calendarContainer.contains(Q)}function Ht(Q){if(i.isOpen&&!i.config.inline){const ge=Ra(Q),Z=qe(ge),V=ge===i.input||ge===i.altInput||i.element.contains(ge)||Q.path&&Q.path.indexOf&&(~Q.path.indexOf(i.input)||~Q.path.indexOf(i.altInput)),q=Q.type==="blur"?V&&Q.relatedTarget&&!qe(Q.relatedTarget):!V&&!Z&&!qe(Q.relatedTarget),J=!i.config.ignoredFocusElements.some(le=>le.contains(ge));q&&J&&(i.timeContainer!==void 0&&i.minuteElement!==void 0&&i.hourElement!==void 0&&i.input.value!==""&&i.input.value!==void 0&&r(),i.close(),i.config&&i.config.mode==="range"&&i.selectedDates.length===1&&(i.clear(!1),i.redraw()))}}function lt(Q){if(!Q||i.config.minDate&&Q<i.config.minDate.getFullYear()||i.config.maxDate&&Q>i.config.maxDate.getFullYear())return;const ge=Q,Z=i.currentYear!==ge;i.currentYear=ge||i.currentYear,i.config.maxDate&&i.currentYear===i.config.maxDate.getFullYear()?i.currentMonth=Math.min(i.config.maxDate.getMonth(),i.currentMonth):i.config.minDate&&i.currentYear===i.config.minDate.getFullYear()&&(i.currentMonth=Math.max(i.config.minDate.getMonth(),i.currentMonth)),Z&&(i.redraw(),Qi("onYearChange"),mt())}function Gt(Q,ge=!0){var Z;const V=i.parseDate(Q,void 0,ge);if(i.config.minDate&&V&&Na(V,i.config.minDate,ge!==void 0?ge:!i.minDateHasTime)<0||i.config.maxDate&&V&&Na(V,i.config.maxDate,ge!==void 0?ge:!i.maxDateHasTime)>0)return!1;if(!i.config.enable&&i.config.disable.length===0)return!0;if(V===void 0)return!1;const q=!!i.config.enable,J=(Z=i.config.enable)!==null&&Z!==void 0?Z:i.config.disable;for(let le=0,ce;le<J.length;le++){if(ce=J[le],typeof ce=="function"&&ce(V))return q;if(ce instanceof Date&&V!==void 0&&ce.getTime()===V.getTime())return q;if(typeof ce=="string"){const Oe=i.parseDate(ce,void 0,!0);return Oe&&Oe.getTime()===V.getTime()?q:!q}else if(typeof ce=="object"&&V!==void 0&&ce.from&&ce.to&&V.getTime()>=ce.from.getTime()&&V.getTime()<=ce.to.getTime())return q}return!q}function Mi(Q){return i.daysContainer!==void 0?Q.className.indexOf("hidden")===-1&&Q.className.indexOf("flatpickr-disabled")===-1&&i.daysContainer.contains(Q):!1}function bt(Q){Q.target===i._input&&(i.selectedDates.length>0||i._input.value.length>0)&&!(Q.relatedTarget&&qe(Q.relatedTarget))&&i.setDate(i._input.value,!0,Q.target===i.altInput?i.config.altFormat:i.config.dateFormat)}function ze(Q){const ge=Ra(Q),Z=i.config.wrap?t.contains(ge):ge===i._input,V=i.config.allowInput,q=i.isOpen&&(!V||!Z),J=i.config.inline&&Z&&!V;if(Q.keyCode===13&&Z){if(V)return i.setDate(i._input.value,!0,ge===i.altInput?i.config.altFormat:i.config.dateFormat),ge.blur();i.open()}else if(qe(ge)||q||J){const le=!!i.timeContainer&&i.timeContainer.contains(ge);switch(Q.keyCode){case 13:le?(Q.preventDefault(),r(),Rt()):Xi(Q);break;case 27:Q.preventDefault(),Rt();break;case 8:case 46:Z&&!i.config.allowInput&&(Q.preventDefault(),i.clear());break;case 37:case 39:if(!le&&!Z){if(Q.preventDefault(),i.daysContainer!==void 0&&(V===!1||document.activeElement&&Mi(document.activeElement))){const Oe=Q.keyCode===39?1:-1;Q.ctrlKey?(Q.stopPropagation(),mi(Oe),_e(ue(1),0)):_e(void 0,Oe)}}else i.hourElement&&i.hourElement.focus();break;case 38:case 40:Q.preventDefault();const ce=Q.keyCode===40?1:-1;i.daysContainer&&ge.$i!==void 0||ge===i.input||ge===i.altInput?Q.ctrlKey?(Q.stopPropagation(),lt(i.currentYear-ce),_e(ue(1),0)):le||_e(void 0,ce*7):ge===i.currentYearElement?lt(i.currentYear-ce):i.config.enableTime&&(!le&&i.hourElement&&i.hourElement.focus(),r(Q),i._debouncedChange());break;case 9:if(le){const Oe=[i.hourElement,i.minuteElement,i.secondElement,i.amPM].concat(i.pluginElements).filter(ye=>ye),Ae=Oe.indexOf(ge);if(Ae!==-1){const ye=Oe[Ae+(Q.shiftKey?-1:1)];Q.preventDefault(),(ye||i._input).focus()}}else!i.config.noCalendar&&i.daysContainer&&i.daysContainer.contains(ge)&&Q.shiftKey&&(Q.preventDefault(),i._input.focus());break}}if(i.amPM!==void 0&&ge===i.amPM)switch(Q.key){case i.l10n.amPM[0].charAt(0):case i.l10n.amPM[0].charAt(0).toLowerCase():i.amPM.textContent=i.l10n.amPM[0],y(),ii();break;case i.l10n.amPM[1].charAt(0):case i.l10n.amPM[1].charAt(0).toLowerCase():i.amPM.textContent=i.l10n.amPM[1],y(),ii();break}(Z||qe(ge))&&Qi("onKeyDown",Q)}function $t(Q){if(i.selectedDates.length!==1||Q&&(!Q.classList.contains("flatpickr-day")||Q.classList.contains("flatpickr-disabled")))return;const ge=Q?Q.dateObj.getTime():i.days.firstElementChild.dateObj.getTime(),Z=i.parseDate(i.selectedDates[0],void 0,!0).getTime(),V=Math.min(ge,i.selectedDates[0].getTime()),q=Math.max(ge,i.selectedDates[0].getTime());let J=!1,le=0,ce=0;for(let Oe=V;Oe<q;Oe+=a3.DAY)Gt(new Date(Oe),!0)||(J=J||Oe>V&&Oe<q,Oe<Z&&(!le||Oe>le)?le=Oe:Oe>Z&&(!ce||Oe<ce)&&(ce=Oe));for(let Oe=0;Oe<i.config.showMonths;Oe++){const Ae=i.daysContainer.children[Oe];for(let ye=0,Ce=Ae.children.length;ye<Ce;ye++){const ot=Ae.children[ye],ht=ot.dateObj.getTime(),di=le>0&&ht<le||ce>0&&ht>ce;if(di){ot.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(Oi=>{ot.classList.remove(Oi)});continue}else if(J&&!di)continue;["startRange","inRange","endRange","notAllowed"].forEach(Oi=>{ot.classList.remove(Oi)}),Q!==void 0&&(Q.classList.add(ge<=i.selectedDates[0].getTime()?"startRange":"endRange"),Z<ge&&ht===Z?ot.classList.add("startRange"):Z>ge&&ht===Z&&ot.classList.add("endRange"),ht>=le&&(ce===0||ht<=ce)&&s3(ht,Z,ge)&&ot.classList.add("inRange"))}}}function dt(){i.isOpen&&!i.config.static&&!i.config.inline&&zi()}function _t(Q,ge=i._positionElement){if(i.isMobile===!0){if(Q){Q.preventDefault();const V=Ra(Q);V&&V.blur()}i.mobileInput!==void 0&&(i.mobileInput.focus(),i.mobileInput.click()),Qi("onOpen");return}else if(i._input.disabled||i.config.inline)return;const Z=i.isOpen;i.isOpen=!0,Z||(i.calendarContainer.classList.add("open"),i._input.classList.add("active"),Qi("onOpen"),zi(ge)),i.config.enableTime===!0&&i.config.noCalendar===!0&&i.config.allowInput===!1&&(Q===void 0||!i.timeContainer.contains(Q.relatedTarget))&&setTimeout(()=>i.hourElement.select(),50)}function ni(Q){return ge=>{const Z=i.config[`_${Q}Date`]=i.parseDate(ge,i.config.dateFormat),V=i.config[`_${Q==="min"?"max":"min"}Date`];Z!==void 0&&(i[Q==="min"?"minDateHasTime":"maxDateHasTime"]=Z.getHours()>0||Z.getMinutes()>0||Z.getSeconds()>0),i.selectedDates&&(i.selectedDates=i.selectedDates.filter(q=>Gt(q)),!i.selectedDates.length&&Q==="min"&&b(Z),ii()),i.daysContainer&&(On(),Z!==void 0?i.currentYearElement[Q]=Z.getFullYear().toString():i.currentYearElement.removeAttribute(Q),i.currentYearElement.disabled=!!V&&Z!==void 0&&V.getFullYear()===Z.getFullYear())}}function Wi(){const Q=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],ge=Object.assign(Object.assign({},JSON.parse(JSON.stringify(t.dataset||{}))),e),Z={};i.config.parseDate=ge.parseDate,i.config.formatDate=ge.formatDate,Object.defineProperty(i.config,"enable",{get:()=>i.config._enable,set:J=>{i.config._enable=jr(J)}}),Object.defineProperty(i.config,"disable",{get:()=>i.config._disable,set:J=>{i.config._disable=jr(J)}});const V=ge.mode==="time";if(!ge.dateFormat&&(ge.enableTime||V)){const J=Qr.defaultConfig.dateFormat||uh.dateFormat;Z.dateFormat=ge.noCalendar||V?"H:i"+(ge.enableSeconds?":S":""):J+" H:i"+(ge.enableSeconds?":S":"")}if(ge.altInput&&(ge.enableTime||V)&&!ge.altFormat){const J=Qr.defaultConfig.altFormat||uh.altFormat;Z.altFormat=ge.noCalendar||V?"h:i"+(ge.enableSeconds?":S K":" K"):J+` h:i${ge.enableSeconds?":S":""} K`}Object.defineProperty(i.config,"minDate",{get:()=>i.config._minDate,set:ni("min")}),Object.defineProperty(i.config,"maxDate",{get:()=>i.config._maxDate,set:ni("max")});const q=J=>le=>{i.config[J==="min"?"_minTime":"_maxTime"]=i.parseDate(le,"H:i:S")};Object.defineProperty(i.config,"minTime",{get:()=>i.config._minTime,set:q("min")}),Object.defineProperty(i.config,"maxTime",{get:()=>i.config._maxTime,set:q("max")}),ge.mode==="time"&&(i.config.noCalendar=!0,i.config.enableTime=!0),Object.assign(i.config,Z,ge);for(let J=0;J<Q.length;J++)i.config[Q[J]]=i.config[Q[J]]===!0||i.config[Q[J]]==="true";Rg.filter(J=>i.config[J]!==void 0).forEach(J=>{i.config[J]=Lg(i.config[J]||[]).map(l)}),i.isMobile=!i.config.disableMobile&&!i.config.inline&&i.config.mode==="single"&&!i.config.disable.length&&!i.config.enable&&!i.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(let J=0;J<i.config.plugins.length;J++){const le=i.config.plugins[J](i)||{};for(const ce in le)Rg.indexOf(ce)>-1?i.config[ce]=Lg(le[ce]).map(l).concat(i.config[ce]):typeof ge[ce]>"u"&&(i.config[ce]=le[ce])}ge.altInputClass||(i.config.altInputClass=ct().className+" "+i.config.altInputClass),Qi("onParseConfig")}function ct(){return i.config.wrap?t.querySelector("[data-input]"):t}function et(){typeof i.config.locale!="object"&&typeof Qr.l10ns[i.config.locale]>"u"&&i.config.errorHandler(new Error(`flatpickr: invalid locale ${i.config.locale}`)),i.l10n=Object.assign(Object.assign({},Qr.l10ns.default),typeof i.config.locale=="object"?i.config.locale:i.config.locale!=="default"?Qr.l10ns[i.config.locale]:void 0),S_.K=`(${i.l10n.amPM[0]}|${i.l10n.amPM[1]}|${i.l10n.amPM[0].toLowerCase()}|${i.l10n.amPM[1].toLowerCase()})`,Object.assign(Object.assign({},e),JSON.parse(JSON.stringify(t.dataset||{}))).time_24hr===void 0&&Qr.defaultConfig.time_24hr===void 0&&(i.config.time_24hr=i.l10n.time_24hr),i.formatDate=PA(i),i.parseDate=I_({config:i.config,l10n:i.l10n})}function zi(Q){if(typeof i.config.position=="function")return void i.config.position(i,Q);if(i.calendarContainer===void 0)return;Qi("onPreCalendarPosition");const ge=Q||i._positionElement,Z=Array.prototype.reduce.call(i.calendarContainer.children,(ai,_i)=>ai+_i.offsetHeight,0),V=i.calendarContainer.offsetWidth,q=i.config.position.split(" "),J=q[0],le=q.length>1?q[1]:null,ce=ge.getBoundingClientRect(),Oe=window.innerHeight-ce.bottom,Ae=J==="above"||J!=="below"&&Oe<Z&&ce.top>Z,ye=window.pageYOffset+ce.top+(Ae?-Z-2:ge.offsetHeight+2);if(aa(i.calendarContainer,"arrowTop",!Ae),aa(i.calendarContainer,"arrowBottom",Ae),i.config.inline)return;let Ce=window.pageXOffset+ce.left,ot=!1,gt=!1;le==="center"?(Ce-=(V-ce.width)/2,ot=!0):le==="right"&&(Ce-=V-ce.width,gt=!0),aa(i.calendarContainer,"arrowLeft",!ot&&!gt),aa(i.calendarContainer,"arrowCenter",ot),aa(i.calendarContainer,"arrowRight",gt);const ht=window.document.body.offsetWidth-(window.pageXOffset+ce.right),di=Ce+V>window.document.body.offsetWidth,Oi=ht+V>window.document.body.offsetWidth;if(aa(i.calendarContainer,"rightMost",di),!i.config.static)if(i.calendarContainer.style.top=`${ye}px`,!di)i.calendarContainer.style.left=`${Ce}px`,i.calendarContainer.style.right="auto";else if(!Oi)i.calendarContainer.style.left="auto",i.calendarContainer.style.right=`${ht}px`;else{const ai=zn();if(ai===void 0)return;const _i=window.document.body.offsetWidth,ji=Math.max(0,_i/2-V/2),ke=".flatpickr-calendar.centerMost:before",Dt=".flatpickr-calendar.centerMost:after",It=ai.cssRules.length,yi=`{left:${ce.left}px;right:auto;}`;aa(i.calendarContainer,"rightMost",!1),aa(i.calendarContainer,"centerMost",!0),ai.insertRule(`${ke},${Dt}${yi}`,It),i.calendarContainer.style.left=`${ji}px`,i.calendarContainer.style.right="auto"}}function zn(){let Q=null;for(let ge=0;ge<document.styleSheets.length;ge++){const Z=document.styleSheets[ge];try{Z.cssRules}catch{continue}Q=Z;break}return Q??Xe()}function Xe(){const Q=document.createElement("style");return document.head.appendChild(Q),Q.sheet}function On(){i.config.noCalendar||i.isMobile||(mt(),Lt(),Be())}function Rt(){i._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(i.close,0):i.close()}function Xi(Q){Q.preventDefault(),Q.stopPropagation();const ge=le=>le.classList&&le.classList.contains("flatpickr-day")&&!le.classList.contains("flatpickr-disabled")&&!le.classList.contains("notAllowed"),Z=LA(Ra(Q),ge);if(Z===void 0)return;const V=Z,q=i.latestSelectedDateObj=new Date(V.dateObj.getTime()),J=(q.getMonth()<i.currentMonth||q.getMonth()>i.currentMonth+i.config.showMonths-1)&&i.config.mode!=="range";if(i.selectedDateElem=V,i.config.mode==="single")i.selectedDates=[q];else if(i.config.mode==="multiple"){const le=Ki(q);le?i.selectedDates.splice(parseInt(le),1):i.selectedDates.push(q)}else i.config.mode==="range"&&(i.selectedDates.length===2&&i.clear(!1,!1),i.latestSelectedDateObj=q,i.selectedDates.push(q),Na(q,i.selectedDates[0],!0)!==0&&i.selectedDates.sort((le,ce)=>le.getTime()-ce.getTime()));if(y(),J){const le=i.currentYear!==q.getFullYear();i.currentYear=q.getFullYear(),i.currentMonth=q.getMonth(),le&&(Qi("onYearChange"),mt()),Qi("onMonthChange")}if(Lt(),Be(),ii(),!J&&i.config.mode!=="range"&&i.config.showMonths===1?ne(V):i.selectedDateElem!==void 0&&i.hourElement===void 0&&i.selectedDateElem&&i.selectedDateElem.focus(),i.hourElement!==void 0&&i.hourElement!==void 0&&i.hourElement.focus(),i.config.closeOnSelect){const le=i.config.mode==="single"&&!i.config.enableTime,ce=i.config.mode==="range"&&i.selectedDates.length===2&&!i.config.enableTime;(le||ce)&&Rt()}R()}const Ui={locale:[et,St],showMonths:[rt,c,Ve],minDate:[H],maxDate:[H],clickOpens:[()=>{i.config.clickOpens===!0?(D(i._input,"focus",i.open),D(i._input,"click",i.open)):(i._input.removeEventListener("focus",i.open),i._input.removeEventListener("click",i.open))}]};function Gn(Q,ge){if(Q!==null&&typeof Q=="object"){Object.assign(i.config,Q);for(const Z in Q)Ui[Z]!==void 0&&Ui[Z].forEach(V=>V())}else i.config[Q]=ge,Ui[Q]!==void 0?Ui[Q].forEach(Z=>Z()):Rg.indexOf(Q)>-1&&(i.config[Q]=Lg(ge));i.redraw(),ii(!0)}function mr(Q,ge){let Z=[];if(Q instanceof Array)Z=Q.map(V=>i.parseDate(V,ge));else if(Q instanceof Date||typeof Q=="number")Z=[i.parseDate(Q,ge)];else if(typeof Q=="string")switch(i.config.mode){case"single":case"time":Z=[i.parseDate(Q,ge)];break;case"multiple":Z=Q.split(i.config.conjunction).map(V=>i.parseDate(V,ge));break;case"range":Z=Q.split(i.l10n.rangeSeparator).map(V=>i.parseDate(V,ge));break}else i.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(Q)}`));i.selectedDates=i.config.allowInvalidPreload?Z:Z.filter(V=>V instanceof Date&&Gt(V,!1)),i.config.mode==="range"&&i.selectedDates.sort((V,q)=>V.getTime()-q.getTime())}function vr(Q,ge=!1,Z=i.config.dateFormat){if(Q!==0&&!Q||Q instanceof Array&&Q.length===0)return i.clear(ge);mr(Q,Z),i.latestSelectedDateObj=i.selectedDates[i.selectedDates.length-1],i.redraw(),H(void 0,ge),b(),i.selectedDates.length===0&&i.clear(!1),ii(ge),ge&&Qi("onChange")}function jr(Q){return Q.slice().map(ge=>typeof ge=="string"||typeof ge=="number"||ge instanceof Date?i.parseDate(ge,void 0,!0):ge&&typeof ge=="object"&&ge.from&&ge.to?{from:i.parseDate(ge.from,void 0),to:i.parseDate(ge.to,void 0)}:ge).filter(ge=>ge)}function Cr(){i.selectedDates=[],i.now=i.parseDate(i.config.now)||new Date;const Q=i.config.defaultDate||((i.input.nodeName==="INPUT"||i.input.nodeName==="TEXTAREA")&&i.input.placeholder&&i.input.value===i.input.placeholder?null:i.input.value);Q&&mr(Q,i.config.dateFormat),i._initialDate=i.selectedDates.length>0?i.selectedDates[0]:i.config.minDate&&i.config.minDate.getTime()>i.now.getTime()?i.config.minDate:i.config.maxDate&&i.config.maxDate.getTime()<i.now.getTime()?i.config.maxDate:i.now,i.currentYear=i._initialDate.getFullYear(),i.currentMonth=i._initialDate.getMonth(),i.selectedDates.length>0&&(i.latestSelectedDateObj=i.selectedDates[0]),i.config.minTime!==void 0&&(i.config.minTime=i.parseDate(i.config.minTime,"H:i")),i.config.maxTime!==void 0&&(i.config.maxTime=i.parseDate(i.config.maxTime,"H:i")),i.minDateHasTime=!!i.config.minDate&&(i.config.minDate.getHours()>0||i.config.minDate.getMinutes()>0||i.config.minDate.getSeconds()>0),i.maxDateHasTime=!!i.config.maxDate&&(i.config.maxDate.getHours()>0||i.config.maxDate.getMinutes()>0||i.config.maxDate.getSeconds()>0)}function lr(){if(i.input=ct(),!i.input){i.config.errorHandler(new Error("Invalid input element specified"));return}i.input._type=i.input.type,i.input.type="text",i.input.classList.add("flatpickr-input"),i._input=i.input,i.config.altInput&&(i.altInput=Un(i.input.nodeName,i.config.altInputClass),i._input=i.altInput,i.altInput.placeholder=i.input.placeholder,i.altInput.disabled=i.input.disabled,i.altInput.required=i.input.required,i.altInput.tabIndex=i.input.tabIndex,i.altInput.type="text",i.input.setAttribute("type","hidden"),!i.config.static&&i.input.parentNode&&i.input.parentNode.insertBefore(i.altInput,i.input.nextSibling)),i.config.allowInput||i._input.setAttribute("readonly","readonly"),i._positionElement=i.config.positionElement||i._input}function Hn(){const Q=i.config.enableTime?i.config.noCalendar?"time":"datetime-local":"date";i.mobileInput=Un("input",i.input.className+" flatpickr-mobile"),i.mobileInput.tabIndex=1,i.mobileInput.type=Q,i.mobileInput.disabled=i.input.disabled,i.mobileInput.required=i.input.required,i.mobileInput.placeholder=i.input.placeholder,i.mobileFormatStr=Q==="datetime-local"?"Y-m-d\\TH:i:S":Q==="date"?"Y-m-d":"H:i:S",i.selectedDates.length>0&&(i.mobileInput.defaultValue=i.mobileInput.value=i.formatDate(i.selectedDates[0],i.mobileFormatStr)),i.config.minDate&&(i.mobileInput.min=i.formatDate(i.config.minDate,"Y-m-d")),i.config.maxDate&&(i.mobileInput.max=i.formatDate(i.config.maxDate,"Y-m-d")),i.input.getAttribute("step")&&(i.mobileInput.step=String(i.input.getAttribute("step"))),i.input.type="hidden",i.altInput!==void 0&&(i.altInput.type="hidden");try{i.input.parentNode&&i.input.parentNode.insertBefore(i.mobileInput,i.input.nextSibling)}catch{}D(i.mobileInput,"change",ge=>{i.setDate(Ra(ge).value,!1,i.mobileFormatStr),Qi("onChange"),Qi("onClose")})}function Nt(Q){if(i.isOpen===!0)return i.close();i.open(Q)}function Qi(Q,ge){if(i.config===void 0)return;const Z=i.config[Q];if(Z!==void 0&&Z.length>0)for(let V=0;Z[V]&&V<Z.length;V++)Z[V](i.selectedDates,i.input.value,i,ge);Q==="onChange"&&(i.input.dispatchEvent(Qe("change")),i.input.dispatchEvent(Qe("input")))}function Qe(Q){const ge=document.createEvent("Event");return ge.initEvent(Q,!0,!0),ge}function Ki(Q){for(let ge=0;ge<i.selectedDates.length;ge++)if(Na(i.selectedDates[ge],Q)===0)return""+ge;return!1}function Gi(Q){return i.config.mode!=="range"||i.selectedDates.length<2?!1:Na(Q,i.selectedDates[0])>=0&&Na(Q,i.selectedDates[1])<=0}function Lt(){i.config.noCalendar||i.isMobile||!i.monthNav||(i.yearElements.forEach((Q,ge)=>{const Z=new Date(i.currentYear,i.currentMonth,1);Z.setMonth(i.currentMonth+ge),i.config.showMonths>1||i.config.monthSelectorType==="static"?i.monthElements[ge].textContent=Nm(Z.getMonth(),i.config.shorthandCurrentMonth,i.l10n)+" ":i.monthsDropdownContainer.value=Z.getMonth().toString(),Q.value=Z.getFullYear().toString()}),i._hidePrevMonthArrow=i.config.minDate!==void 0&&(i.currentYear===i.config.minDate.getFullYear()?i.currentMonth<=i.config.minDate.getMonth():i.currentYear<i.config.minDate.getFullYear()),i._hideNextMonthArrow=i.config.maxDate!==void 0&&(i.currentYear===i.config.maxDate.getFullYear()?i.currentMonth+1>i.config.maxDate.getMonth():i.currentYear>i.config.maxDate.getFullYear()))}function Bi(Q){return i.selectedDates.map(ge=>i.formatDate(ge,Q)).filter((ge,Z,V)=>i.config.mode!=="range"||i.config.enableTime||V.indexOf(ge)===Z).join(i.config.mode!=="range"?i.config.conjunction:i.l10n.rangeSeparator)}function ii(Q=!0){i.mobileInput!==void 0&&i.mobileFormatStr&&(i.mobileInput.value=i.latestSelectedDateObj!==void 0?i.formatDate(i.latestSelectedDateObj,i.mobileFormatStr):""),i.input.value=Bi(i.config.dateFormat),i.altInput!==void 0&&(i.altInput.value=Bi(i.config.altFormat)),Q!==!1&&Qi("onValueUpdate")}function Bn(Q){const ge=Ra(Q),Z=i.prevMonthNav.contains(ge),V=i.nextMonthNav.contains(ge);Z||V?mi(Z?-1:1):i.yearElements.indexOf(ge)>=0?ge.select():ge.classList.contains("arrowUp")?i.changeYear(i.currentYear+1):ge.classList.contains("arrowDown")&&i.changeYear(i.currentYear-1)}function st(Q){Q.preventDefault();const ge=Q.type==="keydown",Z=Ra(Q),V=Z;i.amPM!==void 0&&Z===i.amPM&&(i.amPM.textContent=i.l10n.amPM[ro(i.amPM.textContent===i.l10n.amPM[0])]);const q=parseFloat(V.getAttribute("min")),J=parseFloat(V.getAttribute("max")),le=parseFloat(V.getAttribute("step")),ce=parseInt(V.value,10),Oe=Q.delta||(ge?Q.which===38?1:-1:0);let Ae=ce+le*Oe;if(typeof V.value<"u"&&V.value.length===2){const ye=V===i.hourElement,Ce=V===i.minuteElement;Ae<q?(Ae=J+Ae+ro(!ye)+(ro(ye)&&ro(!i.amPM)),Ce&&W(void 0,-1,i.hourElement)):Ae>J&&(Ae=V===i.hourElement?Ae-J-ro(!i.amPM):q,Ce&&W(void 0,1,i.hourElement)),i.amPM&&ye&&(le===1?Ae+ce===23:Math.abs(Ae-ce)>le)&&(i.amPM.textContent=i.l10n.amPM[ro(i.amPM.textContent===i.l10n.amPM[0])]),V.value=ya(Ae)}}return s(),i}function hh(t,e){const i=Array.prototype.slice.call(t).filter(s=>s instanceof HTMLElement),n=[];for(let s=0;s<i.length;s++){const l=i[s];try{if(l.getAttribute("data-fp-omit")!==null)continue;l._flatpickr!==void 0&&(l._flatpickr.destroy(),l._flatpickr=void 0),l._flatpickr=l3(l,e||{}),n.push(l._flatpickr)}catch(c){console.error(c)}}return n.length===1?n[0]:n}typeof HTMLElement<"u"&&typeof HTMLCollection<"u"&&typeof NodeList<"u"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(t){return hh(this,t)},HTMLElement.prototype.flatpickr=function(t){return hh([this],t)});var Qr=function(t,e){return typeof t=="string"?hh(window.document.querySelectorAll(t),e):t instanceof Node?hh([t],e):hh(t,e)};Qr.defaultConfig={};Qr.l10ns={en:Object.assign({},Wd),default:Object.assign({},Wd)};Qr.localize=t=>{Qr.l10ns.default=Object.assign(Object.assign({},Qr.l10ns.default),t)};Qr.setDefaults=t=>{Qr.defaultConfig=Object.assign(Object.assign({},Qr.defaultConfig),t)};Qr.parseDate=I_({});Qr.formatDate=PA({});Qr.compareDates=Na;typeof jQuery<"u"&&typeof jQuery.fn<"u"&&(jQuery.fn.flatpickr=function(t){return hh(this,t)});Date.prototype.fp_incr=function(t){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof t=="string"?parseInt(t,10):t))};typeof window<"u"&&(window.flatpickr=Qr);let yd;function c3(t){const{calendarContainer:e,days:i,daysContainer:n,weekdayContainer:s,selectedDates:l}=t;e.classList.add("bx--date-picker__calendar"),e.querySelector(".flatpickr-month").classList.add("bx--date-picker__month"),s.classList.add("bx--date-picker__weekdays"),s.querySelectorAll(".flatpickr-weekday").forEach(c=>{c.classList.add("bx--date-picker__weekday")}),n.classList.add("bx--date-picker__days"),i.querySelectorAll(".flatpickr-day").forEach(c=>{c.classList.add("bx--date-picker__day"),c.classList.contains("today")&&l.length>0?c.classList.add("no-border"):c.classList.contains("today")&&l.length===0&&c.classList.remove("no-border")})}function db(t){const e=t.l10n.months.longhand[t.currentMonth],i=t.monthNav.querySelector(".cur-month");if(i)i.textContent=e;else{const n=t.monthsDropdownContainer,s=document.createElement("span");s.setAttribute("class","cur-month"),s.textContent=e,n.parentNode.replaceChild(s,n)}}async function u3({options:t,base:e,input:i,dispatch:n}){let s=t.locale;t.locale==="en"&&yd&&yd.en&&(yd.en.weekdays.shorthand.forEach((c,r)=>{const f=c.slice(0,2);yd.en.weekdays.shorthand[r]=f==="Th"?"Th":f.charAt(0)}),s=yd.en);let l;return t.mode==="range"&&(l=(await ru(()=>import("./rangePlugin-yWOidBqj.js"),__vite__mapDeps([]))).default),new Qr(e,{allowInput:!0,disableMobile:!0,clickOpens:!0,locale:s,plugins:[t.mode==="range"&&new l({position:"left",input:i})].filter(Boolean),nextArrow:'<svg width="16px" height="16px" viewBox="0 0 16 16"><polygon points="11,8 6,13 5.3,12.3 9.6,8 5.3,3.7 6,3 "/><rect width="16" height="16" style="fill: none" /></svg>',prevArrow:'<svg width="16px" height="16px" viewBox="0 0 16 16"><polygon points="5,8 10,3 10.7,3.7 6.4,8 10.7,12.3 10,13 "/><rect width="16" height="16" style="fill: none" /></svg>',onChange:()=>{n("change")},onClose:()=>{n("close")},onMonthChange:(c,r,f)=>{db(f)},onOpen:(c,r,f)=>{n("open"),c3(f),db(f)},...t})}function h3(t){let e,i,n,s,l;const c=t[30].default,r=$i(c,t,t[29],null);let f=[t[15]],m={};for(let y=0;y<f.length;y+=1)m=Ye(m,f[y]);return{c(){e=nt("div"),i=nt("div"),r&&r.c(),je(i,"id",t[3]),$(i,"bx--date-picker",!0),$(i,"bx--date-picker--short",t[1]),$(i,"bx--date-picker--light",t[2]),$(i,"bx--date-picker--simple",t[0]==="simple"),$(i,"bx--date-picker--single",t[0]==="single"),$(i,"bx--date-picker--range",t[0]==="range"),$(i,"bx--date-picker--nolabel",t[0]==="range"&&t[6]),ui(e,m),$(e,"bx--form-item",!0)},m(y,b){Se(y,e,b),Ze(e,i),r&&r.m(i,null),t[36](i),n=!0,s||(l=[ut(window,"click",t[35]),ut(i,"keydown",t[37]),ut(e,"click",t[31]),ut(e,"mouseover",t[32]),ut(e,"mouseenter",t[33]),ut(e,"mouseleave",t[34])],s=!0)},p(y,b){r&&r.p&&(!n||b[0]&536870912)&&tn(r,c,y,y[29],n?en(c,y[29],b,null):nn(y[29]),null),(!n||b[0]&8)&&je(i,"id",y[3]),(!n||b[0]&2)&&$(i,"bx--date-picker--short",y[1]),(!n||b[0]&4)&&$(i,"bx--date-picker--light",y[2]),(!n||b[0]&1)&&$(i,"bx--date-picker--simple",y[0]==="simple"),(!n||b[0]&1)&&$(i,"bx--date-picker--single",y[0]==="single"),(!n||b[0]&1)&&$(i,"bx--date-picker--range",y[0]==="range"),(!n||b[0]&65)&&$(i,"bx--date-picker--nolabel",y[0]==="range"&&y[6]),ui(e,m=Ni(f,[b[0]&32768&&y[15]])),$(e,"bx--form-item",!0)},i(y){n||(ae(r,y),n=!0)},o(y){pe(r,y),n=!1},d(y){y&&Te(e),r&&r.d(y),t[36](null),s=!1,vn(l)}}}function d3(t,e,i){const n=["datePickerType","value","valueFrom","valueTo","dateFormat","maxDate","minDate","locale","short","light","id","flatpickrProps"];let s=Ut(e,n),l,c,r,f,m,y,b,E,{$$slots:S={},$$scope:D}=e,{datePickerType:R="simple"}=e,{value:z=""}=e,{valueFrom:H=""}=e,{valueTo:K=""}=e,{dateFormat:W="m/d/Y"}=e,{maxDate:se=null}=e,{minDate:Y=null}=e,{locale:ne="en"}=e,{short:ue=!1}=e,{light:ve=!1}=e,{id:_e="ccs-"+Math.random().toString(36)}=e,{flatpickrProps:oe={static:!0}}=e;const Be=co(),mt=Ur([]),Le=Xf(mt,_t=>_t.map(({id:ni})=>ni));Ln(t,Le,_t=>i(41,b=_t));const rt=Xf(mt,_t=>_t.filter(({labelText:ni})=>!!ni).length===0);Ln(t,rt,_t=>i(6,E=_t));const tt=Ur(z);Ln(t,tt,_t=>i(28,f=_t));const We=Ur(H);Ln(t,We,_t=>i(27,r=_t));const Ve=Ur(K);Ln(t,Ve,_t=>i(26,c=_t));const St=Ur(R);Ln(t,St,_t=>i(40,y=_t));const zt=Xf(St,_t=>_t==="range");Ln(t,zt,_t=>i(39,m=_t));const mi=Xf(St,_t=>_t==="single"||_t==="range");Ln(t,mi,_t=>i(25,l=_t));let vt=null,pt=null,Pt=null,qe=null;uf("DatePicker",{range:zt,inputValue:tt,inputValueFrom:We,inputValueTo:Ve,inputIds:Le,hasCalendar:mi,add:_t=>{mt.update(ni=>[...ni,_t])},declareRef:({id:_t,ref:ni})=>{b.indexOf(_t)===0?i(24,Pt=ni):qe=ni},updateValue:({type:_t,value:ni})=>{(!vt&&_t==="input"||_t==="change")&&tt.set(ni),!vt&&_t==="change"&&Be("change",ni)},blurInput:_t=>{vt&&!vt.calendarContainer.contains(_t)&&vt.close()},openCalendar:()=>{vt.open()},focusCalendar:()=>{(vt.selectedDateElem||vt.todayDateElem||vt.calendarContainer.querySelector(".flatpickr-day[tabindex]")||vt.calendarContainer).focus()}});async function Ht(_t){var ni,Wi;if(vt){vt.set("minDate",Y),vt.set("maxDate",se),vt.set("locale",ne),vt.set("dateFormat",W),Object.entries(oe).forEach(([ct,et])=>{vt.set(_t,et)});return}i(4,vt=await u3({options:{..._t,appendTo:pt,defaultDate:f,mode:y},base:Pt,input:qe,dispatch:ct=>{const et={selectedDates:vt.selectedDates};if(m){const zi=Pt.value,zn=qe.value;et.dateStr={from:Pt.value,to:qe.value},i(17,H=zi),i(18,K=zn)}else et.dateStr=Pt.value;return Be(ct,et)}})),(ni=vt==null?void 0:vt.calendarContainer)==null||ni.setAttribute("role","application"),(Wi=vt==null?void 0:vt.calendarContainer)==null||Wi.setAttribute("aria-label","calendar-container")}Pl(()=>()=>{vt&&(vt.destroy(),i(4,vt=null))}),Rh(()=>{vt&&(m?(vt.setDate([r,c]),i(24,Pt.value=r,Pt)):vt.setDate(f))});function lt(_t){At.call(this,t,_t)}function Gt(_t){At.call(this,t,_t)}function Mi(_t){At.call(this,t,_t)}function bt(_t){At.call(this,t,_t)}const ze=({target:_t})=>{!vt||!vt.isOpen||pt&&pt.contains(_t)||vt.calendarContainer.contains(_t)||vt.close()};function $t(_t){sn[_t?"unshift":"push"](()=>{pt=_t,i(5,pt)})}const dt=_t=>{vt!=null&&vt.isOpen&&_t.key==="Escape"&&(_t.stopPropagation(),vt.close())};return t.$$set=_t=>{e=Ye(Ye({},e),fi(_t)),i(15,s=Ut(e,n)),"datePickerType"in _t&&i(0,R=_t.datePickerType),"value"in _t&&i(16,z=_t.value),"valueFrom"in _t&&i(17,H=_t.valueFrom),"valueTo"in _t&&i(18,K=_t.valueTo),"dateFormat"in _t&&i(19,W=_t.dateFormat),"maxDate"in _t&&i(20,se=_t.maxDate),"minDate"in _t&&i(21,Y=_t.minDate),"locale"in _t&&i(22,ne=_t.locale),"short"in _t&&i(1,ue=_t.short),"light"in _t&&i(2,ve=_t.light),"id"in _t&&i(3,_e=_t.id),"flatpickrProps"in _t&&i(23,oe=_t.flatpickrProps),"$$scope"in _t&&i(29,D=_t.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&268435456&&i(16,z=f),t.$$.dirty[0]&65536&&tt.set(z),t.$$.dirty[0]&134217728&&i(17,H=r),t.$$.dirty[0]&131072&&We.set(H),t.$$.dirty[0]&67108864&&i(18,K=c),t.$$.dirty[0]&262144&&Ve.set(K),t.$$.dirty[0]&66584576&&l&&Pt&&Ht({dateFormat:W,locale:ne,maxDate:se,minDate:Y,static:!0,...oe})},[R,ue,ve,_e,vt,pt,E,Le,rt,tt,We,Ve,St,zt,mi,s,z,H,K,W,se,Y,ne,oe,Pt,l,c,r,f,D,S,lt,Gt,Mi,bt,ze,$t,dt]}class f3 extends Ri{constructor(e){super(),Di(this,e,d3,h3,Ci,{datePickerType:0,value:16,valueFrom:17,valueTo:18,dateFormat:19,maxDate:20,minDate:21,locale:22,short:1,light:2,id:3,flatpickrProps:23},null,[-1,-1])}}function fb(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function m3(t){let e,i,n=t[1]&&fb(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M26,4h-4V2h-2v2h-8V2h-2v2H6C4.9,4,4,4.9,4,6v20c0,1.1,0.9,2,2,2h20c1.1,0,2-0.9,2-2V6C28,4.9,27.1,4,26,4z M26,26H6V12h20	V26z M26,10H6V6h4v2h2V6h8v2h2V6h4V10z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=fb(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function p3(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class g3 extends Ri{constructor(e){super(),Di(this,e,p3,m3,Ci,{size:0,title:1})}}const _3=g3,y3=t=>({}),mb=t=>({});function pb(t){let e,i;const n=t[35].labelText,s=$i(n,t,t[34],mb),l=s||v3(t);return{c(){e=nt("label"),l&&l.c(),je(e,"for",t[8]),$(e,"bx--label",!0),$(e,"bx--visually-hidden",t[10]),$(e,"bx--label--disabled",t[5])},m(c,r){Se(c,e,r),l&&l.m(e,null),i=!0},p(c,r){s?s.p&&(!i||r[1]&8)&&tn(s,n,c,c[34],i?en(n,c[34],r,y3):nn(c[34]),mb):l&&l.p&&(!i||r[0]&512)&&l.p(c,i?r:[-1,-1]),(!i||r[0]&256)&&je(e,"for",c[8]),(!i||r[0]&1024)&&$(e,"bx--visually-hidden",c[10]),(!i||r[0]&32)&&$(e,"bx--label--disabled",c[5])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function v3(t){let e;return{c(){e=gi(t[9])},m(i,n){Se(i,e,n)},p(i,n){n[0]&512&&Si(e,i[9])},d(i){i&&Te(e)}}}function gb(t){let e,i;return e=new mu({props:{class:"bx--date-picker__icon bx--date-picker__icon--invalid"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function _b(t){let e,i;return e=new df({props:{class:"bx--date-picker__icon bx--date-picker__icon--warn"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function yb(t){let e,i;return e=new _3({props:{class:"bx--date-picker__icon","aria-label":t[7]}}),e.$on("click",t[27]),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s[0]&128&&(l["aria-label"]=n[7]),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function vb(t){let e,i;return{c(){e=nt("div"),i=gi(t[12]),$(e,"bx--form-requirement",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&4096&&Si(i,n[12])},d(n){n&&Te(e)}}}function bb(t){let e,i;return{c(){e=nt("div"),i=gi(t[14]),$(e,"bx--form-requirement",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&16384&&Si(i,n[14])},d(n){n&&Te(e)}}}function xb(t){let e,i;return{c(){e=nt("div"),i=gi(t[6]),$(e,"bx--form__helper-text",!0),$(e,"bx--form__helper-text--disabled",t[5])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&64&&Si(i,n[6]),s[0]&32&&$(e,"bx--form__helper-text--disabled",n[5])},d(n){n&&Te(e)}}}function b3(t){let e,i,n,s,l,c,r,f,m,y,b,E,S,D,R,z=(t[9]||t[32].labelText)&&pb(t),H=[{"data-invalid":l=t[11]||void 0},{id:t[8]},{name:t[15]},{placeholder:t[3]},{type:t[2]},{pattern:t[4]},{disabled:t[5]},t[33],{value:c=t[16]?t[17].indexOf(t[8])===0?t[18]:t[19]:t[20]}],K={};for(let _e=0;_e<H.length;_e+=1)K=Ye(K,H[_e]);let W=t[11]&&gb(),se=!t[11]&&t[13]&&_b(),Y=t[21]&&!t[11]&&!t[13]&&yb(t),ne=t[11]&&vb(t),ue=!t[11]&&t[13]&&bb(t),ve=!t[11]&&!t[13]&&t[6]&&xb(t);return{c(){e=nt("div"),z&&z.c(),i=Et(),n=nt("div"),s=nt("input"),r=Et(),W&&W.c(),f=Et(),se&&se.c(),m=Et(),Y&&Y.c(),y=Et(),ne&&ne.c(),b=Et(),ue&&ue.c(),E=Et(),ve&&ve.c(),ui(s,K),$(s,"bx--date-picker__input",!0),$(s,"bx--date-picker__input--invalid",t[11]),$(s,"bx--date-picker__input--sm",t[1]==="sm"),$(s,"bx--date-picker__input--xl",t[1]==="xl"),$(n,"bx--date-picker-input__wrapper",!0),$(n,"bx--date-picker-input__wrapper--invalid",t[11]),$(n,"bx--date-picker-input__wrapper--warn",t[13]),$(e,"bx--date-picker-container",!0),$(e,"bx--date-picker--nolabel",!t[9])},m(_e,oe){Se(_e,e,oe),z&&z.m(e,null),Ze(e,i),Ze(e,n),Ze(n,s),"value"in K&&(s.value=K.value),s.autofocus&&s.focus(),t[41](s),Ze(n,r),W&&W.m(n,null),Ze(n,f),se&&se.m(n,null),Ze(n,m),Y&&Y.m(n,null),Ze(e,y),ne&&ne.m(e,null),Ze(e,b),ue&&ue.m(e,null),Ze(e,E),ve&&ve.m(e,null),S=!0,D||(R=[ut(s,"input",t[36]),ut(s,"input",t[42]),ut(s,"change",t[43]),ut(s,"keydown",t[37]),ut(s,"keydown",t[44]),ut(s,"keyup",t[38]),ut(s,"blur",t[39]),ut(s,"blur",t[45]),ut(s,"paste",t[40])],D=!0)},p(_e,oe){_e[9]||_e[32].labelText?z?(z.p(_e,oe),oe[0]&512|oe[1]&2&&ae(z,1)):(z=pb(_e),z.c(),ae(z,1),z.m(e,i)):z&&(Ai(),pe(z,1,1,()=>{z=null}),Ei()),ui(s,K=Ni(H,[(!S||oe[0]&2048&&l!==(l=_e[11]||void 0))&&{"data-invalid":l},(!S||oe[0]&256)&&{id:_e[8]},(!S||oe[0]&32768)&&{name:_e[15]},(!S||oe[0]&8)&&{placeholder:_e[3]},(!S||oe[0]&4)&&{type:_e[2]},(!S||oe[0]&16)&&{pattern:_e[4]},(!S||oe[0]&32)&&{disabled:_e[5]},oe[1]&4&&_e[33],(!S||oe[0]&2031872&&c!==(c=_e[16]?_e[17].indexOf(_e[8])===0?_e[18]:_e[19]:_e[20])&&s.value!==c)&&{value:c}])),"value"in K&&(s.value=K.value),$(s,"bx--date-picker__input",!0),$(s,"bx--date-picker__input--invalid",_e[11]),$(s,"bx--date-picker__input--sm",_e[1]==="sm"),$(s,"bx--date-picker__input--xl",_e[1]==="xl"),_e[11]?W?oe[0]&2048&&ae(W,1):(W=gb(),W.c(),ae(W,1),W.m(n,f)):W&&(Ai(),pe(W,1,1,()=>{W=null}),Ei()),!_e[11]&&_e[13]?se?oe[0]&10240&&ae(se,1):(se=_b(),se.c(),ae(se,1),se.m(n,m)):se&&(Ai(),pe(se,1,1,()=>{se=null}),Ei()),_e[21]&&!_e[11]&&!_e[13]?Y?(Y.p(_e,oe),oe[0]&2107392&&ae(Y,1)):(Y=yb(_e),Y.c(),ae(Y,1),Y.m(n,null)):Y&&(Ai(),pe(Y,1,1,()=>{Y=null}),Ei()),(!S||oe[0]&2048)&&$(n,"bx--date-picker-input__wrapper--invalid",_e[11]),(!S||oe[0]&8192)&&$(n,"bx--date-picker-input__wrapper--warn",_e[13]),_e[11]?ne?ne.p(_e,oe):(ne=vb(_e),ne.c(),ne.m(e,b)):ne&&(ne.d(1),ne=null),!_e[11]&&_e[13]?ue?ue.p(_e,oe):(ue=bb(_e),ue.c(),ue.m(e,E)):ue&&(ue.d(1),ue=null),!_e[11]&&!_e[13]&&_e[6]?ve?ve.p(_e,oe):(ve=xb(_e),ve.c(),ve.m(e,null)):ve&&(ve.d(1),ve=null),(!S||oe[0]&512)&&$(e,"bx--date-picker--nolabel",!_e[9])},i(_e){S||(ae(z),ae(W),ae(se),ae(Y),S=!0)},o(_e){pe(z),pe(W),pe(se),pe(Y),S=!1},d(_e){_e&&Te(e),z&&z.d(),t[41](null),W&&W.d(),se&&se.d(),Y&&Y.d(),ne&&ne.d(),ue&&ue.d(),ve&&ve.d(),D=!1,vn(R)}}}function x3(t,e,i){const n=["size","type","placeholder","pattern","disabled","helperText","iconDescription","id","labelText","hideLabel","invalid","invalidText","warn","warnText","name","ref"];let s=Ut(e,n),l,c,r,f,m,y,{$$slots:b={},$$scope:E}=e;const S=hu(b);let{size:D=void 0}=e,{type:R="text"}=e,{placeholder:z=""}=e,{pattern:H="\\d{1,2}\\/\\d{1,2}\\/\\d{4}"}=e,{disabled:K=!1}=e,{helperText:W=""}=e,{iconDescription:se=""}=e,{id:Y="ccs-"+Math.random().toString(36)}=e,{labelText:ne=""}=e,{hideLabel:ue=!1}=e,{invalid:ve=!1}=e,{invalidText:_e=""}=e,{warn:oe=!1}=e,{warnText:Be=""}=e,{name:mt=void 0}=e,{ref:Le=null}=e;const{range:rt,add:tt,hasCalendar:We,declareRef:Ve,inputIds:St,updateValue:zt,blurInput:mi,openCalendar:vt,focusCalendar:pt,inputValue:Pt,inputValueFrom:qe,inputValueTo:Ht}=Ec("DatePicker");Ln(t,rt,ct=>i(16,l=ct)),Ln(t,We,ct=>i(21,y=ct)),Ln(t,St,ct=>i(17,c=ct)),Ln(t,Pt,ct=>i(20,m=ct)),Ln(t,qe,ct=>i(18,r=ct)),Ln(t,Ht,ct=>i(19,f=ct)),tt({id:Y,labelText:ne});function lt(ct){At.call(this,t,ct)}function Gt(ct){At.call(this,t,ct)}function Mi(ct){At.call(this,t,ct)}function bt(ct){At.call(this,t,ct)}function ze(ct){At.call(this,t,ct)}function $t(ct){sn[ct?"unshift":"push"](()=>{Le=ct,i(0,Le)})}const dt=({target:ct})=>{zt({type:"input",value:ct.value})},_t=({target:ct})=>{zt({type:"change",value:ct.value})},ni=({key:ct})=>{ct==="ArrowDown"&&pt()},Wi=({relatedTarget:ct})=>{mi(ct)};return t.$$set=ct=>{e=Ye(Ye({},e),fi(ct)),i(33,s=Ut(e,n)),"size"in ct&&i(1,D=ct.size),"type"in ct&&i(2,R=ct.type),"placeholder"in ct&&i(3,z=ct.placeholder),"pattern"in ct&&i(4,H=ct.pattern),"disabled"in ct&&i(5,K=ct.disabled),"helperText"in ct&&i(6,W=ct.helperText),"iconDescription"in ct&&i(7,se=ct.iconDescription),"id"in ct&&i(8,Y=ct.id),"labelText"in ct&&i(9,ne=ct.labelText),"hideLabel"in ct&&i(10,ue=ct.hideLabel),"invalid"in ct&&i(11,ve=ct.invalid),"invalidText"in ct&&i(12,_e=ct.invalidText),"warn"in ct&&i(13,oe=ct.warn),"warnText"in ct&&i(14,Be=ct.warnText),"name"in ct&&i(15,mt=ct.name),"ref"in ct&&i(0,Le=ct.ref),"$$scope"in ct&&i(34,E=ct.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&257&&Le&&Ve({id:Y,ref:Le})},[Le,D,R,z,H,K,W,se,Y,ne,ue,ve,_e,oe,Be,mt,l,c,r,f,m,y,rt,We,St,zt,mi,vt,pt,Pt,qe,Ht,S,s,E,b,lt,Gt,Mi,bt,ze,$t,dt,_t,ni,Wi]}class wb extends Ri{constructor(e){super(),Di(this,e,x3,b3,Ci,{size:1,type:2,placeholder:3,pattern:4,disabled:5,helperText:6,iconDescription:7,id:8,labelText:9,hideLabel:10,invalid:11,invalidText:12,warn:13,warnText:14,name:15,ref:0},null,[-1,-1])}}function Ab(t,e,i){const n=t.slice();return n[39]=e[i],n[41]=i,n}const w3=t=>({item:t[0]&8,index:t[0]&8}),Eb=t=>({item:t[39],index:t[41]});function Tb(t){let e,i;return{c(){e=nt("label"),i=gi(t[10]),je(e,"for",t[19]),$(e,"bx--label",!0),$(e,"bx--label--disabled",t[9]),$(e,"bx--visually-hidden",t[17])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&1024&&Si(i,n[10]),s[0]&524288&&je(e,"for",n[19]),s[0]&512&&$(e,"bx--label--disabled",n[9]),s[0]&131072&&$(e,"bx--visually-hidden",n[17])},d(n){n&&Te(e)}}}function Sb(t){let e,i;return e=new mu({props:{class:"bx--list-box__invalid-icon"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function Ib(t){let e,i;return e=new df({props:{class:"bx--list-box__invalid-icon bx--list-box__invalid-icon--warning"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function A3(t){let e;return{c(){e=gi(t[16])},m(i,n){Se(i,e,n)},p(i,n){n[0]&65536&&Si(e,i[16])},d(i){i&&Te(e)}}}function E3(t){let e=t[4](t[22])+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p(n,s){s[0]&4194320&&e!==(e=n[4](n[22])+"")&&Si(i,e)},d(n){n&&Te(i)}}}function kb(t){let e,i;return e=new OA({props:{"aria-labelledby":t[19],id:t[19],$$slots:{default:[I3]},$$scope:{ctx:t}}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s[0]&524288&&(l["aria-labelledby"]=n[19]),s[0]&524288&&(l.id=n[19]),s[0]&2097181|s[1]&64&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function T3(t){let e=t[4](t[39])+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p(n,s){s[0]&24&&e!==(e=n[4](n[39])+"")&&Si(i,e)},d(n){n&&Te(i)}}}function S3(t){let e,i;const n=t[29].default,s=$i(n,t,t[37],Eb),l=s||T3(t);return{c(){l&&l.c(),e=Et()},m(c,r){l&&l.m(c,r),Se(c,e,r),i=!0},p(c,r){s?s.p&&(!i||r[0]&8|r[1]&64)&&tn(s,n,c,c[37],i?en(n,c[37],r,w3):nn(c[37]),Eb):l&&l.p&&(!i||r[0]&24)&&l.p(c,i?r:[-1,-1])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function Ob(t,e){let i,n,s;function l(...r){return e[34](e[39],...r)}function c(){return e[35](e[39],e[41])}return n=new CA({props:{id:e[39].id,active:e[0]===e[39].id,highlighted:e[21]===e[41],disabled:e[39].disabled,$$slots:{default:[S3]},$$scope:{ctx:e}}}),n.$on("click",l),n.$on("mouseenter",c),{key:t,first:null,c(){i=Mn(),Mt(n.$$.fragment),this.first=i},m(r,f){Se(r,i,f),Ot(n,r,f),s=!0},p(r,f){e=r;const m={};f[0]&8&&(m.id=e[39].id),f[0]&9&&(m.active=e[0]===e[39].id),f[0]&2097160&&(m.highlighted=e[21]===e[41]),f[0]&8&&(m.disabled=e[39].disabled),f[0]&24|f[1]&64&&(m.$$scope={dirty:f,ctx:e}),n.$set(m)},i(r){s||(ae(n.$$.fragment,r),s=!0)},o(r){pe(n.$$.fragment,r),s=!1},d(r){r&&Te(i),Ct(n,r)}}}function I3(t){let e=[],i=new Map,n,s,l=Ks(t[3]);const c=r=>r[39].id;for(let r=0;r<l.length;r+=1){let f=Ab(t,l,r),m=c(f);i.set(m,e[r]=Ob(m,f))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();n=Mn()},m(r,f){for(let m=0;m<e.length;m+=1)e[m]&&e[m].m(r,f);Se(r,n,f),s=!0},p(r,f){f[0]&35651613|f[1]&64&&(l=Ks(r[3]),Ai(),e=fu(e,f,c,1,r,l,i,n.parentNode,du,Ob,n,Ab),Ei())},i(r){if(!s){for(let f=0;f<l.length;f+=1)ae(e[f]);s=!0}},o(r){for(let f=0;f<e.length;f+=1)pe(e[f]);s=!1},d(r){r&&Te(n);for(let f=0;f<e.length;f+=1)e[f].d(r)}}}function k3(t){let e,i,n,s,l,c,r,f,m,y,b,E=t[11]&&Sb(),S=!t[11]&&t[13]&&Ib();function D(K,W){return K[22]?E3:A3}let R=D(t),z=R(t);c=new M0({props:{translateWithId:t[18],open:t[1]}}),c.$on("click",t[30]);let H=t[1]&&kb(t);return{c(){E&&E.c(),e=Et(),S&&S.c(),i=Et(),n=nt("button"),s=nt("span"),z.c(),l=Et(),Mt(c.$$.fragment),r=Et(),H&&H.c(),f=Mn(),$(s,"bx--list-box__label",!0),je(n,"type","button"),je(n,"tabindex","0"),je(n,"aria-expanded",t[1]),n.disabled=t[9],je(n,"translatewithid",t[18]),je(n,"id",t[19]),$(n,"bx--list-box__field",!0)},m(K,W){E&&E.m(K,W),Se(K,e,W),S&&S.m(K,W),Se(K,i,W),Se(K,n,W),Ze(n,s),z.m(s,null),Ze(n,l),Ot(c,n,null),t[31](n),Se(K,r,W),H&&H.m(K,W),Se(K,f,W),m=!0,y||(b=[ut(n,"keydown",t[32]),ut(n,"keyup",t[33])],y=!0)},p(K,W){K[11]?E?W[0]&2048&&ae(E,1):(E=Sb(),E.c(),ae(E,1),E.m(e.parentNode,e)):E&&(Ai(),pe(E,1,1,()=>{E=null}),Ei()),!K[11]&&K[13]?S?W[0]&10240&&ae(S,1):(S=Ib(),S.c(),ae(S,1),S.m(i.parentNode,i)):S&&(Ai(),pe(S,1,1,()=>{S=null}),Ei()),R===(R=D(K))&&z?z.p(K,W):(z.d(1),z=R(K),z&&(z.c(),z.m(s,null)));const se={};W[0]&262144&&(se.translateWithId=K[18]),W[0]&2&&(se.open=K[1]),c.$set(se),(!m||W[0]&2)&&je(n,"aria-expanded",K[1]),(!m||W[0]&512)&&(n.disabled=K[9]),(!m||W[0]&262144)&&je(n,"translatewithid",K[18]),(!m||W[0]&524288)&&je(n,"id",K[19]),K[1]?H?(H.p(K,W),W[0]&2&&ae(H,1)):(H=kb(K),H.c(),ae(H,1),H.m(f.parentNode,f)):H&&(Ai(),pe(H,1,1,()=>{H=null}),Ei())},i(K){m||(ae(E),ae(S),ae(c.$$.fragment,K),ae(H),m=!0)},o(K){pe(E),pe(S),pe(c.$$.fragment,K),pe(H),m=!1},d(K){K&&(Te(e),Te(i),Te(n),Te(r),Te(f)),E&&E.d(K),S&&S.d(K),z.d(),Ct(c),t[31](null),H&&H.d(K),y=!1,vn(b)}}}function Cb(t){let e,i;return{c(){e=nt("div"),i=gi(t[15]),$(e,"bx--form__helper-text",!0),$(e,"bx--form__helper-text--disabled",t[9])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&32768&&Si(i,n[15]),s[0]&512&&$(e,"bx--form__helper-text--disabled",n[9])},d(n){n&&Te(e)}}}function O3(t){let e,i,n,s,l,c,r,f=t[10]&&Tb(t);n=new kA({props:{role:void 0,type:t[5],size:t[7],name:t[20],"aria-label":t[28]["aria-label"],class:`bx--dropdown 
      `+(t[6]==="top"&&"bx--list-box--up")+` 
      `+(t[11]&&"bx--dropdown--invalid")+` 
      `+(!t[11]&&t[13]&&"bx--dropdown--warning")+` 
      `+(t[1]&&"bx--dropdown--open")+`
      `+(t[7]==="sm"&&"bx--dropdown--sm")+`
      `+(t[7]==="xl"&&"bx--dropdown--xl")+`
      `+(t[23]&&"bx--dropdown--inline")+`
      `+(t[9]&&"bx--dropdown--disabled")+`
      `+(t[8]&&"bx--dropdown--light"),disabled:t[9],open:t[1],invalid:t[11],invalidText:t[12],light:t[8],warn:t[13],warnText:t[14],$$slots:{default:[k3]},$$scope:{ctx:t}}}),n.$on("click",t[36]);let m=!t[23]&&!t[11]&&!t[13]&&t[15]&&Cb(t),y=[t[27]],b={};for(let E=0;E<y.length;E+=1)b=Ye(b,y[E]);return{c(){e=nt("div"),f&&f.c(),i=Et(),Mt(n.$$.fragment),s=Et(),m&&m.c(),ui(e,b),$(e,"bx--dropdown__wrapper",!0),$(e,"bx--list-box__wrapper",!0),$(e,"bx--dropdown__wrapper--inline",t[23]),$(e,"bx--list-box__wrapper--inline",t[23]),$(e,"bx--dropdown__wrapper--inline--invalid",t[23]&&t[11])},m(E,S){Se(E,e,S),f&&f.m(e,null),Ze(e,i),Ot(n,e,null),Ze(e,s),m&&m.m(e,null),l=!0,c||(r=ut(window,"click",t[26]),c=!0)},p(E,S){E[10]?f?f.p(E,S):(f=Tb(E),f.c(),f.m(e,i)):f&&(f.d(1),f=null);const D={};S[0]&32&&(D.type=E[5]),S[0]&128&&(D.size=E[7]),S[0]&1048576&&(D.name=E[20]),S[0]&268435456&&(D["aria-label"]=E[28]["aria-label"]),S[0]&8399810&&(D.class=`bx--dropdown 
      `+(E[6]==="top"&&"bx--list-box--up")+` 
      `+(E[11]&&"bx--dropdown--invalid")+` 
      `+(!E[11]&&E[13]&&"bx--dropdown--warning")+` 
      `+(E[1]&&"bx--dropdown--open")+`
      `+(E[7]==="sm"&&"bx--dropdown--sm")+`
      `+(E[7]==="xl"&&"bx--dropdown--xl")+`
      `+(E[23]&&"bx--dropdown--inline")+`
      `+(E[9]&&"bx--dropdown--disabled")+`
      `+(E[8]&&"bx--dropdown--light")),S[0]&512&&(D.disabled=E[9]),S[0]&2&&(D.open=E[1]),S[0]&2048&&(D.invalid=E[11]),S[0]&4096&&(D.invalidText=E[12]),S[0]&256&&(D.light=E[8]),S[0]&8192&&(D.warn=E[13]),S[0]&16384&&(D.warnText=E[14]),S[0]&7154207|S[1]&64&&(D.$$scope={dirty:S,ctx:E}),n.$set(D),!E[23]&&!E[11]&&!E[13]&&E[15]?m?m.p(E,S):(m=Cb(E),m.c(),m.m(e,null)):m&&(m.d(1),m=null),ui(e,b=Ni(y,[S[0]&134217728&&E[27]])),$(e,"bx--dropdown__wrapper",!0),$(e,"bx--list-box__wrapper",!0),$(e,"bx--dropdown__wrapper--inline",E[23]),$(e,"bx--list-box__wrapper--inline",E[23]),$(e,"bx--dropdown__wrapper--inline--invalid",E[23]&&E[11])},i(E){l||(ae(n.$$.fragment,E),l=!0)},o(E){pe(n.$$.fragment,E),l=!1},d(E){E&&Te(e),f&&f.d(),Ct(n),m&&m.d(),c=!1,r()}}}function C3(t,e,i){let n,s;const l=["items","itemToString","selectedId","type","direction","size","open","light","disabled","titleText","invalid","invalidText","warn","warnText","helperText","label","hideLabel","translateWithId","id","name","ref"];let c=Ut(e,l),{$$slots:r={},$$scope:f}=e,{items:m=[]}=e,{itemToString:y=lt=>lt.text||lt.id}=e,{selectedId:b}=e,{type:E="default"}=e,{direction:S="bottom"}=e,{size:D=void 0}=e,{open:R=!1}=e,{light:z=!1}=e,{disabled:H=!1}=e,{titleText:K=""}=e,{invalid:W=!1}=e,{invalidText:se=""}=e,{warn:Y=!1}=e,{warnText:ne=""}=e,{helperText:ue=""}=e,{label:ve=void 0}=e,{hideLabel:_e=!1}=e,{translateWithId:oe=void 0}=e,{id:Be="ccs-"+Math.random().toString(36)}=e,{name:mt=void 0}=e,{ref:Le=null}=e;const rt=co();let tt=-1;function We(lt){let Gt=tt+lt;if(m.length===0)return;Gt<0?Gt=m.length-1:Gt>=m.length&&(Gt=0);let Mi=m[Gt].disabled;for(;Mi;)Gt=Gt+lt,Gt<0?Gt=m.length-1:Gt>=m.length&&(Gt=0),Mi=m[Gt].disabled;i(21,tt=Gt)}const Ve=()=>{rt("select",{selectedId:b,selectedItem:m.find(lt=>lt.id===b)})},St=({target:lt})=>{R&&Le&&!Le.contains(lt)&&i(1,R=!1)};Pl(()=>(parent&&parent.addEventListener("click",St),()=>{parent&&parent.removeEventListener("click",St)}));const zt=lt=>{lt.stopPropagation(),!H&&i(1,R=!R)};function mi(lt){sn[lt?"unshift":"push"](()=>{Le=lt,i(2,Le)})}const vt=lt=>{const{key:Gt}=lt;["Enter","ArrowDown","ArrowUp"].includes(Gt)&&lt.preventDefault(),Gt==="Enter"?(i(1,R=!R),tt>-1&&m[tt].id!==b&&(i(0,b=m[tt].id),Ve(),i(1,R=!1))):Gt==="Tab"?(i(1,R=!1),Le.blur()):Gt==="ArrowDown"?(R||i(1,R=!0),We(1)):Gt==="ArrowUp"?(R||i(1,R=!0),We(-1)):Gt==="Escape"&&i(1,R=!1)},pt=lt=>{const{key:Gt}=lt;if([" "].includes(Gt))lt.preventDefault();else return;i(1,R=!R),tt>-1&&m[tt].id!==b&&(i(0,b=m[tt].id),Ve(),i(1,R=!1))},Pt=(lt,Gt)=>{if(lt.disabled){Gt.stopPropagation();return}i(0,b=lt.id),Ve(),Le.focus()},qe=(lt,Gt)=>{lt.disabled||i(21,tt=Gt)},Ht=({target:lt})=>{H||i(1,R=Le.contains(lt)?!R:!1)};return t.$$set=lt=>{i(28,e=Ye(Ye({},e),fi(lt))),i(27,c=Ut(e,l)),"items"in lt&&i(3,m=lt.items),"itemToString"in lt&&i(4,y=lt.itemToString),"selectedId"in lt&&i(0,b=lt.selectedId),"type"in lt&&i(5,E=lt.type),"direction"in lt&&i(6,S=lt.direction),"size"in lt&&i(7,D=lt.size),"open"in lt&&i(1,R=lt.open),"light"in lt&&i(8,z=lt.light),"disabled"in lt&&i(9,H=lt.disabled),"titleText"in lt&&i(10,K=lt.titleText),"invalid"in lt&&i(11,W=lt.invalid),"invalidText"in lt&&i(12,se=lt.invalidText),"warn"in lt&&i(13,Y=lt.warn),"warnText"in lt&&i(14,ne=lt.warnText),"helperText"in lt&&i(15,ue=lt.helperText),"label"in lt&&i(16,ve=lt.label),"hideLabel"in lt&&i(17,_e=lt.hideLabel),"translateWithId"in lt&&i(18,oe=lt.translateWithId),"id"in lt&&i(19,Be=lt.id),"name"in lt&&i(20,mt=lt.name),"ref"in lt&&i(2,Le=lt.ref),"$$scope"in lt&&i(37,f=lt.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&32&&i(23,n=E==="inline"),t.$$.dirty[0]&9&&i(22,s=m.find(lt=>lt.id===b)),t.$$.dirty[0]&2&&(R||i(21,tt=-1))},e=fi(e),[b,R,Le,m,y,E,S,D,z,H,K,W,se,Y,ne,ue,ve,_e,oe,Be,mt,tt,s,n,We,Ve,St,c,e,r,zt,mi,vt,pt,Pt,qe,Ht,f]}class M3 extends Ri{constructor(e){super(),Di(this,e,C3,O3,Ci,{items:3,itemToString:4,selectedId:0,type:5,direction:6,size:7,open:1,light:8,disabled:9,titleText:10,invalid:11,invalidText:12,warn:13,warnText:14,helperText:15,label:16,hideLabel:17,translateWithId:18,id:19,name:20,ref:2},null,[-1,-1])}}const eu=M3;function Mb(t,e,i){const n=t.slice();return n[74]=e[i],n[76]=i,n}const D3=t=>({item:t[0]&1073750016|t[1]&1,index:t[0]&1073750016|t[1]&1}),Db=t=>({slot:"labelText",item:t[74],index:t[76]}),R3=t=>({}),Rb=t=>({});function Lb(t){let e,i;const n=t[46].titleText,s=$i(n,t,t[68],Rb),l=s||L3(t);return{c(){e=nt("label"),l&&l.c(),je(e,"for",t[27]),$(e,"bx--label",!0),$(e,"bx--label--disabled",t[12]),$(e,"bx--visually-hidden",t[26])},m(c,r){Se(c,e,r),l&&l.m(e,null),i=!0},p(c,r){s?s.p&&(!i||r[2]&64)&&tn(s,n,c,c[68],i?en(n,c[68],r,R3):nn(c[68]),Rb):l&&l.p&&(!i||r[0]&262144)&&l.p(c,i?r:[-1,-1,-1]),(!i||r[0]&134217728)&&je(e,"for",c[27]),(!i||r[0]&4096)&&$(e,"bx--label--disabled",c[12]),(!i||r[0]&67108864)&&$(e,"bx--visually-hidden",c[26])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function L3(t){let e;return{c(){e=gi(t[18])},m(i,n){Se(i,e,n)},p(i,n){n[0]&262144&&Si(e,i[18])},d(i){i&&Te(e)}}}function Pb(t){let e,i;return e=new mu({props:{class:"bx--list-box__invalid-icon"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function Nb(t){let e,i;return e=new df({props:{class:"bx--list-box__invalid-icon bx--list-box__invalid-icon--warning"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function zb(t){let e,i;return e=new MA({props:{selectionCount:t[32].length,translateWithId:t[17],disabled:t[12]}}),e.$on("clear",t[53]),e.$on("clear",t[54]),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s[1]&2&&(l.selectionCount=n[32].length),s[0]&131072&&(l.translateWithId=n[17]),s[0]&4096&&(l.disabled=n[12]),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function Bb(t){let e,i,n,s,l,c,r,f,m=[t[39],{role:"combobox"},{tabindex:"0"},{autocomplete:"off"},{"aria-autocomplete":"list"},{"aria-expanded":t[2]},{"aria-activedescendant":t[7]},{"aria-disabled":t[12]},{"aria-controls":t[35]},{disabled:t[12]},{placeholder:t[15]},{id:t[27]},{name:t[28]}],y={};for(let S=0;S<m.length;S+=1)y=Ye(y,m[S]);let b=t[20]&&Vb(),E=t[1]&&Fb(t);return l=new M0({props:{style:"pointer-events: "+(t[2]?"auto":"none"),translateWithId:t[16],open:t[2]}}),l.$on("click",t[59]),{c(){e=nt("input"),i=Et(),b&&b.c(),n=Et(),E&&E.c(),s=Et(),Mt(l.$$.fragment),ui(e,y),$(e,"bx--text-input",!0),$(e,"bx--text-input--empty",t[1]===""),$(e,"bx--text-input--light",t[14])},m(S,D){Se(S,e,D),e.autofocus&&e.focus(),t[55](e),Pm(e,t[1]),Se(S,i,D),b&&b.m(S,D),Se(S,n,D),E&&E.m(S,D),Se(S,s,D),Ot(l,S,D),c=!0,r||(f=[ut(e,"input",t[56]),ut(e,"keydown",t[47]),ut(e,"keydown",iu(t[57])),ut(e,"keyup",t[48]),ut(e,"focus",t[49]),ut(e,"blur",t[50]),ut(e,"paste",t[51])],r=!0)},p(S,D){ui(e,y=Ni(m,[D[1]&256&&S[39],{role:"combobox"},{tabindex:"0"},{autocomplete:"off"},{"aria-autocomplete":"list"},(!c||D[0]&4)&&{"aria-expanded":S[2]},(!c||D[0]&128)&&{"aria-activedescendant":S[7]},(!c||D[0]&4096)&&{"aria-disabled":S[12]},(!c||D[1]&16)&&{"aria-controls":S[35]},(!c||D[0]&4096)&&{disabled:S[12]},(!c||D[0]&32768)&&{placeholder:S[15]},(!c||D[0]&134217728)&&{id:S[27]},(!c||D[0]&268435456)&&{name:S[28]}])),D[0]&2&&e.value!==S[1]&&Pm(e,S[1]),$(e,"bx--text-input",!0),$(e,"bx--text-input--empty",S[1]===""),$(e,"bx--text-input--light",S[14]),S[20]?b?D[0]&1048576&&ae(b,1):(b=Vb(),b.c(),ae(b,1),b.m(n.parentNode,n)):b&&(Ai(),pe(b,1,1,()=>{b=null}),Ei()),S[1]?E?(E.p(S,D),D[0]&2&&ae(E,1)):(E=Fb(S),E.c(),ae(E,1),E.m(s.parentNode,s)):E&&(Ai(),pe(E,1,1,()=>{E=null}),Ei());const R={};D[0]&4&&(R.style="pointer-events: "+(S[2]?"auto":"none")),D[0]&65536&&(R.translateWithId=S[16]),D[0]&4&&(R.open=S[2]),l.$set(R)},i(S){c||(ae(b),ae(E),ae(l.$$.fragment,S),c=!0)},o(S){pe(b),pe(E),pe(l.$$.fragment,S),c=!1},d(S){S&&(Te(e),Te(i),Te(n),Te(s)),t[55](null),b&&b.d(S),E&&E.d(S),Ct(l,S),r=!1,vn(f)}}}function Vb(t){let e,i;return e=new mu({props:{class:"bx--list-box__invalid-icon"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function Fb(t){let e,i;return e=new MA({props:{translateWithId:t[17],disabled:t[12],open:t[2]}}),e.$on("clear",t[58]),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s[0]&131072&&(l.translateWithId=n[17]),s[0]&4096&&(l.disabled=n[12]),s[0]&4&&(l.open=n[2]),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function Ub(t){let e,i,n,s,l;return s=new M0({props:{open:t[2],translateWithId:t[16]}}),{c(){e=nt("span"),i=gi(t[25]),n=Et(),Mt(s.$$.fragment),$(e,"bx--list-box__label",!0)},m(c,r){Se(c,e,r),Ze(e,i),Se(c,n,r),Ot(s,c,r),l=!0},p(c,r){(!l||r[0]&33554432)&&Si(i,c[25]);const f={};r[0]&4&&(f.open=c[2]),r[0]&65536&&(f.translateWithId=c[16]),s.$set(f)},i(c){l||(ae(s.$$.fragment,c),l=!0)},o(c){pe(s.$$.fragment,c),l=!1},d(c){c&&(Te(e),Te(n)),Ct(s,c)}}}function P3(t){let e,i,n,s,l=t[32].length>0&&zb(t),c=t[13]&&Bb(t),r=!t[13]&&Ub(t);return{c(){l&&l.c(),e=Et(),c&&c.c(),i=Et(),r&&r.c(),n=Mn()},m(f,m){l&&l.m(f,m),Se(f,e,m),c&&c.m(f,m),Se(f,i,m),r&&r.m(f,m),Se(f,n,m),s=!0},p(f,m){f[32].length>0?l?(l.p(f,m),m[1]&2&&ae(l,1)):(l=zb(f),l.c(),ae(l,1),l.m(e.parentNode,e)):l&&(Ai(),pe(l,1,1,()=>{l=null}),Ei()),f[13]?c?(c.p(f,m),m[0]&8192&&ae(c,1)):(c=Bb(f),c.c(),ae(c,1),c.m(i.parentNode,i)):c&&(Ai(),pe(c,1,1,()=>{c=null}),Ei()),f[13]?r&&(Ai(),pe(r,1,1,()=>{r=null}),Ei()):r?(r.p(f,m),m[0]&8192&&ae(r,1)):(r=Ub(f),r.c(),ae(r,1),r.m(n.parentNode,n))},i(f){s||(ae(l),ae(c),ae(r),s=!0)},o(f){pe(l),pe(c),pe(r),s=!1},d(f){f&&(Te(e),Te(i),Te(n)),l&&l.d(f),c&&c.d(f),r&&r.d(f)}}}function N3(t){let e=t[8](t[74])+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p(n,s){s[0]&1073750272|s[1]&1&&e!==(e=n[8](n[74])+"")&&Si(i,e)},d(n){n&&Te(i)}}}function z3(t){let e;const i=t[46].default,n=$i(i,t,t[68],Db),s=n||N3(t);return{c(){s&&s.c()},m(l,c){s&&s.m(l,c),e=!0},p(l,c){n?n.p&&(!e||c[0]&1073750016|c[1]&1|c[2]&64)&&tn(n,i,l,l[68],e?en(i,l[68],c,D3):nn(l[68]),Db):s&&s.p&&(!e||c[0]&1073750272|c[1]&1)&&s.p(l,e?c:[-1,-1,-1])},i(l){e||(ae(s,l),e=!0)},o(l){pe(s,l),e=!1},d(l){s&&s.d(l)}}}function B3(t){let e,i,n;const s=[{name:t[74].id},{title:t[19]?t[8](t[74]):void 0},t[9](t[74]),{readonly:!0},{tabindex:"-1"},{id:"checkbox-"+t[74].id},{checked:t[74].checked},{disabled:t[74].disabled}];function l(){return t[64](t[76])}let c={$$slots:{labelText:[z3]},$$scope:{ctx:t}};for(let r=0;r<s.length;r+=1)c=Ye(c,s[r]);return e=new E_({props:c}),e.$on("blur",l),{c(){Mt(e.$$.fragment),i=Et()},m(r,f){Ot(e,r,f),Se(r,i,f),n=!0},p(r,f){t=r;const m=f[0]&1074275072|f[1]&1?Ni(s,[f[0]&1073750016|f[1]&1&&{name:t[74].id},f[0]&1074274560|f[1]&1&&{title:t[19]?t[8](t[74]):void 0},f[0]&1073750528|f[1]&1&&hf(t[9](t[74])),s[3],s[4],f[0]&1073750016|f[1]&1&&{id:"checkbox-"+t[74].id},f[0]&1073750016|f[1]&1&&{checked:t[74].checked},f[0]&1073750016|f[1]&1&&{disabled:t[74].disabled}]):{};f[0]&1073750272|f[1]&1|f[2]&64&&(m.$$scope={dirty:f,ctx:t}),e.$set(m)},i(r){n||(ae(e.$$.fragment,r),n=!0)},o(r){pe(e.$$.fragment,r),n=!1},d(r){r&&Te(i),Ct(e,r)}}}function jb(t,e){let i,n,s;function l(...r){return e[65](e[74],...r)}function c(){return e[66](e[74],e[76])}return n=new CA({props:{id:e[74].id,role:"option","aria-labelledby":"checkbox-"+e[74].id,"aria-selected":e[74].checked,active:e[74].checked,highlighted:e[29]===e[76],disabled:e[74].disabled,$$slots:{default:[B3]},$$scope:{ctx:e}}}),n.$on("click",l),n.$on("mouseenter",c),{key:t,first:null,c(){i=Mn(),Mt(n.$$.fragment),this.first=i},m(r,f){Se(r,i,f),Ot(n,r,f),s=!0},p(r,f){e=r;const m={};f[0]&1073750016|f[1]&1&&(m.id=e[74].id),f[0]&1073750016|f[1]&1&&(m["aria-labelledby"]="checkbox-"+e[74].id),f[0]&1073750016|f[1]&1&&(m["aria-selected"]=e[74].checked),f[0]&1073750016|f[1]&1&&(m.active=e[74].checked),f[0]&1610620928|f[1]&1&&(m.highlighted=e[29]===e[76]),f[0]&1073750016|f[1]&1&&(m.disabled=e[74].disabled),f[0]&1074275076|f[1]&1|f[2]&64&&(m.$$scope={dirty:f,ctx:e}),n.$set(m)},i(r){s||(ae(n.$$.fragment,r),s=!0)},o(r){pe(n.$$.fragment,r),s=!1},d(r){r&&Te(i),Ct(n,r)}}}function V3(t){let e=[],i=new Map,n,s,l=Ks(t[13]?t[31]:t[30]);const c=r=>r[74].id;for(let r=0;r<l.length;r+=1){let f=Mb(t,l,r),m=c(f);i.set(m,e[r]=jb(m,f))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();n=Mn()},m(r,f){for(let m=0;m<e.length;m+=1)e[m]&&e[m].m(r,f);Se(r,n,f),s=!0},p(r,f){f[0]&1611146020|f[1]&1|f[2]&64&&(l=Ks(r[13]?r[31]:r[30]),Ai(),e=fu(e,f,c,1,r,l,i,n.parentNode,du,jb,n,Mb),Ei())},i(r){if(!s){for(let f=0;f<l.length;f+=1)ae(e[f]);s=!0}},o(r){for(let f=0;f<e.length;f+=1)pe(e[f]);s=!1},d(r){r&&Te(n);for(let f=0;f<e.length;f+=1)e[f].d(r)}}}function F3(t){let e,i,n,s,l,c,r,f=t[20]&&Pb(),m=!t[20]&&t[22]&&Nb();return n=new hC({props:{role:"button",tabindex:"0","aria-expanded":t[2],id:t[27],disabled:t[12],translateWithId:t[16],$$slots:{default:[P3]},$$scope:{ctx:t}}}),n.$on("click",t[60]),n.$on("keydown",t[61]),n.$on("focus",t[62]),n.$on("blur",t[63]),c=new OA({props:{"aria-label":t[33],id:t[27],"aria-multiselectable":"true",$$slots:{default:[V3]},$$scope:{ctx:t}}}),{c(){f&&f.c(),e=Et(),m&&m.c(),i=Et(),Mt(n.$$.fragment),s=Et(),l=nt("div"),Mt(c.$$.fragment),Ml(l,"display",t[2]?"block":"none")},m(y,b){f&&f.m(y,b),Se(y,e,b),m&&m.m(y,b),Se(y,i,b),Ot(n,y,b),Se(y,s,b),Se(y,l,b),Ot(c,l,null),r=!0},p(y,b){y[20]?f?b[0]&1048576&&ae(f,1):(f=Pb(),f.c(),ae(f,1),f.m(e.parentNode,e)):f&&(Ai(),pe(f,1,1,()=>{f=null}),Ei()),!y[20]&&y[22]?m?b[0]&5242880&&ae(m,1):(m=Nb(),m.c(),ae(m,1),m.m(i.parentNode,i)):m&&(Ai(),pe(m,1,1,()=>{m=null}),Ei());const E={};b[0]&4&&(E["aria-expanded"]=y[2]),b[0]&134217728&&(E.id=y[27]),b[0]&4096&&(E.disabled=y[12]),b[0]&65536&&(E.translateWithId=y[16]),b[0]&1511256239|b[1]&274|b[2]&64&&(E.$$scope={dirty:b,ctx:y}),n.$set(E);const S={};b[1]&4&&(S["aria-label"]=y[33]),b[0]&134217728&&(S.id=y[27]),b[0]&1611146020|b[1]&1|b[2]&64&&(S.$$scope={dirty:b,ctx:y}),c.$set(S),b[0]&4&&Ml(l,"display",y[2]?"block":"none")},i(y){r||(ae(f),ae(m),ae(n.$$.fragment,y),ae(c.$$.fragment,y),r=!0)},o(y){pe(f),pe(m),pe(n.$$.fragment,y),pe(c.$$.fragment,y),r=!1},d(y){y&&(Te(e),Te(i),Te(s),Te(l)),f&&f.d(y),m&&m.d(y),Ct(n,y),Ct(c)}}}function Gb(t){let e,i;return{c(){e=nt("div"),i=gi(t[24]),$(e,"bx--form__helper-text",!0),$(e,"bx--form__helper-text--disabled",t[12])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&16777216&&Si(i,n[24]),s[0]&4096&&$(e,"bx--form__helper-text--disabled",n[12])},d(n){n&&Te(e)}}}function U3(t){let e,i,n,s,l,c,r,f=(t[18]||t[38].titleText)&&Lb(t);n=new kA({props:{role:void 0,disabled:t[12],invalid:t[20],invalidText:t[21],open:t[2],light:t[14],size:t[10],warn:t[22],warnText:t[23],class:"bx--multi-select "+(t[11]==="top"&&"bx--list-box--up")+" "+(t[13]&&"bx--combo-box")+`
      `+(t[13]&&"bx--multi-select--filterable")+`
      `+(t[20]&&"bx--multi-select--invalid")+`
      `+(t[34]&&"bx--multi-select--inline")+`
      `+(t[32].length>0&&"bx--multi-select--selected"),$$slots:{default:[F3]},$$scope:{ctx:t}}});let m=!t[34]&&!t[20]&&!t[22]&&t[24]&&Gb(t);return{c(){e=nt("div"),f&&f.c(),i=Et(),Mt(n.$$.fragment),s=Et(),m&&m.c(),$(e,"bx--multi-select__wrapper",!0),$(e,"bx--list-box__wrapper",!0),$(e,"bx--multi-select__wrapper--inline",t[34]),$(e,"bx--list-box__wrapper--inline",t[34]),$(e,"bx--multi-select__wrapper--inline--invalid",t[34]&&t[20])},m(y,b){Se(y,e,b),f&&f.m(e,null),Ze(e,i),Ot(n,e,null),Ze(e,s),m&&m.m(e,null),t[67](e),l=!0,c||(r=ut(window,"click",t[52]),c=!0)},p(y,b){y[18]||y[38].titleText?f?(f.p(y,b),b[0]&262144|b[1]&128&&ae(f,1)):(f=Lb(y),f.c(),ae(f,1),f.m(e,i)):f&&(Ai(),pe(f,1,1,()=>{f=null}),Ei());const E={};b[0]&4096&&(E.disabled=y[12]),b[0]&1048576&&(E.invalid=y[20]),b[0]&2097152&&(E.invalidText=y[21]),b[0]&4&&(E.open=y[2]),b[0]&16384&&(E.light=y[14]),b[0]&1024&&(E.size=y[10]),b[0]&4194304&&(E.warn=y[22]),b[0]&8388608&&(E.warnText=y[23]),b[0]&1058816|b[1]&10&&(E.class="bx--multi-select "+(y[11]==="top"&&"bx--list-box--up")+" "+(y[13]&&"bx--combo-box")+`
      `+(y[13]&&"bx--multi-select--filterable")+`
      `+(y[20]&&"bx--multi-select--invalid")+`
      `+(y[34]&&"bx--multi-select--inline")+`
      `+(y[32].length>0&&"bx--multi-select--selected")),b[0]&2052846575|b[1]&279|b[2]&64&&(E.$$scope={dirty:b,ctx:y}),n.$set(E),!y[34]&&!y[20]&&!y[22]&&y[24]?m?m.p(y,b):(m=Gb(y),m.c(),m.m(e,null)):m&&(m.d(1),m=null),(!l||b[1]&8)&&$(e,"bx--multi-select__wrapper--inline",y[34]),(!l||b[1]&8)&&$(e,"bx--list-box__wrapper--inline",y[34]),(!l||b[0]&1048576|b[1]&8)&&$(e,"bx--multi-select__wrapper--inline--invalid",y[34]&&y[20])},i(y){l||(ae(f),ae(n.$$.fragment,y),l=!0)},o(y){pe(f),pe(n.$$.fragment,y),l=!1},d(y){y&&Te(e),f&&f.d(),Ct(n),m&&m.d(),t[67](null),c=!1,r()}}}function j3(t,e,i){let n,s,l,c,r,f,m;const y=["items","itemToString","itemToInput","selectedIds","value","size","type","direction","selectionFeedback","disabled","filterable","filterItem","open","light","locale","placeholder","sortItem","translateWithId","translateWithIdSelection","titleText","useTitleInItem","invalid","invalidText","warn","warnText","helperText","label","hideLabel","id","name","inputRef","multiSelectRef","fieldRef","selectionRef","highlightedId"];let b=Ut(e,y),{$$slots:E={},$$scope:S}=e;const D=hu(E);let{items:R=[]}=e,{itemToString:z=st=>st.text||st.id}=e,{itemToInput:H=st=>{}}=e,{selectedIds:K=[]}=e,{value:W=""}=e,{size:se=void 0}=e,{type:Y="default"}=e,{direction:ne="bottom"}=e,{selectionFeedback:ue="top-after-reopen"}=e,{disabled:ve=!1}=e,{filterable:_e=!1}=e,{filterItem:oe=(st,Q)=>st.text.toLowerCase().includes(Q.trim().toLowerCase())}=e,{open:Be=!1}=e,{light:mt=!1}=e,{locale:Le="en"}=e,{placeholder:rt=""}=e,{sortItem:tt=(st,Q)=>st.text.localeCompare(Q.text,Le,{numeric:!0})}=e,{translateWithId:We=void 0}=e,{translateWithIdSelection:Ve=void 0}=e,{titleText:St=""}=e,{useTitleInItem:zt=!1}=e,{invalid:mi=!1}=e,{invalidText:vt=""}=e,{warn:pt=!1}=e,{warnText:Pt=""}=e,{helperText:qe=""}=e,{label:Ht=""}=e,{hideLabel:lt=!1}=e,{id:Gt="ccs-"+Math.random().toString(36)}=e,{name:Mi=void 0}=e,{inputRef:bt=null}=e,{multiSelectRef:ze=null}=e,{fieldRef:$t=null}=e,{selectionRef:dt=null}=e,{highlightedId:_t=null}=e;const ni=co();let Wi=!1,ct=-1,et=[];uf("MultiSelect",{declareRef:({key:st,ref:Q})=>{switch(st){case"field":i(5,$t=Q);break;case"selection":i(6,dt=Q);break}}});function zi(st){let Q=ct+st;const ge=_e?m.length:R.length;if(ge===0)return;Q<0?Q=ge-1:Q>=ge&&(Q=0);let Z=R[Q].disabled;for(;Z;)Q=Q+st,Q<0?Q=R.length-1:Q>=R.length&&(Q=0),Z=R[Q].disabled;i(29,ct=Q)}function zn(){return[...r.length>1?r.sort(tt):r,...f.sort(tt)]}Rh(()=>{r.length!==et.length&&(ue==="top"&&i(30,c=zn()),et=r,i(0,K=r.map(({id:st})=>st)),ni("select",{selectedIds:K,selected:r,unselected:f})),Be||((!Wi||ue!=="fixed")&&(i(30,c=zn()),Wi=!0),i(29,ct=-1),i(1,W="")),i(40,R=c)});function Xe(st){At.call(this,t,st)}function On(st){At.call(this,t,st)}function Rt(st){At.call(this,t,st)}function Xi(st){At.call(this,t,st)}function Ui(st){At.call(this,t,st)}const Gn=({target:st})=>{Be&&ze&&!ze.contains(st)&&i(2,Be=!1)};function mr(st){At.call(this,t,st)}const vr=()=>{i(0,K=[]),i(30,c=c.map(st=>({...st,checked:!1}))),$t&&$t.blur()};function jr(st){sn[st?"unshift":"push"](()=>{bt=st,i(3,bt)})}function Cr(){W=this.value,i(1,W)}const lr=({key:st})=>{if(st==="Enter"){if(_t){const Q=c.findIndex(ge=>ge.id===_t);i(30,c=c.map((ge,Z)=>Z!==Q?ge:{...ge,checked:!ge.checked}))}}else st==="Tab"?(i(2,Be=!1),bt.blur()):st==="ArrowDown"?zi(1):st==="ArrowUp"?zi(-1):st==="Escape"?i(2,Be=!1):st===" "&&(Be||i(2,Be=!0))},Hn=()=>{i(1,W=""),i(2,Be=!1)},Nt=st=>{st.stopPropagation(),i(2,Be=!Be)},Qi=()=>{ve||(_e?(i(2,Be=!0),bt.focus()):i(2,Be=!Be))},Qe=st=>{if(_e)return;const Q=st.key;[" ","ArrowUp","ArrowDown"].includes(Q)&&st.preventDefault(),Q===" "?i(2,Be=!Be):Q==="Tab"?dt&&r.length>0?dt.focus():(i(2,Be=!1),$t.blur()):Q==="ArrowDown"?zi(1):Q==="ArrowUp"?zi(-1):Q==="Enter"?ct>-1&&i(30,c=c.map((ge,Z)=>Z!==ct?ge:{...ge,checked:!ge.checked})):Q==="Escape"&&i(2,Be=!1)},Ki=()=>{_e&&(i(2,Be=!0),bt&&bt.focus())},Gi=st=>{_e||ni("blur",st)},Lt=st=>{st===m.length-1&&i(2,Be=!1)},Bi=(st,Q)=>{if(st.disabled){Q.stopPropagation();return}i(30,c=c.map(ge=>ge.id===st.id?{...ge,checked:!ge.checked}:ge)),$t.focus()},ii=(st,Q)=>{st.disabled||i(29,ct=Q)};function Bn(st){sn[st?"unshift":"push"](()=>{ze=st,i(4,ze)})}return t.$$set=st=>{i(73,e=Ye(Ye({},e),fi(st))),i(39,b=Ut(e,y)),"items"in st&&i(40,R=st.items),"itemToString"in st&&i(8,z=st.itemToString),"itemToInput"in st&&i(9,H=st.itemToInput),"selectedIds"in st&&i(0,K=st.selectedIds),"value"in st&&i(1,W=st.value),"size"in st&&i(10,se=st.size),"type"in st&&i(41,Y=st.type),"direction"in st&&i(11,ne=st.direction),"selectionFeedback"in st&&i(42,ue=st.selectionFeedback),"disabled"in st&&i(12,ve=st.disabled),"filterable"in st&&i(13,_e=st.filterable),"filterItem"in st&&i(43,oe=st.filterItem),"open"in st&&i(2,Be=st.open),"light"in st&&i(14,mt=st.light),"locale"in st&&i(44,Le=st.locale),"placeholder"in st&&i(15,rt=st.placeholder),"sortItem"in st&&i(45,tt=st.sortItem),"translateWithId"in st&&i(16,We=st.translateWithId),"translateWithIdSelection"in st&&i(17,Ve=st.translateWithIdSelection),"titleText"in st&&i(18,St=st.titleText),"useTitleInItem"in st&&i(19,zt=st.useTitleInItem),"invalid"in st&&i(20,mi=st.invalid),"invalidText"in st&&i(21,vt=st.invalidText),"warn"in st&&i(22,pt=st.warn),"warnText"in st&&i(23,Pt=st.warnText),"helperText"in st&&i(24,qe=st.helperText),"label"in st&&i(25,Ht=st.label),"hideLabel"in st&&i(26,lt=st.hideLabel),"id"in st&&i(27,Gt=st.id),"name"in st&&i(28,Mi=st.name),"inputRef"in st&&i(3,bt=st.inputRef),"multiSelectRef"in st&&i(4,ze=st.multiSelectRef),"fieldRef"in st&&i(5,$t=st.fieldRef),"selectionRef"in st&&i(6,dt=st.selectionRef),"highlightedId"in st&&i(7,_t=st.highlightedId),"$$scope"in st&&i(68,S=st.$$scope)},t.$$.update=()=>{var st;t.$$.dirty[0]&134217728&&i(35,n=`menu-${Gt}`),t.$$.dirty[1]&1024&&i(34,s=Y==="inline"),i(33,l=e["aria-label"]||"Choose an item"),t.$$.dirty[0]&1|t.$$.dirty[1]&512&&i(30,c=R.map(Q=>({...Q,checked:K.includes(Q.id)}))),t.$$.dirty[0]&1073741824&&i(32,r=c.filter(({checked:Q})=>Q)),t.$$.dirty[0]&1073741824&&(f=c.filter(({checked:Q})=>!Q)),t.$$.dirty[0]&1073741826|t.$$.dirty[1]&4096&&i(31,m=c.filter(Q=>oe(Q,W))),t.$$.dirty[0]&1610620928|t.$$.dirty[1]&1&&i(7,_t=ct>-1?((st=(_e?m:c)[ct])==null?void 0:st.id)??null:null)},e=fi(e),[K,W,Be,bt,ze,$t,dt,_t,z,H,se,ne,ve,_e,mt,rt,We,Ve,St,zt,mi,vt,pt,Pt,qe,Ht,lt,Gt,Mi,ct,c,m,r,l,s,n,ni,zi,D,b,R,Y,ue,oe,Le,tt,E,Xe,On,Rt,Xi,Ui,Gn,mr,vr,jr,Cr,lr,Hn,Nt,Qi,Qe,Ki,Gi,Lt,Bi,ii,Bn,S]}class Hb extends Ri{constructor(e){super(),Di(this,e,j3,U3,Ci,{items:40,itemToString:8,itemToInput:9,selectedIds:0,value:1,size:10,type:41,direction:11,selectionFeedback:42,disabled:12,filterable:13,filterItem:43,open:2,light:14,locale:44,placeholder:15,sortItem:45,translateWithId:16,translateWithIdSelection:17,titleText:18,useTitleInItem:19,invalid:20,invalidText:21,warn:22,warnText:23,helperText:24,label:25,hideLabel:26,id:27,name:28,inputRef:3,multiSelectRef:4,fieldRef:5,selectionRef:6,highlightedId:7},null,[-1,-1,-1])}}function Kb(t,e,i){const n=t.slice();return n[55]=e[i],n}const G3=t=>({}),qb=t=>({}),H3=t=>({}),Zb=t=>({});function Wb(t){let e,i,n,s,l;return i=new Lh({props:{size:20,class:"bx--modal-close__icon","aria-hidden":"true"}}),{c(){e=nt("button"),Mt(i.$$.fragment),je(e,"type","button"),je(e,"aria-label",t[8]),$(e,"bx--modal-close",!0)},m(c,r){Se(c,e,r),Ot(i,e,null),t[37](e),n=!0,s||(l=ut(e,"click",t[38]),s=!0)},p(c,r){(!n||r[0]&256)&&je(e,"aria-label",c[8])},i(c){n||(ae(i.$$.fragment,c),n=!0)},o(c){pe(i.$$.fragment,c),n=!1},d(c){c&&Te(e),Ct(i),t[37](null),s=!1,l()}}}function Yb(t){let e,i;const n=t[31].label,s=$i(n,t,t[50],Zb),l=s||K3(t);return{c(){e=nt("h2"),l&&l.c(),je(e,"id",t[25]),$(e,"bx--modal-header__label",!0)},m(c,r){Se(c,e,r),l&&l.m(e,null),i=!0},p(c,r){s?s.p&&(!i||r[1]&524288)&&tn(s,n,c,c[50],i?en(n,c[50],r,H3):nn(c[50]),Zb):l&&l.p&&(!i||r[0]&128)&&l.p(c,i?r:[-1,-1]),(!i||r[0]&33554432)&&je(e,"id",c[25])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function K3(t){let e;return{c(){e=gi(t[7])},m(i,n){Se(i,e,n)},p(i,n){n[0]&128&&Si(e,i[7])},d(i){i&&Te(e)}}}function q3(t){let e;return{c(){e=gi(t[6])},m(i,n){Se(i,e,n)},p(i,n){n[0]&64&&Si(e,i[6])},d(i){i&&Te(e)}}}function Jb(t){let e,i,n,s,l;return i=new Lh({props:{size:20,class:"bx--modal-close__icon","aria-hidden":"true"}}),{c(){e=nt("button"),Mt(i.$$.fragment),je(e,"type","button"),je(e,"aria-label",t[8]),$(e,"bx--modal-close",!0)},m(c,r){Se(c,e,r),Ot(i,e,null),t[39](e),n=!0,s||(l=ut(e,"click",t[40]),s=!0)},p(c,r){(!n||r[0]&256)&&je(e,"aria-label",c[8])},i(c){n||(ae(i.$$.fragment,c),n=!0)},o(c){pe(i.$$.fragment,c),n=!1},d(c){c&&Te(e),Ct(i),t[39](null),s=!1,l()}}}function Xb(t){let e;return{c(){e=nt("div"),$(e,"bx--modal-content--overflow-indicator",!0)},m(i,n){Se(i,e,n)},d(i){i&&Te(e)}}}function Qb(t){let e,i,n,s,l,c;const r=[W3,Z3],f=[];function m(y,b){return y[16].length>0?0:y[15]?1:-1}return~(i=m(t))&&(n=f[i]=r[i](t)),l=new nu({props:{kind:t[3]?"danger":"primary",disabled:t[12],icon:t[13],$$slots:{default:[X3]},$$scope:{ctx:t}}}),l.$on("click",t[43]),{c(){e=nt("div"),n&&n.c(),s=Et(),Mt(l.$$.fragment),$(e,"bx--modal-footer",!0),$(e,"bx--modal-footer--three-button",t[16].length===2)},m(y,b){Se(y,e,b),~i&&f[i].m(e,null),Ze(e,s),Ot(l,e,null),c=!0},p(y,b){let E=i;i=m(y),i===E?~i&&f[i].p(y,b):(n&&(Ai(),pe(f[E],1,1,()=>{f[E]=null}),Ei()),~i?(n=f[i],n?n.p(y,b):(n=f[i]=r[i](y),n.c()),ae(n,1),n.m(e,s)):n=null);const S={};b[0]&8&&(S.kind=y[3]?"danger":"primary"),b[0]&4096&&(S.disabled=y[12]),b[0]&8192&&(S.icon=y[13]),b[0]&2048|b[1]&524288&&(S.$$scope={dirty:b,ctx:y}),l.$set(S),(!c||b[0]&65536)&&$(e,"bx--modal-footer--three-button",y[16].length===2)},i(y){c||(ae(n),ae(l.$$.fragment,y),c=!0)},o(y){pe(n),pe(l.$$.fragment,y),c=!1},d(y){y&&Te(e),~i&&f[i].d(),Ct(l)}}}function Z3(t){let e,i;return e=new nu({props:{kind:"secondary",$$slots:{default:[Y3]},$$scope:{ctx:t}}}),e.$on("click",t[42]),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s[0]&32768|s[1]&524288&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function W3(t){let e,i,n=Ks(t[16]),s=[];for(let c=0;c<n.length;c+=1)s[c]=$b(Kb(t,n,c));const l=c=>pe(s[c],1,1,()=>{s[c]=null});return{c(){for(let c=0;c<s.length;c+=1)s[c].c();e=Mn()},m(c,r){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(c,r);Se(c,e,r),i=!0},p(c,r){if(r[0]&67174400){n=Ks(c[16]);let f;for(f=0;f<n.length;f+=1){const m=Kb(c,n,f);s[f]?(s[f].p(m,r),ae(s[f],1)):(s[f]=$b(m),s[f].c(),ae(s[f],1),s[f].m(e.parentNode,e))}for(Ai(),f=n.length;f<s.length;f+=1)l(f);Ei()}},i(c){if(!i){for(let r=0;r<n.length;r+=1)ae(s[r]);i=!0}},o(c){s=s.filter(Boolean);for(let r=0;r<s.length;r+=1)pe(s[r]);i=!1},d(c){c&&Te(e),pO(s,c)}}}function Y3(t){let e;return{c(){e=gi(t[15])},m(i,n){Se(i,e,n)},p(i,n){n[0]&32768&&Si(e,i[15])},d(i){i&&Te(e)}}}function J3(t){let e=t[55].text+"",i,n;return{c(){i=gi(e),n=Et()},m(s,l){Se(s,i,l),Se(s,n,l)},p(s,l){l[0]&65536&&e!==(e=s[55].text+"")&&Si(i,e)},d(s){s&&(Te(i),Te(n))}}}function $b(t){let e,i;function n(){return t[41](t[55])}return e=new nu({props:{kind:"secondary",$$slots:{default:[J3]},$$scope:{ctx:t}}}),e.$on("click",n),{c(){Mt(e.$$.fragment)},m(s,l){Ot(e,s,l),i=!0},p(s,l){t=s;const c={};l[0]&65536|l[1]&524288&&(c.$$scope={dirty:l,ctx:t}),e.$set(c)},i(s){i||(ae(e.$$.fragment,s),i=!0)},o(s){pe(e.$$.fragment,s),i=!1},d(s){Ct(e,s)}}}function X3(t){let e;return{c(){e=gi(t[11])},m(i,n){Se(i,e,n)},p(i,n){n[0]&2048&&Si(e,i[11])},d(i){i&&Te(e)}}}function Q3(t){let e,i,n,s,l,c,r,f,m,y,b,E,S,D,R,z,H,K,W,se,Y=t[5]&&Wb(t),ne=t[7]&&Yb(t);const ue=t[31].heading,ve=$i(ue,t,t[50],qb),_e=ve||q3(t);let oe=!t[5]&&Jb(t);const Be=t[31].default,mt=$i(Be,t,t[50],null);let Le=t[10]&&Xb(),rt=!t[5]&&Qb(t),tt=[{role:"presentation"},{id:t[18]},t[28]],We={};for(let Ve=0;Ve<tt.length;Ve+=1)We=Ye(We,tt[Ve]);return{c(){e=nt("div"),i=nt("div"),n=nt("div"),Y&&Y.c(),s=Et(),ne&&ne.c(),l=Et(),c=nt("h3"),_e&&_e.c(),r=Et(),oe&&oe.c(),f=Et(),m=nt("div"),mt&&mt.c(),D=Et(),Le&&Le.c(),R=Et(),rt&&rt.c(),je(c,"id",t[24]),$(c,"bx--modal-header__heading",!0),$(n,"bx--modal-header",!0),je(m,"id",t[23]),je(m,"tabindex",y=t[10]?"0":void 0),je(m,"role",b=t[10]?"region":void 0),je(m,"aria-label",E=t[10]?t[22]:void 0),je(m,"aria-labelledby",S=t[7]?t[25]:t[24]),$(m,"bx--modal-content",!0),$(m,"bx--modal-content--with-form",t[9]),$(m,"bx--modal-scroll-content",t[10]),je(i,"tabindex","-1"),je(i,"role",z=t[4]?t[5]?"alert":"alertdialog":"dialog"),je(i,"aria-describedby",H=t[4]&&!t[5]?t[23]:void 0),je(i,"aria-modal","true"),je(i,"aria-label",t[22]),$(i,"bx--modal-container",!0),$(i,"bx--modal-container--xs",t[2]==="xs"),$(i,"bx--modal-container--sm",t[2]==="sm"),$(i,"bx--modal-container--lg",t[2]==="lg"),ui(e,We),$(e,"bx--modal",!0),$(e,"bx--modal-tall",!t[5]),$(e,"is-visible",t[0]),$(e,"bx--modal--danger",t[3])},m(Ve,St){Se(Ve,e,St),Ze(e,i),Ze(i,n),Y&&Y.m(n,null),Ze(n,s),ne&&ne.m(n,null),Ze(n,l),Ze(n,c),_e&&_e.m(c,null),Ze(n,r),oe&&oe.m(n,null),Ze(i,f),Ze(i,m),mt&&mt.m(m,null),Ze(i,D),Le&&Le.m(i,null),Ze(i,R),rt&&rt.m(i,null),t[44](i),t[46](e),K=!0,W||(se=[ut(i,"click",t[45]),ut(e,"keydown",t[32]),ut(e,"keydown",t[47]),ut(e,"click",t[33]),ut(e,"click",t[48]),ut(e,"mouseover",t[34]),ut(e,"mouseenter",t[35]),ut(e,"mouseleave",t[36]),ut(e,"transitionend",t[49])],W=!0)},p(Ve,St){Ve[5]?Y?(Y.p(Ve,St),St[0]&32&&ae(Y,1)):(Y=Wb(Ve),Y.c(),ae(Y,1),Y.m(n,s)):Y&&(Ai(),pe(Y,1,1,()=>{Y=null}),Ei()),Ve[7]?ne?(ne.p(Ve,St),St[0]&128&&ae(ne,1)):(ne=Yb(Ve),ne.c(),ae(ne,1),ne.m(n,l)):ne&&(Ai(),pe(ne,1,1,()=>{ne=null}),Ei()),ve?ve.p&&(!K||St[1]&524288)&&tn(ve,ue,Ve,Ve[50],K?en(ue,Ve[50],St,G3):nn(Ve[50]),qb):_e&&_e.p&&(!K||St[0]&64)&&_e.p(Ve,K?St:[-1,-1]),(!K||St[0]&16777216)&&je(c,"id",Ve[24]),Ve[5]?oe&&(Ai(),pe(oe,1,1,()=>{oe=null}),Ei()):oe?(oe.p(Ve,St),St[0]&32&&ae(oe,1)):(oe=Jb(Ve),oe.c(),ae(oe,1),oe.m(n,null)),mt&&mt.p&&(!K||St[1]&524288)&&tn(mt,Be,Ve,Ve[50],K?en(Be,Ve[50],St,null):nn(Ve[50]),null),(!K||St[0]&8388608)&&je(m,"id",Ve[23]),(!K||St[0]&1024&&y!==(y=Ve[10]?"0":void 0))&&je(m,"tabindex",y),(!K||St[0]&1024&&b!==(b=Ve[10]?"region":void 0))&&je(m,"role",b),(!K||St[0]&4195328&&E!==(E=Ve[10]?Ve[22]:void 0))&&je(m,"aria-label",E),(!K||St[0]&50331776&&S!==(S=Ve[7]?Ve[25]:Ve[24]))&&je(m,"aria-labelledby",S),(!K||St[0]&512)&&$(m,"bx--modal-content--with-form",Ve[9]),(!K||St[0]&1024)&&$(m,"bx--modal-scroll-content",Ve[10]),Ve[10]?Le||(Le=Xb(),Le.c(),Le.m(i,R)):Le&&(Le.d(1),Le=null),Ve[5]?rt&&(Ai(),pe(rt,1,1,()=>{rt=null}),Ei()):rt?(rt.p(Ve,St),St[0]&32&&ae(rt,1)):(rt=Qb(Ve),rt.c(),ae(rt,1),rt.m(i,null)),(!K||St[0]&48&&z!==(z=Ve[4]?Ve[5]?"alert":"alertdialog":"dialog"))&&je(i,"role",z),(!K||St[0]&8388656&&H!==(H=Ve[4]&&!Ve[5]?Ve[23]:void 0))&&je(i,"aria-describedby",H),(!K||St[0]&4194304)&&je(i,"aria-label",Ve[22]),(!K||St[0]&4)&&$(i,"bx--modal-container--xs",Ve[2]==="xs"),(!K||St[0]&4)&&$(i,"bx--modal-container--sm",Ve[2]==="sm"),(!K||St[0]&4)&&$(i,"bx--modal-container--lg",Ve[2]==="lg"),ui(e,We=Ni(tt,[{role:"presentation"},(!K||St[0]&262144)&&{id:Ve[18]},St[0]&268435456&&Ve[28]])),$(e,"bx--modal",!0),$(e,"bx--modal-tall",!Ve[5]),$(e,"is-visible",Ve[0]),$(e,"bx--modal--danger",Ve[3])},i(Ve){K||(ae(Y),ae(ne),ae(_e,Ve),ae(oe),ae(mt,Ve),ae(rt),K=!0)},o(Ve){pe(Y),pe(ne),pe(_e,Ve),pe(oe),pe(mt,Ve),pe(rt),K=!1},d(Ve){Ve&&Te(e),Y&&Y.d(),ne&&ne.d(),_e&&_e.d(Ve),oe&&oe.d(),mt&&mt.d(Ve),Le&&Le.d(),rt&&rt.d(),t[44](null),t[46](null),W=!1,vn(se)}}}function $3(t,e,i){let n,s,l,c;const r=["size","open","danger","alert","passiveModal","modalHeading","modalLabel","modalAriaLabel","iconDescription","hasForm","hasScrollingContent","primaryButtonText","primaryButtonDisabled","primaryButtonIcon","shouldSubmitOnEnter","secondaryButtonText","secondaryButtons","selectorPrimaryFocus","preventCloseOnClickOutside","id","ref"];let f=Ut(e,r),m,{$$slots:y={},$$scope:b}=e,{size:E=void 0}=e,{open:S=!1}=e,{danger:D=!1}=e,{alert:R=!1}=e,{passiveModal:z=!1}=e,{modalHeading:H=void 0}=e,{modalLabel:K=void 0}=e,{modalAriaLabel:W=void 0}=e,{iconDescription:se="Close the modal"}=e,{hasForm:Y=!1}=e,{hasScrollingContent:ne=!1}=e,{primaryButtonText:ue=""}=e,{primaryButtonDisabled:ve=!1}=e,{primaryButtonIcon:_e=void 0}=e,{shouldSubmitOnEnter:oe=!0}=e,{secondaryButtonText:Be=""}=e,{secondaryButtons:mt=[]}=e,{selectorPrimaryFocus:Le="[data-modal-primary-focus]"}=e,{preventCloseOnClickOutside:rt=!1}=e,{id:tt="ccs-"+Math.random().toString(36)}=e,{ref:We=null}=e;const Ve=co();let St=null,zt=null,mi=!1,vt=!1;function pt(Rt){((Rt||zt).querySelector(Le)||St).focus()}const Pt=Ur(S);Ln(t,Pt,Rt=>i(52,m=Rt)),DC(Pt),Rh(()=>{mi?S||(mi=!1,Ve("close")):S&&(mi=!0,pt(),Ve("open"))});function qe(Rt){At.call(this,t,Rt)}function Ht(Rt){At.call(this,t,Rt)}function lt(Rt){At.call(this,t,Rt)}function Gt(Rt){At.call(this,t,Rt)}function Mi(Rt){At.call(this,t,Rt)}function bt(Rt){sn[Rt?"unshift":"push"](()=>{St=Rt,i(19,St)})}const ze=()=>{i(0,S=!1)};function $t(Rt){sn[Rt?"unshift":"push"](()=>{St=Rt,i(19,St)})}const dt=()=>{i(0,S=!1)},_t=Rt=>{Ve("click:button--secondary",{text:Rt.text})},ni=()=>{Ve("click:button--secondary",{text:Be})},Wi=()=>{Ve("submit"),Ve("click:button--primary")};function ct(Rt){sn[Rt?"unshift":"push"](()=>{zt=Rt,i(20,zt)})}const et=()=>{i(21,vt=!0)};function zi(Rt){sn[Rt?"unshift":"push"](()=>{We=Rt,i(1,We)})}const zn=Rt=>{if(S)if(Rt.key==="Escape")i(0,S=!1);else if(Rt.key==="Tab"){const Ui=Array.from(We.querySelectorAll(`
  a[href], area[href], input:not([disabled]):not([tabindex='-1']),
  button:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),
  textarea:not([disabled]):not([tabindex='-1']),
  iframe, object, embed, *[tabindex]:not([tabindex='-1']):not([disabled]), *[contenteditable=true]
`));let Gn=Ui.indexOf(document.activeElement);Gn===-1&&Rt.shiftKey&&(Gn=0),Gn+=Ui.length+(Rt.shiftKey?-1:1),Gn%=Ui.length,Ui[Gn].focus(),Rt.preventDefault()}else oe&&Rt.key==="Enter"&&!ve&&(Ve("submit"),Ve("click:button--primary"))},Xe=()=>{!vt&&!rt&&i(0,S=!1),i(21,vt=!1)},On=Rt=>{Rt.propertyName==="transform"&&Ve("transitionend",{open:S})};return t.$$set=Rt=>{i(54,e=Ye(Ye({},e),fi(Rt))),i(28,f=Ut(e,r)),"size"in Rt&&i(2,E=Rt.size),"open"in Rt&&i(0,S=Rt.open),"danger"in Rt&&i(3,D=Rt.danger),"alert"in Rt&&i(4,R=Rt.alert),"passiveModal"in Rt&&i(5,z=Rt.passiveModal),"modalHeading"in Rt&&i(6,H=Rt.modalHeading),"modalLabel"in Rt&&i(7,K=Rt.modalLabel),"modalAriaLabel"in Rt&&i(29,W=Rt.modalAriaLabel),"iconDescription"in Rt&&i(8,se=Rt.iconDescription),"hasForm"in Rt&&i(9,Y=Rt.hasForm),"hasScrollingContent"in Rt&&i(10,ne=Rt.hasScrollingContent),"primaryButtonText"in Rt&&i(11,ue=Rt.primaryButtonText),"primaryButtonDisabled"in Rt&&i(12,ve=Rt.primaryButtonDisabled),"primaryButtonIcon"in Rt&&i(13,_e=Rt.primaryButtonIcon),"shouldSubmitOnEnter"in Rt&&i(14,oe=Rt.shouldSubmitOnEnter),"secondaryButtonText"in Rt&&i(15,Be=Rt.secondaryButtonText),"secondaryButtons"in Rt&&i(16,mt=Rt.secondaryButtons),"selectorPrimaryFocus"in Rt&&i(30,Le=Rt.selectorPrimaryFocus),"preventCloseOnClickOutside"in Rt&&i(17,rt=Rt.preventCloseOnClickOutside),"id"in Rt&&i(18,tt=Rt.id),"ref"in Rt&&i(1,We=Rt.ref),"$$scope"in Rt&&i(50,b=Rt.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&Lm(Pt,m=S,m),t.$$.dirty[0]&262144&&i(25,n=`bx--modal-header__label--modal-${tt}`),t.$$.dirty[0]&262144&&i(24,s=`bx--modal-header__heading--modal-${tt}`),t.$$.dirty[0]&262144&&i(23,l=`bx--modal-body--${tt}`),i(22,c=K||e["aria-label"]||W||H)},e=fi(e),[S,We,E,D,R,z,H,K,se,Y,ne,ue,ve,_e,oe,Be,mt,rt,tt,St,zt,vt,c,l,s,n,Ve,Pt,f,W,Le,y,qe,Ht,lt,Gt,Mi,bt,ze,$t,dt,_t,ni,Wi,ct,et,zi,zn,Xe,On,b]}class eD extends Ri{constructor(e){super(),Di(this,e,$3,Q3,Ci,{size:2,open:0,danger:3,alert:4,passiveModal:5,modalHeading:6,modalLabel:7,modalAriaLabel:29,iconDescription:8,hasForm:9,hasScrollingContent:10,primaryButtonText:11,primaryButtonDisabled:12,primaryButtonIcon:13,shouldSubmitOnEnter:14,secondaryButtonText:15,secondaryButtons:16,selectorPrimaryFocus:30,preventCloseOnClickOutside:17,id:18,ref:1},null,[-1,-1])}}function ex(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function tD(t){let e,i,n=t[1]&&ex(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M17 15L17 8 15 8 15 15 8 15 8 17 15 17 15 24 17 24 17 17 24 17 24 15z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=ex(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function iD(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class nD extends Ri{constructor(e){super(),Di(this,e,iD,tD,Ci,{size:0,title:1})}}function tx(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function rD(t){let e,i,n=t[1]&&tx(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M8 15H24V17H8z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=tx(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function sD(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class aD extends Ri{constructor(e){super(),Di(this,e,sD,rD,Ci,{size:0,title:1})}}function ix(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function oD(t){let e,i,n=t[1]&&ix(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M30 28.6L3.4 2 2 3.4l10.1 10.1L4 21.6V28h6.4l8.1-8.1L28.6 30 30 28.6zM9.6 26H6v-3.6l7.5-7.5 3.6 3.6L9.6 26zM29.4 6.2L29.4 6.2l-3.6-3.6c-.8-.8-2-.8-2.8 0l0 0 0 0-8 8 1.4 1.4L20 8.4l3.6 3.6L20 15.6l1.4 1.4 8-8C30.2 8.2 30.2 7 29.4 6.2L29.4 6.2zM25 10.6L21.4 7l3-3L28 7.6 25 10.6z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=ix(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function lD(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class cD extends Ri{constructor(e){super(),Di(this,e,lD,oD,Ci,{size:0,title:1})}}const uD=t=>({}),nx=t=>({});function rx(t){let e,i;const n=t[34].label,s=$i(n,t,t[33],nx),l=s||hD(t);return{c(){e=nt("label"),l&&l.c(),je(e,"for",t[18]),$(e,"bx--label",!0),$(e,"bx--label--disabled",t[8]),$(e,"bx--visually-hidden",t[17])},m(c,r){Se(c,e,r),l&&l.m(e,null),i=!0},p(c,r){s?s.p&&(!i||r[1]&4)&&tn(s,n,c,c[33],i?en(n,c[33],r,uD):nn(c[33]),nx):l&&l.p&&(!i||r[0]&65536)&&l.p(c,i?r:[-1,-1]),(!i||r[0]&262144)&&je(e,"for",c[18]),(!i||r[0]&256)&&$(e,"bx--label--disabled",c[8]),(!i||r[0]&131072)&&$(e,"bx--visually-hidden",c[17])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function hD(t){let e;return{c(){e=gi(t[16])},m(i,n){Se(i,e,n)},p(i,n){n[0]&65536&&Si(e,i[16])},d(i){i&&Te(e)}}}function dD(t){let e,i,n,s=t[11]&&sx(),l=!t[11]&&t[13]&&ax();return{c(){s&&s.c(),e=Et(),l&&l.c(),i=Mn()},m(c,r){s&&s.m(c,r),Se(c,e,r),l&&l.m(c,r),Se(c,i,r),n=!0},p(c,r){c[11]?s?r[0]&2048&&ae(s,1):(s=sx(),s.c(),ae(s,1),s.m(e.parentNode,e)):s&&(Ai(),pe(s,1,1,()=>{s=null}),Ei()),!c[11]&&c[13]?l?r[0]&10240&&ae(l,1):(l=ax(),l.c(),ae(l,1),l.m(i.parentNode,i)):l&&(Ai(),pe(l,1,1,()=>{l=null}),Ei())},i(c){n||(ae(s),ae(l),n=!0)},o(c){pe(s),pe(l),n=!1},d(c){c&&(Te(e),Te(i)),s&&s.d(c),l&&l.d(c)}}}function fD(t){let e,i;return e=new cD({props:{class:"bx--text-input__readonly-icon"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p:ki,i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function sx(t){let e,i;return e=new mu({props:{class:"bx--number__invalid"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function ax(t){let e,i;return e=new df({props:{class:"bx--number__invalid bx--number__invalid--warning"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function ox(t){let e,i,n,s,l,c,r,f,m,y,b,E,S,D,R,z,H;return n=new aD({props:{class:"down-icon"}}),y=new nD({props:{class:"up-icon"}}),{c(){e=nt("div"),i=nt("button"),Mt(n.$$.fragment),c=Et(),r=nt("div"),f=Et(),m=nt("button"),Mt(y.$$.fragment),S=Et(),D=nt("div"),je(i,"type","button"),je(i,"tabindex","-1"),je(i,"title",s=t[23]||t[10]),je(i,"aria-label",l=t[23]||t[10]),i.disabled=t[8],$(i,"bx--number__control-btn",!0),$(i,"down-icon",!0),$(r,"bx--number__rule-divider",!0),je(m,"type","button"),je(m,"tabindex","-1"),je(m,"title",b=t[24]||t[10]),je(m,"aria-label",E=t[24]||t[10]),m.disabled=t[8],$(m,"bx--number__control-btn",!0),$(m,"up-icon",!0),$(D,"bx--number__rule-divider",!0),$(e,"bx--number__controls",!0)},m(K,W){Se(K,e,W),Ze(e,i),Ot(n,i,null),Ze(e,c),Ze(e,r),Ze(e,f),Ze(e,m),Ot(y,m,null),Ze(e,S),Ze(e,D),R=!0,z||(H=[ut(i,"click",t[45]),ut(m,"click",t[46])],z=!0)},p(K,W){(!R||W[0]&8389632&&s!==(s=K[23]||K[10]))&&je(i,"title",s),(!R||W[0]&8389632&&l!==(l=K[23]||K[10]))&&je(i,"aria-label",l),(!R||W[0]&256)&&(i.disabled=K[8]),(!R||W[0]&16778240&&b!==(b=K[24]||K[10]))&&je(m,"title",b),(!R||W[0]&16778240&&E!==(E=K[24]||K[10]))&&je(m,"aria-label",E),(!R||W[0]&256)&&(m.disabled=K[8])},i(K){R||(ae(n.$$.fragment,K),ae(y.$$.fragment,K),R=!0)},o(K){pe(n.$$.fragment,K),pe(y.$$.fragment,K),R=!1},d(K){K&&Te(e),Ct(n),Ct(y),z=!1,vn(H)}}}function lx(t){let e,i;return{c(){e=nt("div"),i=gi(t[15]),$(e,"bx--form__helper-text",!0),$(e,"bx--form__helper-text--disabled",t[8])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&32768&&Si(i,n[15]),s[0]&256&&$(e,"bx--form__helper-text--disabled",n[8])},d(n){n&&Te(e)}}}function cx(t){let e,i;return{c(){e=nt("div"),i=gi(t[12]),je(e,"id",t[21]),$(e,"bx--form-requirement",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&4096&&Si(i,n[12]),s[0]&2097152&&je(e,"id",n[21])},d(n){n&&Te(e)}}}function ux(t){let e,i;return{c(){e=nt("div"),i=gi(t[14]),je(e,"id",t[21]),$(e,"bx--form-requirement",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&16384&&Si(i,n[14]),s[0]&2097152&&je(e,"id",n[21])},d(n){n&&Te(e)}}}function mD(t){let e,i,n,s,l,c,r,f,m,y,b,E,S,D,R,z,H,K,W,se,Y=(t[28].label||t[16])&&rx(t),ne=[{type:"number"},{pattern:"[0-9]*"},{"aria-describedby":t[21]},{"data-invalid":c=t[22]||void 0},{"aria-invalid":r=t[22]||void 0},{"aria-label":f=t[16]?void 0:t[20]},{disabled:t[8]},{id:t[18]},{name:t[19]},{max:t[4]},{min:t[5]},{step:t[3]},{value:m=t[0]??""},{readOnly:t[7]},t[29]],ue={};for(let tt=0;tt<ne.length;tt+=1)ue=Ye(ue,ne[tt]);const ve=[fD,dD],_e=[];function oe(tt,We){return tt[7]?0:1}b=oe(t),E=_e[b]=ve[b](t);let Be=!t[9]&&ox(t),mt=!t[22]&&!t[13]&&t[15]&&lx(t),Le=t[22]&&cx(t),rt=!t[22]&&t[13]&&ux(t);return{c(){e=nt("div"),i=nt("div"),Y&&Y.c(),n=Et(),s=nt("div"),l=nt("input"),y=Et(),E.c(),S=Et(),Be&&Be.c(),D=Et(),mt&&mt.c(),R=Et(),Le&&Le.c(),z=Et(),rt&&rt.c(),ui(l,ue),$(s,"bx--number__input-wrapper",!0),$(s,"bx--number__input-wrapper--warning",!t[11]&&t[13]),je(i,"data-invalid",H=t[22]||void 0),$(i,"bx--number",!0),$(i,"bx--number--helpertext",!0),$(i,"bx--number--readonly",t[7]),$(i,"bx--number--light",t[6]),$(i,"bx--number--nolabel",t[17]),$(i,"bx--number--nosteppers",t[9]),$(i,"bx--number--sm",t[2]==="sm"),$(i,"bx--number--xl",t[2]==="xl"),$(e,"bx--form-item",!0)},m(tt,We){Se(tt,e,We),Ze(e,i),Y&&Y.m(i,null),Ze(i,n),Ze(i,s),Ze(s,l),l.autofocus&&l.focus(),t[44](l),Ze(s,y),_e[b].m(s,null),Ze(s,S),Be&&Be.m(s,null),Ze(i,D),mt&&mt.m(i,null),Ze(i,R),Le&&Le.m(i,null),Ze(i,z),rt&&rt.m(i,null),K=!0,W||(se=[ut(l,"change",t[27]),ut(l,"input",t[26]),ut(l,"keydown",t[39]),ut(l,"keyup",t[40]),ut(l,"focus",t[41]),ut(l,"blur",t[42]),ut(l,"paste",t[43]),ut(e,"click",t[35]),ut(e,"mouseover",t[36]),ut(e,"mouseenter",t[37]),ut(e,"mouseleave",t[38])],W=!0)},p(tt,We){tt[28].label||tt[16]?Y?(Y.p(tt,We),We[0]&268500992&&ae(Y,1)):(Y=rx(tt),Y.c(),ae(Y,1),Y.m(i,n)):Y&&(Ai(),pe(Y,1,1,()=>{Y=null}),Ei()),ui(l,ue=Ni(ne,[{type:"number"},{pattern:"[0-9]*"},(!K||We[0]&2097152)&&{"aria-describedby":tt[21]},(!K||We[0]&4194304&&c!==(c=tt[22]||void 0))&&{"data-invalid":c},(!K||We[0]&4194304&&r!==(r=tt[22]||void 0))&&{"aria-invalid":r},(!K||We[0]&1114112&&f!==(f=tt[16]?void 0:tt[20]))&&{"aria-label":f},(!K||We[0]&256)&&{disabled:tt[8]},(!K||We[0]&262144)&&{id:tt[18]},(!K||We[0]&524288)&&{name:tt[19]},(!K||We[0]&16)&&{max:tt[4]},(!K||We[0]&32)&&{min:tt[5]},(!K||We[0]&8)&&{step:tt[3]},(!K||We[0]&1&&m!==(m=tt[0]??"")&&l.value!==m)&&{value:m},(!K||We[0]&128)&&{readOnly:tt[7]},We[0]&536870912&&tt[29]]));let Ve=b;b=oe(tt),b===Ve?_e[b].p(tt,We):(Ai(),pe(_e[Ve],1,1,()=>{_e[Ve]=null}),Ei(),E=_e[b],E?E.p(tt,We):(E=_e[b]=ve[b](tt),E.c()),ae(E,1),E.m(s,S)),tt[9]?Be&&(Ai(),pe(Be,1,1,()=>{Be=null}),Ei()):Be?(Be.p(tt,We),We[0]&512&&ae(Be,1)):(Be=ox(tt),Be.c(),ae(Be,1),Be.m(s,null)),(!K||We[0]&10240)&&$(s,"bx--number__input-wrapper--warning",!tt[11]&&tt[13]),!tt[22]&&!tt[13]&&tt[15]?mt?mt.p(tt,We):(mt=lx(tt),mt.c(),mt.m(i,R)):mt&&(mt.d(1),mt=null),tt[22]?Le?Le.p(tt,We):(Le=cx(tt),Le.c(),Le.m(i,z)):Le&&(Le.d(1),Le=null),!tt[22]&&tt[13]?rt?rt.p(tt,We):(rt=ux(tt),rt.c(),rt.m(i,null)):rt&&(rt.d(1),rt=null),(!K||We[0]&4194304&&H!==(H=tt[22]||void 0))&&je(i,"data-invalid",H),(!K||We[0]&128)&&$(i,"bx--number--readonly",tt[7]),(!K||We[0]&64)&&$(i,"bx--number--light",tt[6]),(!K||We[0]&131072)&&$(i,"bx--number--nolabel",tt[17]),(!K||We[0]&512)&&$(i,"bx--number--nosteppers",tt[9]),(!K||We[0]&4)&&$(i,"bx--number--sm",tt[2]==="sm"),(!K||We[0]&4)&&$(i,"bx--number--xl",tt[2]==="xl")},i(tt){K||(ae(Y),ae(E),ae(Be),K=!0)},o(tt){pe(Y),pe(E),pe(Be),K=!1},d(tt){tt&&Te(e),Y&&Y.d(),t[44](null),_e[b].d(),Be&&Be.d(),mt&&mt.d(),Le&&Le.d(),rt&&rt.d(),W=!1,vn(se)}}}function hx(t){return t!=""?Number(t):null}function pD(t,e,i){let n,s,l,c,r;const f=["size","value","step","max","min","light","readonly","allowEmpty","disabled","hideSteppers","iconDescription","invalid","invalidText","warn","warnText","helperText","label","hideLabel","translateWithId","translationIds","id","name","ref"];let m=Ut(e,f),{$$slots:y={},$$scope:b}=e;const E=hu(y);let{size:S=void 0}=e,{value:D=null}=e,{step:R=1}=e,{max:z=void 0}=e,{min:H=void 0}=e,{light:K=!1}=e,{readonly:W=!1}=e,{allowEmpty:se=!1}=e,{disabled:Y=!1}=e,{hideSteppers:ne=!1}=e,{iconDescription:ue=""}=e,{invalid:ve=!1}=e,{invalidText:_e=""}=e,{warn:oe=!1}=e,{warnText:Be=""}=e,{helperText:mt=""}=e,{label:Le=""}=e,{hideLabel:rt=!1}=e,{translateWithId:tt=et=>mi[et]}=e;const We={increment:"increment",decrement:"decrement"};let{id:Ve="ccs-"+Math.random().toString(36)}=e,{name:St=void 0}=e,{ref:zt=null}=e;const mi={[We.increment]:"Increment number",[We.decrement]:"Decrement number"},vt=co();function pt(et){et?zt.stepUp():zt.stepDown(),i(0,D=+zt.value),vt("input",D),vt("change",D)}function Pt({target:et}){i(0,D=hx(et.value)),vt("input",D)}function qe({target:et}){vt("change",hx(et.value))}function Ht(et){At.call(this,t,et)}function lt(et){At.call(this,t,et)}function Gt(et){At.call(this,t,et)}function Mi(et){At.call(this,t,et)}function bt(et){At.call(this,t,et)}function ze(et){At.call(this,t,et)}function $t(et){At.call(this,t,et)}function dt(et){At.call(this,t,et)}function _t(et){At.call(this,t,et)}function ni(et){sn[et?"unshift":"push"](()=>{zt=et,i(1,zt)})}const Wi=()=>{pt(!1)},ct=()=>{pt(!0)};return t.$$set=et=>{i(49,e=Ye(Ye({},e),fi(et))),i(29,m=Ut(e,f)),"size"in et&&i(2,S=et.size),"value"in et&&i(0,D=et.value),"step"in et&&i(3,R=et.step),"max"in et&&i(4,z=et.max),"min"in et&&i(5,H=et.min),"light"in et&&i(6,K=et.light),"readonly"in et&&i(7,W=et.readonly),"allowEmpty"in et&&i(30,se=et.allowEmpty),"disabled"in et&&i(8,Y=et.disabled),"hideSteppers"in et&&i(9,ne=et.hideSteppers),"iconDescription"in et&&i(10,ue=et.iconDescription),"invalid"in et&&i(11,ve=et.invalid),"invalidText"in et&&i(12,_e=et.invalidText),"warn"in et&&i(13,oe=et.warn),"warnText"in et&&i(14,Be=et.warnText),"helperText"in et&&i(15,mt=et.helperText),"label"in et&&i(16,Le=et.label),"hideLabel"in et&&i(17,rt=et.hideLabel),"translateWithId"in et&&i(31,tt=et.translateWithId),"id"in et&&i(18,Ve=et.id),"name"in et&&i(19,St=et.name),"ref"in et&&i(1,zt=et.ref),"$$scope"in et&&i(33,b=et.$$scope)},t.$$.update=()=>{t.$$.dirty[1]&1&&i(24,n=tt("increment")),t.$$.dirty[1]&1&&i(23,s=tt("decrement")),t.$$.dirty[0]&1073744049&&i(22,l=ve&&!W||!se&&D==null||D>z||typeof D=="number"&&D<H),t.$$.dirty[0]&262144&&i(21,c=`error-${Ve}`),i(20,r=e["aria-label"]||"Numeric input field with increment and decrement buttons")},e=fi(e),[D,zt,S,R,z,H,K,W,Y,ne,ue,ve,_e,oe,Be,mt,Le,rt,Ve,St,r,c,l,s,n,pt,Pt,qe,E,m,se,tt,We,b,y,Ht,lt,Gt,Mi,bt,ze,$t,dt,_t,ni,Wi,ct]}class Gu extends Ri{constructor(e){super(),Di(this,e,pD,mD,Ci,{size:2,value:0,step:3,max:4,min:5,light:6,readonly:7,allowEmpty:30,disabled:8,hideSteppers:9,iconDescription:10,invalid:11,invalidText:12,warn:13,warnText:14,helperText:15,label:16,hideLabel:17,translateWithId:31,translationIds:32,id:18,name:19,ref:1},null,[-1,-1])}get translationIds(){return this.$$.ctx[32]}}function dx(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function gD(t){let e,i,n=t[1]&&dx(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M20 24L10 16 20 8z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=dx(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function _D(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class yD extends Ri{constructor(e){super(),Di(this,e,_D,gD,Ci,{size:0,title:1})}}const vD=yD,bD=t=>({}),fx=t=>({});function mx(t){let e,i;const n=t[26].labelText,s=$i(n,t,t[25],fx),l=s||xD(t);return{c(){e=nt("label"),l&&l.c(),je(e,"for",t[5]),$(e,"bx--label",!0),$(e,"bx--visually-hidden",t[14]),$(e,"bx--label--disabled",t[4])},m(c,r){Se(c,e,r),l&&l.m(e,null),i=!0},p(c,r){s?s.p&&(!i||r[0]&33554432)&&tn(s,n,c,c[25],i?en(n,c[25],r,bD):nn(c[25]),fx):l&&l.p&&(!i||r[0]&8192)&&l.p(c,i?r:[-1,-1]),(!i||r[0]&32)&&je(e,"for",c[5]),(!i||r[0]&16384)&&$(e,"bx--visually-hidden",c[14]),(!i||r[0]&16)&&$(e,"bx--label--disabled",c[4])},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function xD(t){let e;return{c(){e=gi(t[13])},m(i,n){Se(i,e,n)},p(i,n){n[0]&8192&&Si(e,i[13])},d(i){i&&Te(e)}}}function px(t){let e,i,n,s,l,c,r,f,m,y,b,E,S,D,R,z,H;const K=t[26].default,W=$i(K,t,t[25],null);m=new C0({props:{class:"bx--select__arrow"}});let se=t[7]&&gx(),Y=t[7]&&_x(t),ne=!t[7]&&!t[9]&&t[11]&&yx(t);return{c(){e=nt("div"),i=nt("div"),n=nt("select"),W&&W.c(),f=Et(),Mt(m.$$.fragment),y=Et(),se&&se.c(),E=Et(),Y&&Y.c(),S=Et(),ne&&ne.c(),D=Mn(),je(n,"aria-describedby",s=t[7]?t[16]:void 0),je(n,"aria-invalid",l=t[7]||void 0),n.disabled=c=t[4]||void 0,n.required=r=t[15]||void 0,je(n,"id",t[5]),je(n,"name",t[6]),$(n,"bx--select-input",!0),$(n,"bx--select-input--sm",t[1]==="sm"),$(n,"bx--select-input--xl",t[1]==="xl"),je(i,"data-invalid",b=t[7]||void 0),$(i,"bx--select-input__wrapper",!0),$(e,"bx--select-input--inline__wrapper",!0)},m(ue,ve){Se(ue,e,ve),Ze(e,i),Ze(i,n),W&&W.m(n,null),t[35](n),Ze(i,f),Ot(m,i,null),Ze(i,y),se&&se.m(i,null),Ze(e,E),Y&&Y.m(e,null),Se(ue,S,ve),ne&&ne.m(ue,ve),Se(ue,D,ve),R=!0,z||(H=[ut(n,"change",t[21]),ut(n,"change",t[31]),ut(n,"input",t[32]),ut(n,"focus",t[33]),ut(n,"blur",t[34])],z=!0)},p(ue,ve){W&&W.p&&(!R||ve[0]&33554432)&&tn(W,K,ue,ue[25],R?en(K,ue[25],ve,null):nn(ue[25]),null),(!R||ve[0]&65664&&s!==(s=ue[7]?ue[16]:void 0))&&je(n,"aria-describedby",s),(!R||ve[0]&128&&l!==(l=ue[7]||void 0))&&je(n,"aria-invalid",l),(!R||ve[0]&16&&c!==(c=ue[4]||void 0))&&(n.disabled=c),(!R||ve[0]&32768&&r!==(r=ue[15]||void 0))&&(n.required=r),(!R||ve[0]&32)&&je(n,"id",ue[5]),(!R||ve[0]&64)&&je(n,"name",ue[6]),(!R||ve[0]&2)&&$(n,"bx--select-input--sm",ue[1]==="sm"),(!R||ve[0]&2)&&$(n,"bx--select-input--xl",ue[1]==="xl"),ue[7]?se?ve[0]&128&&ae(se,1):(se=gx(),se.c(),ae(se,1),se.m(i,null)):se&&(Ai(),pe(se,1,1,()=>{se=null}),Ei()),(!R||ve[0]&128&&b!==(b=ue[7]||void 0))&&je(i,"data-invalid",b),ue[7]?Y?Y.p(ue,ve):(Y=_x(ue),Y.c(),Y.m(e,null)):Y&&(Y.d(1),Y=null),!ue[7]&&!ue[9]&&ue[11]?ne?ne.p(ue,ve):(ne=yx(ue),ne.c(),ne.m(D.parentNode,D)):ne&&(ne.d(1),ne=null)},i(ue){R||(ae(W,ue),ae(m.$$.fragment,ue),ae(se),R=!0)},o(ue){pe(W,ue),pe(m.$$.fragment,ue),pe(se),R=!1},d(ue){ue&&(Te(e),Te(S),Te(D)),W&&W.d(ue),t[35](null),Ct(m),se&&se.d(),Y&&Y.d(),ne&&ne.d(ue),z=!1,vn(H)}}}function gx(t){let e,i;return e=new mu({props:{class:"bx--select__invalid-icon"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function _x(t){let e,i;return{c(){e=nt("div"),i=gi(t[8]),je(e,"id",t[16]),$(e,"bx--form-requirement",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&256&&Si(i,n[8]),s[0]&65536&&je(e,"id",n[16])},d(n){n&&Te(e)}}}function yx(t){let e,i;return{c(){e=nt("div"),i=gi(t[11]),$(e,"bx--form__helper-text",!0),$(e,"bx--form__helper-text--disabled",t[4])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&2048&&Si(i,n[11]),s[0]&16&&$(e,"bx--form__helper-text--disabled",n[4])},d(n){n&&Te(e)}}}function vx(t){let e,i,n,s,l,c,r,f,m,y,b,E,S,D,R,z,H,K;const W=t[26].default,se=$i(W,t,t[25],null);f=new C0({props:{class:"bx--select__arrow"}});let Y=t[7]&&bx(),ne=!t[7]&&t[9]&&xx(),ue=!t[7]&&t[11]&&wx(t),ve=t[7]&&Ax(t),_e=!t[7]&&t[9]&&Ex(t);return{c(){e=nt("div"),i=nt("select"),se&&se.c(),r=Et(),Mt(f.$$.fragment),m=Et(),Y&&Y.c(),y=Et(),ne&&ne.c(),E=Et(),ue&&ue.c(),S=Et(),ve&&ve.c(),D=Et(),_e&&_e.c(),R=Mn(),je(i,"id",t[5]),je(i,"name",t[6]),je(i,"aria-describedby",n=t[7]?t[16]:void 0),i.disabled=s=t[4]||void 0,i.required=l=t[15]||void 0,je(i,"aria-invalid",c=t[7]||void 0),$(i,"bx--select-input",!0),$(i,"bx--select-input--sm",t[1]==="sm"),$(i,"bx--select-input--xl",t[1]==="xl"),je(e,"data-invalid",b=t[7]||void 0),$(e,"bx--select-input__wrapper",!0)},m(oe,Be){Se(oe,e,Be),Ze(e,i),se&&se.m(i,null),t[36](i),Ze(e,r),Ot(f,e,null),Ze(e,m),Y&&Y.m(e,null),Ze(e,y),ne&&ne.m(e,null),Se(oe,E,Be),ue&&ue.m(oe,Be),Se(oe,S,Be),ve&&ve.m(oe,Be),Se(oe,D,Be),_e&&_e.m(oe,Be),Se(oe,R,Be),z=!0,H||(K=[ut(i,"change",t[21]),ut(i,"change",t[27]),ut(i,"input",t[28]),ut(i,"focus",t[29]),ut(i,"blur",t[30])],H=!0)},p(oe,Be){se&&se.p&&(!z||Be[0]&33554432)&&tn(se,W,oe,oe[25],z?en(W,oe[25],Be,null):nn(oe[25]),null),(!z||Be[0]&32)&&je(i,"id",oe[5]),(!z||Be[0]&64)&&je(i,"name",oe[6]),(!z||Be[0]&65664&&n!==(n=oe[7]?oe[16]:void 0))&&je(i,"aria-describedby",n),(!z||Be[0]&16&&s!==(s=oe[4]||void 0))&&(i.disabled=s),(!z||Be[0]&32768&&l!==(l=oe[15]||void 0))&&(i.required=l),(!z||Be[0]&128&&c!==(c=oe[7]||void 0))&&je(i,"aria-invalid",c),(!z||Be[0]&2)&&$(i,"bx--select-input--sm",oe[1]==="sm"),(!z||Be[0]&2)&&$(i,"bx--select-input--xl",oe[1]==="xl"),oe[7]?Y?Be[0]&128&&ae(Y,1):(Y=bx(),Y.c(),ae(Y,1),Y.m(e,y)):Y&&(Ai(),pe(Y,1,1,()=>{Y=null}),Ei()),!oe[7]&&oe[9]?ne?Be[0]&640&&ae(ne,1):(ne=xx(),ne.c(),ae(ne,1),ne.m(e,null)):ne&&(Ai(),pe(ne,1,1,()=>{ne=null}),Ei()),(!z||Be[0]&128&&b!==(b=oe[7]||void 0))&&je(e,"data-invalid",b),!oe[7]&&oe[11]?ue?ue.p(oe,Be):(ue=wx(oe),ue.c(),ue.m(S.parentNode,S)):ue&&(ue.d(1),ue=null),oe[7]?ve?ve.p(oe,Be):(ve=Ax(oe),ve.c(),ve.m(D.parentNode,D)):ve&&(ve.d(1),ve=null),!oe[7]&&oe[9]?_e?_e.p(oe,Be):(_e=Ex(oe),_e.c(),_e.m(R.parentNode,R)):_e&&(_e.d(1),_e=null)},i(oe){z||(ae(se,oe),ae(f.$$.fragment,oe),ae(Y),ae(ne),z=!0)},o(oe){pe(se,oe),pe(f.$$.fragment,oe),pe(Y),pe(ne),z=!1},d(oe){oe&&(Te(e),Te(E),Te(S),Te(D),Te(R)),se&&se.d(oe),t[36](null),Ct(f),Y&&Y.d(),ne&&ne.d(),ue&&ue.d(oe),ve&&ve.d(oe),_e&&_e.d(oe),H=!1,vn(K)}}}function bx(t){let e,i;return e=new mu({props:{class:"bx--select__invalid-icon"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function xx(t){let e,i;return e=new df({props:{class:"bx--select__invalid-icon bx--select__invalid-icon--warning"}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function wx(t){let e,i;return{c(){e=nt("div"),i=gi(t[11]),$(e,"bx--form__helper-text",!0),$(e,"bx--form__helper-text--disabled",t[4])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&2048&&Si(i,n[11]),s[0]&16&&$(e,"bx--form__helper-text--disabled",n[4])},d(n){n&&Te(e)}}}function Ax(t){let e,i;return{c(){e=nt("div"),i=gi(t[8]),je(e,"id",t[16]),$(e,"bx--form-requirement",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&256&&Si(i,n[8]),s[0]&65536&&je(e,"id",n[16])},d(n){n&&Te(e)}}}function Ex(t){let e,i;return{c(){e=nt("div"),i=gi(t[10]),je(e,"id",t[16]),$(e,"bx--form-requirement",!0)},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s[0]&1024&&Si(i,n[10]),s[0]&65536&&je(e,"id",n[16])},d(n){n&&Te(e)}}}function wD(t){let e,i,n,s,l,c=!t[12]&&mx(t),r=t[2]&&px(t),f=!t[2]&&vx(t),m=[t[22]],y={};for(let b=0;b<m.length;b+=1)y=Ye(y,m[b]);return{c(){e=nt("div"),i=nt("div"),c&&c.c(),n=Et(),r&&r.c(),s=Et(),f&&f.c(),$(i,"bx--select",!0),$(i,"bx--select--inline",t[2]),$(i,"bx--select--light",t[3]),$(i,"bx--select--invalid",t[7]),$(i,"bx--select--disabled",t[4]),$(i,"bx--select--warning",t[9]),ui(e,y),$(e,"bx--form-item",!0)},m(b,E){Se(b,e,E),Ze(e,i),c&&c.m(i,null),Ze(i,n),r&&r.m(i,null),Ze(i,s),f&&f.m(i,null),l=!0},p(b,E){b[12]?c&&(Ai(),pe(c,1,1,()=>{c=null}),Ei()):c?(c.p(b,E),E[0]&4096&&ae(c,1)):(c=mx(b),c.c(),ae(c,1),c.m(i,n)),b[2]?r?(r.p(b,E),E[0]&4&&ae(r,1)):(r=px(b),r.c(),ae(r,1),r.m(i,s)):r&&(Ai(),pe(r,1,1,()=>{r=null}),Ei()),b[2]?f&&(Ai(),pe(f,1,1,()=>{f=null}),Ei()):f?(f.p(b,E),E[0]&4&&ae(f,1)):(f=vx(b),f.c(),ae(f,1),f.m(i,null)),(!l||E[0]&4)&&$(i,"bx--select--inline",b[2]),(!l||E[0]&8)&&$(i,"bx--select--light",b[3]),(!l||E[0]&128)&&$(i,"bx--select--invalid",b[7]),(!l||E[0]&16)&&$(i,"bx--select--disabled",b[4]),(!l||E[0]&512)&&$(i,"bx--select--warning",b[9]),ui(e,y=Ni(m,[E[0]&4194304&&b[22]])),$(e,"bx--form-item",!0)},i(b){l||(ae(c),ae(r),ae(f),l=!0)},o(b){pe(c),pe(r),pe(f),l=!1},d(b){b&&Te(e),c&&c.d(),r&&r.d(),f&&f.d()}}}function AD(t,e,i){let n;const s=["selected","size","inline","light","disabled","id","name","invalid","invalidText","warn","warnText","helperText","noLabel","labelText","hideLabel","ref","required"];let l=Ut(e,s),c,r,f,m,{$$slots:y={},$$scope:b}=e,{selected:E=void 0}=e,{size:S=void 0}=e,{inline:D=!1}=e,{light:R=!1}=e,{disabled:z=!1}=e,{id:H="ccs-"+Math.random().toString(36)}=e,{name:K=void 0}=e,{invalid:W=!1}=e,{invalidText:se=""}=e,{warn:Y=!1}=e,{warnText:ne=""}=e,{helperText:ue=""}=e,{noLabel:ve=!1}=e,{labelText:_e=""}=e,{hideLabel:oe=!1}=e,{ref:Be=null}=e,{required:mt=!1}=e;const Le=co(),rt=Ur(E);Ln(t,rt,ze=>i(38,r=ze));const tt=Ur(null);Ln(t,tt,ze=>i(40,m=ze));const We=Ur(null);Ln(t,We,ze=>i(24,c=ze));const Ve=Ur({});Ln(t,Ve,ze=>i(39,f=ze)),uf("Select",{selectedValue:rt,setDefaultValue:(ze,$t)=>{c===null?(tt.set(ze),We.set($t)):m===ze&&rt.set($t),Ve.update(dt=>({...dt,[$t]:typeof $t}))}});const St=({target:ze})=>{let $t=ze.value;f[$t]==="number"&&($t=Number($t)),rt.set($t)};let zt;Rh(()=>{i(23,E=r),zt!==void 0&&E!==zt&&Le("update",r),zt=E});function mi(ze){At.call(this,t,ze)}function vt(ze){At.call(this,t,ze)}function pt(ze){At.call(this,t,ze)}function Pt(ze){At.call(this,t,ze)}function qe(ze){At.call(this,t,ze)}function Ht(ze){At.call(this,t,ze)}function lt(ze){At.call(this,t,ze)}function Gt(ze){At.call(this,t,ze)}function Mi(ze){sn[ze?"unshift":"push"](()=>{Be=ze,i(0,Be)})}function bt(ze){sn[ze?"unshift":"push"](()=>{Be=ze,i(0,Be)})}return t.$$set=ze=>{e=Ye(Ye({},e),fi(ze)),i(22,l=Ut(e,s)),"selected"in ze&&i(23,E=ze.selected),"size"in ze&&i(1,S=ze.size),"inline"in ze&&i(2,D=ze.inline),"light"in ze&&i(3,R=ze.light),"disabled"in ze&&i(4,z=ze.disabled),"id"in ze&&i(5,H=ze.id),"name"in ze&&i(6,K=ze.name),"invalid"in ze&&i(7,W=ze.invalid),"invalidText"in ze&&i(8,se=ze.invalidText),"warn"in ze&&i(9,Y=ze.warn),"warnText"in ze&&i(10,ne=ze.warnText),"helperText"in ze&&i(11,ue=ze.helperText),"noLabel"in ze&&i(12,ve=ze.noLabel),"labelText"in ze&&i(13,_e=ze.labelText),"hideLabel"in ze&&i(14,oe=ze.hideLabel),"ref"in ze&&i(0,Be=ze.ref),"required"in ze&&i(15,mt=ze.required),"$$scope"in ze&&i(25,b=ze.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&32&&i(16,n=`error-${H}`),t.$$.dirty[0]&25165824&&rt.set(E??c)},[Be,S,D,R,z,H,K,W,se,Y,ne,ue,ve,_e,oe,mt,n,rt,tt,We,Ve,St,l,E,c,b,y,mi,vt,pt,Pt,qe,Ht,lt,Gt,Mi,bt]}class NA extends Ri{constructor(e){super(),Di(this,e,AD,wD,Ci,{selected:23,size:1,inline:2,light:3,disabled:4,id:5,name:6,invalid:7,invalidText:8,warn:9,warnText:10,helperText:11,noLabel:12,labelText:13,hideLabel:14,ref:0,required:15},null,[-1,-1])}}function ED(t){let e,i=(t[1]||t[0])+"",n;return{c(){e=nt("option"),n=gi(i),e.__value=t[0],Pm(e,e.__value),e.disabled=t[3],e.hidden=t[2],e.selected=t[6],je(e,"class",t[4]),je(e,"style",t[5]),$(e,"bx--select-option",!0)},m(s,l){Se(s,e,l),Ze(e,n)},p(s,[l]){l&3&&i!==(i=(s[1]||s[0])+"")&&Si(n,i),l&1&&(e.__value=s[0],Pm(e,e.__value)),l&8&&(e.disabled=s[3]),l&4&&(e.hidden=s[2]),l&64&&(e.selected=s[6]),l&16&&je(e,"class",s[4]),l&32&&je(e,"style",s[5]),l&16&&$(e,"bx--select-option",!0)},i:ki,o:ki,d(s){s&&Te(e)}}}function TD(t,e,i){let{value:n=""}=e,{text:s=""}=e,{hidden:l=!1}=e,{disabled:c=!1}=e,{class:r=void 0}=e,{style:f=void 0}=e;const m="ccs-"+Math.random().toString(36),y=Ec("Select")||Ec("TimePickerSelect");let b=!1;const E=y.selectedValue.subscribe(S=>{i(6,b=S===n)});return Pl(()=>()=>E()),t.$$set=S=>{"value"in S&&i(0,n=S.value),"text"in S&&i(1,s=S.text),"hidden"in S&&i(2,l=S.hidden),"disabled"in S&&i(3,c=S.disabled),"class"in S&&i(4,r=S.class),"style"in S&&i(5,f=S.style)},t.$$.update=()=>{var S;t.$$.dirty&1&&((S=y==null?void 0:y.setDefaultValue)==null||S.call(y,m,n))},[n,s,l,c,r,f,b]}class SD extends Ri{constructor(e){super(),Di(this,e,TD,ED,Ci,{value:0,text:1,hidden:2,disabled:3,class:4,style:5})}}const zA=SD;function Tx(t,e,i){const n=t.slice();return n[28]=e[i],n[30]=i,n}function Sx(t,e,i){const n=t.slice();return n[28]=e[i],n[30]=i,n}function Ix(t){let e,i,n,s,l,c,r,f;function m(b){t[22](b)}let y={id:"bx--pagination-select-"+t[14],class:"bx--select__item-count",hideLabel:!0,noLabel:!0,inline:!0,$$slots:{default:[ID]},$$scope:{ctx:t}};return t[1]!==void 0&&(y.selected=t[1]),c=new NA({props:y}),sn.push(()=>Fa(c,"selected",m)),c.$on("change",t[23]),{c(){e=nt("label"),i=gi(t[5]),l=Et(),Mt(c.$$.fragment),je(e,"id",n="bx--pagination-select-"+t[14]+"-count-label"),je(e,"for",s="bx--pagination-select-"+t[14]),$(e,"bx--pagination__text",!0)},m(b,E){Se(b,e,E),Ze(e,i),Se(b,l,E),Ot(c,b,E),f=!0},p(b,E){(!f||E[0]&32)&&Si(i,b[5]),(!f||E[0]&16384&&n!==(n="bx--pagination-select-"+b[14]+"-count-label"))&&je(e,"id",n),(!f||E[0]&16384&&s!==(s="bx--pagination-select-"+b[14]))&&je(e,"for",s);const S={};E[0]&16384&&(S.id="bx--pagination-select-"+b[14]),E[0]&1024|E[1]&2&&(S.$$scope={dirty:E,ctx:b}),!r&&E[0]&2&&(r=!0,S.selected=b[1],Va(()=>r=!1)),c.$set(S)},i(b){f||(ae(c.$$.fragment,b),f=!0)},o(b){pe(c.$$.fragment,b),f=!1},d(b){b&&(Te(e),Te(l)),Ct(c,b)}}}function kx(t,e){let i,n,s;return n=new zA({props:{value:e[28],text:e[28].toString()}}),{key:t,first:null,c(){i=Mn(),Mt(n.$$.fragment),this.first=i},m(l,c){Se(l,i,c),Ot(n,l,c),s=!0},p(l,c){e=l;const r={};c[0]&1024&&(r.value=e[28]),c[0]&1024&&(r.text=e[28].toString()),n.$set(r)},i(l){s||(ae(n.$$.fragment,l),s=!0)},o(l){pe(n.$$.fragment,l),s=!1},d(l){l&&Te(i),Ct(n,l)}}}function ID(t){let e=[],i=new Map,n,s,l=Ks(t[10]);const c=r=>r[28];for(let r=0;r<l.length;r+=1){let f=Sx(t,l,r),m=c(f);i.set(m,e[r]=kx(m,f))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();n=Mn()},m(r,f){for(let m=0;m<e.length;m+=1)e[m]&&e[m].m(r,f);Se(r,n,f),s=!0},p(r,f){f[0]&1024&&(l=Ks(r[10]),Ai(),e=fu(e,f,c,1,r,l,i,n.parentNode,du,kx,n,Sx),Ei())},i(r){if(!s){for(let f=0;f<l.length;f+=1)ae(e[f]);s=!0}},o(r){for(let f=0;f<e.length;f+=1)pe(e[f]);s=!1},d(r){r&&Te(n);for(let f=0;f<e.length;f+=1)e[f].d(r)}}}function kD(t){let e=t[7](Math.min(t[1]*(t[0]-1)+1,t[2]),Math.min(t[0]*t[1],t[2]),t[2])+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p(n,s){s[0]&135&&e!==(e=n[7](Math.min(n[1]*(n[0]-1)+1,n[2]),Math.min(n[0]*n[1],n[2]),n[2])+"")&&Si(i,e)},d(n){n&&Te(i)}}}function OD(t){let e=t[6](t[1]*(t[0]-1)+1,t[0]*t[1])+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p(n,s){s[0]&67&&e!==(e=n[6](n[1]*(n[0]-1)+1,n[0]*n[1])+"")&&Si(i,e)},d(n){n&&Te(i)}}}function Ox(t){let e,i,n,s,l;function c(b){t[24](b)}let r={id:"bx--pagination-select-"+(t[14]+2),class:"bx--select__page-number",labelText:"Page number, of "+t[15]+" pages",inline:!0,hideLabel:!0,$$slots:{default:[CD]},$$scope:{ctx:t}};t[0]!==void 0&&(r.selected=t[0]),e=new NA({props:r}),sn.push(()=>Fa(e,"selected",c)),e.$on("change",t[25]);function f(b,E){return b[11]?DD:MD}let m=f(t),y=m(t);return{c(){Mt(e.$$.fragment),n=Et(),s=nt("span"),y.c(),$(s,"bx--pagination__text",!0)},m(b,E){Ot(e,b,E),Se(b,n,E),Se(b,s,E),y.m(s,null),l=!0},p(b,E){const S={};E[0]&16384&&(S.id="bx--pagination-select-"+(b[14]+2)),E[0]&32768&&(S.labelText="Page number, of "+b[15]+" pages"),E[0]&262144|E[1]&2&&(S.$$scope={dirty:E,ctx:b}),!i&&E[0]&1&&(i=!0,S.selected=b[0],Va(()=>i=!1)),e.$set(S),m===(m=f(b))&&y?y.p(b,E):(y.d(1),y=m(b),y&&(y.c(),y.m(s,null)))},i(b){l||(ae(e.$$.fragment,b),l=!0)},o(b){pe(e.$$.fragment,b),l=!1},d(b){b&&(Te(n),Te(s)),Ct(e,b),y.d()}}}function Cx(t,e){let i,n,s;return n=new zA({props:{value:e[28]+1,text:(e[28]+1).toString()}}),{key:t,first:null,c(){i=Mn(),Mt(n.$$.fragment),this.first=i},m(l,c){Se(l,i,c),Ot(n,l,c),s=!0},p(l,c){e=l;const r={};c[0]&262144&&(r.value=e[28]+1),c[0]&262144&&(r.text=(e[28]+1).toString()),n.$set(r)},i(l){s||(ae(n.$$.fragment,l),s=!0)},o(l){pe(n.$$.fragment,l),s=!1},d(l){l&&Te(i),Ct(n,l)}}}function CD(t){let e=[],i=new Map,n,s,l=Ks(t[18]);const c=r=>r[28];for(let r=0;r<l.length;r+=1){let f=Tx(t,l,r),m=c(f);i.set(m,e[r]=Cx(m,f))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();n=Mn()},m(r,f){for(let m=0;m<e.length;m+=1)e[m]&&e[m].m(r,f);Se(r,n,f),s=!0},p(r,f){f[0]&262144&&(l=Ks(r[18]),Ai(),e=fu(e,f,c,1,r,l,i,n.parentNode,du,Cx,n,Tx),Ei())},i(r){if(!s){for(let f=0;f<l.length;f+=1)ae(e[f]);s=!0}},o(r){for(let f=0;f<e.length;f+=1)pe(e[f]);s=!1},d(r){r&&Te(n);for(let f=0;f<e.length;f+=1)e[f].d(r)}}}function MD(t){let e=t[13](t[0],t[15])+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p(n,s){s[0]&40961&&e!==(e=n[13](n[0],n[15])+"")&&Si(i,e)},d(n){n&&Te(i)}}}function DD(t){let e=t[12](t[0])+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p(n,s){s[0]&4097&&e!==(e=n[12](n[0])+"")&&Si(i,e)},d(n){n&&Te(i)}}}function RD(t){let e,i,n,s,l,c,r,f,m,y,b,E=!t[9]&&Ix(t);function S(W,se){return W[11]?OD:kD}let D=S(t),R=D(t),z=!t[8]&&Ox(t);f=new nu({props:{kind:"ghost",tooltipAlignment:"center",tooltipPosition:"top",icon:vD,iconDescription:t[4],disabled:t[17],class:"bx--pagination__button bx--pagination__button--backward "+(t[17]?"bx--pagination__button--no-index":"")}}),f.$on("click",t[26]),y=new nu({props:{kind:"ghost",tooltipAlignment:"end",tooltipPosition:"top",icon:$O,iconDescription:t[3],disabled:t[16],class:"bx--pagination__button bx--pagination__button--forward "+(t[16]?"bx--pagination__button--no-index":"")}}),y.$on("click",t[27]);let H=[{id:t[14]},t[20]],K={};for(let W=0;W<H.length;W+=1)K=Ye(K,H[W]);return{c(){e=nt("div"),i=nt("div"),E&&E.c(),n=Et(),s=nt("span"),R.c(),l=Et(),c=nt("div"),z&&z.c(),r=Et(),Mt(f.$$.fragment),m=Et(),Mt(y.$$.fragment),$(s,"bx--pagination__text",!t[9]),$(i,"bx--pagination__left",!0),$(c,"bx--pagination__right",!0),ui(e,K),$(e,"bx--pagination",!0)},m(W,se){Se(W,e,se),Ze(e,i),E&&E.m(i,null),Ze(i,n),Ze(i,s),R.m(s,null),Ze(e,l),Ze(e,c),z&&z.m(c,null),Ze(c,r),Ot(f,c,null),Ze(c,m),Ot(y,c,null),b=!0},p(W,se){W[9]?E&&(Ai(),pe(E,1,1,()=>{E=null}),Ei()):E?(E.p(W,se),se[0]&512&&ae(E,1)):(E=Ix(W),E.c(),ae(E,1),E.m(i,n)),D===(D=S(W))&&R?R.p(W,se):(R.d(1),R=D(W),R&&(R.c(),R.m(s,null))),(!b||se[0]&512)&&$(s,"bx--pagination__text",!W[9]),W[8]?z&&(Ai(),pe(z,1,1,()=>{z=null}),Ei()):z?(z.p(W,se),se[0]&256&&ae(z,1)):(z=Ox(W),z.c(),ae(z,1),z.m(c,r));const Y={};se[0]&16&&(Y.iconDescription=W[4]),se[0]&131072&&(Y.disabled=W[17]),se[0]&131072&&(Y.class="bx--pagination__button bx--pagination__button--backward "+(W[17]?"bx--pagination__button--no-index":"")),f.$set(Y);const ne={};se[0]&8&&(ne.iconDescription=W[3]),se[0]&65536&&(ne.disabled=W[16]),se[0]&65536&&(ne.class="bx--pagination__button bx--pagination__button--forward "+(W[16]?"bx--pagination__button--no-index":"")),y.$set(ne),ui(e,K=Ni(H,[(!b||se[0]&16384)&&{id:W[14]},se[0]&1048576&&W[20]])),$(e,"bx--pagination",!0)},i(W){b||(ae(E),ae(z),ae(f.$$.fragment,W),ae(y.$$.fragment,W),b=!0)},o(W){pe(E),pe(z),pe(f.$$.fragment,W),pe(y.$$.fragment,W),b=!1},d(W){W&&Te(e),E&&E.d(),R.d(),z&&z.d(),Ct(f),Ct(y)}}}function LD(t,e,i){let n,s,l,c;const r=["page","totalItems","disabled","forwardText","backwardText","itemsPerPageText","itemText","itemRangeText","pageInputDisabled","pageSizeInputDisabled","pageSize","pageSizes","pagesUnknown","pageText","pageRangeText","id"];let f=Ut(e,r),{page:m=1}=e,{totalItems:y=0}=e,{disabled:b=!1}=e,{forwardText:E="Next page"}=e,{backwardText:S="Previous page"}=e,{itemsPerPageText:D="Items per page:"}=e,{itemText:R=(We,Ve)=>`${We}${Ve} item${Ve===1?"":"s"}`}=e,{itemRangeText:z=(We,Ve,St)=>`${We}${Ve} of ${St} item${Ve===1?"":"s"}`}=e,{pageInputDisabled:H=!1}=e,{pageSizeInputDisabled:K=!1}=e,{pageSize:W=10}=e,{pageSizes:se=[10]}=e,{pagesUnknown:Y=!1}=e,{pageText:ne=We=>`page ${We}`}=e,{pageRangeText:ue=(We,Ve)=>`of ${Ve} page${Ve===1?"":"s"}`}=e,{id:ve="ccs-"+Math.random().toString(36)}=e;const _e=co();Rh(()=>{m>n&&i(0,m=n)});function oe(We){W=We,i(1,W)}const Be=()=>{_e("change",{pageSize:W})};function mt(We){m=We,i(0,m)}const Le=()=>{_e("change",{page:m})},rt=()=>{i(0,m--,m),_e("click:button--previous",{page:m}),_e("change",{page:m})},tt=()=>{i(0,m++,m),_e("click:button--next",{page:m}),_e("change",{page:m})};return t.$$set=We=>{e=Ye(Ye({},e),fi(We)),i(20,f=Ut(e,r)),"page"in We&&i(0,m=We.page),"totalItems"in We&&i(2,y=We.totalItems),"disabled"in We&&i(21,b=We.disabled),"forwardText"in We&&i(3,E=We.forwardText),"backwardText"in We&&i(4,S=We.backwardText),"itemsPerPageText"in We&&i(5,D=We.itemsPerPageText),"itemText"in We&&i(6,R=We.itemText),"itemRangeText"in We&&i(7,z=We.itemRangeText),"pageInputDisabled"in We&&i(8,H=We.pageInputDisabled),"pageSizeInputDisabled"in We&&i(9,K=We.pageSizeInputDisabled),"pageSize"in We&&i(1,W=We.pageSize),"pageSizes"in We&&i(10,se=We.pageSizes),"pagesUnknown"in We&&i(11,Y=We.pagesUnknown),"pageText"in We&&i(12,ne=We.pageText),"pageRangeText"in We&&i(13,ue=We.pageRangeText),"id"in We&&i(14,ve=We.id)},t.$$.update=()=>{t.$$.dirty[0]&3&&_e("update",{pageSize:W,page:m}),t.$$.dirty[0]&6&&i(15,n=Math.max(Math.ceil(y/W),1)),t.$$.dirty[0]&32768&&i(18,s=Array.from({length:n},(We,Ve)=>Ve)),t.$$.dirty[0]&2097153&&i(17,l=b||m===1),t.$$.dirty[0]&2129921&&i(16,c=b||m===n)},[m,W,y,E,S,D,R,z,H,K,se,Y,ne,ue,ve,n,c,l,s,_e,f,b,oe,Be,mt,Le,rt,tt]}class PD extends Ri{constructor(e){super(),Di(this,e,LD,RD,Ci,{page:0,totalItems:2,disabled:21,forwardText:3,backwardText:4,itemsPerPageText:5,itemText:6,itemRangeText:7,pageInputDisabled:8,pageSizeInputDisabled:9,pageSize:1,pageSizes:10,pagesUnknown:11,pageText:12,pageRangeText:13,id:14},null,[-1,-1])}}function Mx(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function ND(t){let e,i,n=t[1]&&Mx(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M4 6H28V8H4zM4 24H28V26H4zM4 12H28V14H4zM4 18H28V20H4z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=Mx(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function zD(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class BD extends Ri{constructor(e){super(),Di(this,e,zD,ND,Ci,{size:0,title:1})}}const BA=BD,k_=Ur(!1),O_=Ur(!1),C_=Ur(!1);function VD(t){let e,i,n,s,l;var c=t[0]?t[4]:t[3];function r(y,b){return{props:{size:20}}}c&&(i=yh(c,r()));let f=[{type:"button"},{title:t[2]},{"aria-label":t[2]},t[5]],m={};for(let y=0;y<f.length;y+=1)m=Ye(m,f[y]);return{c(){e=nt("button"),i&&Mt(i.$$.fragment),ui(e,m),$(e,"bx--header__action",!0),$(e,"bx--header__menu-trigger",!0),$(e,"bx--header__menu-toggle",!0)},m(y,b){Se(y,e,b),i&&Ot(i,e,null),e.autofocus&&e.focus(),t[7](e),n=!0,s||(l=[ut(e,"click",t[6]),ut(e,"click",t[8])],s=!0)},p(y,[b]){if(b&25&&c!==(c=y[0]?y[4]:y[3])){if(i){Ai();const E=i;pe(E.$$.fragment,1,0,()=>{Ct(E,1)}),Ei()}c?(i=yh(c,r()),Mt(i.$$.fragment),ae(i.$$.fragment,1),Ot(i,e,null)):i=null}ui(e,m=Ni(f,[{type:"button"},(!n||b&4)&&{title:y[2]},(!n||b&4)&&{"aria-label":y[2]},b&32&&y[5]])),$(e,"bx--header__action",!0),$(e,"bx--header__menu-trigger",!0),$(e,"bx--header__menu-toggle",!0)},i(y){n||(i&&ae(i.$$.fragment,y),n=!0)},o(y){i&&pe(i.$$.fragment,y),n=!1},d(y){y&&Te(e),i&&Ct(i),t[7](null),s=!1,vn(l)}}}function FD(t,e,i){const n=["ariaLabel","isOpen","iconMenu","iconClose","ref"];let s=Ut(e,n),{ariaLabel:l=void 0}=e,{isOpen:c=!1}=e,{iconMenu:r=BA}=e,{iconClose:f=Lh}=e,{ref:m=null}=e;function y(S){At.call(this,t,S)}function b(S){sn[S?"unshift":"push"](()=>{m=S,i(1,m)})}const E=()=>i(0,c=!c);return t.$$set=S=>{e=Ye(Ye({},e),fi(S)),i(5,s=Ut(e,n)),"ariaLabel"in S&&i(2,l=S.ariaLabel),"isOpen"in S&&i(0,c=S.isOpen),"iconMenu"in S&&i(3,r=S.iconMenu),"iconClose"in S&&i(4,f=S.iconClose),"ref"in S&&i(1,m=S.ref)},[c,m,l,r,f,s,y,b,E]}class UD extends Ri{constructor(e){super(),Di(this,e,FD,VD,Ci,{ariaLabel:2,isOpen:0,iconMenu:3,iconClose:4,ref:1})}}const jD=t=>({}),Dx=t=>({}),GD=t=>({}),Rx=t=>({}),HD=t=>({}),Lx=t=>({});function Px(t){let e,i,n;function s(c){t[20](c)}let l={iconClose:t[8],iconMenu:t[7]};return t[0]!==void 0&&(l.isOpen=t[0]),e=new UD({props:l}),sn.push(()=>Fa(e,"isOpen",s)),{c(){Mt(e.$$.fragment)},m(c,r){Ot(e,c,r),n=!0},p(c,r){const f={};r&256&&(f.iconClose=c[8]),r&128&&(f.iconMenu=c[7]),!i&&r&1&&(i=!0,f.isOpen=c[0],Va(()=>i=!1)),e.$set(f)},i(c){n||(ae(e.$$.fragment,c),n=!0)},o(c){pe(e.$$.fragment,c),n=!1},d(c){Ct(e,c)}}}function Nx(t){let e,i;const n=t[17].company,s=$i(n,t,t[16],Rx),l=s||KD(t);return{c(){e=nt("span"),l&&l.c(),$(e,"bx--header__name--prefix",!0)},m(c,r){Se(c,e,r),l&&l.m(e,null),i=!0},p(c,r){s?s.p&&(!i||r&65536)&&tn(s,n,c,c[16],i?en(n,c[16],r,GD):nn(c[16]),Rx):l&&l.p&&(!i||r&8)&&l.p(c,i?r:-1)},i(c){i||(ae(l,c),i=!0)},o(c){pe(l,c),i=!1},d(c){c&&Te(e),l&&l.d(c)}}}function KD(t){let e,i;return{c(){e=gi(t[3]),i=gi("")},m(n,s){Se(n,e,s),Se(n,i,s)},p(n,s){s&8&&Si(e,n[3])},d(n){n&&(Te(e),Te(i))}}}function qD(t){let e;return{c(){e=gi(t[4])},m(i,n){Se(i,e,n)},p(i,n){n&16&&Si(e,i[4])},d(i){i&&Te(e)}}}function ZD(t){let e,i,n,s,l,c,r,f,m;Zd(t[19]);const y=t[17]["skip-to-content"],b=$i(y,t,t[16],Lx);let E=(t[11]&&t[9]<t[6]||t[5])&&Px(t),S=(t[3]||t[13].company)&&Nx(t);const D=t[17].platform,R=$i(D,t,t[16],Dx),z=R||qD(t);let H=[{href:t[2]},t[12]],K={};for(let Y=0;Y<H.length;Y+=1)K=Ye(K,H[Y]);const W=t[17].default,se=$i(W,t,t[16],null);return{c(){e=nt("header"),b&&b.c(),i=Et(),E&&E.c(),n=Et(),s=nt("a"),S&&S.c(),l=Et(),z&&z.c(),c=Et(),se&&se.c(),ui(s,K),$(s,"bx--header__name",!0),je(e,"aria-label",t[10]),$(e,"bx--header",!0)},m(Y,ne){Se(Y,e,ne),b&&b.m(e,null),Ze(e,i),E&&E.m(e,null),Ze(e,n),Ze(e,s),S&&S.m(s,null),Ze(s,l),z&&z.m(s,null),t[21](s),Ze(e,c),se&&se.m(e,null),r=!0,f||(m=[ut(window,"resize",t[19]),ut(s,"click",t[18])],f=!0)},p(Y,[ne]){b&&b.p&&(!r||ne&65536)&&tn(b,y,Y,Y[16],r?en(y,Y[16],ne,HD):nn(Y[16]),Lx),Y[11]&&Y[9]<Y[6]||Y[5]?E?(E.p(Y,ne),ne&2656&&ae(E,1)):(E=Px(Y),E.c(),ae(E,1),E.m(e,n)):E&&(Ai(),pe(E,1,1,()=>{E=null}),Ei()),Y[3]||Y[13].company?S?(S.p(Y,ne),ne&8200&&ae(S,1)):(S=Nx(Y),S.c(),ae(S,1),S.m(s,l)):S&&(Ai(),pe(S,1,1,()=>{S=null}),Ei()),R?R.p&&(!r||ne&65536)&&tn(R,D,Y,Y[16],r?en(D,Y[16],ne,jD):nn(Y[16]),Dx):z&&z.p&&(!r||ne&16)&&z.p(Y,r?ne:-1),ui(s,K=Ni(H,[(!r||ne&4)&&{href:Y[2]},ne&4096&&Y[12]])),$(s,"bx--header__name",!0),se&&se.p&&(!r||ne&65536)&&tn(se,W,Y,Y[16],r?en(W,Y[16],ne,null):nn(Y[16]),null),(!r||ne&1024)&&je(e,"aria-label",Y[10])},i(Y){r||(ae(b,Y),ae(E),ae(S),ae(z,Y),ae(se,Y),r=!0)},o(Y){pe(b,Y),pe(E),pe(S),pe(z,Y),pe(se,Y),r=!1},d(Y){Y&&Te(e),b&&b.d(Y),E&&E.d(),S&&S.d(),z&&z.d(Y),t[21](null),se&&se.d(Y),f=!1,vn(m)}}}function WD(t,e,i){let n;const s=["expandedByDefault","isSideNavOpen","uiShellAriaLabel","href","company","platformName","persistentHamburgerMenu","expansionBreakpoint","ref","iconMenu","iconClose"];let l=Ut(e,s),c;Ln(t,k_,oe=>i(11,c=oe));let{$$slots:r={},$$scope:f}=e;const m=hu(r);let{expandedByDefault:y=!0}=e,{isSideNavOpen:b=!1}=e,{uiShellAriaLabel:E=void 0}=e,{href:S=void 0}=e,{company:D=void 0}=e,{platformName:R=""}=e,{persistentHamburgerMenu:z=!1}=e,{expansionBreakpoint:H=1056}=e,{ref:K=null}=e,{iconMenu:W=BA}=e,{iconClose:se=Lh}=e,Y;function ne(oe){At.call(this,t,oe)}function ue(){i(9,Y=window.innerWidth)}function ve(oe){b=oe,i(0,b),i(14,y),i(9,Y),i(6,H),i(5,z)}function _e(oe){sn[oe?"unshift":"push"](()=>{K=oe,i(1,K)})}return t.$$set=oe=>{i(22,e=Ye(Ye({},e),fi(oe))),i(12,l=Ut(e,s)),"expandedByDefault"in oe&&i(14,y=oe.expandedByDefault),"isSideNavOpen"in oe&&i(0,b=oe.isSideNavOpen),"uiShellAriaLabel"in oe&&i(15,E=oe.uiShellAriaLabel),"href"in oe&&i(2,S=oe.href),"company"in oe&&i(3,D=oe.company),"platformName"in oe&&i(4,R=oe.platformName),"persistentHamburgerMenu"in oe&&i(5,z=oe.persistentHamburgerMenu),"expansionBreakpoint"in oe&&i(6,H=oe.expansionBreakpoint),"ref"in oe&&i(1,K=oe.ref),"iconMenu"in oe&&i(7,W=oe.iconMenu),"iconClose"in oe&&i(8,se=oe.iconClose),"$$scope"in oe&&i(16,f=oe.$$scope)},t.$$.update=()=>{t.$$.dirty&16992&&i(0,b=y&&Y>=H&&!z),i(10,n=D?`${D} `:""+(E||e["aria-label"]||R))},e=fi(e),[b,K,S,D,R,z,H,W,se,Y,n,c,l,m,y,E,f,r,ne,ue,ve,_e]}class YD extends Ri{constructor(e){super(),Di(this,e,WD,ZD,Ci,{expandedByDefault:14,isSideNavOpen:0,uiShellAriaLabel:15,href:2,company:3,platformName:4,persistentHamburgerMenu:5,expansionBreakpoint:6,ref:1,iconMenu:7,iconClose:8})}}function JD(t){let e,i,n;const s=t[3].default,l=$i(s,t,t[2],null);let c=[t[0],{role:"menubar"}],r={};for(let y=0;y<c.length;y+=1)r=Ye(r,c[y]);let f=[t[0],t[1]],m={};for(let y=0;y<f.length;y+=1)m=Ye(m,f[y]);return{c(){e=nt("nav"),i=nt("ul"),l&&l.c(),ui(i,r),$(i,"bx--header__menu-bar",!0),ui(e,m),$(e,"bx--header__nav",!0)},m(y,b){Se(y,e,b),Ze(e,i),l&&l.m(i,null),n=!0},p(y,[b]){l&&l.p&&(!n||b&4)&&tn(l,s,y,y[2],n?en(s,y[2],b,null):nn(y[2]),null),ui(i,r=Ni(c,[b&1&&y[0],{role:"menubar"}])),$(i,"bx--header__menu-bar",!0),ui(e,m=Ni(f,[b&1&&y[0],b&2&&y[1]])),$(e,"bx--header__nav",!0)},i(y){n||(ae(l,y),n=!0)},o(y){pe(l,y),n=!1},d(y){y&&Te(e),l&&l.d(y)}}}function XD(t,e,i){let n;const s=[];let l=Ut(e,s),{$$slots:c={},$$scope:r}=e;return t.$$set=f=>{i(4,e=Ye(Ye({},e),fi(f))),i(1,l=Ut(e,s)),"$$scope"in f&&i(2,r=f.$$scope)},t.$$.update=()=>{i(0,n={"aria-label":e["aria-label"],"aria-labelledby":e["aria-labelledby"]})},e=fi(e),[n,l,r,c]}class QD extends Ri{constructor(e){super(),Di(this,e,XD,JD,Ci,{})}}function $D(t){let e;return{c(){e=gi(t[2])},m(i,n){Se(i,e,n)},p(i,n){n&4&&Si(e,i[2])},d(i){i&&Te(e)}}}function eR(t){let e,i,n,s,l,c,r,f;const m=t[9].default,y=$i(m,t,t[8],null),b=y||$D(t);let E=[{role:"menuitem"},{tabindex:"0"},{href:t[1]},{rel:s=t[7].target==="_blank"?"noopener noreferrer":void 0},{"aria-current":l=t[3]?"page":void 0},t[7]],S={};for(let D=0;D<E.length;D+=1)S=Ye(S,E[D]);return{c(){e=nt("li"),i=nt("a"),n=nt("span"),b&&b.c(),$(n,"bx--text-truncate--end",!0),ui(i,S),$(i,"bx--header__menu-item",!0),je(e,"role","none")},m(D,R){Se(D,e,R),Ze(e,i),Ze(i,n),b&&b.m(n,null),t[18](i),c=!0,r||(f=[ut(i,"click",t[10]),ut(i,"mouseover",t[11]),ut(i,"mouseenter",t[12]),ut(i,"mouseleave",t[13]),ut(i,"keyup",t[14]),ut(i,"keydown",t[15]),ut(i,"focus",t[16]),ut(i,"blur",t[17]),ut(i,"blur",t[19])],r=!0)},p(D,[R]){y?y.p&&(!c||R&256)&&tn(y,m,D,D[8],c?en(m,D[8],R,null):nn(D[8]),null):b&&b.p&&(!c||R&4)&&b.p(D,c?R:-1),ui(i,S=Ni(E,[{role:"menuitem"},{tabindex:"0"},(!c||R&2)&&{href:D[1]},(!c||R&128&&s!==(s=D[7].target==="_blank"?"noopener noreferrer":void 0))&&{rel:s},(!c||R&8&&l!==(l=D[3]?"page":void 0))&&{"aria-current":l},R&128&&D[7]])),$(i,"bx--header__menu-item",!0)},i(D){c||(ae(b,D),c=!0)},o(D){pe(b,D),c=!1},d(D){D&&Te(e),b&&b.d(D),t[18](null),r=!1,vn(f)}}}function tR(t,e,i){const n=["href","text","isSelected","ref"];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e,{href:r=void 0}=e,{text:f=void 0}=e,{isSelected:m=!1}=e,{ref:y=null}=e;const b="ccs-"+Math.random().toString(36),E=Ec("HeaderNavMenu");let S=[];const D=E==null?void 0:E.selectedItems.subscribe(_e=>{i(4,S=Object.keys(_e))});Pl(()=>()=>{D&&D()});function R(_e){At.call(this,t,_e)}function z(_e){At.call(this,t,_e)}function H(_e){At.call(this,t,_e)}function K(_e){At.call(this,t,_e)}function W(_e){At.call(this,t,_e)}function se(_e){At.call(this,t,_e)}function Y(_e){At.call(this,t,_e)}function ne(_e){At.call(this,t,_e)}function ue(_e){sn[_e?"unshift":"push"](()=>{y=_e,i(0,y)})}const ve=()=>{S.indexOf(b)===S.length-1&&(E==null||E.closeMenu())};return t.$$set=_e=>{e=Ye(Ye({},e),fi(_e)),i(7,s=Ut(e,n)),"href"in _e&&i(1,r=_e.href),"text"in _e&&i(2,f=_e.text),"isSelected"in _e&&i(3,m=_e.isSelected),"ref"in _e&&i(0,y=_e.ref),"$$scope"in _e&&i(8,c=_e.$$scope)},t.$$.update=()=>{t.$$.dirty&8&&(E==null||E.updateSelectedItems({id:b,isSelected:m}))},[y,r,f,m,S,b,E,s,c,l,R,z,H,K,W,se,Y,ne,ue,ve]}class zg extends Ri{constructor(e){super(),Di(this,e,tR,eR,Ci,{href:1,text:2,isSelected:3,ref:0})}}function zx(t){let e,i,n;return{c(){e=nt("div"),$(e,"bx--side-nav__overlay",!0),$(e,"bx--side-nav__overlay-active",t[0]),Ml(e,"z-index",t[0]?6e3:void 0)},m(s,l){Se(s,e,l),i||(n=ut(e,"click",t[11]),i=!0)},p(s,l){l&1&&$(e,"bx--side-nav__overlay-active",s[0]),l&1&&Ml(e,"z-index",s[0]?6e3:void 0)},d(s){s&&Te(e),i=!1,n()}}}function iR(t){let e,i,n,s,l,c;Zd(t[10]);let r=!t[1]&&zx(t);const f=t[9].default,m=$i(f,t,t[8],null);let y=[{"aria-hidden":n=!t[0]},{"aria-label":t[3]},t[7]],b={};for(let E=0;E<y.length;E+=1)b=Ye(b,y[E]);return{c(){r&&r.c(),e=Et(),i=nt("nav"),m&&m.c(),ui(i,b),$(i,"bx--side-nav__navigation",!0),$(i,"bx--side-nav",!0),$(i,"bx--side-nav--ux",!0),$(i,"bx--side-nav--expanded",t[2]&&t[5]>=t[4]?!1:t[0]),$(i,"bx--side-nav--collapsed",!t[0]&&!t[2]),$(i,"bx--side-nav--rail",t[2])},m(E,S){r&&r.m(E,S),Se(E,e,S),Se(E,i,S),m&&m.m(i,null),s=!0,l||(c=ut(window,"resize",t[10]),l=!0)},p(E,[S]){E[1]?r&&(r.d(1),r=null):r?r.p(E,S):(r=zx(E),r.c(),r.m(e.parentNode,e)),m&&m.p&&(!s||S&256)&&tn(m,f,E,E[8],s?en(f,E[8],S,null):nn(E[8]),null),ui(i,b=Ni(y,[(!s||S&1&&n!==(n=!E[0]))&&{"aria-hidden":n},(!s||S&8)&&{"aria-label":E[3]},S&128&&E[7]])),$(i,"bx--side-nav__navigation",!0),$(i,"bx--side-nav",!0),$(i,"bx--side-nav--ux",!0),$(i,"bx--side-nav--expanded",E[2]&&E[5]>=E[4]?!1:E[0]),$(i,"bx--side-nav--collapsed",!E[0]&&!E[2]),$(i,"bx--side-nav--rail",E[2])},i(E){s||(ae(m,E),s=!0)},o(E){pe(m,E),s=!1},d(E){E&&(Te(e),Te(i)),r&&r.d(E),m&&m.d(E),l=!1,c()}}}function nR(t,e,i){const n=["fixed","rail","ariaLabel","isOpen","expansionBreakpoint"];let s=Ut(e,n),l,c;Ln(t,C_,K=>i(12,l=K)),Ln(t,O_,K=>i(13,c=K));let{$$slots:r={},$$scope:f}=e,{fixed:m=!1}=e,{rail:y=!1}=e,{ariaLabel:b=void 0}=e,{isOpen:E=!1}=e,{expansionBreakpoint:S=1056}=e;const D=co();let R;Pl(()=>(k_.set(!0),()=>k_.set(!1)));function z(){i(5,R=window.innerWidth)}const H=()=>{D("click:overlay"),i(0,E=!1)};return t.$$set=K=>{e=Ye(Ye({},e),fi(K)),i(7,s=Ut(e,n)),"fixed"in K&&i(1,m=K.fixed),"rail"in K&&i(2,y=K.rail),"ariaLabel"in K&&i(3,b=K.ariaLabel),"isOpen"in K&&i(0,E=K.isOpen),"expansionBreakpoint"in K&&i(4,S=K.expansionBreakpoint),"$$scope"in K&&i(8,f=K.$$scope)},t.$$.update=()=>{t.$$.dirty&1&&D(E?"open":"close"),t.$$.dirty&1&&Lm(O_,c=!E,c),t.$$.dirty&4&&Lm(C_,l=y,l)},[E,m,y,b,S,R,D,s,f,r,z,H]}class rR extends Ri{constructor(e){super(),Di(this,e,nR,iR,Ci,{fixed:1,rail:2,ariaLabel:3,isOpen:0,expansionBreakpoint:4})}}function sR(t){let e,i;const n=t[1].default,s=$i(n,t,t[0],null);return{c(){e=nt("ul"),s&&s.c(),$(e,"bx--side-nav__items",!0)},m(l,c){Se(l,e,c),s&&s.m(e,null),i=!0},p(l,[c]){s&&s.p&&(!i||c&1)&&tn(s,n,l,l[0],i?en(n,l[0],c,null):nn(l[0]),null)},i(l){i||(ae(s,l),i=!0)},o(l){pe(s,l),i=!1},d(l){l&&Te(e),s&&s.d(l)}}}function aR(t,e,i){let{$$slots:n={},$$scope:s}=e;return t.$$set=l=>{"$$scope"in l&&i(0,s=l.$$scope)},[s,n]}class oR extends Ri{constructor(e){super(),Di(this,e,aR,sR,Ci,{})}}function lR(t){let e,i;const n=t[6].default,s=$i(n,t,t[5],null);let l=[{id:t[0]},t[2]],c={};for(let r=0;r<l.length;r+=1)c=Ye(c,l[r]);return{c(){e=nt("main"),s&&s.c(),ui(e,c),$(e,"bx--content",!0),Ml(e,"margin-left",t[1]?0:void 0)},m(r,f){Se(r,e,f),s&&s.m(e,null),i=!0},p(r,[f]){s&&s.p&&(!i||f&32)&&tn(s,n,r,r[5],i?en(n,r[5],f,null):nn(r[5]),null),ui(e,c=Ni(l,[(!i||f&1)&&{id:r[0]},f&4&&r[2]])),$(e,"bx--content",!0),Ml(e,"margin-left",r[1]?0:void 0)},i(r){i||(ae(s,r),i=!0)},o(r){pe(s,r),i=!1},d(r){r&&Te(e),s&&s.d(r)}}}function cR(t,e,i){let n;const s=["id"];let l=Ut(e,s),c,r;Ln(t,C_,b=>i(3,c=b)),Ln(t,O_,b=>i(4,r=b));let{$$slots:f={},$$scope:m}=e,{id:y="main-content"}=e;return t.$$set=b=>{e=Ye(Ye({},e),fi(b)),i(2,l=Ut(e,s)),"id"in b&&i(0,y=b.id),"$$scope"in b&&i(5,m=b.$$scope)},t.$$.update=()=>{t.$$.dirty&24&&i(1,n=r&&!c)},[y,n,l,c,r,m,f]}class uR extends Ri{constructor(e){super(),Di(this,e,cR,lR,Ci,{id:0})}}function hR(t){let e;return{c(){e=gi("Skip to main content")},m(i,n){Se(i,e,n)},d(i){i&&Te(e)}}}function dR(t){let e,i,n,s;const l=t[4].default,c=$i(l,t,t[3],null),r=c||hR();let f=[{href:t[0]},{tabindex:t[1]},t[2]],m={};for(let y=0;y<f.length;y+=1)m=Ye(m,f[y]);return{c(){e=nt("a"),r&&r.c(),ui(e,m),$(e,"bx--skip-to-content",!0)},m(y,b){Se(y,e,b),r&&r.m(e,null),i=!0,n||(s=ut(e,"click",t[5]),n=!0)},p(y,[b]){c&&c.p&&(!i||b&8)&&tn(c,l,y,y[3],i?en(l,y[3],b,null):nn(y[3]),null),ui(e,m=Ni(f,[(!i||b&1)&&{href:y[0]},(!i||b&2)&&{tabindex:y[1]},b&4&&y[2]])),$(e,"bx--skip-to-content",!0)},i(y){i||(ae(r,y),i=!0)},o(y){pe(r,y),i=!1},d(y){y&&Te(e),r&&r.d(y),n=!1,s()}}}function fR(t,e,i){const n=["href","tabindex"];let s=Ut(e,n),{$$slots:l={},$$scope:c}=e,{href:r="#main-content"}=e,{tabindex:f="0"}=e;function m(y){At.call(this,t,y)}return t.$$set=y=>{e=Ye(Ye({},e),fi(y)),i(2,s=Ut(e,n)),"href"in y&&i(0,r=y.href),"tabindex"in y&&i(1,f=y.tabindex),"$$scope"in y&&i(3,c=y.$$scope)},[r,f,s,c,l,m]}class mR extends Ri{constructor(e){super(),Di(this,e,fR,dR,Ci,{href:0,tabindex:1})}}function Bx(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function pR(t){let e,i,n=t[1]&&Bx(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M29,27.5859l-7.5521-7.5521a11.0177,11.0177,0,1,0-1.4141,1.4141L27.5859,29ZM4,13a9,9,0,1,1,9,9A9.01,9.01,0,0,1,4,13Z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=Bx(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function gR(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class VA extends Ri{constructor(e){super(),Di(this,e,gR,pR,Ci,{size:0,title:1})}}let Wn={search:"Upisi lokaciju...",city:"Grad",municipality:"Opstina",cadastre:"Katastar",year:"Godina",month:"Mesec",location:"Lokacija",period_from:"Period od",period_to:"Period do",do_search:"Izvrsi pretragu",old_housing:"Starogradnja",new_housing:"Novogradnja",headline_turnover:"PROMET",headline_properties:"NEKRETNINA",filter:"Filter",table_name:"Ime za tabelu",table_description:"Opis tabele",table_headers:{date:"Datum ugovora",type:"Tip",price:"Cena",appt_size:"Stan kvm",parking_size:"Parking kvm",room_number:"Broj soba",price_per_sqm:"Cena kvm"},modal:{filter_table:"Filter podataka u tabeli",options:"Opcije",date_from:"Datum od:",date_to:"Datum do:"}},FA=new Date,_R=FA.getMonth()+1,yR=FA.getFullYear();const em=Ur("Map"),Vx=Ur([]),zm=Ur([]);function vR(){const t={grad_id:79014,gradoviSvi:!1,ops_id:"*",kat_id:"*",old_housing:!0,new_housing:!0,broj_soba:[],opstine:[],katastri:[],coords:[],start:{year:yR,month:_R},end:{year:0,month:0}},{subscribe:e,set:i,update:n}=Ur(t);return{subscribe:e,...{setPropToValue(l){n(c=>({...c,[l[0]]:l[1]}))},setNestedPropToValue(l){n(c=>({...c,[l[0]]:{...c[l[0]],[l[1]]:l[2]}}))}}}}const Eo=vR();function bR(t){let e,i,n,s,l;return i=new eu({props:{selectedId:"2024",titleText:Wn.year,size:"sm",items:t[0]}}),i.$on("select",t[2]),s=new eu({props:{selectedId:"1",titleText:Wn.month,size:"sm",items:t[1]}}),s.$on("select",t[3]),{c(){e=nt("div"),Mt(i.$$.fragment),n=Et(),Mt(s.$$.fragment)},m(c,r){Se(c,e,r),Ot(i,e,null),Ze(e,n),Ot(s,e,null),l=!0},p:ki,i(c){l||(ae(i.$$.fragment,c),ae(s.$$.fragment,c),l=!0)},o(c){pe(i.$$.fragment,c),pe(s.$$.fragment,c),l=!1},d(c){c&&Te(e),Ct(i),Ct(s)}}}function xR(t){let e=null,i=null,n=[{id:"2024",text:"2024"},{id:"2023",text:"2023"},{id:"2022",text:"2022"},{id:"2021",text:"2021"},{id:"2020",text:"2020"},{id:"2019",text:"2019"},{id:"2018",text:"2018"},{id:"2017",text:"2017"},{id:"2016",text:"2016"},{id:"2015",text:"2015"},{id:"2014",text:"2014"}],s=[{id:"1",text:"Januar"},{id:"2",text:"Februar"},{id:"3",text:"Mart"},{id:"4",text:"April"},{id:"5",text:"Maj"},{id:"6",text:"Jun"},{id:"7",text:"Jul"},{id:"8",text:"Avgust"},{id:"9",text:"Septembar"},{id:"10",text:"Oktobar"},{id:"11",text:"Novembar"},{id:"12",text:"Decembar"}];function l(r){e=r.detail.selectedItem,Eo.setNestedPropToValue(["start","year",parseInt(e.id)])}function c(r){i=r.detail.selectedItem,Eo.setNestedPropToValue(["start","month",parseInt(i.id)])}return[n,s,l,c]}class wR extends Ri{constructor(e){super(),Di(this,e,xR,bR,Ci,{})}}function AR(t){let e,i,n,s,l;return i=new eu({props:{selectedId:"-",titleText:Wn.year,size:"sm",items:t[0]}}),i.$on("select",t[2]),s=new eu({props:{selectedId:"-",titleText:Wn.month,size:"sm",items:t[1]}}),s.$on("select",t[3]),{c(){e=nt("div"),Mt(i.$$.fragment),n=Et(),Mt(s.$$.fragment)},m(c,r){Se(c,e,r),Ot(i,e,null),Ze(e,n),Ot(s,e,null),l=!0},p:ki,i(c){l||(ae(i.$$.fragment,c),ae(s.$$.fragment,c),l=!0)},o(c){pe(i.$$.fragment,c),pe(s.$$.fragment,c),l=!1},d(c){c&&Te(e),Ct(i),Ct(s)}}}function ER(t){let e=[{id:"-",text:"-"},{id:"2024",text:"2024"},{id:"2023",text:"2023"},{id:"2022",text:"2022"},{id:"2021",text:"2021"},{id:"2020",text:"2020"},{id:"2019",text:"2019"},{id:"2018",text:"2018"},{id:"2017",text:"2017"},{id:"2016",text:"2016"},{id:"2015",text:"2015"},{id:"2014",text:"2014"}],i=[{id:"-",text:"-"},{id:"1",text:"Januar"},{id:"2",text:"Februar"},{id:"3",text:"Mart"},{id:"4",text:"April"},{id:"5",text:"Maj"},{id:"6",text:"Jun"},{id:"7",text:"Jul"},{id:"8",text:"Avgust"},{id:"9",text:"Septembar"},{id:"10",text:"Oktobar"},{id:"11",text:"Novembar"},{id:"12",text:"Decembar"}];function n(l){l.detail.selectedItem}function s(l){l.detail.selectedItem}return[e,i,n,s]}class TR extends Ri{constructor(e){super(),Di(this,e,ER,AR,Ci,{})}}function SR(t){let e,i,n,s,l,c;function r(b){t[3](b)}let f={labelText:Wn.old_housing,name:"old_housing"};t[0]!==void 0&&(f.checked=t[0]),e=new E_({props:f}),sn.push(()=>Fa(e,"checked",r)),e.$on("change",t[2]);function m(b){t[4](b)}let y={labelText:Wn.new_housing,name:"new_housing"};return t[1]!==void 0&&(y.checked=t[1]),s=new E_({props:y}),sn.push(()=>Fa(s,"checked",m)),s.$on("change",t[2]),{c(){Mt(e.$$.fragment),n=Et(),Mt(s.$$.fragment)},m(b,E){Ot(e,b,E),Se(b,n,E),Ot(s,b,E),c=!0},p(b,[E]){const S={};!i&&E&1&&(i=!0,S.checked=b[0],Va(()=>i=!1)),e.$set(S);const D={};!l&&E&2&&(l=!0,D.checked=b[1],Va(()=>l=!1)),s.$set(D)},i(b){c||(ae(e.$$.fragment,b),ae(s.$$.fragment,b),c=!0)},o(b){pe(e.$$.fragment,b),pe(s.$$.fragment,b),c=!1},d(b){b&&Te(n),Ct(e,b),Ct(s,b)}}}function IR(t,e,i){let n;Ln(t,Eo,m=>i(5,n=m));let s=n.old_housing,l=n.new_housing;function c(m){Eo.setPropToValue([m.target.name,m.target.checked])}function r(m){s=m,i(0,s)}function f(m){l=m,i(1,l)}return[s,l,c,r,f]}class kR extends Ri{constructor(e){super(),Di(this,e,IR,SR,Ci,{})}}function Fx(t){let e,i;return{c(){e=Ji("title"),i=gi(t[1])},m(n,s){Se(n,e,s),Ze(e,i)},p(n,s){s&2&&Si(i,n[1])},d(n){n&&Te(e)}}}function OR(t){let e,i,n=t[1]&&Fx(t),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:t[0]},{height:t[0]},t[2],t[3]],l={};for(let c=0;c<s.length;c+=1)l=Ye(l,s[c]);return{c(){e=Ji("svg"),n&&n.c(),i=Ji("path"),je(i,"d","M18,28H14a2,2,0,0,1-2-2V18.41L4.59,11A2,2,0,0,1,4,9.59V6A2,2,0,0,1,6,4H26a2,2,0,0,1,2,2V9.59A2,2,0,0,1,27.41,11L20,18.41V26A2,2,0,0,1,18,28ZM6,6V9.59l8,8V26h4V17.59l8-8V6Z"),Pn(e,l)},m(c,r){Se(c,e,r),n&&n.m(e,null),Ze(e,i)},p(c,[r]){c[1]?n?n.p(c,r):(n=Fx(c),n.c(),n.m(e,i)):n&&(n.d(1),n=null),Pn(e,l=Ni(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},r&1&&{width:c[0]},r&1&&{height:c[0]},r&4&&c[2],r&8&&c[3]]))},i:ki,o:ki,d(c){c&&Te(e),n&&n.d()}}}function CR(t,e,i){let n,s;const l=["size","title"];let c=Ut(e,l),{size:r=16}=e,{title:f=void 0}=e;return t.$$set=m=>{i(5,e=Ye(Ye({},e),fi(m))),i(3,c=Ut(e,l)),"size"in m&&i(0,r=m.size),"title"in m&&i(1,f=m.title)},t.$$.update=()=>{i(4,n=e["aria-label"]||e["aria-labelledby"]||f),i(2,s={"aria-hidden":n?void 0:!0,role:n?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=fi(e),[r,f,s,c,n]}class MR extends Ri{constructor(e){super(),Di(this,e,CR,OR,Ci,{size:0,title:1})}}var Jc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function DR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function RR(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var i=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(i,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),i}var M_={exports:{}};(function(t,e){(function(i,n){n(e)})(Jc,function(i){var n=typeof window<"u"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},s={weekdays:{shorthand:["Ned","Pon","Uto","Sre","et","Pet","Sub"],longhand:["Nedelja","Ponedeljak","Utorak","Sreda","etvrtak","Petak","Subota"]},months:{shorthand:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],longhand:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"]},firstDayOfWeek:1,weekAbbreviation:"Ned.",rangeSeparator:" do ",time_24hr:!0};n.l10ns.sr=s;var l=n.l10ns;i.Serbian=s,i.default=l,Object.defineProperty(i,"__esModule",{value:!0})})})(M_,M_.exports);var LR=M_.exports;function PR(t){let e=Wn.filter+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p:ki,d(n){n&&Te(i)}}}function NR(t){let e,i;return e=new nu({props:{icon:MR,kind:"secondary",$$slots:{default:[PR]},$$scope:{ctx:t}}}),e.$on("click",t[6]),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s&131072&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function zR(t){let e,i;return e=new t3({props:{$$slots:{default:[NR]},$$scope:{ctx:t}}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s&131076&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function BR(t){let e,i;return e=new QM({props:{$$slots:{default:[zR]},$$scope:{ctx:t}}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s&131076&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function VR(t){let e;return{c(){e=nt("strong"),e.textContent=`${Wn.table_name}`,je(e,"slot","title")},m(i,n){Se(i,e,n)},p:ki,d(i){i&&Te(e)}}}function FR(t){let e;return{c(){e=nt("span"),e.textContent=`${Wn.table_description}`,je(e,"slot","description"),Ml(e,"font-size","1rem")},m(i,n){Se(i,e,n)},p:ki,d(i){i&&Te(e)}}}function UR(t){let e,i,n,s;return e=new wb({props:{labelText:Wn.modal.date_from,placeholder:"mm/dd/yyyy"}}),n=new wb({props:{labelText:Wn.modal.date_to,placeholder:"mm/dd/yyyy"}}),{c(){Mt(e.$$.fragment),i=Et(),Mt(n.$$.fragment)},m(l,c){Ot(e,l,c),Se(l,i,c),Ot(n,l,c),s=!0},p:ki,i(l){s||(ae(e.$$.fragment,l),ae(n.$$.fragment,l),s=!0)},o(l){pe(e.$$.fragment,l),pe(n.$$.fragment,l),s=!1},d(l){l&&Te(i),Ct(e,l),Ct(n,l)}}}function jR(t){let e,i,n,s,l,c,r,f,m,y,b,E,S,D,R,z,H,K,W,se,Y,ne={datePickerType:"range",flatpickrProps:t[5],$$slots:{default:[UR]},$$scope:{ctx:t}};return e=new f3({props:ne}),t[9](e),e.$on("change",t[10]),n=new Hb({props:{titleText:Wn.modal.options,label:Wn.modal.filter_table,style:"width:25%",items:[{id:"0",text:"Slack"},{id:"1",text:"Email"},{id:"2",text:"Fax"}]}}),l=new Hb({props:{titleText:"Contact",label:"Select contact methods...",items:[{id:"0",text:"Slack"},{id:"1",text:"Email"},{id:"2",text:"Fax"}]}}),f=new Gu({props:{min:4,max:20,value:4,invalidText:"Number must be between 4 and 20.",helperText:"Clusters provisioned in your region",label:"Clusters (4 min, 20 max)",hideSteppers:!0,style:"width:25%"}}),y=new Gu({props:{min:4,max:20,value:4,invalidText:"Number must be between 4 and 20.",helperText:"Clusters provisioned in your region",label:"Clusters (4 min, 20 max)",hideSteppers:!0,style:"width:25%"}}),S=new Gu({props:{min:4,max:20,value:4,invalidText:"Number must be between 4 and 20.",helperText:"Clusters provisioned in your region",label:"Clusters (4 min, 20 max)",hideSteppers:!0,style:"width:25%"}}),R=new Gu({props:{min:4,max:20,value:4,invalidText:"Number must be between 4 and 20.",helperText:"Clusters provisioned in your region",label:"Clusters (4 min, 20 max)",hideSteppers:!0,style:"width:25%"}}),K=new Gu({props:{min:4,max:20,value:4,invalidText:"Number must be between 4 and 20.",helperText:"Clusters provisioned in your region",label:"Clusters (4 min, 20 max)",hideSteppers:!0,style:"width:25%"}}),se=new Gu({props:{min:4,max:20,value:4,invalidText:"Number must be between 4 and 20.",helperText:"Clusters provisioned in your region",label:"Clusters (4 min, 20 max)",hideSteppers:!0,style:"width:25%"}}),{c(){Mt(e.$$.fragment),i=Et(),Mt(n.$$.fragment),s=Et(),Mt(l.$$.fragment),c=Et(),r=nt("div"),Mt(f.$$.fragment),m=Et(),Mt(y.$$.fragment),b=Et(),E=nt("div"),Mt(S.$$.fragment),D=Et(),Mt(R.$$.fragment),z=Et(),H=nt("div"),Mt(K.$$.fragment),W=Et(),Mt(se.$$.fragment),je(r,"class","flex-row-start svelte-uoagfr"),je(E,"class","flex-row-start svelte-uoagfr"),je(H,"class","flex-row-start svelte-uoagfr")},m(ue,ve){Ot(e,ue,ve),Se(ue,i,ve),Ot(n,ue,ve),Se(ue,s,ve),Ot(l,ue,ve),Se(ue,c,ve),Se(ue,r,ve),Ot(f,r,null),Ze(r,m),Ot(y,r,null),Se(ue,b,ve),Se(ue,E,ve),Ot(S,E,null),Ze(E,D),Ot(R,E,null),Se(ue,z,ve),Se(ue,H,ve),Ot(K,H,null),Ze(H,W),Ot(se,H,null),Y=!0},p(ue,ve){const _e={};ve&131072&&(_e.$$scope={dirty:ve,ctx:ue}),e.$set(_e)},i(ue){Y||(ae(e.$$.fragment,ue),ae(n.$$.fragment,ue),ae(l.$$.fragment,ue),ae(f.$$.fragment,ue),ae(y.$$.fragment,ue),ae(S.$$.fragment,ue),ae(R.$$.fragment,ue),ae(K.$$.fragment,ue),ae(se.$$.fragment,ue),Y=!0)},o(ue){pe(e.$$.fragment,ue),pe(n.$$.fragment,ue),pe(l.$$.fragment,ue),pe(f.$$.fragment,ue),pe(y.$$.fragment,ue),pe(S.$$.fragment,ue),pe(R.$$.fragment,ue),pe(K.$$.fragment,ue),pe(se.$$.fragment,ue),Y=!1},d(ue){ue&&(Te(i),Te(s),Te(c),Te(r),Te(b),Te(E),Te(z),Te(H)),t[9](null),Ct(e,ue),Ct(n,ue),Ct(l,ue),Ct(f),Ct(y),Ct(S),Ct(R),Ct(K),Ct(se)}}}function GR(t){let e,i,n,s,l,c,r,f,m;e=new YM({props:{size:"short",zebra:!0,sortable:!0,pageSize:t[3],page:t[4],headers:[{key:"datum",value:Wn.table_headers.date},{key:"tip_gradnje",value:Wn.table_headers.type},{key:"cena",value:Wn.table_headers.price},{key:"stanovi_pov",value:Wn.table_headers.appt_size},{key:"parking_pov",value:Wn.table_headers.parking_size},{key:"stan_kat_velicine",value:Wn.table_headers.room_number},{key:"cena_kvm",value:Wn.table_headers.price_per_sqm}],rows:t[0],$$slots:{description:[FR],title:[VR],default:[BR]},$$scope:{ctx:t}}});function y(R){t[7](R)}function b(R){t[8](R)}let E={totalItems:t[0].length,pageSizeInputDisabled:!0};t[3]!==void 0&&(E.pageSize=t[3]),t[4]!==void 0&&(E.page=t[4]),n=new PD({props:E}),sn.push(()=>Fa(n,"pageSize",y)),sn.push(()=>Fa(n,"page",b));function S(R){t[11](R)}let D={modalHeading:Wn.modal.filter_table,primaryButtonText:"Confirm",secondaryButtonText:"Cancel",hasScrollingContent:!0,$$slots:{default:[jR]},$$scope:{ctx:t}};return t[2]!==void 0&&(D.open=t[2]),r=new eD({props:D}),sn.push(()=>Fa(r,"open",S)),r.$on("click:button--secondary",t[12]),r.$on("open",t[13]),r.$on("close",t[14]),r.$on("submit",t[15]),{c(){Mt(e.$$.fragment),i=Et(),Mt(n.$$.fragment),c=Et(),Mt(r.$$.fragment)},m(R,z){Ot(e,R,z),Se(R,i,z),Ot(n,R,z),Se(R,c,z),Ot(r,R,z),m=!0},p(R,[z]){const H={};z&8&&(H.pageSize=R[3]),z&16&&(H.page=R[4]),z&1&&(H.rows=R[0]),z&131076&&(H.$$scope={dirty:z,ctx:R}),e.$set(H);const K={};z&1&&(K.totalItems=R[0].length),!s&&z&8&&(s=!0,K.pageSize=R[3],Va(()=>s=!1)),!l&&z&16&&(l=!0,K.page=R[4],Va(()=>l=!1)),n.$set(K);const W={};z&131074&&(W.$$scope={dirty:z,ctx:R}),!f&&z&4&&(f=!0,W.open=R[2],Va(()=>f=!1)),r.$set(W)},i(R){m||(ae(e.$$.fragment,R),ae(n.$$.fragment,R),ae(r.$$.fragment,R),m=!0)},o(R){pe(e.$$.fragment,R),pe(n.$$.fragment,R),pe(r.$$.fragment,R),m=!1},d(R){R&&(Te(i),Te(c)),Ct(e,R),Ct(n,R),Ct(r,R)}}}function HR(t,e,i){let n,s={dateFormat:"d-m-Y"};Pl(()=>{let W=document.getElementById("main-content");W.style.padding="1rem";let se=[...document.getElementsByClassName("bx--form-item")];for(let ne of se)ne.style.flexGrow=0,ne.style.flexShrink=0,ne.style.flexBasis="unset";let Y=[...document.getElementsByClassName("bx--multi-select")];for(let ne of Y)ne.style.width="40%";Qr(n,{locale:LR.Serbian})});let{contracts:l}=e,c=!1,r=20,f=1;const m=()=>i(2,c=!0);function y(W){r=W,i(3,r)}function b(W){f=W,i(4,f)}function E(W){sn[W?"unshift":"push"](()=>{n=W,i(1,n)})}function S(W){At.call(this,t,W)}function D(W){c=W,i(2,c)}const R=()=>i(2,c=!1);function z(W){At.call(this,t,W)}function H(W){At.call(this,t,W)}function K(W){At.call(this,t,W)}return t.$$set=W=>{"contracts"in W&&i(0,l=W.contracts)},t.$$.update=()=>{t.$$.dirty&1},[l,n,c,r,f,s,m,y,b,E,S,D,R,z,H,K]}class KR extends Ri{constructor(e){super(),Di(this,e,HR,GR,Ci,{contracts:0})}}var UA=(t=>(t.RENDER_FINISHED="render-finished",t.RESIZE="chart-resize",t.MOUSEOVER="chart-mouseover",t.MOUSEOUT="chart-mouseout",t))(UA||{}),jA=(t=>(t.SHOW="show-modal",t.HIDE="hide-modal",t))(jA||{}),GA=(t=>(t.UPDATE="model-update",t))(GA||{}),HA=(t=>(t.SHOW_OVERFLOW_MENU="show-toolbar-overflow-menu",t.HIDE_OVERFLOW_MENU="hide-toolbar-overflow-menu",t.BUTTON_CLICK="toolbar-button-click",t))(HA||{}),KA=(t=>(t.UPDATE="zoom-bar-update",t.SELECTION_START="zoom-bar-selection-start",t.SELECTION_IN_PROGRESS="zoom-bar-selection-in-progress",t.SELECTION_END="zoom-bar-selection-end",t))(KA||{}),qA=(t=>(t.CHANGE="zoom-domain-change",t))(qA||{}),ZA=(t=>(t.CANVAS_ZOOM_IN="canvas-zoom-in",t.CANVAS_ZOOM_OUT="canvas-zoom-out",t))(ZA||{}),WA=(t=>(t.LABEL_MOUSEOVER="axis-label-mouseover",t.LABEL_MOUSEMOVE="axis-label-mousemove",t.LABEL_CLICK="axis-label-click",t.LABEL_MOUSEOUT="axis-label-mouseout",t.LABEL_FOCUS="axis-label-focus",t.LABEL_BLUR="axis-label-blur",t.RENDER_COMPLETE="axis-render-complete",t))(WA||{}),YA=(t=>(t.POINT_MOUSEOVER="scatter-mouseover",t.POINT_MOUSEMOVE="scatter-mousemove",t.POINT_CLICK="scatter-click",t.POINT_MOUSEOUT="scatter-mouseout",t))(YA||{}),JA=(t=>(t.WORD_MOUSEOVER="wordcloud-word-mouseover",t.WORD_MOUSEMOVE="wordcloud-word-mousemove",t.WORD_CLICK="wordcloud-word-click",t.WORD_MOUSEOUT="wordcloud-word-mouseout",t))(JA||{}),XA=(t=>(t.SLICE_MOUSEOVER="pie-slice-mouseover",t.SLICE_MOUSEMOVE="pie-slice-mousemove",t.SLICE_CLICK="pie-slice-click",t.SLICE_MOUSEOUT="pie-slice-mouseout",t))(XA||{}),QA=(t=>(t.ARC_MOUSEOVER="gauge-arc-mouseover",t.ARC_MOUSEMOVE="gauge-arc-mousemove",t.ARC_CLICK="gauge-arc-click",t.ARC_MOUSEOUT="gauge-arc-mouseout",t))(QA||{}),$A=(t=>(t.BAR_MOUSEOVER="bar-mouseover",t.BAR_MOUSEMOVE="bar-mousemove",t.BAR_CLICK="bar-click",t.BAR_MOUSEOUT="bar-mouseout",t))($A||{}),eE=(t=>(t.BOX_MOUSEOVER="box-mouseover",t.BOX_MOUSEMOVE="box-mousemove",t.BOX_CLICK="box-click",t.BOX_MOUSEOUT="box-mouseout",t.OUTLIER_MOUSEOVER="outlier-mouseover",t.OUTLIER_MOUSEMOVE="outlier-mousemove",t.OUTLIER_CLICK="outlier-click",t.OUTLIER_MOUSEOUT="outlier-mouseout",t))(eE||{}),tE=(t=>(t.SCATTER_MOUSEOVER="scatter-mouseover",t.SCATTER_MOUSEMOVE="scatter-mousemove",t.SCATTER_CLICK="scatter-click",t.SCATTER_MOUSEOUT="scatter-mouseout",t))(tE||{}),iE=(t=>(t.POINT_MOUSEOVER="scatter-mouseover",t.POINT_MOUSEMOVE="scatter-mousemove",t.POINT_CLICK="scatter-click",t.POINT_MOUSEOUT="scatter-mouseout",t))(iE||{}),nE=(t=>(t.X_AXIS_MOUSEOVER="radar-x-axis-mouseover",t.X_AXIS_MOUSEMOVE="radar-x-axis-mousemove",t.X_AXIS_CLICK="radar-x-axis-click",t.X_AXIS_MOUSEOUT="radar-x-axis-mouseout",t))(nE||{}),rE=(t=>(t.NODE_MOUSEOVER="tree-node-mouseover",t.NODE_CLICK="tree-node-click",t.NODE_MOUSEOUT="tree-node-mouseout",t))(rE||{}),sE=(t=>(t.LEAF_MOUSEOVER="leaf-mouseover",t.LEAF_MOUSEMOVE="leaf-mousemove",t.LEAF_CLICK="leaf-click",t.LEAF_MOUSEOUT="leaf-mouseout",t))(sE||{}),aE=(t=>(t.SHOW="show-tooltip",t.MOVE="move-tooltip",t.HIDE="hide-tooltip",t))(aE||{}),oE=(t=>(t.SHOW="show-threshold",t.HIDE="hide-threshold",t))(oE||{}),lE=(t=>(t.ITEM_HOVER="legend-item-onhover",t.ITEM_CLICK="legend-item-onclick",t.ITEM_MOUSEOUT="legend-item-onmouseout",t.ITEMS_UPDATE="legend-items-update",t))(lE||{}),cE=(t=>(t.CIRCLE_MOUSEOVER="circle-leaf-mouseover",t.CIRCLE_CLICK="circle-leaf-click",t.CIRCLE_MOUSEOUT="circle-leaf-mouseout",t.CIRCLE_MOUSEMOVE="circle-leaf-mousemove",t))(cE||{}),uE=(t=>(t.NODE_MOUSEOVER="alluvial-node-mouseover",t.NODE_CLICK="alluvial-node-click",t.NODE_MOUSEOUT="alluvial-node-mouseout",t.NODE_MOUSEMOVE="alluvial-node-mousemove",t.LINE_MOUSEOVER="alluvial-line-mouseover",t.LINE_CLICK="alluvial-line-click",t.LINE_MOUSEOUT="alluvial-line-mouseout",t.LINE_MOUSEMOVE="alluvial-line-mousemove",t))(uE||{}),hE=(t=>(t.METER_MOUSEOVER="meter-mouseover",t.METER_CLICK="meter-click",t.METER_MOUSEOUT="meter-mouseout",t.METER_MOUSEMOVE="meter-mousemove",t))(hE||{}),dE=(t=>(t.HEATMAP_MOUSEOVER="heatmap-mouseover",t.HEATMAP_CLICK="heatmap-click",t.HEATMAP_MOUSEOUT="heatmap-mouseout",t.HEATMAP_MOUSEMOVE="hetmap-mousemove",t))(dE||{}),fE=(t=>(t.CHOROPLETH_MOUSEOVER="choropleth-mouseover",t.CHOROPLETH_CLICK="choropleth-click",t.CHOROPLETH_MOUSEOUT="choropleth-mouseout",t.CHOROPLETH_MOUSEMOVE="choropleth-mousemove",t))(fE||{});const qR=Object.freeze(Object.defineProperty({__proto__:null,Alluvial:uE,Area:YA,Axis:WA,Bar:$A,Boxplot:eE,CanvasZoom:ZA,Chart:UA,Choropleth:fE,CirclePack:cE,Gauge:QA,Heatmap:dE,Legend:lE,Line:iE,Meter:hE,Modal:jA,Model:GA,Pie:XA,Radar:nE,Scatter:tE,Threshold:oE,Toolbar:HA,Tooltip:aE,Tree:rE,Treemap:sE,WordCloud:JA,ZoomBar:KA,ZoomDomain:qA},Symbol.toStringTag,{value:"Module"})),yt=qR;var Yn=(t=>(t.HTML="html",t.SVG="svg",t))(Yn||{}),mE=(t=>(t.WHITE="white",t.G100="g100",t.G90="g90",t.G10="g10",t))(mE||{}),Cs=(t=>(t.BACKGROUND="background",t.FILL="fill",t.STROKE="stroke",t.TOOLTIP="tooltip",t))(Cs||{}),Ft=(t=>(t.LEFT="left",t.RIGHT="right",t.TOP="top",t.BOTTOM="bottom",t))(Ft||{}),Yo=(t=>(t.GRAPH_VIEW="graph_view",t.SLIDER_VIEW="slider_view",t))(Yo||{}),Io=(t=>(t.END_LINE="end_line",t.MID_LINE="mid_line",t.FRONT_LINE="front_line",t.NONE="none",t))(Io||{}),wa=(t=>(t.VERTICAL="vertical",t.HORIZONTAL="horizontal",t))(wa||{}),Hi=(t=>(t.TIME="time",t.LINEAR="linear",t.LOG="log",t.LABELS="labels",t.LABELS_RATIO="labels-ratio",t))(Hi||{}),Fd=(t=>(t.RIGHT="right",t.LEFT="left",t.TOP="top",t.BOTTOM="bottom",t))(Fd||{}),Oo=(t=>(t.LEFT="left",t.CENTER="center",t.RIGHT="right",t))(Oo||{}),Yd=(t=>(t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t))(Yd||{}),pE=(t=>(t.TREE="tree",t.DENDROGRAM="dendrogram",t))(pE||{}),os=(t=>(t.ROW="row",t.COLUMN="column",t.ROW_REVERSE="row-reverse",t.COLUMN_REVERSE="column-reverse",t))(os||{}),yr=(t=>(t.FIXED="fixed",t.PREFERRED="preferred",t.STRETCH="stretch",t))(yr||{}),gp=(t=>(t.CENTER="center",t))(gp||{}),rh=(t=>(t.GRID="grid",t.VERT_OR_HORIZ="vertOrHoriz",t.PIE="pie",t.DONUT="donut",t))(rh||{}),gE=(t=>(t.SEMI="semi",t.FULL="full",t))(gE||{}),vm=(t=>(t.ALWAYS="always",t.AUTO="auto",t.NEVER="never",t))(vm||{}),bc=(t=>(t.SCATTER="scatter",t.LINE="line",t.SIMPLE_BAR="simple-bar",t.STACKED_BAR="stacked-bar",t.GROUPED_BAR="grouped-bar",t.AREA="area",t.STACKED_AREA="stacked-area",t))(bc||{}),Pr=(t=>(t.EXPORT_CSV="Export as CSV",t.EXPORT_PNG="Export as PNG",t.EXPORT_JPG="Export as JPG",t.ZOOM_IN="Zoom in",t.ZOOM_OUT="Zoom out",t.RESET_ZOOM="Reset zoom",t.MAKE_FULLSCREEN="Make fullscreen",t.SHOW_AS_DATATABLE="Show as data-table",t.CUSTOM="Custom",t))(Pr||{}),D_=(t=>(t.LEFT="left",t.RIGHT="right",t))(D_||{}),ys=(t=>(t.CHECKBOX="checkbox",t.RADIUS="radius",t.AREA="area",t.SIZE="size",t.LINE="line",t.QUARTILE="quartile",t.ZOOM="zoom",t))(ys||{}),_E=(t=>(t.ON="on",t.AUTO="auto",t.OFF="off",t))(_E||{}),R0=(t=>(t.DEFAULT="default",t.HOVERABLE="hoverable",t))(R0||{}),yE=(t=>(t.geoEqualEarth="geoEqualEarth",t.geoAlbers="geoAlbers",t.geoConicEqualArea="geoConicEqualArea",t.geoConicEquidistant="geoConicEquidistant",t.geoEquirectangular="geoEquirectangular",t.geoMercator="geoMercator",t.geoNaturalEarth1="geoNaturalEarth1",t))(yE||{});function bm(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ZR(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function L0(t){let e,i,n;t.length!==2?(e=bm,i=(r,f)=>bm(t(r),f),n=(r,f)=>t(r)-f):(e=t===bm||t===ZR?t:WR,i=t,n=t);function s(r,f,m=0,y=r.length){if(m<y){if(e(f,f)!==0)return y;do{const b=m+y>>>1;i(r[b],f)<0?m=b+1:y=b}while(m<y)}return m}function l(r,f,m=0,y=r.length){if(m<y){if(e(f,f)!==0)return y;do{const b=m+y>>>1;i(r[b],f)<=0?m=b+1:y=b}while(m<y)}return m}function c(r,f,m=0,y=r.length){const b=s(r,f,m,y-1);return b>m&&n(r[b-1],f)>-n(r[b],f)?b-1:b}return{left:s,center:c,right:l}}function WR(){return 0}function YR(t){return t===null?NaN:+t}const JR=L0(bm),vE=JR.right;L0(YR).center;function XR(t,e){let i=0;if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&++i;else{let n=-1;for(let s of t)(s=e(s,++n,t))!=null&&(s=+s)>=s&&++i}return i}function dh(t,e){let i,n;if(e===void 0)for(const s of t)s!=null&&(i===void 0?s>=s&&(i=n=s):(i>s&&(i=s),n<s&&(n=s)));else{let s=-1;for(let l of t)(l=e(l,++s,t))!=null&&(i===void 0?l>=l&&(i=n=l):(i>l&&(i=l),n<l&&(n=l)))}return[i,n]}class Ux extends Map{constructor(e,i=eL){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),e!=null)for(const[n,s]of e)this.set(n,s)}get(e){return super.get(jx(this,e))}has(e){return super.has(jx(this,e))}set(e,i){return super.set(QR(this,e),i)}delete(e){return super.delete($R(this,e))}}function jx({_intern:t,_key:e},i){const n=e(i);return t.has(n)?t.get(n):i}function QR({_intern:t,_key:e},i){const n=e(i);return t.has(n)?t.get(n):(t.set(n,i),i)}function $R({_intern:t,_key:e},i){const n=e(i);return t.has(n)&&(i=t.get(n),t.delete(n)),i}function eL(t){return t!==null&&typeof t=="object"?t.valueOf():t}function tL(t){return t}var iL=Array.prototype,nL=iL.slice;function Bg(t){return()=>t}const rL=Math.sqrt(50),sL=Math.sqrt(10),aL=Math.sqrt(2);function Bm(t,e,i){const n=(e-t)/Math.max(0,i),s=Math.floor(Math.log10(n)),l=n/Math.pow(10,s),c=l>=rL?10:l>=sL?5:l>=aL?2:1;let r,f,m;return s<0?(m=Math.pow(10,-s)/c,r=Math.round(t*m),f=Math.round(e*m),r/m<t&&++r,f/m>e&&--f,m=-m):(m=Math.pow(10,s)*c,r=Math.round(t/m),f=Math.round(e/m),r*m<t&&++r,f*m>e&&--f),f<r&&.5<=i&&i<2?Bm(t,e,i*2):[r,f,m]}function Vm(t,e,i){if(e=+e,t=+t,i=+i,!(i>0))return[];if(t===e)return[t];const n=e<t,[s,l,c]=n?Bm(e,t,i):Bm(t,e,i);if(!(l>=s))return[];const r=l-s+1,f=new Array(r);if(n)if(c<0)for(let m=0;m<r;++m)f[m]=(l-m)/-c;else for(let m=0;m<r;++m)f[m]=(l-m)*c;else if(c<0)for(let m=0;m<r;++m)f[m]=(s+m)/-c;else for(let m=0;m<r;++m)f[m]=(s+m)*c;return f}function vh(t,e,i){return e=+e,t=+t,i=+i,Bm(t,e,i)[2]}function R_(t,e,i){e=+e,t=+t,i=+i;const n=e<t,s=n?vh(e,t,i):vh(t,e,i);return(n?-1:1)*(s<0?1/-s:s)}function oL(t,e,i){let n;for(;;){const s=vh(t,e,i);if(s===n||s===0||!isFinite(s))return[t,e];s>0?(t=Math.floor(t/s)*s,e=Math.ceil(e/s)*s):s<0&&(t=Math.ceil(t*s)/s,e=Math.floor(e*s)/s),n=s}}function lL(t){return Math.max(1,Math.ceil(Math.log(XR(t))/Math.LN2)+1)}function cL(){var t=tL,e=dh,i=lL;function n(s){Array.isArray(s)||(s=Array.from(s));var l,c=s.length,r,f,m=new Array(c);for(l=0;l<c;++l)m[l]=t(s[l],l,s);var y=e(m),b=y[0],E=y[1],S=i(m,b,E);if(!Array.isArray(S)){const W=E,se=+S;if(e===dh&&([b,E]=oL(b,E,se)),S=Vm(b,E,se),S[0]<=b&&(f=vh(b,E,se)),S[S.length-1]>=E)if(W>=E&&e===dh){const Y=vh(b,E,se);isFinite(Y)&&(Y>0?E=(Math.floor(E/Y)+1)*Y:Y<0&&(E=(Math.ceil(E*-Y)+1)/-Y))}else S.pop()}for(var D=S.length,R=0,z=D;S[R]<=b;)++R;for(;S[z-1]>E;)--z;(R||z<D)&&(S=S.slice(R,z),D=z-R);var H=new Array(D+1),K;for(l=0;l<=D;++l)K=H[l]=[],K.x0=l>0?S[l-1]:b,K.x1=l<D?S[l]:E;if(isFinite(f)){if(f>0)for(l=0;l<c;++l)(r=m[l])!=null&&b<=r&&r<=E&&H[Math.min(D,Math.floor((r-b)/f))].push(s[l]);else if(f<0){for(l=0;l<c;++l)if((r=m[l])!=null&&b<=r&&r<=E){const W=Math.floor((b-r)*f);H[Math.min(D,W+(S[W]<=r))].push(s[l])}}}else for(l=0;l<c;++l)(r=m[l])!=null&&b<=r&&r<=E&&H[vE(S,r,0,D)].push(s[l]);return H}return n.value=function(s){return arguments.length?(t=typeof s=="function"?s:Bg(s),n):t},n.domain=function(s){return arguments.length?(e=typeof s=="function"?s:Bg([s[0],s[1]]),n):e},n.thresholds=function(s){return arguments.length?(i=typeof s=="function"?s:Bg(Array.isArray(s)?nL.call(s):s),n):i},n}function uL(t,e){let i;if(e===void 0)for(const n of t)n!=null&&(i<n||i===void 0&&n>=n)&&(i=n);else{let n=-1;for(let s of t)(s=e(s,++n,t))!=null&&(i<s||i===void 0&&s>=s)&&(i=s)}return i}function hL(t,e){let i;if(e===void 0)for(const n of t)n!=null&&(i>n||i===void 0&&n>=n)&&(i=n);else{let n=-1;for(let s of t)(s=e(s,++n,t))!=null&&(i>s||i===void 0&&s>=s)&&(i=s)}return i}function dL(t,e,i){t=+t,e=+e,i=(s=arguments.length)<2?(e=t,t=0,1):s<3?1:+i;for(var n=-1,s=Math.max(0,Math.ceil((e-t)/i))|0,l=new Array(s);++n<s;)l[n]=t+n*i;return l}function fL(t){return t}var xm=1,wm=2,L_=3,Dd=4,Gx=1e-6;function mL(t){return"translate("+t+",0)"}function pL(t){return"translate(0,"+t+")"}function gL(t){return e=>+t(e)}function _L(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),i=>+t(i)+e}function yL(){return!this.__axis}function _p(t,e){var i=[],n=null,s=null,l=6,c=6,r=3,f=typeof window<"u"&&window.devicePixelRatio>1?0:.5,m=t===xm||t===Dd?-1:1,y=t===Dd||t===wm?"x":"y",b=t===xm||t===L_?mL:pL;function E(S){var D=n??(e.ticks?e.ticks.apply(e,i):e.domain()),R=s??(e.tickFormat?e.tickFormat.apply(e,i):fL),z=Math.max(l,0)+r,H=e.range(),K=+H[0]+f,W=+H[H.length-1]+f,se=(e.bandwidth?_L:gL)(e.copy(),f),Y=S.selection?S.selection():S,ne=Y.selectAll(".domain").data([null]),ue=Y.selectAll(".tick").data(D,e).order(),ve=ue.exit(),_e=ue.enter().append("g").attr("class","tick"),oe=ue.select("line"),Be=ue.select("text");ne=ne.merge(ne.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),ue=ue.merge(_e),oe=oe.merge(_e.append("line").attr("stroke","currentColor").attr(y+"2",m*l)),Be=Be.merge(_e.append("text").attr("fill","currentColor").attr(y,m*z).attr("dy",t===xm?"0em":t===L_?"0.71em":"0.32em")),S!==Y&&(ne=ne.transition(S),ue=ue.transition(S),oe=oe.transition(S),Be=Be.transition(S),ve=ve.transition(S).attr("opacity",Gx).attr("transform",function(mt){return isFinite(mt=se(mt))?b(mt+f):this.getAttribute("transform")}),_e.attr("opacity",Gx).attr("transform",function(mt){var Le=this.parentNode.__axis;return b((Le&&isFinite(Le=Le(mt))?Le:se(mt))+f)})),ve.remove(),ne.attr("d",t===Dd||t===wm?c?"M"+m*c+","+K+"H"+f+"V"+W+"H"+m*c:"M"+f+","+K+"V"+W:c?"M"+K+","+m*c+"V"+f+"H"+W+"V"+m*c:"M"+K+","+f+"H"+W),ue.attr("opacity",1).attr("transform",function(mt){return b(se(mt)+f)}),oe.attr(y+"2",m*l),Be.attr(y,m*z).text(R),Y.filter(yL).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===wm?"start":t===Dd?"end":"middle"),Y.each(function(){this.__axis=se})}return E.scale=function(S){return arguments.length?(e=S,E):e},E.ticks=function(){return i=Array.from(arguments),E},E.tickArguments=function(S){return arguments.length?(i=S==null?[]:Array.from(S),E):i.slice()},E.tickValues=function(S){return arguments.length?(n=S==null?null:Array.from(S),E):n&&n.slice()},E.tickFormat=function(S){return arguments.length?(s=S,E):s},E.tickSize=function(S){return arguments.length?(l=c=+S,E):l},E.tickSizeInner=function(S){return arguments.length?(l=+S,E):l},E.tickSizeOuter=function(S){return arguments.length?(c=+S,E):c},E.tickPadding=function(S){return arguments.length?(r=+S,E):r},E.offset=function(S){return arguments.length?(f=+S,E):f},E}function vL(t){return _p(xm,t)}function bL(t){return _p(wm,t)}function bE(t){return _p(L_,t)}function xE(t){return _p(Dd,t)}var xL={value:()=>{}};function P0(){for(var t=0,e=arguments.length,i={},n;t<e;++t){if(!(n=arguments[t]+"")||n in i||/[\s.]/.test(n))throw new Error("illegal type: "+n);i[n]=[]}return new Am(i)}function Am(t){this._=t}function wL(t,e){return t.trim().split(/^|\s+/).map(function(i){var n="",s=i.indexOf(".");if(s>=0&&(n=i.slice(s+1),i=i.slice(0,s)),i&&!e.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:n}})}Am.prototype=P0.prototype={constructor:Am,on:function(t,e){var i=this._,n=wL(t+"",i),s,l=-1,c=n.length;if(arguments.length<2){for(;++l<c;)if((s=(t=n[l]).type)&&(s=AL(i[s],t.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++l<c;)if(s=(t=n[l]).type)i[s]=Hx(i[s],t.name,e);else if(e==null)for(s in i)i[s]=Hx(i[s],t.name,null);return this},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new Am(t)},call:function(t,e){if((s=arguments.length-2)>0)for(var i=new Array(s),n=0,s,l;n<s;++n)i[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(l=this._[t],n=0,s=l.length;n<s;++n)l[n].value.apply(e,i)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],s=0,l=n.length;s<l;++s)n[s].value.apply(e,i)}};function AL(t,e){for(var i=0,n=t.length,s;i<n;++i)if((s=t[i]).name===e)return s.value}function Hx(t,e,i){for(var n=0,s=t.length;n<s;++n)if(t[n].name===e){t[n]=xL,t=t.slice(0,n).concat(t.slice(n+1));break}return i!=null&&t.push({name:e,value:i}),t}var P_="http://www.w3.org/1999/xhtml";const Kx={svg:"http://www.w3.org/2000/svg",xhtml:P_,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function yp(t){var e=t+="",i=e.indexOf(":");return i>=0&&(e=t.slice(0,i))!=="xmlns"&&(t=t.slice(i+1)),Kx.hasOwnProperty(e)?{space:Kx[e],local:t}:t}function EL(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===P_&&e.documentElement.namespaceURI===P_?e.createElement(t):e.createElementNS(i,t)}}function TL(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function wE(t){var e=yp(t);return(e.local?TL:EL)(e)}function SL(){}function N0(t){return t==null?SL:function(){return this.querySelector(t)}}function IL(t){typeof t!="function"&&(t=N0(t));for(var e=this._groups,i=e.length,n=new Array(i),s=0;s<i;++s)for(var l=e[s],c=l.length,r=n[s]=new Array(c),f,m,y=0;y<c;++y)(f=l[y])&&(m=t.call(f,f.__data__,y,l))&&("__data__"in f&&(m.__data__=f.__data__),r[y]=m);return new Ua(n,this._parents)}function kL(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function OL(){return[]}function AE(t){return t==null?OL:function(){return this.querySelectorAll(t)}}function CL(t){return function(){return kL(t.apply(this,arguments))}}function ML(t){typeof t=="function"?t=CL(t):t=AE(t);for(var e=this._groups,i=e.length,n=[],s=[],l=0;l<i;++l)for(var c=e[l],r=c.length,f,m=0;m<r;++m)(f=c[m])&&(n.push(t.call(f,f.__data__,m,c)),s.push(f));return new Ua(n,s)}function EE(t){return function(){return this.matches(t)}}function TE(t){return function(e){return e.matches(t)}}var DL=Array.prototype.find;function RL(t){return function(){return DL.call(this.children,t)}}function LL(){return this.firstElementChild}function PL(t){return this.select(t==null?LL:RL(typeof t=="function"?t:TE(t)))}var NL=Array.prototype.filter;function zL(){return Array.from(this.children)}function BL(t){return function(){return NL.call(this.children,t)}}function VL(t){return this.selectAll(t==null?zL:BL(typeof t=="function"?t:TE(t)))}function FL(t){typeof t!="function"&&(t=EE(t));for(var e=this._groups,i=e.length,n=new Array(i),s=0;s<i;++s)for(var l=e[s],c=l.length,r=n[s]=[],f,m=0;m<c;++m)(f=l[m])&&t.call(f,f.__data__,m,l)&&r.push(f);return new Ua(n,this._parents)}function SE(t){return new Array(t.length)}function UL(){return new Ua(this._enter||this._groups.map(SE),this._parents)}function Fm(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Fm.prototype={constructor:Fm,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function jL(t){return function(){return t}}function GL(t,e,i,n,s,l){for(var c=0,r,f=e.length,m=l.length;c<m;++c)(r=e[c])?(r.__data__=l[c],n[c]=r):i[c]=new Fm(t,l[c]);for(;c<f;++c)(r=e[c])&&(s[c]=r)}function HL(t,e,i,n,s,l,c){var r,f,m=new Map,y=e.length,b=l.length,E=new Array(y),S;for(r=0;r<y;++r)(f=e[r])&&(E[r]=S=c.call(f,f.__data__,r,e)+"",m.has(S)?s[r]=f:m.set(S,f));for(r=0;r<b;++r)S=c.call(t,l[r],r,l)+"",(f=m.get(S))?(n[r]=f,f.__data__=l[r],m.delete(S)):i[r]=new Fm(t,l[r]);for(r=0;r<y;++r)(f=e[r])&&m.get(E[r])===f&&(s[r]=f)}function KL(t){return t.__data__}function qL(t,e){if(!arguments.length)return Array.from(this,KL);var i=e?HL:GL,n=this._parents,s=this._groups;typeof t!="function"&&(t=jL(t));for(var l=s.length,c=new Array(l),r=new Array(l),f=new Array(l),m=0;m<l;++m){var y=n[m],b=s[m],E=b.length,S=ZL(t.call(y,y&&y.__data__,m,n)),D=S.length,R=r[m]=new Array(D),z=c[m]=new Array(D),H=f[m]=new Array(E);i(y,b,R,z,H,S,e);for(var K=0,W=0,se,Y;K<D;++K)if(se=R[K]){for(K>=W&&(W=K+1);!(Y=z[W])&&++W<D;);se._next=Y||null}}return c=new Ua(c,n),c._enter=r,c._exit=f,c}function ZL(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function WL(){return new Ua(this._exit||this._groups.map(SE),this._parents)}function YL(t,e,i){var n=this.enter(),s=this,l=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(s=e(s),s&&(s=s.selection())),i==null?l.remove():i(l),n&&s?n.merge(s).order():s}function JL(t){for(var e=t.selection?t.selection():t,i=this._groups,n=e._groups,s=i.length,l=n.length,c=Math.min(s,l),r=new Array(s),f=0;f<c;++f)for(var m=i[f],y=n[f],b=m.length,E=r[f]=new Array(b),S,D=0;D<b;++D)(S=m[D]||y[D])&&(E[D]=S);for(;f<s;++f)r[f]=i[f];return new Ua(r,this._parents)}function XL(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var n=t[e],s=n.length-1,l=n[s],c;--s>=0;)(c=n[s])&&(l&&c.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(c,l),l=c);return this}function QL(t){t||(t=$L);function e(b,E){return b&&E?t(b.__data__,E.__data__):!b-!E}for(var i=this._groups,n=i.length,s=new Array(n),l=0;l<n;++l){for(var c=i[l],r=c.length,f=s[l]=new Array(r),m,y=0;y<r;++y)(m=c[y])&&(f[y]=m);f.sort(e)}return new Ua(s,this._parents).order()}function $L(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function eP(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function tP(){return Array.from(this)}function iP(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],s=0,l=n.length;s<l;++s){var c=n[s];if(c)return c}return null}function nP(){let t=0;for(const e of this)++t;return t}function rP(){return!this.node()}function sP(t){for(var e=this._groups,i=0,n=e.length;i<n;++i)for(var s=e[i],l=0,c=s.length,r;l<c;++l)(r=s[l])&&t.call(r,r.__data__,l,s);return this}function aP(t){return function(){this.removeAttribute(t)}}function oP(t){return function(){this.removeAttributeNS(t.space,t.local)}}function lP(t,e){return function(){this.setAttribute(t,e)}}function cP(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function uP(t,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttribute(t):this.setAttribute(t,i)}}function hP(t,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function dP(t,e){var i=yp(t);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((e==null?i.local?oP:aP:typeof e=="function"?i.local?hP:uP:i.local?cP:lP)(i,e))}function IE(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function fP(t){return function(){this.style.removeProperty(t)}}function mP(t,e,i){return function(){this.style.setProperty(t,e,i)}}function pP(t,e,i){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,i)}}function gP(t,e,i){return arguments.length>1?this.each((e==null?fP:typeof e=="function"?pP:mP)(t,e,i??"")):bh(this.node(),t)}function bh(t,e){return t.style.getPropertyValue(e)||IE(t).getComputedStyle(t,null).getPropertyValue(e)}function _P(t){return function(){delete this[t]}}function yP(t,e){return function(){this[t]=e}}function vP(t,e){return function(){var i=e.apply(this,arguments);i==null?delete this[t]:this[t]=i}}function bP(t,e){return arguments.length>1?this.each((e==null?_P:typeof e=="function"?vP:yP)(t,e)):this.node()[t]}function kE(t){return t.trim().split(/^|\s+/)}function z0(t){return t.classList||new OE(t)}function OE(t){this._node=t,this._names=kE(t.getAttribute("class")||"")}OE.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function CE(t,e){for(var i=z0(t),n=-1,s=e.length;++n<s;)i.add(e[n])}function ME(t,e){for(var i=z0(t),n=-1,s=e.length;++n<s;)i.remove(e[n])}function xP(t){return function(){CE(this,t)}}function wP(t){return function(){ME(this,t)}}function AP(t,e){return function(){(e.apply(this,arguments)?CE:ME)(this,t)}}function EP(t,e){var i=kE(t+"");if(arguments.length<2){for(var n=z0(this.node()),s=-1,l=i.length;++s<l;)if(!n.contains(i[s]))return!1;return!0}return this.each((typeof e=="function"?AP:e?xP:wP)(i,e))}function TP(){this.textContent=""}function SP(t){return function(){this.textContent=t}}function IP(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function kP(t){return arguments.length?this.each(t==null?TP:(typeof t=="function"?IP:SP)(t)):this.node().textContent}function OP(){this.innerHTML=""}function CP(t){return function(){this.innerHTML=t}}function MP(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function DP(t){return arguments.length?this.each(t==null?OP:(typeof t=="function"?MP:CP)(t)):this.node().innerHTML}function RP(){this.nextSibling&&this.parentNode.appendChild(this)}function LP(){return this.each(RP)}function PP(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function NP(){return this.each(PP)}function zP(t){var e=typeof t=="function"?t:wE(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function BP(){return null}function VP(t,e){var i=typeof t=="function"?t:wE(t),n=e==null?BP:typeof e=="function"?e:N0(e);return this.select(function(){return this.insertBefore(i.apply(this,arguments),n.apply(this,arguments)||null)})}function FP(){var t=this.parentNode;t&&t.removeChild(this)}function UP(){return this.each(FP)}function jP(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function GP(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function HP(t){return this.select(t?GP:jP)}function KP(t){return arguments.length?this.property("__data__",t):this.node().__data__}function qP(t){return function(e){t.call(this,e,this.__data__)}}function ZP(t){return t.trim().split(/^|\s+/).map(function(e){var i="",n=e.indexOf(".");return n>=0&&(i=e.slice(n+1),e=e.slice(0,n)),{type:e,name:i}})}function WP(t){return function(){var e=this.__on;if(e){for(var i=0,n=-1,s=e.length,l;i<s;++i)l=e[i],(!t.type||l.type===t.type)&&l.name===t.name?this.removeEventListener(l.type,l.listener,l.options):e[++n]=l;++n?e.length=n:delete this.__on}}}function YP(t,e,i){return function(){var n=this.__on,s,l=qP(e);if(n){for(var c=0,r=n.length;c<r;++c)if((s=n[c]).type===t.type&&s.name===t.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=l,s.options=i),s.value=e;return}}this.addEventListener(t.type,l,i),s={type:t.type,name:t.name,value:e,listener:l,options:i},n?n.push(s):this.__on=[s]}}function JP(t,e,i){var n=ZP(t+""),s,l=n.length,c;if(arguments.length<2){var r=this.node().__on;if(r){for(var f=0,m=r.length,y;f<m;++f)for(s=0,y=r[f];s<l;++s)if((c=n[s]).type===y.type&&c.name===y.name)return y.value}return}for(r=e?YP:WP,s=0;s<l;++s)this.each(r(n[s],e,i));return this}function DE(t,e,i){var n=IE(t),s=n.CustomEvent;typeof s=="function"?s=new s(e,i):(s=n.document.createEvent("Event"),i?(s.initEvent(e,i.bubbles,i.cancelable),s.detail=i.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function XP(t,e){return function(){return DE(this,t,e)}}function QP(t,e){return function(){return DE(this,t,e.apply(this,arguments))}}function $P(t,e){return this.each((typeof e=="function"?QP:XP)(t,e))}function*e4(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],s=0,l=n.length,c;s<l;++s)(c=n[s])&&(yield c)}var RE=[null];function Ua(t,e){this._groups=t,this._parents=e}function ff(){return new Ua([[document.documentElement]],RE)}function t4(){return this}Ua.prototype=ff.prototype={constructor:Ua,select:IL,selectAll:ML,selectChild:PL,selectChildren:VL,filter:FL,data:qL,enter:UL,exit:WL,join:YL,merge:JL,selection:t4,order:XL,sort:QL,call:eP,nodes:tP,node:iP,size:nP,empty:rP,each:sP,attr:dP,style:gP,property:bP,classed:EP,text:kP,html:DP,raise:LP,lower:NP,append:zP,insert:VP,remove:UP,clone:HP,datum:KP,on:JP,dispatch:$P,[Symbol.iterator]:e4};function Jt(t){return typeof t=="string"?new Ua([[document.querySelector(t)]],[document.documentElement]):new Ua([[t]],RE)}function i4(t){let e;for(;e=t.sourceEvent;)t=e;return t}function su(t,e){if(t=i4(t),e===void 0&&(e=t.currentTarget),e){var i=e.ownerSVGElement||e;if(i.createSVGPoint){var n=i.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}}return[t.pageX,t.pageY]}const N_={capture:!0,passive:!1};function z_(t){t.preventDefault(),t.stopImmediatePropagation()}function n4(t){var e=t.document.documentElement,i=Jt(t).on("dragstart.drag",z_,N_);"onselectstart"in e?i.on("selectstart.drag",z_,N_):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function r4(t,e){var i=t.document.documentElement,n=Jt(t).on("dragstart.drag",null);e&&(n.on("click.drag",z_,N_),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in i?n.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}function B0(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function LE(t,e){var i=Object.create(t.prototype);for(var n in e)i[n]=e[n];return i}function mf(){}var Jd=.7,Um=1/Jd,fh="\\s*([+-]?\\d+)\\s*",Xd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Jo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",s4=/^#([0-9a-f]{3,8})$/,a4=new RegExp(`^rgb\\(${fh},${fh},${fh}\\)$`),o4=new RegExp(`^rgb\\(${Jo},${Jo},${Jo}\\)$`),l4=new RegExp(`^rgba\\(${fh},${fh},${fh},${Xd}\\)$`),c4=new RegExp(`^rgba\\(${Jo},${Jo},${Jo},${Xd}\\)$`),u4=new RegExp(`^hsl\\(${Xd},${Jo},${Jo}\\)$`),h4=new RegExp(`^hsla\\(${Xd},${Jo},${Jo},${Xd}\\)$`),qx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};B0(mf,au,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Zx,formatHex:Zx,formatHex8:d4,formatHsl:f4,formatRgb:Wx,toString:Wx});function Zx(){return this.rgb().formatHex()}function d4(){return this.rgb().formatHex8()}function f4(){return PE(this).formatHsl()}function Wx(){return this.rgb().formatRgb()}function au(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=s4.exec(t))?(i=e[1].length,e=parseInt(e[1],16),i===6?Yx(e):i===3?new ba(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):i===8?tm(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):i===4?tm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=a4.exec(t))?new ba(e[1],e[2],e[3],1):(e=o4.exec(t))?new ba(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=l4.exec(t))?tm(e[1],e[2],e[3],e[4]):(e=c4.exec(t))?tm(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=u4.exec(t))?Qx(e[1],e[2]/100,e[3]/100,1):(e=h4.exec(t))?Qx(e[1],e[2]/100,e[3]/100,e[4]):qx.hasOwnProperty(t)?Yx(qx[t]):t==="transparent"?new ba(NaN,NaN,NaN,0):null}function Yx(t){return new ba(t>>16&255,t>>8&255,t&255,1)}function tm(t,e,i,n){return n<=0&&(t=e=i=NaN),new ba(t,e,i,n)}function m4(t){return t instanceof mf||(t=au(t)),t?(t=t.rgb(),new ba(t.r,t.g,t.b,t.opacity)):new ba}function B_(t,e,i,n){return arguments.length===1?m4(t):new ba(t,e,i,n??1)}function ba(t,e,i,n){this.r=+t,this.g=+e,this.b=+i,this.opacity=+n}B0(ba,B_,LE(mf,{brighter(t){return t=t==null?Um:Math.pow(Um,t),new ba(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Jd:Math.pow(Jd,t),new ba(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ba(tu(this.r),tu(this.g),tu(this.b),jm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Jx,formatHex:Jx,formatHex8:p4,formatRgb:Xx,toString:Xx}));function Jx(){return`#${$c(this.r)}${$c(this.g)}${$c(this.b)}`}function p4(){return`#${$c(this.r)}${$c(this.g)}${$c(this.b)}${$c((isNaN(this.opacity)?1:this.opacity)*255)}`}function Xx(){const t=jm(this.opacity);return`${t===1?"rgb(":"rgba("}${tu(this.r)}, ${tu(this.g)}, ${tu(this.b)}${t===1?")":`, ${t})`}`}function jm(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function tu(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function $c(t){return t=tu(t),(t<16?"0":"")+t.toString(16)}function Qx(t,e,i,n){return n<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new So(t,e,i,n)}function PE(t){if(t instanceof So)return new So(t.h,t.s,t.l,t.opacity);if(t instanceof mf||(t=au(t)),!t)return new So;if(t instanceof So)return t;t=t.rgb();var e=t.r/255,i=t.g/255,n=t.b/255,s=Math.min(e,i,n),l=Math.max(e,i,n),c=NaN,r=l-s,f=(l+s)/2;return r?(e===l?c=(i-n)/r+(i<n)*6:i===l?c=(n-e)/r+2:c=(e-i)/r+4,r/=f<.5?l+s:2-l-s,c*=60):r=f>0&&f<1?0:c,new So(c,r,f,t.opacity)}function g4(t,e,i,n){return arguments.length===1?PE(t):new So(t,e,i,n??1)}function So(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n}B0(So,g4,LE(mf,{brighter(t){return t=t==null?Um:Math.pow(Um,t),new So(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Jd:Math.pow(Jd,t),new So(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,s=2*i-n;return new ba(Vg(t>=240?t-240:t+120,s,n),Vg(t,s,n),Vg(t<120?t+240:t-120,s,n),this.opacity)},clamp(){return new So($x(this.h),im(this.s),im(this.l),jm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=jm(this.opacity);return`${t===1?"hsl(":"hsla("}${$x(this.h)}, ${im(this.s)*100}%, ${im(this.l)*100}%${t===1?")":`, ${t})`}`}}));function $x(t){return t=(t||0)%360,t<0?t+360:t}function im(t){return Math.max(0,Math.min(1,t||0))}function Vg(t,e,i){return(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)*255}const V0=t=>()=>t;function _4(t,e){return function(i){return t+i*e}}function y4(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(n){return Math.pow(t+n*e,i)}}function v4(t){return(t=+t)==1?NE:function(e,i){return i-e?y4(e,i,t):V0(isNaN(e)?i:e)}}function NE(t,e){var i=e-t;return i?_4(t,i):V0(isNaN(t)?e:t)}const Gm=function t(e){var i=v4(e);function n(s,l){var c=i((s=B_(s)).r,(l=B_(l)).r),r=i(s.g,l.g),f=i(s.b,l.b),m=NE(s.opacity,l.opacity);return function(y){return s.r=c(y),s.g=r(y),s.b=f(y),s.opacity=m(y),s+""}}return n.gamma=t,n}(1);function b4(t,e){e||(e=[]);var i=t?Math.min(e.length,t.length):0,n=e.slice(),s;return function(l){for(s=0;s<i;++s)n[s]=t[s]*(1-l)+e[s]*l;return n}}function x4(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function w4(t,e){var i=e?e.length:0,n=t?Math.min(i,t.length):0,s=new Array(n),l=new Array(i),c;for(c=0;c<n;++c)s[c]=vp(t[c],e[c]);for(;c<i;++c)l[c]=e[c];return function(r){for(c=0;c<n;++c)l[c]=s[c](r);return l}}function A4(t,e){var i=new Date;return t=+t,e=+e,function(n){return i.setTime(t*(1-n)+e*n),i}}function To(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}function E4(t,e){var i={},n={},s;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in t?i[s]=vp(t[s],e[s]):n[s]=e[s];return function(l){for(s in i)n[s]=i[s](l);return n}}var V_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fg=new RegExp(V_.source,"g");function T4(t){return function(){return t}}function S4(t){return function(e){return t(e)+""}}function zE(t,e){var i=V_.lastIndex=Fg.lastIndex=0,n,s,l,c=-1,r=[],f=[];for(t=t+"",e=e+"";(n=V_.exec(t))&&(s=Fg.exec(e));)(l=s.index)>i&&(l=e.slice(i,l),r[c]?r[c]+=l:r[++c]=l),(n=n[0])===(s=s[0])?r[c]?r[c]+=s:r[++c]=s:(r[++c]=null,f.push({i:c,x:To(n,s)})),i=Fg.lastIndex;return i<e.length&&(l=e.slice(i),r[c]?r[c]+=l:r[++c]=l),r.length<2?f[0]?S4(f[0].x):T4(e):(e=f.length,function(m){for(var y=0,b;y<e;++y)r[(b=f[y]).i]=b.x(m);return r.join("")})}function vp(t,e){var i=typeof e,n;return e==null||i==="boolean"?V0(e):(i==="number"?To:i==="string"?(n=au(e))?(e=n,Gm):zE:e instanceof au?Gm:e instanceof Date?A4:x4(e)?b4:Array.isArray(e)?w4:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?E4:To)(t,e)}function I4(t,e){return t=+t,e=+e,function(i){return Math.round(t*(1-i)+e*i)}}var ew=180/Math.PI,F_={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function BE(t,e,i,n,s,l){var c,r,f;return(c=Math.sqrt(t*t+e*e))&&(t/=c,e/=c),(f=t*i+e*n)&&(i-=t*f,n-=e*f),(r=Math.sqrt(i*i+n*n))&&(i/=r,n/=r,f/=r),t*n<e*i&&(t=-t,e=-e,f=-f,c=-c),{translateX:s,translateY:l,rotate:Math.atan2(e,t)*ew,skewX:Math.atan(f)*ew,scaleX:c,scaleY:r}}var nm;function k4(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?F_:BE(e.a,e.b,e.c,e.d,e.e,e.f)}function O4(t){return t==null||(nm||(nm=document.createElementNS("http://www.w3.org/2000/svg","g")),nm.setAttribute("transform",t),!(t=nm.transform.baseVal.consolidate()))?F_:(t=t.matrix,BE(t.a,t.b,t.c,t.d,t.e,t.f))}function VE(t,e,i,n){function s(m){return m.length?m.pop()+" ":""}function l(m,y,b,E,S,D){if(m!==b||y!==E){var R=S.push("translate(",null,e,null,i);D.push({i:R-4,x:To(m,b)},{i:R-2,x:To(y,E)})}else(b||E)&&S.push("translate("+b+e+E+i)}function c(m,y,b,E){m!==y?(m-y>180?y+=360:y-m>180&&(m+=360),E.push({i:b.push(s(b)+"rotate(",null,n)-2,x:To(m,y)})):y&&b.push(s(b)+"rotate("+y+n)}function r(m,y,b,E){m!==y?E.push({i:b.push(s(b)+"skewX(",null,n)-2,x:To(m,y)}):y&&b.push(s(b)+"skewX("+y+n)}function f(m,y,b,E,S,D){if(m!==b||y!==E){var R=S.push(s(S)+"scale(",null,",",null,")");D.push({i:R-4,x:To(m,b)},{i:R-2,x:To(y,E)})}else(b!==1||E!==1)&&S.push(s(S)+"scale("+b+","+E+")")}return function(m,y){var b=[],E=[];return m=t(m),y=t(y),l(m.translateX,m.translateY,y.translateX,y.translateY,b,E),c(m.rotate,y.rotate,b,E),r(m.skewX,y.skewX,b,E),f(m.scaleX,m.scaleY,y.scaleX,y.scaleY,b,E),m=y=null,function(S){for(var D=-1,R=E.length,z;++D<R;)b[(z=E[D]).i]=z.x(S);return b.join("")}}}var C4=VE(k4,"px, ","px)","deg)"),M4=VE(O4,", ",")",")"),xh=0,Rd=0,vd=0,FE=1e3,Hm,Ld,Km=0,ou=0,bp=0,Qd=typeof performance=="object"&&performance.now?performance:Date,UE=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function F0(){return ou||(UE(D4),ou=Qd.now()+bp)}function D4(){ou=0}function qm(){this._call=this._time=this._next=null}qm.prototype=jE.prototype={constructor:qm,restart:function(t,e,i){if(typeof t!="function")throw new TypeError("callback is not a function");i=(i==null?F0():+i)+(e==null?0:+e),!this._next&&Ld!==this&&(Ld?Ld._next=this:Hm=this,Ld=this),this._call=t,this._time=i,U_()},stop:function(){this._call&&(this._call=null,this._time=1/0,U_())}};function jE(t,e,i){var n=new qm;return n.restart(t,e,i),n}function R4(){F0(),++xh;for(var t=Hm,e;t;)(e=ou-t._time)>=0&&t._call.call(void 0,e),t=t._next;--xh}function tw(){ou=(Km=Qd.now())+bp,xh=Rd=0;try{R4()}finally{xh=0,P4(),ou=0}}function L4(){var t=Qd.now(),e=t-Km;e>FE&&(bp-=e,Km=t)}function P4(){for(var t,e=Hm,i,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(i=e._next,e._next=null,e=t?t._next=i:Hm=i);Ld=t,U_(n)}function U_(t){if(!xh){Rd&&(Rd=clearTimeout(Rd));var e=t-ou;e>24?(t<1/0&&(Rd=setTimeout(tw,t-Qd.now()-bp)),vd&&(vd=clearInterval(vd))):(vd||(Km=Qd.now(),vd=setInterval(L4,FE)),xh=1,UE(tw))}}function iw(t,e,i){var n=new qm;return e=e==null?0:+e,n.restart(s=>{n.stop(),t(s+e)},e,i),n}var N4=P0("start","end","cancel","interrupt"),z4=[],GE=0,nw=1,j_=2,Em=3,rw=4,G_=5,Tm=6;function xp(t,e,i,n,s,l){var c=t.__transition;if(!c)t.__transition={};else if(i in c)return;B4(t,i,{name:e,index:n,group:s,on:N4,tween:z4,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:GE})}function U0(t,e){var i=Do(t,e);if(i.state>GE)throw new Error("too late; already scheduled");return i}function $o(t,e){var i=Do(t,e);if(i.state>Em)throw new Error("too late; already running");return i}function Do(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function B4(t,e,i){var n=t.__transition,s;n[e]=i,i.timer=jE(l,0,i.time);function l(m){i.state=nw,i.timer.restart(c,i.delay,i.time),i.delay<=m&&c(m-i.delay)}function c(m){var y,b,E,S;if(i.state!==nw)return f();for(y in n)if(S=n[y],S.name===i.name){if(S.state===Em)return iw(c);S.state===rw?(S.state=Tm,S.timer.stop(),S.on.call("interrupt",t,t.__data__,S.index,S.group),delete n[y]):+y<e&&(S.state=Tm,S.timer.stop(),S.on.call("cancel",t,t.__data__,S.index,S.group),delete n[y])}if(iw(function(){i.state===Em&&(i.state=rw,i.timer.restart(r,i.delay,i.time),r(m))}),i.state=j_,i.on.call("start",t,t.__data__,i.index,i.group),i.state===j_){for(i.state=Em,s=new Array(E=i.tween.length),y=0,b=-1;y<E;++y)(S=i.tween[y].value.call(t,t.__data__,i.index,i.group))&&(s[++b]=S);s.length=b+1}}function r(m){for(var y=m<i.duration?i.ease.call(null,m/i.duration):(i.timer.restart(f),i.state=G_,1),b=-1,E=s.length;++b<E;)s[b].call(t,y);i.state===G_&&(i.on.call("end",t,t.__data__,i.index,i.group),f())}function f(){i.state=Tm,i.timer.stop(),delete n[e];for(var m in n)return;delete t.__transition}}function H_(t,e){var i=t.__transition,n,s,l=!0,c;if(i){e=e==null?null:e+"";for(c in i){if((n=i[c]).name!==e){l=!1;continue}s=n.state>j_&&n.state<G_,n.state=Tm,n.timer.stop(),n.on.call(s?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete i[c]}l&&delete t.__transition}}function V4(t){return this.each(function(){H_(this,t)})}function F4(t,e){var i,n;return function(){var s=$o(this,t),l=s.tween;if(l!==i){n=i=l;for(var c=0,r=n.length;c<r;++c)if(n[c].name===e){n=n.slice(),n.splice(c,1);break}}s.tween=n}}function U4(t,e,i){var n,s;if(typeof i!="function")throw new Error;return function(){var l=$o(this,t),c=l.tween;if(c!==n){s=(n=c).slice();for(var r={name:e,value:i},f=0,m=s.length;f<m;++f)if(s[f].name===e){s[f]=r;break}f===m&&s.push(r)}l.tween=s}}function j4(t,e){var i=this._id;if(t+="",arguments.length<2){for(var n=Do(this.node(),i).tween,s=0,l=n.length,c;s<l;++s)if((c=n[s]).name===t)return c.value;return null}return this.each((e==null?F4:U4)(i,t,e))}function j0(t,e,i){var n=t._id;return t.each(function(){var s=$o(this,n);(s.value||(s.value={}))[e]=i.apply(this,arguments)}),function(s){return Do(s,n).value[e]}}function HE(t,e){var i;return(typeof e=="number"?To:e instanceof au?Gm:(i=au(e))?(e=i,Gm):zE)(t,e)}function G4(t){return function(){this.removeAttribute(t)}}function H4(t){return function(){this.removeAttributeNS(t.space,t.local)}}function K4(t,e,i){var n,s=i+"",l;return function(){var c=this.getAttribute(t);return c===s?null:c===n?l:l=e(n=c,i)}}function q4(t,e,i){var n,s=i+"",l;return function(){var c=this.getAttributeNS(t.space,t.local);return c===s?null:c===n?l:l=e(n=c,i)}}function Z4(t,e,i){var n,s,l;return function(){var c,r=i(this),f;return r==null?void this.removeAttribute(t):(c=this.getAttribute(t),f=r+"",c===f?null:c===n&&f===s?l:(s=f,l=e(n=c,r)))}}function W4(t,e,i){var n,s,l;return function(){var c,r=i(this),f;return r==null?void this.removeAttributeNS(t.space,t.local):(c=this.getAttributeNS(t.space,t.local),f=r+"",c===f?null:c===n&&f===s?l:(s=f,l=e(n=c,r)))}}function Y4(t,e){var i=yp(t),n=i==="transform"?M4:HE;return this.attrTween(t,typeof e=="function"?(i.local?W4:Z4)(i,n,j0(this,"attr."+t,e)):e==null?(i.local?H4:G4)(i):(i.local?q4:K4)(i,n,e))}function J4(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}function X4(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}function Q4(t,e){var i,n;function s(){var l=e.apply(this,arguments);return l!==n&&(i=(n=l)&&X4(t,l)),i}return s._value=e,s}function $4(t,e){var i,n;function s(){var l=e.apply(this,arguments);return l!==n&&(i=(n=l)&&J4(t,l)),i}return s._value=e,s}function e7(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;var n=yp(t);return this.tween(i,(n.local?Q4:$4)(n,e))}function t7(t,e){return function(){U0(this,t).delay=+e.apply(this,arguments)}}function i7(t,e){return e=+e,function(){U0(this,t).delay=e}}function n7(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?t7:i7)(e,t)):Do(this.node(),e).delay}function r7(t,e){return function(){$o(this,t).duration=+e.apply(this,arguments)}}function s7(t,e){return e=+e,function(){$o(this,t).duration=e}}function a7(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?r7:s7)(e,t)):Do(this.node(),e).duration}function o7(t,e){if(typeof e!="function")throw new Error;return function(){$o(this,t).ease=e}}function l7(t){var e=this._id;return arguments.length?this.each(o7(e,t)):Do(this.node(),e).ease}function c7(t,e){return function(){var i=e.apply(this,arguments);if(typeof i!="function")throw new Error;$o(this,t).ease=i}}function u7(t){if(typeof t!="function")throw new Error;return this.each(c7(this._id,t))}function h7(t){typeof t!="function"&&(t=EE(t));for(var e=this._groups,i=e.length,n=new Array(i),s=0;s<i;++s)for(var l=e[s],c=l.length,r=n[s]=[],f,m=0;m<c;++m)(f=l[m])&&t.call(f,f.__data__,m,l)&&r.push(f);return new Dl(n,this._parents,this._name,this._id)}function d7(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,n=e.length,s=i.length,l=Math.min(n,s),c=new Array(n),r=0;r<l;++r)for(var f=e[r],m=i[r],y=f.length,b=c[r]=new Array(y),E,S=0;S<y;++S)(E=f[S]||m[S])&&(b[S]=E);for(;r<n;++r)c[r]=e[r];return new Dl(c,this._parents,this._name,this._id)}function f7(t){return(t+"").trim().split(/^|\s+/).every(function(e){var i=e.indexOf(".");return i>=0&&(e=e.slice(0,i)),!e||e==="start"})}function m7(t,e,i){var n,s,l=f7(e)?U0:$o;return function(){var c=l(this,t),r=c.on;r!==n&&(s=(n=r).copy()).on(e,i),c.on=s}}function p7(t,e){var i=this._id;return arguments.length<2?Do(this.node(),i).on.on(t):this.each(m7(i,t,e))}function g7(t){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}}function _7(){return this.on("end.remove",g7(this._id))}function y7(t){var e=this._name,i=this._id;typeof t!="function"&&(t=N0(t));for(var n=this._groups,s=n.length,l=new Array(s),c=0;c<s;++c)for(var r=n[c],f=r.length,m=l[c]=new Array(f),y,b,E=0;E<f;++E)(y=r[E])&&(b=t.call(y,y.__data__,E,r))&&("__data__"in y&&(b.__data__=y.__data__),m[E]=b,xp(m[E],e,i,E,m,Do(y,i)));return new Dl(l,this._parents,e,i)}function v7(t){var e=this._name,i=this._id;typeof t!="function"&&(t=AE(t));for(var n=this._groups,s=n.length,l=[],c=[],r=0;r<s;++r)for(var f=n[r],m=f.length,y,b=0;b<m;++b)if(y=f[b]){for(var E=t.call(y,y.__data__,b,f),S,D=Do(y,i),R=0,z=E.length;R<z;++R)(S=E[R])&&xp(S,e,i,R,E,D);l.push(E),c.push(y)}return new Dl(l,c,e,i)}var b7=ff.prototype.constructor;function x7(){return new b7(this._groups,this._parents)}function w7(t,e){var i,n,s;return function(){var l=bh(this,t),c=(this.style.removeProperty(t),bh(this,t));return l===c?null:l===i&&c===n?s:s=e(i=l,n=c)}}function KE(t){return function(){this.style.removeProperty(t)}}function A7(t,e,i){var n,s=i+"",l;return function(){var c=bh(this,t);return c===s?null:c===n?l:l=e(n=c,i)}}function E7(t,e,i){var n,s,l;return function(){var c=bh(this,t),r=i(this),f=r+"";return r==null&&(f=r=(this.style.removeProperty(t),bh(this,t))),c===f?null:c===n&&f===s?l:(s=f,l=e(n=c,r))}}function T7(t,e){var i,n,s,l="style."+e,c="end."+l,r;return function(){var f=$o(this,t),m=f.on,y=f.value[l]==null?r||(r=KE(e)):void 0;(m!==i||s!==y)&&(n=(i=m).copy()).on(c,s=y),f.on=n}}function S7(t,e,i){var n=(t+="")=="transform"?C4:HE;return e==null?this.styleTween(t,w7(t,n)).on("end.style."+t,KE(t)):typeof e=="function"?this.styleTween(t,E7(t,n,j0(this,"style."+t,e))).each(T7(this._id,t)):this.styleTween(t,A7(t,n,e),i).on("end.style."+t,null)}function I7(t,e,i){return function(n){this.style.setProperty(t,e.call(this,n),i)}}function k7(t,e,i){var n,s;function l(){var c=e.apply(this,arguments);return c!==s&&(n=(s=c)&&I7(t,c,i)),n}return l._value=e,l}function O7(t,e,i){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,k7(t,e,i??""))}function C7(t){return function(){this.textContent=t}}function M7(t){return function(){var e=t(this);this.textContent=e??""}}function D7(t){return this.tween("text",typeof t=="function"?M7(j0(this,"text",t)):C7(t==null?"":t+""))}function R7(t){return function(e){this.textContent=t.call(this,e)}}function L7(t){var e,i;function n(){var s=t.apply(this,arguments);return s!==i&&(e=(i=s)&&R7(s)),e}return n._value=t,n}function P7(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,L7(t))}function N7(){for(var t=this._name,e=this._id,i=qE(),n=this._groups,s=n.length,l=0;l<s;++l)for(var c=n[l],r=c.length,f,m=0;m<r;++m)if(f=c[m]){var y=Do(f,e);xp(f,t,i,m,c,{time:y.time+y.delay+y.duration,delay:0,duration:y.duration,ease:y.ease})}return new Dl(n,this._parents,t,i)}function z7(){var t,e,i=this,n=i._id,s=i.size();return new Promise(function(l,c){var r={value:c},f={value:function(){--s===0&&l()}};i.each(function(){var m=$o(this,n),y=m.on;y!==t&&(e=(t=y).copy(),e._.cancel.push(r),e._.interrupt.push(r),e._.end.push(f)),m.on=e}),s===0&&l()})}var B7=0;function Dl(t,e,i,n){this._groups=t,this._parents=e,this._name=i,this._id=n}function qE(){return++B7}var El=ff.prototype;Dl.prototype={constructor:Dl,select:y7,selectAll:v7,selectChild:El.selectChild,selectChildren:El.selectChildren,filter:h7,merge:d7,selection:x7,transition:N7,call:El.call,nodes:El.nodes,node:El.node,size:El.size,empty:El.empty,each:El.each,on:p7,attr:Y4,attrTween:e7,style:S7,styleTween:O7,text:D7,textTween:P7,remove:_7,tween:j4,delay:n7,duration:a7,ease:l7,easeVarying:u7,end:z7,[Symbol.iterator]:El[Symbol.iterator]};const V7=t=>+t;function ZE(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var F7={time:null,delay:0,duration:250,ease:ZE};function U7(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}function j7(t){var e,i;t instanceof Dl?(e=t._id,t=t._name):(e=qE(),(i=F7).time=F0(),t=t==null?null:t+"");for(var n=this._groups,s=n.length,l=0;l<s;++l)for(var c=n[l],r=c.length,f,m=0;m<r;++m)(f=c[m])&&xp(f,t,e,m,c,i||U7(f,e));return new Dl(n,this._parents,t,e)}ff.prototype.interrupt=V4;ff.prototype.transition=j7;const Ug=t=>()=>t;function G7(t,{sourceEvent:e,target:i,selection:n,mode:s,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},selection:{value:n,enumerable:!0,configurable:!0},mode:{value:s,enumerable:!0,configurable:!0},_:{value:l}})}function H7(t){t.stopImmediatePropagation()}function jg(t){t.preventDefault(),t.stopImmediatePropagation()}var sw={name:"drag"},Gg={name:"space"},Hu={name:"handle"},Ku={name:"center"};const{abs:aw,max:Fs,min:Us}=Math;function ow(t){return[+t[0],+t[1]]}function lw(t){return[ow(t[0]),ow(t[1])]}var Sm={name:"x",handles:["w","e"].map(Zm),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Hg={name:"y",handles:["n","s"].map(Zm),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Tl={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},cw={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},uw={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},K7={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},q7={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Zm(t){return{type:t}}function Z7(t){return!t.ctrlKey&&!t.button}function W7(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Y7(){return navigator.maxTouchPoints||"ontouchstart"in this}function Kg(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function J7(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function WE(){return X7(Sm)}function X7(t){var e=W7,i=Z7,n=Y7,s=!0,l=P0("start","brush","end"),c=6,r;function f(z){var H=z.property("__brush",R).selectAll(".overlay").data([Zm("overlay")]);H.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Tl.overlay).merge(H).each(function(){var W=Kg(this).extent;Jt(this).attr("x",W[0][0]).attr("y",W[0][1]).attr("width",W[1][0]-W[0][0]).attr("height",W[1][1]-W[0][1])}),z.selectAll(".selection").data([Zm("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Tl.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var K=z.selectAll(".handle").data(t.handles,function(W){return W.type});K.exit().remove(),K.enter().append("rect").attr("class",function(W){return"handle handle--"+W.type}).attr("cursor",function(W){return Tl[W.type]}),z.each(m).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",E).filter(n).on("touchstart.brush",E).on("touchmove.brush",S).on("touchend.brush touchcancel.brush",D).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}f.move=function(z,H,K){z.tween?z.on("start.brush",function(W){y(this,arguments).beforestart().start(W)}).on("interrupt.brush end.brush",function(W){y(this,arguments).end(W)}).tween("brush",function(){var W=this,se=W.__brush,Y=y(W,arguments),ne=se.selection,ue=t.input(typeof H=="function"?H.apply(this,arguments):H,se.extent),ve=vp(ne,ue);function _e(oe){se.selection=oe===1&&ue===null?null:ve(oe),m.call(W),Y.brush()}return ne!==null&&ue!==null?_e:_e(1)}):z.each(function(){var W=this,se=arguments,Y=W.__brush,ne=t.input(typeof H=="function"?H.apply(W,se):H,Y.extent),ue=y(W,se).beforestart();H_(W),Y.selection=ne===null?null:ne,m.call(W),ue.start(K).brush(K).end(K)})},f.clear=function(z,H){f.move(z,null,H)};function m(){var z=Jt(this),H=Kg(this).selection;H?(z.selectAll(".selection").style("display",null).attr("x",H[0][0]).attr("y",H[0][1]).attr("width",H[1][0]-H[0][0]).attr("height",H[1][1]-H[0][1]),z.selectAll(".handle").style("display",null).attr("x",function(K){return K.type[K.type.length-1]==="e"?H[1][0]-c/2:H[0][0]-c/2}).attr("y",function(K){return K.type[0]==="s"?H[1][1]-c/2:H[0][1]-c/2}).attr("width",function(K){return K.type==="n"||K.type==="s"?H[1][0]-H[0][0]+c:c}).attr("height",function(K){return K.type==="e"||K.type==="w"?H[1][1]-H[0][1]+c:c})):z.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function y(z,H,K){var W=z.__brush.emitter;return W&&(!K||!W.clean)?W:new b(z,H,K)}function b(z,H,K){this.that=z,this.args=H,this.state=z.__brush,this.active=0,this.clean=K}b.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(z,H){return this.starting?(this.starting=!1,this.emit("start",z,H)):this.emit("brush",z),this},brush:function(z,H){return this.emit("brush",z,H),this},end:function(z,H){return--this.active===0&&(delete this.state.emitter,this.emit("end",z,H)),this},emit:function(z,H,K){var W=Jt(this.that).datum();l.call(z,this.that,new G7(z,{sourceEvent:H,target:f,selection:t.output(this.state.selection),mode:K,dispatch:l}),W)}};function E(z){if(r&&!z.touches||!i.apply(this,arguments))return;var H=this,K=z.target.__data__.type,W=(s&&z.metaKey?K="overlay":K)==="selection"?sw:s&&z.altKey?Ku:Hu,se=t===Hg?null:K7[K],Y=t===Sm?null:q7[K],ne=Kg(H),ue=ne.extent,ve=ne.selection,_e=ue[0][0],oe,Be,mt=ue[0][1],Le,rt,tt=ue[1][0],We,Ve,St=ue[1][1],zt,mi,vt=0,pt=0,Pt,qe=se&&Y&&s&&z.shiftKey,Ht,lt,Gt=Array.from(z.touches||[z],et=>{const zi=et.identifier;return et=su(et,H),et.point0=et.slice(),et.identifier=zi,et});H_(H);var Mi=y(H,arguments,!0).beforestart();if(K==="overlay"){ve&&(Pt=!0);const et=[Gt[0],Gt[1]||Gt[0]];ne.selection=ve=[[oe=t===Hg?_e:Us(et[0][0],et[1][0]),Le=t===Sm?mt:Us(et[0][1],et[1][1])],[We=t===Hg?tt:Fs(et[0][0],et[1][0]),zt=t===Sm?St:Fs(et[0][1],et[1][1])]],Gt.length>1&&_t(z)}else oe=ve[0][0],Le=ve[0][1],We=ve[1][0],zt=ve[1][1];Be=oe,rt=Le,Ve=We,mi=zt;var bt=Jt(H).attr("pointer-events","none"),ze=bt.selectAll(".overlay").attr("cursor",Tl[K]);if(z.touches)Mi.moved=dt,Mi.ended=ni;else{var $t=Jt(z.view).on("mousemove.brush",dt,!0).on("mouseup.brush",ni,!0);s&&$t.on("keydown.brush",Wi,!0).on("keyup.brush",ct,!0),n4(z.view)}m.call(H),Mi.start(z,W.name);function dt(et){for(const zi of et.changedTouches||[et])for(const zn of Gt)zn.identifier===zi.identifier&&(zn.cur=su(zi,H));if(qe&&!Ht&&!lt&&Gt.length===1){const zi=Gt[0];aw(zi.cur[0]-zi[0])>aw(zi.cur[1]-zi[1])?lt=!0:Ht=!0}for(const zi of Gt)zi.cur&&(zi[0]=zi.cur[0],zi[1]=zi.cur[1]);Pt=!0,jg(et),_t(et)}function _t(et){const zi=Gt[0],zn=zi.point0;var Xe;switch(vt=zi[0]-zn[0],pt=zi[1]-zn[1],W){case Gg:case sw:{se&&(vt=Fs(_e-oe,Us(tt-We,vt)),Be=oe+vt,Ve=We+vt),Y&&(pt=Fs(mt-Le,Us(St-zt,pt)),rt=Le+pt,mi=zt+pt);break}case Hu:{Gt[1]?(se&&(Be=Fs(_e,Us(tt,Gt[0][0])),Ve=Fs(_e,Us(tt,Gt[1][0])),se=1),Y&&(rt=Fs(mt,Us(St,Gt[0][1])),mi=Fs(mt,Us(St,Gt[1][1])),Y=1)):(se<0?(vt=Fs(_e-oe,Us(tt-oe,vt)),Be=oe+vt,Ve=We):se>0&&(vt=Fs(_e-We,Us(tt-We,vt)),Be=oe,Ve=We+vt),Y<0?(pt=Fs(mt-Le,Us(St-Le,pt)),rt=Le+pt,mi=zt):Y>0&&(pt=Fs(mt-zt,Us(St-zt,pt)),rt=Le,mi=zt+pt));break}case Ku:{se&&(Be=Fs(_e,Us(tt,oe-vt*se)),Ve=Fs(_e,Us(tt,We+vt*se))),Y&&(rt=Fs(mt,Us(St,Le-pt*Y)),mi=Fs(mt,Us(St,zt+pt*Y)));break}}Ve<Be&&(se*=-1,Xe=oe,oe=We,We=Xe,Xe=Be,Be=Ve,Ve=Xe,K in cw&&ze.attr("cursor",Tl[K=cw[K]])),mi<rt&&(Y*=-1,Xe=Le,Le=zt,zt=Xe,Xe=rt,rt=mi,mi=Xe,K in uw&&ze.attr("cursor",Tl[K=uw[K]])),ne.selection&&(ve=ne.selection),Ht&&(Be=ve[0][0],Ve=ve[1][0]),lt&&(rt=ve[0][1],mi=ve[1][1]),(ve[0][0]!==Be||ve[0][1]!==rt||ve[1][0]!==Ve||ve[1][1]!==mi)&&(ne.selection=[[Be,rt],[Ve,mi]],m.call(H),Mi.brush(et,W.name))}function ni(et){if(H7(et),et.touches){if(et.touches.length)return;r&&clearTimeout(r),r=setTimeout(function(){r=null},500)}else r4(et.view,Pt),$t.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);bt.attr("pointer-events","all"),ze.attr("cursor",Tl.overlay),ne.selection&&(ve=ne.selection),J7(ve)&&(ne.selection=null,m.call(H)),Mi.end(et,W.name)}function Wi(et){switch(et.keyCode){case 16:{qe=se&&Y;break}case 18:{W===Hu&&(se&&(We=Ve-vt*se,oe=Be+vt*se),Y&&(zt=mi-pt*Y,Le=rt+pt*Y),W=Ku,_t(et));break}case 32:{(W===Hu||W===Ku)&&(se<0?We=Ve-vt:se>0&&(oe=Be-vt),Y<0?zt=mi-pt:Y>0&&(Le=rt-pt),W=Gg,ze.attr("cursor",Tl.selection),_t(et));break}default:return}jg(et)}function ct(et){switch(et.keyCode){case 16:{qe&&(Ht=lt=qe=!1,_t(et));break}case 18:{W===Ku&&(se<0?We=Ve:se>0&&(oe=Be),Y<0?zt=mi:Y>0&&(Le=rt),W=Hu,_t(et));break}case 32:{W===Gg&&(et.altKey?(se&&(We=Ve-vt*se,oe=Be+vt*se),Y&&(zt=mi-pt*Y,Le=rt+pt*Y),W=Ku):(se<0?We=Ve:se>0&&(oe=Be),Y<0?zt=mi:Y>0&&(Le=rt),W=Hu),ze.attr("cursor",Tl[K]),_t(et));break}default:return}jg(et)}}function S(z){y(this,arguments).moved(z)}function D(z){y(this,arguments).ended(z)}function R(){var z=this.__brush||{selection:null};return z.extent=lw(e.apply(this,arguments)),z.dim=t,z}return f.extent=function(z){return arguments.length?(e=typeof z=="function"?z:Ug(lw(z)),f):e},f.filter=function(z){return arguments.length?(i=typeof z=="function"?z:Ug(!!z),f):i},f.touchable=function(z){return arguments.length?(n=typeof z=="function"?z:Ug(!!z),f):n},f.handleSize=function(z){return arguments.length?(c=+z,f):c},f.keyModifiers=function(z){return arguments.length?(s=!!z,f):s},f.on=function(){var z=l.on.apply(l,arguments);return z===l?f:z},f}const K_=Math.PI,q_=2*K_,qc=1e-6,Q7=q_-qc;function YE(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=arguments[e]+t[e]}function $7(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return YE;const i=10**e;return function(n){this._+=n[0];for(let s=1,l=n.length;s<l;++s)this._+=Math.round(arguments[s]*i)/i+n[s]}}class e5{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?YE:$7(e)}moveTo(e,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,i){this._append`L${this._x1=+e},${this._y1=+i}`}quadraticCurveTo(e,i,n,s){this._append`Q${+e},${+i},${this._x1=+n},${this._y1=+s}`}bezierCurveTo(e,i,n,s,l,c){this._append`C${+e},${+i},${+n},${+s},${this._x1=+l},${this._y1=+c}`}arcTo(e,i,n,s,l){if(e=+e,i=+i,n=+n,s=+s,l=+l,l<0)throw new Error(`negative radius: ${l}`);let c=this._x1,r=this._y1,f=n-e,m=s-i,y=c-e,b=r-i,E=y*y+b*b;if(this._x1===null)this._append`M${this._x1=e},${this._y1=i}`;else if(E>qc)if(!(Math.abs(b*f-m*y)>qc)||!l)this._append`L${this._x1=e},${this._y1=i}`;else{let S=n-c,D=s-r,R=f*f+m*m,z=S*S+D*D,H=Math.sqrt(R),K=Math.sqrt(E),W=l*Math.tan((K_-Math.acos((R+E-z)/(2*H*K)))/2),se=W/K,Y=W/H;Math.abs(se-1)>qc&&this._append`L${e+se*y},${i+se*b}`,this._append`A${l},${l},0,0,${+(b*S>y*D)},${this._x1=e+Y*f},${this._y1=i+Y*m}`}}arc(e,i,n,s,l,c){if(e=+e,i=+i,n=+n,c=!!c,n<0)throw new Error(`negative radius: ${n}`);let r=n*Math.cos(s),f=n*Math.sin(s),m=e+r,y=i+f,b=1^c,E=c?s-l:l-s;this._x1===null?this._append`M${m},${y}`:(Math.abs(this._x1-m)>qc||Math.abs(this._y1-y)>qc)&&this._append`L${m},${y}`,n&&(E<0&&(E=E%q_+q_),E>Q7?this._append`A${n},${n},0,1,${b},${e-r},${i-f}A${n},${n},0,1,${b},${this._x1=m},${this._y1=y}`:E>qc&&this._append`A${n},${n},0,${+(E>=K_)},${b},${this._x1=e+n*Math.cos(l)},${this._y1=i+n*Math.sin(l)}`)}rect(e,i,n,s){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+i}h${n=+n}v${+s}h${-n}Z`}toString(){return this._}}function t5(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Wm(t,e){if((i=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var i,n=t.slice(0,i);return[n.length>1?n[0]+n.slice(2):n,+t.slice(i+1)]}function wh(t){return t=Wm(Math.abs(t)),t?t[1]:NaN}function i5(t,e){return function(i,n){for(var s=i.length,l=[],c=0,r=t[0],f=0;s>0&&r>0&&(f+r+1>n&&(r=Math.max(1,n-f)),l.push(i.substring(s-=r,s+r)),!((f+=r+1)>n));)r=t[c=(c+1)%t.length];return l.reverse().join(e)}}function n5(t){return function(e){return e.replace(/[0-9]/g,function(i){return t[+i]})}}var r5=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $d(t){if(!(e=r5.exec(t)))throw new Error("invalid format: "+t);var e;return new G0({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}$d.prototype=G0.prototype;function G0(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}G0.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function s5(t){e:for(var e=t.length,i=1,n=-1,s;i<e;++i)switch(t[i]){case".":n=s=i;break;case"0":n===0&&(n=i),s=i;break;default:if(!+t[i])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(s+1):t}var JE;function a5(t,e){var i=Wm(t,e);if(!i)return t+"";var n=i[0],s=i[1],l=s-(JE=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,c=n.length;return l===c?n:l>c?n+new Array(l-c+1).join("0"):l>0?n.slice(0,l)+"."+n.slice(l):"0."+new Array(1-l).join("0")+Wm(t,Math.max(0,e+l-1))[0]}function hw(t,e){var i=Wm(t,e);if(!i)return t+"";var n=i[0],s=i[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const dw={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:t5,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>hw(t*100,e),r:hw,s:a5,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function fw(t){return t}var mw=Array.prototype.map,pw=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function o5(t){var e=t.grouping===void 0||t.thousands===void 0?fw:i5(mw.call(t.grouping,Number),t.thousands+""),i=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",s=t.decimal===void 0?".":t.decimal+"",l=t.numerals===void 0?fw:n5(mw.call(t.numerals,String)),c=t.percent===void 0?"%":t.percent+"",r=t.minus===void 0?"":t.minus+"",f=t.nan===void 0?"NaN":t.nan+"";function m(b){b=$d(b);var E=b.fill,S=b.align,D=b.sign,R=b.symbol,z=b.zero,H=b.width,K=b.comma,W=b.precision,se=b.trim,Y=b.type;Y==="n"?(K=!0,Y="g"):dw[Y]||(W===void 0&&(W=12),se=!0,Y="g"),(z||E==="0"&&S==="=")&&(z=!0,E="0",S="=");var ne=R==="$"?i:R==="#"&&/[boxX]/.test(Y)?"0"+Y.toLowerCase():"",ue=R==="$"?n:/[%p]/.test(Y)?c:"",ve=dw[Y],_e=/[defgprs%]/.test(Y);W=W===void 0?6:/[gprs]/.test(Y)?Math.max(1,Math.min(21,W)):Math.max(0,Math.min(20,W));function oe(Be){var mt=ne,Le=ue,rt,tt,We;if(Y==="c")Le=ve(Be)+Le,Be="";else{Be=+Be;var Ve=Be<0||1/Be<0;if(Be=isNaN(Be)?f:ve(Math.abs(Be),W),se&&(Be=s5(Be)),Ve&&+Be==0&&D!=="+"&&(Ve=!1),mt=(Ve?D==="("?D:r:D==="-"||D==="("?"":D)+mt,Le=(Y==="s"?pw[8+JE/3]:"")+Le+(Ve&&D==="("?")":""),_e){for(rt=-1,tt=Be.length;++rt<tt;)if(We=Be.charCodeAt(rt),48>We||We>57){Le=(We===46?s+Be.slice(rt+1):Be.slice(rt))+Le,Be=Be.slice(0,rt);break}}}K&&!z&&(Be=e(Be,1/0));var St=mt.length+Be.length+Le.length,zt=St<H?new Array(H-St+1).join(E):"";switch(K&&z&&(Be=e(zt+Be,zt.length?H-Le.length:1/0),zt=""),S){case"<":Be=mt+Be+Le+zt;break;case"=":Be=mt+zt+Be+Le;break;case"^":Be=zt.slice(0,St=zt.length>>1)+mt+Be+Le+zt.slice(St);break;default:Be=zt+mt+Be+Le;break}return l(Be)}return oe.toString=function(){return b+""},oe}function y(b,E){var S=m((b=$d(b),b.type="f",b)),D=Math.max(-8,Math.min(8,Math.floor(wh(E)/3)))*3,R=Math.pow(10,-D),z=pw[8+D/3];return function(H){return S(R*H)+z}}return{format:m,formatPrefix:y}}var rm,H0,XE;l5({thousands:",",grouping:[3],currency:["$",""]});function l5(t){return rm=o5(t),H0=rm.format,XE=rm.formatPrefix,rm}function c5(t){return Math.max(0,-wh(Math.abs(t)))}function u5(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wh(e)/3)))*3-wh(Math.abs(t)))}function h5(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,wh(e)-wh(t))+1}function pf(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const gw=Symbol("implicit");function K0(){var t=new Ux,e=[],i=[],n=gw;function s(l){let c=t.get(l);if(c===void 0){if(n!==gw)return n;t.set(l,c=e.push(l)-1)}return i[c%i.length]}return s.domain=function(l){if(!arguments.length)return e.slice();e=[],t=new Ux;for(const c of l)t.has(c)||t.set(c,e.push(c)-1);return s},s.range=function(l){return arguments.length?(i=Array.from(l),s):i.slice()},s.unknown=function(l){return arguments.length?(n=l,s):n},s.copy=function(){return K0(e,i).unknown(n)},pf.apply(s,arguments),s}function q0(){var t=K0().unknown(void 0),e=t.domain,i=t.range,n=0,s=1,l,c,r=!1,f=0,m=0,y=.5;delete t.unknown;function b(){var E=e().length,S=s<n,D=S?s:n,R=S?n:s;l=(R-D)/Math.max(1,E-f+m*2),r&&(l=Math.floor(l)),D+=(R-D-l*(E-f))*y,c=l*(1-f),r&&(D=Math.round(D),c=Math.round(c));var z=dL(E).map(function(H){return D+l*H});return i(S?z.reverse():z)}return t.domain=function(E){return arguments.length?(e(E),b()):e()},t.range=function(E){return arguments.length?([n,s]=E,n=+n,s=+s,b()):[n,s]},t.rangeRound=function(E){return[n,s]=E,n=+n,s=+s,r=!0,b()},t.bandwidth=function(){return c},t.step=function(){return l},t.round=function(E){return arguments.length?(r=!!E,b()):r},t.padding=function(E){return arguments.length?(f=Math.min(1,m=+E),b()):f},t.paddingInner=function(E){return arguments.length?(f=Math.min(1,E),b()):f},t.paddingOuter=function(E){return arguments.length?(m=+E,b()):m},t.align=function(E){return arguments.length?(y=Math.max(0,Math.min(1,E)),b()):y},t.copy=function(){return q0(e(),[n,s]).round(r).paddingInner(f).paddingOuter(m).align(y)},pf.apply(b(),arguments)}function d5(t){return function(){return t}}function f5(t){return+t}var _w=[0,1];function sh(t){return t}function Z_(t,e){return(e-=t=+t)?function(i){return(i-t)/e}:d5(isNaN(e)?NaN:.5)}function m5(t,e){var i;return t>e&&(i=t,t=e,e=i),function(n){return Math.max(t,Math.min(e,n))}}function p5(t,e,i){var n=t[0],s=t[1],l=e[0],c=e[1];return s<n?(n=Z_(s,n),l=i(c,l)):(n=Z_(n,s),l=i(l,c)),function(r){return l(n(r))}}function g5(t,e,i){var n=Math.min(t.length,e.length)-1,s=new Array(n),l=new Array(n),c=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++c<n;)s[c]=Z_(t[c],t[c+1]),l[c]=i(e[c],e[c+1]);return function(r){var f=vE(t,r,1,n)-1;return l[f](s[f](r))}}function Z0(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function QE(){var t=_w,e=_w,i=vp,n,s,l,c=sh,r,f,m;function y(){var E=Math.min(t.length,e.length);return c!==sh&&(c=m5(t[0],t[E-1])),r=E>2?g5:p5,f=m=null,b}function b(E){return E==null||isNaN(E=+E)?l:(f||(f=r(t.map(n),e,i)))(n(c(E)))}return b.invert=function(E){return c(s((m||(m=r(e,t.map(n),To)))(E)))},b.domain=function(E){return arguments.length?(t=Array.from(E,f5),y()):t.slice()},b.range=function(E){return arguments.length?(e=Array.from(E),y()):e.slice()},b.rangeRound=function(E){return e=Array.from(E),i=I4,y()},b.clamp=function(E){return arguments.length?(c=E?!0:sh,y()):c!==sh},b.interpolate=function(E){return arguments.length?(i=E,y()):i},b.unknown=function(E){return arguments.length?(l=E,b):l},function(E,S){return n=E,s=S,y()}}function $E(){return QE()(sh,sh)}function _5(t,e,i,n){var s=R_(t,e,i),l;switch(n=$d(n??",f"),n.type){case"s":{var c=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(l=u5(s,c))&&(n.precision=l),XE(n,c)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(l=h5(s,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=l-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(l=c5(s))&&(n.precision=l-(n.type==="%")*2);break}}return H0(n)}function y5(t){var e=t.domain;return t.ticks=function(i){var n=e();return Vm(n[0],n[n.length-1],i??10)},t.tickFormat=function(i,n){var s=e();return _5(s[0],s[s.length-1],i??10,n)},t.nice=function(i){i==null&&(i=10);var n=e(),s=0,l=n.length-1,c=n[s],r=n[l],f,m,y=10;for(r<c&&(m=c,c=r,r=m,m=s,s=l,l=m);y-- >0;){if(m=vh(c,r,i),m===f)return n[s]=c,n[l]=r,e(n);if(m>0)c=Math.floor(c/m)*m,r=Math.ceil(r/m)*m;else if(m<0)c=Math.ceil(c*m)/m,r=Math.floor(r*m)/m;else break;f=m}return t},t}function Ym(){var t=$E();return t.copy=function(){return Z0(t,Ym())},pf.apply(t,arguments),y5(t)}function eT(t,e){t=t.slice();var i=0,n=t.length-1,s=t[i],l=t[n],c;return l<s&&(c=i,i=n,n=c,c=s,s=l,l=c),t[i]=e.floor(s),t[n]=e.ceil(l),t}function yw(t){return Math.log(t)}function vw(t){return Math.exp(t)}function v5(t){return-Math.log(-t)}function b5(t){return-Math.exp(-t)}function x5(t){return isFinite(t)?+("1e"+t):t<0?0:t}function w5(t){return t===10?x5:t===Math.E?Math.exp:e=>Math.pow(t,e)}function A5(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function bw(t){return(e,i)=>-t(-e,i)}function E5(t){const e=t(yw,vw),i=e.domain;let n=10,s,l;function c(){return s=A5(n),l=w5(n),i()[0]<0?(s=bw(s),l=bw(l),t(v5,b5)):t(yw,vw),e}return e.base=function(r){return arguments.length?(n=+r,c()):n},e.domain=function(r){return arguments.length?(i(r),c()):i()},e.ticks=r=>{const f=i();let m=f[0],y=f[f.length-1];const b=y<m;b&&([m,y]=[y,m]);let E=s(m),S=s(y),D,R;const z=r==null?10:+r;let H=[];if(!(n%1)&&S-E<z){if(E=Math.floor(E),S=Math.ceil(S),m>0){for(;E<=S;++E)for(D=1;D<n;++D)if(R=E<0?D/l(-E):D*l(E),!(R<m)){if(R>y)break;H.push(R)}}else for(;E<=S;++E)for(D=n-1;D>=1;--D)if(R=E>0?D/l(-E):D*l(E),!(R<m)){if(R>y)break;H.push(R)}H.length*2<z&&(H=Vm(m,y,z))}else H=Vm(E,S,Math.min(S-E,z)).map(l);return b?H.reverse():H},e.tickFormat=(r,f)=>{if(r==null&&(r=10),f==null&&(f=n===10?"s":","),typeof f!="function"&&(!(n%1)&&(f=$d(f)).precision==null&&(f.trim=!0),f=H0(f)),r===1/0)return f;const m=Math.max(1,n*r/e.ticks().length);return y=>{let b=y/l(Math.round(s(y)));return b*n<n-.5&&(b*=n),b<=m?f(y):""}},e.nice=()=>i(eT(i(),{floor:r=>l(Math.floor(s(r))),ceil:r=>l(Math.ceil(s(r)))})),e}function tT(){const t=E5(QE()).domain([1,10]);return t.copy=()=>Z0(t,tT()).base(t.base()),pf.apply(t,arguments),t}const qg=new Date,Zg=new Date;function ls(t,e,i,n){function s(l){return t(l=arguments.length===0?new Date:new Date(+l)),l}return s.floor=l=>(t(l=new Date(+l)),l),s.ceil=l=>(t(l=new Date(l-1)),e(l,1),t(l),l),s.round=l=>{const c=s(l),r=s.ceil(l);return l-c<r-l?c:r},s.offset=(l,c)=>(e(l=new Date(+l),c==null?1:Math.floor(c)),l),s.range=(l,c,r)=>{const f=[];if(l=s.ceil(l),r=r==null?1:Math.floor(r),!(l<c)||!(r>0))return f;let m;do f.push(m=new Date(+l)),e(l,r),t(l);while(m<l&&l<c);return f},s.filter=l=>ls(c=>{if(c>=c)for(;t(c),!l(c);)c.setTime(c-1)},(c,r)=>{if(c>=c)if(r<0)for(;++r<=0;)for(;e(c,-1),!l(c););else for(;--r>=0;)for(;e(c,1),!l(c););}),i&&(s.count=(l,c)=>(qg.setTime(+l),Zg.setTime(+c),t(qg),t(Zg),Math.floor(i(qg,Zg))),s.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?s.filter(n?c=>n(c)%l===0:c=>s.count(0,c)%l===0):s)),s}const Jm=ls(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Jm.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?ls(e=>{e.setTime(Math.floor(e/t)*t)},(e,i)=>{e.setTime(+e+i*t)},(e,i)=>(i-e)/t):Jm);Jm.range;const kl=1e3,so=kl*60,Ol=so*60,Rl=Ol*24,W0=Rl*7,xw=Rl*30,Wg=Rl*365,ah=ls(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*kl)},(t,e)=>(e-t)/kl,t=>t.getUTCSeconds());ah.range;const Y0=ls(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*kl)},(t,e)=>{t.setTime(+t+e*so)},(t,e)=>(e-t)/so,t=>t.getMinutes());Y0.range;const T5=ls(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*so)},(t,e)=>(e-t)/so,t=>t.getUTCMinutes());T5.range;const J0=ls(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*kl-t.getMinutes()*so)},(t,e)=>{t.setTime(+t+e*Ol)},(t,e)=>(e-t)/Ol,t=>t.getHours());J0.range;const S5=ls(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Ol)},(t,e)=>(e-t)/Ol,t=>t.getUTCHours());S5.range;const gf=ls(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*so)/Rl,t=>t.getDate()-1);gf.range;const X0=ls(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Rl,t=>t.getUTCDate()-1);X0.range;const I5=ls(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Rl,t=>Math.floor(t/Rl));I5.range;function pu(t){return ls(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,i)=>{e.setDate(e.getDate()+i*7)},(e,i)=>(i-e-(i.getTimezoneOffset()-e.getTimezoneOffset())*so)/W0)}const wp=pu(0),Xm=pu(1),k5=pu(2),O5=pu(3),Ah=pu(4),C5=pu(5),M5=pu(6);wp.range;Xm.range;k5.range;O5.range;Ah.range;C5.range;M5.range;function gu(t){return ls(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,i)=>{e.setUTCDate(e.getUTCDate()+i*7)},(e,i)=>(i-e)/W0)}const iT=gu(0),Qm=gu(1),D5=gu(2),R5=gu(3),Eh=gu(4),L5=gu(5),P5=gu(6);iT.range;Qm.range;D5.range;R5.range;Eh.range;L5.range;P5.range;const Q0=ls(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Q0.range;const N5=ls(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());N5.range;const Ll=ls(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Ll.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ls(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,i)=>{e.setFullYear(e.getFullYear()+i*t)});Ll.range;const lu=ls(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());lu.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ls(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,i)=>{e.setUTCFullYear(e.getUTCFullYear()+i*t)});lu.range;function z5(t,e,i,n,s,l){const c=[[ah,1,kl],[ah,5,5*kl],[ah,15,15*kl],[ah,30,30*kl],[l,1,so],[l,5,5*so],[l,15,15*so],[l,30,30*so],[s,1,Ol],[s,3,3*Ol],[s,6,6*Ol],[s,12,12*Ol],[n,1,Rl],[n,2,2*Rl],[i,1,W0],[e,1,xw],[e,3,3*xw],[t,1,Wg]];function r(m,y,b){const E=y<m;E&&([m,y]=[y,m]);const S=b&&typeof b.range=="function"?b:f(m,y,b),D=S?S.range(m,+y+1):[];return E?D.reverse():D}function f(m,y,b){const E=Math.abs(y-m)/b,S=L0(([,,z])=>z).right(c,E);if(S===c.length)return t.every(R_(m/Wg,y/Wg,b));if(S===0)return Jm.every(Math.max(R_(m,y,b),1));const[D,R]=c[E/c[S-1][2]<c[S][2]/E?S-1:S];return D.every(R)}return[r,f]}const[B5,V5]=z5(Ll,Q0,wp,gf,J0,Y0);function Yg(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Jg(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function bd(t,e,i){return{y:t,m:e,d:i,H:0,M:0,S:0,L:0}}function F5(t){var e=t.dateTime,i=t.date,n=t.time,s=t.periods,l=t.days,c=t.shortDays,r=t.months,f=t.shortMonths,m=xd(s),y=wd(s),b=xd(l),E=wd(l),S=xd(c),D=wd(c),R=xd(r),z=wd(r),H=xd(f),K=wd(f),W={a:Ve,A:St,b:zt,B:mi,c:null,d:Iw,e:Iw,f:cN,g:vN,G:xN,H:aN,I:oN,j:lN,L:nT,m:uN,M:hN,p:vt,q:pt,Q:Cw,s:Mw,S:dN,u:fN,U:mN,V:pN,w:gN,W:_N,x:null,X:null,y:yN,Y:bN,Z:wN,"%":Ow},se={a:Pt,A:qe,b:Ht,B:lt,c:null,d:kw,e:kw,f:SN,g:NN,G:BN,H:AN,I:EN,j:TN,L:sT,m:IN,M:kN,p:Gt,q:Mi,Q:Cw,s:Mw,S:ON,u:CN,U:MN,V:DN,w:RN,W:LN,x:null,X:null,y:PN,Y:zN,Z:VN,"%":Ow},Y={a:oe,A:Be,b:mt,B:Le,c:rt,d:Tw,e:Tw,f:iN,g:Ew,G:Aw,H:Sw,I:Sw,j:Q5,L:tN,m:X5,M:$5,p:_e,q:J5,Q:rN,s:sN,S:eN,u:K5,U:q5,V:Z5,w:H5,W:W5,x:tt,X:We,y:Ew,Y:Aw,Z:Y5,"%":nN};W.x=ne(i,W),W.X=ne(n,W),W.c=ne(e,W),se.x=ne(i,se),se.X=ne(n,se),se.c=ne(e,se);function ne(bt,ze){return function($t){var dt=[],_t=-1,ni=0,Wi=bt.length,ct,et,zi;for($t instanceof Date||($t=new Date(+$t));++_t<Wi;)bt.charCodeAt(_t)===37&&(dt.push(bt.slice(ni,_t)),(et=ww[ct=bt.charAt(++_t)])!=null?ct=bt.charAt(++_t):et=ct==="e"?" ":"0",(zi=ze[ct])&&(ct=zi($t,et)),dt.push(ct),ni=_t+1);return dt.push(bt.slice(ni,_t)),dt.join("")}}function ue(bt,ze){return function($t){var dt=bd(1900,void 0,1),_t=ve(dt,bt,$t+="",0),ni,Wi;if(_t!=$t.length)return null;if("Q"in dt)return new Date(dt.Q);if("s"in dt)return new Date(dt.s*1e3+("L"in dt?dt.L:0));if(ze&&!("Z"in dt)&&(dt.Z=0),"p"in dt&&(dt.H=dt.H%12+dt.p*12),dt.m===void 0&&(dt.m="q"in dt?dt.q:0),"V"in dt){if(dt.V<1||dt.V>53)return null;"w"in dt||(dt.w=1),"Z"in dt?(ni=Jg(bd(dt.y,0,1)),Wi=ni.getUTCDay(),ni=Wi>4||Wi===0?Qm.ceil(ni):Qm(ni),ni=X0.offset(ni,(dt.V-1)*7),dt.y=ni.getUTCFullYear(),dt.m=ni.getUTCMonth(),dt.d=ni.getUTCDate()+(dt.w+6)%7):(ni=Yg(bd(dt.y,0,1)),Wi=ni.getDay(),ni=Wi>4||Wi===0?Xm.ceil(ni):Xm(ni),ni=gf.offset(ni,(dt.V-1)*7),dt.y=ni.getFullYear(),dt.m=ni.getMonth(),dt.d=ni.getDate()+(dt.w+6)%7)}else("W"in dt||"U"in dt)&&("w"in dt||(dt.w="u"in dt?dt.u%7:"W"in dt?1:0),Wi="Z"in dt?Jg(bd(dt.y,0,1)).getUTCDay():Yg(bd(dt.y,0,1)).getDay(),dt.m=0,dt.d="W"in dt?(dt.w+6)%7+dt.W*7-(Wi+5)%7:dt.w+dt.U*7-(Wi+6)%7);return"Z"in dt?(dt.H+=dt.Z/100|0,dt.M+=dt.Z%100,Jg(dt)):Yg(dt)}}function ve(bt,ze,$t,dt){for(var _t=0,ni=ze.length,Wi=$t.length,ct,et;_t<ni;){if(dt>=Wi)return-1;if(ct=ze.charCodeAt(_t++),ct===37){if(ct=ze.charAt(_t++),et=Y[ct in ww?ze.charAt(_t++):ct],!et||(dt=et(bt,$t,dt))<0)return-1}else if(ct!=$t.charCodeAt(dt++))return-1}return dt}function _e(bt,ze,$t){var dt=m.exec(ze.slice($t));return dt?(bt.p=y.get(dt[0].toLowerCase()),$t+dt[0].length):-1}function oe(bt,ze,$t){var dt=S.exec(ze.slice($t));return dt?(bt.w=D.get(dt[0].toLowerCase()),$t+dt[0].length):-1}function Be(bt,ze,$t){var dt=b.exec(ze.slice($t));return dt?(bt.w=E.get(dt[0].toLowerCase()),$t+dt[0].length):-1}function mt(bt,ze,$t){var dt=H.exec(ze.slice($t));return dt?(bt.m=K.get(dt[0].toLowerCase()),$t+dt[0].length):-1}function Le(bt,ze,$t){var dt=R.exec(ze.slice($t));return dt?(bt.m=z.get(dt[0].toLowerCase()),$t+dt[0].length):-1}function rt(bt,ze,$t){return ve(bt,e,ze,$t)}function tt(bt,ze,$t){return ve(bt,i,ze,$t)}function We(bt,ze,$t){return ve(bt,n,ze,$t)}function Ve(bt){return c[bt.getDay()]}function St(bt){return l[bt.getDay()]}function zt(bt){return f[bt.getMonth()]}function mi(bt){return r[bt.getMonth()]}function vt(bt){return s[+(bt.getHours()>=12)]}function pt(bt){return 1+~~(bt.getMonth()/3)}function Pt(bt){return c[bt.getUTCDay()]}function qe(bt){return l[bt.getUTCDay()]}function Ht(bt){return f[bt.getUTCMonth()]}function lt(bt){return r[bt.getUTCMonth()]}function Gt(bt){return s[+(bt.getUTCHours()>=12)]}function Mi(bt){return 1+~~(bt.getUTCMonth()/3)}return{format:function(bt){var ze=ne(bt+="",W);return ze.toString=function(){return bt},ze},parse:function(bt){var ze=ue(bt+="",!1);return ze.toString=function(){return bt},ze},utcFormat:function(bt){var ze=ne(bt+="",se);return ze.toString=function(){return bt},ze},utcParse:function(bt){var ze=ue(bt+="",!0);return ze.toString=function(){return bt},ze}}}var ww={"-":"",_:" ",0:"0"},vs=/^\s*\d+/,U5=/^%/,j5=/[\\^$*+?|[\]().{}]/g;function Nn(t,e,i){var n=t<0?"-":"",s=(n?-t:t)+"",l=s.length;return n+(l<i?new Array(i-l+1).join(e)+s:s)}function G5(t){return t.replace(j5,"\\$&")}function xd(t){return new RegExp("^(?:"+t.map(G5).join("|")+")","i")}function wd(t){return new Map(t.map((e,i)=>[e.toLowerCase(),i]))}function H5(t,e,i){var n=vs.exec(e.slice(i,i+1));return n?(t.w=+n[0],i+n[0].length):-1}function K5(t,e,i){var n=vs.exec(e.slice(i,i+1));return n?(t.u=+n[0],i+n[0].length):-1}function q5(t,e,i){var n=vs.exec(e.slice(i,i+2));return n?(t.U=+n[0],i+n[0].length):-1}function Z5(t,e,i){var n=vs.exec(e.slice(i,i+2));return n?(t.V=+n[0],i+n[0].length):-1}function W5(t,e,i){var n=vs.exec(e.slice(i,i+2));return n?(t.W=+n[0],i+n[0].length):-1}function Aw(t,e,i){var n=vs.exec(e.slice(i,i+4));return n?(t.y=+n[0],i+n[0].length):-1}function Ew(t,e,i){var n=vs.exec(e.slice(i,i+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),i+n[0].length):-1}function Y5(t,e,i){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(i,i+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),i+n[0].length):-1}function J5(t,e,i){var n=vs.exec(e.slice(i,i+1));return n?(t.q=n[0]*3-3,i+n[0].length):-1}function X5(t,e,i){var n=vs.exec(e.slice(i,i+2));return n?(t.m=n[0]-1,i+n[0].length):-1}function Tw(t,e,i){var n=vs.exec(e.slice(i,i+2));return n?(t.d=+n[0],i+n[0].length):-1}function Q5(t,e,i){var n=vs.exec(e.slice(i,i+3));return n?(t.m=0,t.d=+n[0],i+n[0].length):-1}function Sw(t,e,i){var n=vs.exec(e.slice(i,i+2));return n?(t.H=+n[0],i+n[0].length):-1}function $5(t,e,i){var n=vs.exec(e.slice(i,i+2));return n?(t.M=+n[0],i+n[0].length):-1}function eN(t,e,i){var n=vs.exec(e.slice(i,i+2));return n?(t.S=+n[0],i+n[0].length):-1}function tN(t,e,i){var n=vs.exec(e.slice(i,i+3));return n?(t.L=+n[0],i+n[0].length):-1}function iN(t,e,i){var n=vs.exec(e.slice(i,i+6));return n?(t.L=Math.floor(n[0]/1e3),i+n[0].length):-1}function nN(t,e,i){var n=U5.exec(e.slice(i,i+1));return n?i+n[0].length:-1}function rN(t,e,i){var n=vs.exec(e.slice(i));return n?(t.Q=+n[0],i+n[0].length):-1}function sN(t,e,i){var n=vs.exec(e.slice(i));return n?(t.s=+n[0],i+n[0].length):-1}function Iw(t,e){return Nn(t.getDate(),e,2)}function aN(t,e){return Nn(t.getHours(),e,2)}function oN(t,e){return Nn(t.getHours()%12||12,e,2)}function lN(t,e){return Nn(1+gf.count(Ll(t),t),e,3)}function nT(t,e){return Nn(t.getMilliseconds(),e,3)}function cN(t,e){return nT(t,e)+"000"}function uN(t,e){return Nn(t.getMonth()+1,e,2)}function hN(t,e){return Nn(t.getMinutes(),e,2)}function dN(t,e){return Nn(t.getSeconds(),e,2)}function fN(t){var e=t.getDay();return e===0?7:e}function mN(t,e){return Nn(wp.count(Ll(t)-1,t),e,2)}function rT(t){var e=t.getDay();return e>=4||e===0?Ah(t):Ah.ceil(t)}function pN(t,e){return t=rT(t),Nn(Ah.count(Ll(t),t)+(Ll(t).getDay()===4),e,2)}function gN(t){return t.getDay()}function _N(t,e){return Nn(Xm.count(Ll(t)-1,t),e,2)}function yN(t,e){return Nn(t.getFullYear()%100,e,2)}function vN(t,e){return t=rT(t),Nn(t.getFullYear()%100,e,2)}function bN(t,e){return Nn(t.getFullYear()%1e4,e,4)}function xN(t,e){var i=t.getDay();return t=i>=4||i===0?Ah(t):Ah.ceil(t),Nn(t.getFullYear()%1e4,e,4)}function wN(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Nn(e/60|0,"0",2)+Nn(e%60,"0",2)}function kw(t,e){return Nn(t.getUTCDate(),e,2)}function AN(t,e){return Nn(t.getUTCHours(),e,2)}function EN(t,e){return Nn(t.getUTCHours()%12||12,e,2)}function TN(t,e){return Nn(1+X0.count(lu(t),t),e,3)}function sT(t,e){return Nn(t.getUTCMilliseconds(),e,3)}function SN(t,e){return sT(t,e)+"000"}function IN(t,e){return Nn(t.getUTCMonth()+1,e,2)}function kN(t,e){return Nn(t.getUTCMinutes(),e,2)}function ON(t,e){return Nn(t.getUTCSeconds(),e,2)}function CN(t){var e=t.getUTCDay();return e===0?7:e}function MN(t,e){return Nn(iT.count(lu(t)-1,t),e,2)}function aT(t){var e=t.getUTCDay();return e>=4||e===0?Eh(t):Eh.ceil(t)}function DN(t,e){return t=aT(t),Nn(Eh.count(lu(t),t)+(lu(t).getUTCDay()===4),e,2)}function RN(t){return t.getUTCDay()}function LN(t,e){return Nn(Qm.count(lu(t)-1,t),e,2)}function PN(t,e){return Nn(t.getUTCFullYear()%100,e,2)}function NN(t,e){return t=aT(t),Nn(t.getUTCFullYear()%100,e,2)}function zN(t,e){return Nn(t.getUTCFullYear()%1e4,e,4)}function BN(t,e){var i=t.getUTCDay();return t=i>=4||i===0?Eh(t):Eh.ceil(t),Nn(t.getUTCFullYear()%1e4,e,4)}function VN(){return"+0000"}function Ow(){return"%"}function Cw(t){return+t}function Mw(t){return Math.floor(+t/1e3)}var qu,oT;FN({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function FN(t){return qu=F5(t),oT=qu.format,qu.parse,qu.utcFormat,qu.utcParse,qu}function UN(t){return new Date(t)}function jN(t){return t instanceof Date?+t:+new Date(+t)}function lT(t,e,i,n,s,l,c,r,f,m){var y=$E(),b=y.invert,E=y.domain,S=m(".%L"),D=m(":%S"),R=m("%I:%M"),z=m("%I %p"),H=m("%a %d"),K=m("%b %d"),W=m("%B"),se=m("%Y");function Y(ne){return(f(ne)<ne?S:r(ne)<ne?D:c(ne)<ne?R:l(ne)<ne?z:n(ne)<ne?s(ne)<ne?H:K:i(ne)<ne?W:se)(ne)}return y.invert=function(ne){return new Date(b(ne))},y.domain=function(ne){return arguments.length?E(Array.from(ne,jN)):E().map(UN)},y.ticks=function(ne){var ue=E();return t(ue[0],ue[ue.length-1],ne??10)},y.tickFormat=function(ne,ue){return ue==null?Y:m(ue)},y.nice=function(ne){var ue=E();return(!ne||typeof ne.range!="function")&&(ne=e(ue[0],ue[ue.length-1],ne??10)),ne?E(eT(ue,ne)):y},y.copy=function(){return Z0(y,lT(t,e,i,n,s,l,c,r,f,m))},y}function cT(){return pf.apply(lT(B5,V5,Ll,Q0,wp,gf,J0,Y0,ah,oT).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Zn(t){return function(){return t}}const Dw=Math.abs,js=Math.atan2,Gc=Math.cos,GN=Math.max,Xg=Math.min,Wo=Math.sin,oh=Math.sqrt,Gs=1e-12,ef=Math.PI,$m=ef/2,HN=2*ef;function KN(t){return t>1?0:t<-1?ef:Math.acos(t)}function Rw(t){return t>=1?$m:t<=-1?-$m:Math.asin(t)}function $0(t){let e=3;return t.digits=function(i){if(!arguments.length)return e;if(i==null)e=null;else{const n=Math.floor(i);if(!(n>=0))throw new RangeError(`invalid digits: ${i}`);e=n}return t},()=>new e5(e)}function qN(t){return t.innerRadius}function ZN(t){return t.outerRadius}function WN(t){return t.startAngle}function YN(t){return t.endAngle}function JN(t){return t&&t.padAngle}function XN(t,e,i,n,s,l,c,r){var f=i-t,m=n-e,y=c-s,b=r-l,E=b*f-y*m;if(!(E*E<Gs))return E=(y*(e-l)-b*(t-s))/E,[t+E*f,e+E*m]}function sm(t,e,i,n,s,l,c){var r=t-i,f=e-n,m=(c?l:-l)/oh(r*r+f*f),y=m*f,b=-m*r,E=t+y,S=e+b,D=i+y,R=n+b,z=(E+D)/2,H=(S+R)/2,K=D-E,W=R-S,se=K*K+W*W,Y=s-l,ne=E*R-D*S,ue=(W<0?-1:1)*oh(GN(0,Y*Y*se-ne*ne)),ve=(ne*W-K*ue)/se,_e=(-ne*K-W*ue)/se,oe=(ne*W+K*ue)/se,Be=(-ne*K+W*ue)/se,mt=ve-z,Le=_e-H,rt=oe-z,tt=Be-H;return mt*mt+Le*Le>rt*rt+tt*tt&&(ve=oe,_e=Be),{cx:ve,cy:_e,x01:-y,y01:-b,x11:ve*(s/Y-1),y11:_e*(s/Y-1)}}function QN(){var t=qN,e=ZN,i=Zn(0),n=null,s=WN,l=YN,c=JN,r=null,f=$0(m);function m(){var y,b,E=+t.apply(this,arguments),S=+e.apply(this,arguments),D=s.apply(this,arguments)-$m,R=l.apply(this,arguments)-$m,z=Dw(R-D),H=R>D;if(r||(r=y=f()),S<E&&(b=S,S=E,E=b),!(S>Gs))r.moveTo(0,0);else if(z>HN-Gs)r.moveTo(S*Gc(D),S*Wo(D)),r.arc(0,0,S,D,R,!H),E>Gs&&(r.moveTo(E*Gc(R),E*Wo(R)),r.arc(0,0,E,R,D,H));else{var K=D,W=R,se=D,Y=R,ne=z,ue=z,ve=c.apply(this,arguments)/2,_e=ve>Gs&&(n?+n.apply(this,arguments):oh(E*E+S*S)),oe=Xg(Dw(S-E)/2,+i.apply(this,arguments)),Be=oe,mt=oe,Le,rt;if(_e>Gs){var tt=Rw(_e/E*Wo(ve)),We=Rw(_e/S*Wo(ve));(ne-=tt*2)>Gs?(tt*=H?1:-1,se+=tt,Y-=tt):(ne=0,se=Y=(D+R)/2),(ue-=We*2)>Gs?(We*=H?1:-1,K+=We,W-=We):(ue=0,K=W=(D+R)/2)}var Ve=S*Gc(K),St=S*Wo(K),zt=E*Gc(Y),mi=E*Wo(Y);if(oe>Gs){var vt=S*Gc(W),pt=S*Wo(W),Pt=E*Gc(se),qe=E*Wo(se),Ht;if(z<ef)if(Ht=XN(Ve,St,Pt,qe,vt,pt,zt,mi)){var lt=Ve-Ht[0],Gt=St-Ht[1],Mi=vt-Ht[0],bt=pt-Ht[1],ze=1/Wo(KN((lt*Mi+Gt*bt)/(oh(lt*lt+Gt*Gt)*oh(Mi*Mi+bt*bt)))/2),$t=oh(Ht[0]*Ht[0]+Ht[1]*Ht[1]);Be=Xg(oe,(E-$t)/(ze-1)),mt=Xg(oe,(S-$t)/(ze+1))}else Be=mt=0}ue>Gs?mt>Gs?(Le=sm(Pt,qe,Ve,St,S,mt,H),rt=sm(vt,pt,zt,mi,S,mt,H),r.moveTo(Le.cx+Le.x01,Le.cy+Le.y01),mt<oe?r.arc(Le.cx,Le.cy,mt,js(Le.y01,Le.x01),js(rt.y01,rt.x01),!H):(r.arc(Le.cx,Le.cy,mt,js(Le.y01,Le.x01),js(Le.y11,Le.x11),!H),r.arc(0,0,S,js(Le.cy+Le.y11,Le.cx+Le.x11),js(rt.cy+rt.y11,rt.cx+rt.x11),!H),r.arc(rt.cx,rt.cy,mt,js(rt.y11,rt.x11),js(rt.y01,rt.x01),!H))):(r.moveTo(Ve,St),r.arc(0,0,S,K,W,!H)):r.moveTo(Ve,St),!(E>Gs)||!(ne>Gs)?r.lineTo(zt,mi):Be>Gs?(Le=sm(zt,mi,vt,pt,E,-Be,H),rt=sm(Ve,St,Pt,qe,E,-Be,H),r.lineTo(Le.cx+Le.x01,Le.cy+Le.y01),Be<oe?r.arc(Le.cx,Le.cy,Be,js(Le.y01,Le.x01),js(rt.y01,rt.x01),!H):(r.arc(Le.cx,Le.cy,Be,js(Le.y01,Le.x01),js(Le.y11,Le.x11),!H),r.arc(0,0,E,js(Le.cy+Le.y11,Le.cx+Le.x11),js(rt.cy+rt.y11,rt.cx+rt.x11),H),r.arc(rt.cx,rt.cy,Be,js(rt.y11,rt.x11),js(rt.y01,rt.x01),!H))):r.arc(0,0,E,Y,se,H)}if(r.closePath(),y)return r=null,y+""||null}return m.centroid=function(){var y=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,b=(+s.apply(this,arguments)+ +l.apply(this,arguments))/2-ef/2;return[Gc(b)*y,Wo(b)*y]},m.innerRadius=function(y){return arguments.length?(t=typeof y=="function"?y:Zn(+y),m):t},m.outerRadius=function(y){return arguments.length?(e=typeof y=="function"?y:Zn(+y),m):e},m.cornerRadius=function(y){return arguments.length?(i=typeof y=="function"?y:Zn(+y),m):i},m.padRadius=function(y){return arguments.length?(n=y==null?null:typeof y=="function"?y:Zn(+y),m):n},m.startAngle=function(y){return arguments.length?(s=typeof y=="function"?y:Zn(+y),m):s},m.endAngle=function(y){return arguments.length?(l=typeof y=="function"?y:Zn(+y),m):l},m.padAngle=function(y){return arguments.length?(c=typeof y=="function"?y:Zn(+y),m):c},m.context=function(y){return arguments.length?(r=y??null,m):r},m}function ey(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function uT(t){this._context=t}uT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function ty(t){return new uT(t)}function hT(t){return t[0]}function dT(t){return t[1]}function iy(t,e){var i=Zn(!0),n=null,s=ty,l=null,c=$0(r);t=typeof t=="function"?t:t===void 0?hT:Zn(t),e=typeof e=="function"?e:e===void 0?dT:Zn(e);function r(f){var m,y=(f=ey(f)).length,b,E=!1,S;for(n==null&&(l=s(S=c())),m=0;m<=y;++m)!(m<y&&i(b=f[m],m,f))===E&&((E=!E)?l.lineStart():l.lineEnd()),E&&l.point(+t(b,m,f),+e(b,m,f));if(S)return l=null,S+""||null}return r.x=function(f){return arguments.length?(t=typeof f=="function"?f:Zn(+f),r):t},r.y=function(f){return arguments.length?(e=typeof f=="function"?f:Zn(+f),r):e},r.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Zn(!!f),r):i},r.curve=function(f){return arguments.length?(s=f,n!=null&&(l=s(n)),r):s},r.context=function(f){return arguments.length?(f==null?n=l=null:l=s(n=f),r):n},r}function ny(t,e,i){var n=null,s=Zn(!0),l=null,c=ty,r=null,f=$0(m);t=typeof t=="function"?t:t===void 0?hT:Zn(+t),e=typeof e=="function"?e:Zn(e===void 0?0:+e),i=typeof i=="function"?i:i===void 0?dT:Zn(+i);function m(b){var E,S,D,R=(b=ey(b)).length,z,H=!1,K,W=new Array(R),se=new Array(R);for(l==null&&(r=c(K=f())),E=0;E<=R;++E){if(!(E<R&&s(z=b[E],E,b))===H)if(H=!H)S=E,r.areaStart(),r.lineStart();else{for(r.lineEnd(),r.lineStart(),D=E-1;D>=S;--D)r.point(W[D],se[D]);r.lineEnd(),r.areaEnd()}H&&(W[E]=+t(z,E,b),se[E]=+e(z,E,b),r.point(n?+n(z,E,b):W[E],i?+i(z,E,b):se[E]))}if(K)return r=null,K+""||null}function y(){return iy().defined(s).curve(c).context(l)}return m.x=function(b){return arguments.length?(t=typeof b=="function"?b:Zn(+b),n=null,m):t},m.x0=function(b){return arguments.length?(t=typeof b=="function"?b:Zn(+b),m):t},m.x1=function(b){return arguments.length?(n=b==null?null:typeof b=="function"?b:Zn(+b),m):n},m.y=function(b){return arguments.length?(e=typeof b=="function"?b:Zn(+b),i=null,m):e},m.y0=function(b){return arguments.length?(e=typeof b=="function"?b:Zn(+b),m):e},m.y1=function(b){return arguments.length?(i=b==null?null:typeof b=="function"?b:Zn(+b),m):i},m.lineX0=m.lineY0=function(){return y().x(t).y(e)},m.lineY1=function(){return y().x(t).y(i)},m.lineX1=function(){return y().x(n).y(e)},m.defined=function(b){return arguments.length?(s=typeof b=="function"?b:Zn(!!b),m):s},m.curve=function(b){return arguments.length?(c=b,l!=null&&(r=c(l)),m):c},m.context=function(b){return arguments.length?(b==null?l=r=null:r=c(l=b),m):l},m}function Tc(){}function ep(t,e,i){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+i)/6)}function Ap(t){this._context=t}Ap.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ep(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ep(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function $N(t){return new Ap(t)}function fT(t){this._context=t}fT.prototype={areaStart:Tc,areaEnd:Tc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:ep(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function e6(t){return new fT(t)}function mT(t){this._context=t}mT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var i=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(i,n):this._context.moveTo(i,n);break;case 3:this._point=4;default:ep(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function t6(t){return new mT(t)}function pT(t,e){this._basis=new Ap(t),this._beta=e}pT.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,i=t.length-1;if(i>0)for(var n=t[0],s=e[0],l=t[i]-n,c=e[i]-s,r=-1,f;++r<=i;)f=r/i,this._basis.point(this._beta*t[r]+(1-this._beta)*(n+f*l),this._beta*e[r]+(1-this._beta)*(s+f*c));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const i6=function t(e){function i(n){return e===1?new Ap(n):new pT(n,e)}return i.beta=function(n){return t(+n)},i}(.85);function tp(t,e,i){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-i),t._x2,t._y2)}function ry(t,e){this._context=t,this._k=(1-e)/6}ry.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:tp(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:tp(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const n6=function t(e){function i(n){return new ry(n,e)}return i.tension=function(n){return t(+n)},i}(0);function sy(t,e){this._context=t,this._k=(1-e)/6}sy.prototype={areaStart:Tc,areaEnd:Tc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:tp(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const r6=function t(e){function i(n){return new sy(n,e)}return i.tension=function(n){return t(+n)},i}(0);function ay(t,e){this._context=t,this._k=(1-e)/6}ay.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:tp(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const s6=function t(e){function i(n){return new ay(n,e)}return i.tension=function(n){return t(+n)},i}(0);function oy(t,e,i){var n=t._x1,s=t._y1,l=t._x2,c=t._y2;if(t._l01_a>Gs){var r=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,f=3*t._l01_a*(t._l01_a+t._l12_a);n=(n*r-t._x0*t._l12_2a+t._x2*t._l01_2a)/f,s=(s*r-t._y0*t._l12_2a+t._y2*t._l01_2a)/f}if(t._l23_a>Gs){var m=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,y=3*t._l23_a*(t._l23_a+t._l12_a);l=(l*m+t._x1*t._l23_2a-e*t._l12_2a)/y,c=(c*m+t._y1*t._l23_2a-i*t._l12_2a)/y}t._context.bezierCurveTo(n,s,l,c,t._x2,t._y2)}function gT(t,e){this._context=t,this._alpha=e}gT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var i=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:oy(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const a6=function t(e){function i(n){return e?new gT(n,e):new ry(n,0)}return i.alpha=function(n){return t(+n)},i}(.5);function _T(t,e){this._context=t,this._alpha=e}_T.prototype={areaStart:Tc,areaEnd:Tc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var i=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:oy(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const o6=function t(e){function i(n){return e?new _T(n,e):new sy(n,0)}return i.alpha=function(n){return t(+n)},i}(.5);function yT(t,e){this._context=t,this._alpha=e}yT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var i=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+n*n,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:oy(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const l6=function t(e){function i(n){return e?new yT(n,e):new ay(n,0)}return i.alpha=function(n){return t(+n)},i}(.5);function vT(t){this._context=t}vT.prototype={areaStart:Tc,areaEnd:Tc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function c6(t){return new vT(t)}function Lw(t){return t<0?-1:1}function Pw(t,e,i){var n=t._x1-t._x0,s=e-t._x1,l=(t._y1-t._y0)/(n||s<0&&-0),c=(i-t._y1)/(s||n<0&&-0),r=(l*s+c*n)/(n+s);return(Lw(l)+Lw(c))*Math.min(Math.abs(l),Math.abs(c),.5*Math.abs(r))||0}function Nw(t,e){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function Qg(t,e,i){var n=t._x0,s=t._y0,l=t._x1,c=t._y1,r=(l-n)/3;t._context.bezierCurveTo(n+r,s+r*e,l-r,c-r*i,l,c)}function ip(t){this._context=t}ip.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Qg(this,this._t0,Nw(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var i=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Qg(this,Nw(this,i=Pw(this,t,e)),i);break;default:Qg(this,this._t0,i=Pw(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=i}}};function bT(t){this._context=new xT(t)}(bT.prototype=Object.create(ip.prototype)).point=function(t,e){ip.prototype.point.call(this,e,t)};function xT(t){this._context=t}xT.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,i,n,s,l){this._context.bezierCurveTo(e,t,n,i,l,s)}};function u6(t){return new ip(t)}function h6(t){return new bT(t)}function wT(t){this._context=t}wT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,i=t.length;if(i)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),i===2)this._context.lineTo(t[1],e[1]);else for(var n=zw(t),s=zw(e),l=0,c=1;c<i;++l,++c)this._context.bezierCurveTo(n[0][l],s[0][l],n[1][l],s[1][l],t[c],e[c]);(this._line||this._line!==0&&i===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function zw(t){var e,i=t.length-1,n,s=new Array(i),l=new Array(i),c=new Array(i);for(s[0]=0,l[0]=2,c[0]=t[0]+2*t[1],e=1;e<i-1;++e)s[e]=1,l[e]=4,c[e]=4*t[e]+2*t[e+1];for(s[i-1]=2,l[i-1]=7,c[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=s[e]/l[e-1],l[e]-=n,c[e]-=n*c[e-1];for(s[i-1]=c[i-1]/l[i-1],e=i-2;e>=0;--e)s[e]=(c[e]-s[e+1])/l[e];for(l[i-1]=(t[i]+s[i-1])/2,e=0;e<i-1;++e)l[e]=2*t[e+1]-s[e+1];return[s,l]}function d6(t){return new wT(t)}function Ep(t,e){this._context=t,this._t=e}Ep.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var i=this._x*(1-this._t)+t*this._t;this._context.lineTo(i,this._y),this._context.lineTo(i,e)}break}}this._x=t,this._y=e}};function f6(t){return new Ep(t,.5)}function m6(t){return new Ep(t,0)}function p6(t){return new Ep(t,1)}function Bw(t,e){if((c=t.length)>1)for(var i=1,n,s,l=t[e[0]],c,r=l.length;i<c;++i)for(s=l,l=t[e[i]],n=0;n<r;++n)l[n][1]+=l[n][0]=isNaN(s[n][1])?s[n][0]:s[n][1]}function Vw(t){for(var e=t.length,i=new Array(e);--e>=0;)i[e]=e;return i}function g6(t,e){return t[e]}function _6(t){const e=[];return e.key=t,e}function $g(){var t=Zn([]),e=Vw,i=Bw,n=g6;function s(l){var c=Array.from(t.apply(this,arguments),_6),r,f=c.length,m=-1,y;for(const b of l)for(r=0,++m;r<f;++r)(c[r][m]=[0,+n(b,c[r].key,m,l)]).data=b;for(r=0,y=ey(e(c));r<f;++r)c[y[r]].index=r;return i(c,y),c}return s.keys=function(l){return arguments.length?(t=typeof l=="function"?l:Zn(Array.from(l)),s):t},s.value=function(l){return arguments.length?(n=typeof l=="function"?l:Zn(+l),s):n},s.order=function(l){return arguments.length?(e=l==null?Vw:typeof l=="function"?l:Zn(Array.from(l)),s):e},s.offset=function(l){return arguments.length?(i=l??Bw,s):i},s}function y6(t,e){if((f=t.length)>0)for(var i,n=0,s,l,c,r,f,m=t[e[0]].length;n<m;++n)for(c=r=0,i=0;i<f;++i)(l=(s=t[e[i]][n])[1]-s[0])>0?(s[0]=c,s[1]=c+=l):l<0?(s[1]=r,s[0]=r+=l):(s[0]=0,s[1]=l)}function Pd(t,e,i){this.k=t,this.x=e,this.y=i}Pd.prototype={constructor:Pd,scale:function(t){return t===1?this:new Pd(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Pd(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Pd.prototype;function e_(t){return(e={})=>{const i=e.width?String(e.width):t.defaultWidth;return t.formats[i]||t.formats[t.defaultWidth]}}function Ad(t){return(e,i)=>{const n=i!=null&&i.context?String(i.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const c=t.defaultFormattingWidth||t.defaultWidth,r=i!=null&&i.width?String(i.width):c;s=t.formattingValues[r]||t.formattingValues[c]}else{const c=t.defaultWidth,r=i!=null&&i.width?String(i.width):t.defaultWidth;s=t.values[r]||t.values[c]}const l=t.argumentCallback?t.argumentCallback(e):e;return s[l]}}function Ed(t){return(e,i={})=>{const n=i.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],l=e.match(s);if(!l)return null;const c=l[0],r=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],f=Array.isArray(r)?b6(r,b=>b.test(c)):v6(r,b=>b.test(c));let m;m=t.valueCallback?t.valueCallback(f):f,m=i.valueCallback?i.valueCallback(m):m;const y=e.slice(c.length);return{value:m,rest:y}}}function v6(t,e){for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e(t[i]))return i}function b6(t,e){for(let i=0;i<t.length;i++)if(e(t[i]))return i}function x6(t){return(e,i={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],l=e.match(t.parsePattern);if(!l)return null;let c=t.valueCallback?t.valueCallback(l[0]):l[0];c=i.valueCallback?i.valueCallback(c):c;const r=e.slice(s.length);return{value:c,rest:r}}}function jn(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}let w6={};function Tp(){return w6}function tf(t,e){var i,n,s,l;const c=Tp(),r=(e==null?void 0:e.weekStartsOn)??((n=(i=e==null?void 0:e.locale)==null?void 0:i.options)==null?void 0:n.weekStartsOn)??c.weekStartsOn??((l=(s=c.locale)==null?void 0:s.options)==null?void 0:l.weekStartsOn)??0,f=jn(t),m=f.getDay(),y=(m<r?7:0)+m-r;return f.setDate(f.getDate()-y),f.setHours(0,0,0,0),f}const A6={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},E6=(t,e,i)=>{let n;const s=A6[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"in "+n:n+" ago":n},T6={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},S6=(t,e,i,n)=>T6[t],I6={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},k6={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},O6={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},C6={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},M6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},D6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},R6=(t,e)=>{const i=Number(t),n=i%100;if(n>20||n<10)switch(n%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},L6={ordinalNumber:R6,era:Ad({values:I6,defaultWidth:"wide"}),quarter:Ad({values:k6,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ad({values:O6,defaultWidth:"wide"}),day:Ad({values:C6,defaultWidth:"wide"}),dayPeriod:Ad({values:M6,defaultWidth:"wide",formattingValues:D6,defaultFormattingWidth:"wide"})},P6=/^(\d+)(th|st|nd|rd)?/i,N6=/\d+/i,z6={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},B6={any:[/^b/i,/^(a|c)/i]},V6={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},F6={any:[/1/i,/2/i,/3/i,/4/i]},U6={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},j6={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},G6={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},H6={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},K6={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},q6={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Z6={ordinalNumber:x6({matchPattern:P6,parsePattern:N6,valueCallback:t=>parseInt(t,10)}),era:Ed({matchPatterns:z6,defaultMatchWidth:"wide",parsePatterns:B6,defaultParseWidth:"any"}),quarter:Ed({matchPatterns:V6,defaultMatchWidth:"wide",parsePatterns:F6,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ed({matchPatterns:U6,defaultMatchWidth:"wide",parsePatterns:j6,defaultParseWidth:"any"}),day:Ed({matchPatterns:G6,defaultMatchWidth:"wide",parsePatterns:H6,defaultParseWidth:"any"}),dayPeriod:Ed({matchPatterns:K6,defaultMatchWidth:"any",parsePatterns:q6,defaultParseWidth:"any"})},W6={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Y6={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},J6={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},X6={date:e_({formats:W6,defaultWidth:"full"}),time:e_({formats:Y6,defaultWidth:"full"}),dateTime:e_({formats:J6,defaultWidth:"full"})},AT={code:"en-US",formatDistance:E6,formatLong:X6,formatRelative:S6,localize:L6,match:Z6,options:{weekStartsOn:0,firstWeekContainsDate:1}};var Q6=typeof global=="object"&&global&&global.Object===Object&&global;const ET=Q6;var $6=typeof self=="object"&&self&&self.Object===Object&&self,ez=ET||$6||Function("return this")();const Ro=ez;var tz=Ro.Symbol;const ao=tz;var TT=Object.prototype,iz=TT.hasOwnProperty,nz=TT.toString,Td=ao?ao.toStringTag:void 0;function rz(t){var e=iz.call(t,Td),i=t[Td];try{t[Td]=void 0;var n=!0}catch{}var s=nz.call(t);return n&&(e?t[Td]=i:delete t[Td]),s}var sz=Object.prototype,az=sz.toString;function oz(t){return az.call(t)}var lz="[object Null]",cz="[object Undefined]",Fw=ao?ao.toStringTag:void 0;function _u(t){return t==null?t===void 0?cz:lz:Fw&&Fw in Object(t)?rz(t):oz(t)}function Qo(t){return t!=null&&typeof t=="object"}var uz="[object Symbol]";function Sp(t){return typeof t=="symbol"||Qo(t)&&_u(t)==uz}function hz(t,e){for(var i=-1,n=t==null?0:t.length,s=Array(n);++i<n;)s[i]=e(t[i],i,t);return s}var dz=Array.isArray;const qs=dz;var fz=1/0,Uw=ao?ao.prototype:void 0,jw=Uw?Uw.toString:void 0;function ST(t){if(typeof t=="string")return t;if(qs(t))return hz(t,ST)+"";if(Sp(t))return jw?jw.call(t):"";var e=t+"";return e=="0"&&1/t==-fz?"-0":e}function oo(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function ly(t){return t}var mz="[object AsyncFunction]",pz="[object Function]",gz="[object GeneratorFunction]",_z="[object Proxy]";function cy(t){if(!oo(t))return!1;var e=_u(t);return e==pz||e==gz||e==mz||e==_z}var yz=Ro["__core-js_shared__"];const t_=yz;var Gw=function(){var t=/[^.]+$/.exec(t_&&t_.keys&&t_.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function vz(t){return!!Gw&&Gw in t}var bz=Function.prototype,xz=bz.toString;function yu(t){if(t!=null){try{return xz.call(t)}catch{}try{return t+""}catch{}}return""}var wz=/[\\^$.*+?()[\]{}|]/g,Az=/^\[object .+?Constructor\]$/,Ez=Function.prototype,Tz=Object.prototype,Sz=Ez.toString,Iz=Tz.hasOwnProperty,kz=RegExp("^"+Sz.call(Iz).replace(wz,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Oz(t){if(!oo(t)||vz(t))return!1;var e=cy(t)?kz:Az;return e.test(yu(t))}function Cz(t,e){return t==null?void 0:t[e]}function vu(t,e){var i=Cz(t,e);return Oz(i)?i:void 0}var Mz=vu(Ro,"WeakMap");const W_=Mz;var Hw=Object.create,Dz=function(){function t(){}return function(e){if(!oo(e))return{};if(Hw)return Hw(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();const Rz=Dz;function Lz(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}function Pz(){}function IT(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}var Nz=800,zz=16,Bz=Date.now;function Vz(t){var e=0,i=0;return function(){var n=Bz(),s=zz-(n-i);if(i=n,s>0){if(++e>=Nz)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Fz(t){return function(){return t}}var Uz=function(){try{var t=vu(Object,"defineProperty");return t({},"",{}),t}catch{}}();const np=Uz;var jz=np?function(t,e){return np(t,"toString",{configurable:!0,enumerable:!1,value:Fz(e),writable:!0})}:ly;const Gz=jz;var Hz=Vz(Gz);const Kz=Hz;function qz(t,e){for(var i=-1,n=t==null?0:t.length;++i<n&&e(t[i],i,t)!==!1;);return t}function Zz(t,e,i,n){for(var s=t.length,l=i+(n?1:-1);n?l--:++l<s;)if(e(t[l],l,t))return l;return-1}function Wz(t){return t!==t}function Yz(t,e,i){for(var n=i-1,s=t.length;++n<s;)if(t[n]===e)return n;return-1}function Jz(t,e,i){return e===e?Yz(t,e,i):Zz(t,Wz,i)}function Xz(t,e){var i=t==null?0:t.length;return!!i&&Jz(t,e,0)>-1}var Qz=9007199254740991,$z=/^(?:0|[1-9]\d*)$/;function uy(t,e){var i=typeof t;return e=e??Qz,!!e&&(i=="number"||i!="symbol"&&$z.test(t))&&t>-1&&t%1==0&&t<e}function Ip(t,e,i){e=="__proto__"&&np?np(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}function _f(t,e){return t===e||t!==t&&e!==e}var e8=Object.prototype,t8=e8.hasOwnProperty;function kT(t,e,i){var n=t[e];(!(t8.call(t,e)&&_f(n,i))||i===void 0&&!(e in t))&&Ip(t,e,i)}function yf(t,e,i,n){var s=!i;i||(i={});for(var l=-1,c=e.length;++l<c;){var r=e[l],f=n?n(i[r],t[r],r,i,t):void 0;f===void 0&&(f=t[r]),s?Ip(i,r,f):kT(i,r,f)}return i}var Kw=Math.max;function i8(t,e,i){return e=Kw(e===void 0?t.length-1:e,0),function(){for(var n=arguments,s=-1,l=Kw(n.length-e,0),c=Array(l);++s<l;)c[s]=n[e+s];s=-1;for(var r=Array(e+1);++s<e;)r[s]=n[s];return r[e]=i(c),Lz(t,this,r)}}function OT(t,e){return Kz(i8(t,e,ly),t+"")}var n8=9007199254740991;function hy(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=n8}function Ph(t){return t!=null&&hy(t.length)&&!cy(t)}function CT(t,e,i){if(!oo(i))return!1;var n=typeof e;return(n=="number"?Ph(i)&&uy(e,i.length):n=="string"&&e in i)?_f(i[e],t):!1}function r8(t){return OT(function(e,i){var n=-1,s=i.length,l=s>1?i[s-1]:void 0,c=s>2?i[2]:void 0;for(l=t.length>3&&typeof l=="function"?(s--,l):void 0,c&&CT(i[0],i[1],c)&&(l=s<3?void 0:l,s=1),e=Object(e);++n<s;){var r=i[n];r&&t(e,r,n,l)}return e})}var s8=Object.prototype;function kp(t){var e=t&&t.constructor,i=typeof e=="function"&&e.prototype||s8;return t===i}function a8(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}var o8="[object Arguments]";function qw(t){return Qo(t)&&_u(t)==o8}var MT=Object.prototype,l8=MT.hasOwnProperty,c8=MT.propertyIsEnumerable,u8=qw(function(){return arguments}())?qw:function(t){return Qo(t)&&l8.call(t,"callee")&&!c8.call(t,"callee")};const Th=u8;function h8(){return!1}var DT=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Zw=DT&&typeof module=="object"&&module&&!module.nodeType&&module,d8=Zw&&Zw.exports===DT,Ww=d8?Ro.Buffer:void 0,f8=Ww?Ww.isBuffer:void 0,m8=f8||h8;const Sh=m8;var p8="[object Arguments]",g8="[object Array]",_8="[object Boolean]",y8="[object Date]",v8="[object Error]",b8="[object Function]",x8="[object Map]",w8="[object Number]",A8="[object Object]",E8="[object RegExp]",T8="[object Set]",S8="[object String]",I8="[object WeakMap]",k8="[object ArrayBuffer]",O8="[object DataView]",C8="[object Float32Array]",M8="[object Float64Array]",D8="[object Int8Array]",R8="[object Int16Array]",L8="[object Int32Array]",P8="[object Uint8Array]",N8="[object Uint8ClampedArray]",z8="[object Uint16Array]",B8="[object Uint32Array]",Ar={};Ar[C8]=Ar[M8]=Ar[D8]=Ar[R8]=Ar[L8]=Ar[P8]=Ar[N8]=Ar[z8]=Ar[B8]=!0;Ar[p8]=Ar[g8]=Ar[k8]=Ar[_8]=Ar[O8]=Ar[y8]=Ar[v8]=Ar[b8]=Ar[x8]=Ar[w8]=Ar[A8]=Ar[E8]=Ar[T8]=Ar[S8]=Ar[I8]=!1;function V8(t){return Qo(t)&&hy(t.length)&&!!Ar[_u(t)]}function dy(t){return function(e){return t(e)}}var RT=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ud=RT&&typeof module=="object"&&module&&!module.nodeType&&module,F8=Ud&&Ud.exports===RT,i_=F8&&ET.process,U8=function(){try{var t=Ud&&Ud.require&&Ud.require("util").types;return t||i_&&i_.binding&&i_.binding("util")}catch{}}();const Ih=U8;var Yw=Ih&&Ih.isTypedArray,j8=Yw?dy(Yw):V8;const Op=j8;var G8=Object.prototype,H8=G8.hasOwnProperty;function LT(t,e){var i=qs(t),n=!i&&Th(t),s=!i&&!n&&Sh(t),l=!i&&!n&&!s&&Op(t),c=i||n||s||l,r=c?a8(t.length,String):[],f=r.length;for(var m in t)(e||H8.call(t,m))&&!(c&&(m=="length"||s&&(m=="offset"||m=="parent")||l&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||uy(m,f)))&&r.push(m);return r}function PT(t,e){return function(i){return t(e(i))}}var K8=PT(Object.keys,Object);const q8=K8;var Z8=Object.prototype,W8=Z8.hasOwnProperty;function NT(t){if(!kp(t))return q8(t);var e=[];for(var i in Object(t))W8.call(t,i)&&i!="constructor"&&e.push(i);return e}function vf(t){return Ph(t)?LT(t):NT(t)}function Y8(t){var e=[];if(t!=null)for(var i in Object(t))e.push(i);return e}var J8=Object.prototype,X8=J8.hasOwnProperty;function Q8(t){if(!oo(t))return Y8(t);var e=kp(t),i=[];for(var n in t)n=="constructor"&&(e||!X8.call(t,n))||i.push(n);return i}function bf(t){return Ph(t)?LT(t,!0):Q8(t)}var $8=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,eB=/^\w*$/;function fy(t,e){if(qs(t))return!1;var i=typeof t;return i=="number"||i=="symbol"||i=="boolean"||t==null||Sp(t)?!0:eB.test(t)||!$8.test(t)||e!=null&&t in Object(e)}var tB=vu(Object,"create");const nf=tB;function iB(){this.__data__=nf?nf(null):{},this.size=0}function nB(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var rB="__lodash_hash_undefined__",sB=Object.prototype,aB=sB.hasOwnProperty;function oB(t){var e=this.__data__;if(nf){var i=e[t];return i===rB?void 0:i}return aB.call(e,t)?e[t]:void 0}var lB=Object.prototype,cB=lB.hasOwnProperty;function uB(t){var e=this.__data__;return nf?e[t]!==void 0:cB.call(e,t)}var hB="__lodash_hash_undefined__";function dB(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=nf&&e===void 0?hB:e,this}function cu(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}cu.prototype.clear=iB;cu.prototype.delete=nB;cu.prototype.get=oB;cu.prototype.has=uB;cu.prototype.set=dB;function fB(){this.__data__=[],this.size=0}function Cp(t,e){for(var i=t.length;i--;)if(_f(t[i][0],e))return i;return-1}var mB=Array.prototype,pB=mB.splice;function gB(t){var e=this.__data__,i=Cp(e,t);if(i<0)return!1;var n=e.length-1;return i==n?e.pop():pB.call(e,i,1),--this.size,!0}function _B(t){var e=this.__data__,i=Cp(e,t);return i<0?void 0:e[i][1]}function yB(t){return Cp(this.__data__,t)>-1}function vB(t,e){var i=this.__data__,n=Cp(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this}function Nl(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}Nl.prototype.clear=fB;Nl.prototype.delete=gB;Nl.prototype.get=_B;Nl.prototype.has=yB;Nl.prototype.set=vB;var bB=vu(Ro,"Map");const rf=bB;function xB(){this.size=0,this.__data__={hash:new cu,map:new(rf||Nl),string:new cu}}function wB(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Mp(t,e){var i=t.__data__;return wB(e)?i[typeof e=="string"?"string":"hash"]:i.map}function AB(t){var e=Mp(this,t).delete(t);return this.size-=e?1:0,e}function EB(t){return Mp(this,t).get(t)}function TB(t){return Mp(this,t).has(t)}function SB(t,e){var i=Mp(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this}function zl(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}zl.prototype.clear=xB;zl.prototype.delete=AB;zl.prototype.get=EB;zl.prototype.has=TB;zl.prototype.set=SB;var IB="Expected a function";function my(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(IB);var i=function(){var n=arguments,s=e?e.apply(this,n):n[0],l=i.cache;if(l.has(s))return l.get(s);var c=t.apply(this,n);return i.cache=l.set(s,c)||l,c};return i.cache=new(my.Cache||zl),i}my.Cache=zl;var kB=500;function OB(t){var e=my(t,function(n){return i.size===kB&&i.clear(),n}),i=e.cache;return e}var CB=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,MB=/\\(\\)?/g,DB=OB(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(CB,function(i,n,s,l){e.push(s?l.replace(MB,"$1"):n||i)}),e});const RB=DB;function LB(t){return t==null?"":ST(t)}function zT(t,e){return qs(t)?t:fy(t,e)?[t]:RB(LB(t))}var PB=1/0;function Dp(t){if(typeof t=="string"||Sp(t))return t;var e=t+"";return e=="0"&&1/t==-PB?"-0":e}function BT(t,e){e=zT(e,t);for(var i=0,n=e.length;t!=null&&i<n;)t=t[Dp(e[i++])];return i&&i==n?t:void 0}function py(t,e,i){var n=t==null?void 0:BT(t,e);return n===void 0?i:n}function gy(t,e){for(var i=-1,n=e.length,s=t.length;++i<n;)t[s+i]=e[i];return t}var Jw=ao?ao.isConcatSpreadable:void 0;function NB(t){return qs(t)||Th(t)||!!(Jw&&t&&t[Jw])}function _y(t,e,i,n,s){var l=-1,c=t.length;for(i||(i=NB),s||(s=[]);++l<c;){var r=t[l];e>0&&i(r)?e>1?_y(r,e-1,i,n,s):gy(s,r):n||(s[s.length]=r)}return s}var zB=PT(Object.getPrototypeOf,Object);const yy=zB;var BB="[object Object]",VB=Function.prototype,FB=Object.prototype,VT=VB.toString,UB=FB.hasOwnProperty,jB=VT.call(Object);function GB(t){if(!Qo(t)||_u(t)!=BB)return!1;var e=yy(t);if(e===null)return!0;var i=UB.call(e,"constructor")&&e.constructor;return typeof i=="function"&&i instanceof i&&VT.call(i)==jB}function HB(){this.__data__=new Nl,this.size=0}function KB(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}function qB(t){return this.__data__.get(t)}function ZB(t){return this.__data__.has(t)}var WB=200;function YB(t,e){var i=this.__data__;if(i instanceof Nl){var n=i.__data__;if(!rf||n.length<WB-1)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new zl(n)}return i.set(t,e),this.size=i.size,this}function ko(t){var e=this.__data__=new Nl(t);this.size=e.size}ko.prototype.clear=HB;ko.prototype.delete=KB;ko.prototype.get=qB;ko.prototype.has=ZB;ko.prototype.set=YB;function JB(t,e){return t&&yf(e,vf(e),t)}function XB(t,e){return t&&yf(e,bf(e),t)}var FT=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Xw=FT&&typeof module=="object"&&module&&!module.nodeType&&module,QB=Xw&&Xw.exports===FT,Qw=QB?Ro.Buffer:void 0,$w=Qw?Qw.allocUnsafe:void 0;function UT(t,e){if(e)return t.slice();var i=t.length,n=$w?$w(i):new t.constructor(i);return t.copy(n),n}function $B(t,e){for(var i=-1,n=t==null?0:t.length,s=0,l=[];++i<n;){var c=t[i];e(c,i,t)&&(l[s++]=c)}return l}function jT(){return[]}var eV=Object.prototype,tV=eV.propertyIsEnumerable,e2=Object.getOwnPropertySymbols,iV=e2?function(t){return t==null?[]:(t=Object(t),$B(e2(t),function(e){return tV.call(t,e)}))}:jT;const vy=iV;function nV(t,e){return yf(t,vy(t),e)}var rV=Object.getOwnPropertySymbols,sV=rV?function(t){for(var e=[];t;)gy(e,vy(t)),t=yy(t);return e}:jT;const GT=sV;function aV(t,e){return yf(t,GT(t),e)}function HT(t,e,i){var n=e(t);return qs(t)?n:gy(n,i(t))}function Y_(t){return HT(t,vf,vy)}function oV(t){return HT(t,bf,GT)}var lV=vu(Ro,"DataView");const J_=lV;var cV=vu(Ro,"Promise");const X_=cV;var uV=vu(Ro,"Set");const mh=uV;var t2="[object Map]",hV="[object Object]",i2="[object Promise]",n2="[object Set]",r2="[object WeakMap]",s2="[object DataView]",dV=yu(J_),fV=yu(rf),mV=yu(X_),pV=yu(mh),gV=yu(W_),Zc=_u;(J_&&Zc(new J_(new ArrayBuffer(1)))!=s2||rf&&Zc(new rf)!=t2||X_&&Zc(X_.resolve())!=i2||mh&&Zc(new mh)!=n2||W_&&Zc(new W_)!=r2)&&(Zc=function(t){var e=_u(t),i=e==hV?t.constructor:void 0,n=i?yu(i):"";if(n)switch(n){case dV:return s2;case fV:return t2;case mV:return i2;case pV:return n2;case gV:return r2}return e});const kh=Zc;var _V=Object.prototype,yV=_V.hasOwnProperty;function vV(t){var e=t.length,i=new t.constructor(e);return e&&typeof t[0]=="string"&&yV.call(t,"index")&&(i.index=t.index,i.input=t.input),i}var bV=Ro.Uint8Array;const rp=bV;function by(t){var e=new t.constructor(t.byteLength);return new rp(e).set(new rp(t)),e}function xV(t,e){var i=e?by(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}var wV=/\w*$/;function AV(t){var e=new t.constructor(t.source,wV.exec(t));return e.lastIndex=t.lastIndex,e}var a2=ao?ao.prototype:void 0,o2=a2?a2.valueOf:void 0;function EV(t){return o2?Object(o2.call(t)):{}}function KT(t,e){var i=e?by(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}var TV="[object Boolean]",SV="[object Date]",IV="[object Map]",kV="[object Number]",OV="[object RegExp]",CV="[object Set]",MV="[object String]",DV="[object Symbol]",RV="[object ArrayBuffer]",LV="[object DataView]",PV="[object Float32Array]",NV="[object Float64Array]",zV="[object Int8Array]",BV="[object Int16Array]",VV="[object Int32Array]",FV="[object Uint8Array]",UV="[object Uint8ClampedArray]",jV="[object Uint16Array]",GV="[object Uint32Array]";function HV(t,e,i){var n=t.constructor;switch(e){case RV:return by(t);case TV:case SV:return new n(+t);case LV:return xV(t,i);case PV:case NV:case zV:case BV:case VV:case FV:case UV:case jV:case GV:return KT(t,i);case IV:return new n;case kV:case MV:return new n(t);case OV:return AV(t);case CV:return new n;case DV:return EV(t)}}function qT(t){return typeof t.constructor=="function"&&!kp(t)?Rz(yy(t)):{}}var KV="[object Map]";function qV(t){return Qo(t)&&kh(t)==KV}var l2=Ih&&Ih.isMap,ZV=l2?dy(l2):qV;const WV=ZV;var YV="[object Set]";function JV(t){return Qo(t)&&kh(t)==YV}var c2=Ih&&Ih.isSet,XV=c2?dy(c2):JV;const QV=XV;var $V=1,eF=2,tF=4,ZT="[object Arguments]",iF="[object Array]",nF="[object Boolean]",rF="[object Date]",sF="[object Error]",WT="[object Function]",aF="[object GeneratorFunction]",oF="[object Map]",lF="[object Number]",YT="[object Object]",cF="[object RegExp]",uF="[object Set]",hF="[object String]",dF="[object Symbol]",fF="[object WeakMap]",mF="[object ArrayBuffer]",pF="[object DataView]",gF="[object Float32Array]",_F="[object Float64Array]",yF="[object Int8Array]",vF="[object Int16Array]",bF="[object Int32Array]",xF="[object Uint8Array]",wF="[object Uint8ClampedArray]",AF="[object Uint16Array]",EF="[object Uint32Array]",_r={};_r[ZT]=_r[iF]=_r[mF]=_r[pF]=_r[nF]=_r[rF]=_r[gF]=_r[_F]=_r[yF]=_r[vF]=_r[bF]=_r[oF]=_r[lF]=_r[YT]=_r[cF]=_r[uF]=_r[hF]=_r[dF]=_r[xF]=_r[wF]=_r[AF]=_r[EF]=!0;_r[sF]=_r[WT]=_r[fF]=!1;function Im(t,e,i,n,s,l){var c,r=e&$V,f=e&eF,m=e&tF;if(i&&(c=s?i(t,n,s,l):i(t)),c!==void 0)return c;if(!oo(t))return t;var y=qs(t);if(y){if(c=vV(t),!r)return IT(t,c)}else{var b=kh(t),E=b==WT||b==aF;if(Sh(t))return UT(t,r);if(b==YT||b==ZT||E&&!s){if(c=f||E?{}:qT(t),!r)return f?aV(t,XB(c,t)):nV(t,JB(c,t))}else{if(!_r[b])return s?t:{};c=HV(t,b,r)}}l||(l=new ko);var S=l.get(t);if(S)return S;l.set(t,c),QV(t)?t.forEach(function(z){c.add(Im(z,e,i,z,t,l))}):WV(t)&&t.forEach(function(z,H){c.set(H,Im(z,e,i,H,t,l))});var D=m?f?oV:Y_:f?bf:vf,R=y?void 0:D(t);return qz(R||t,function(z,H){R&&(H=z,z=t[H]),kT(c,H,Im(z,e,i,H,t,l))}),c}var TF=1,SF=4;function Rp(t){return Im(t,TF|SF)}var IF="__lodash_hash_undefined__";function kF(t){return this.__data__.set(t,IF),this}function OF(t){return this.__data__.has(t)}function sf(t){var e=-1,i=t==null?0:t.length;for(this.__data__=new zl;++e<i;)this.add(t[e])}sf.prototype.add=sf.prototype.push=kF;sf.prototype.has=OF;function JT(t,e){for(var i=-1,n=t==null?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}function XT(t,e){return t.has(e)}var CF=1,MF=2;function QT(t,e,i,n,s,l){var c=i&CF,r=t.length,f=e.length;if(r!=f&&!(c&&f>r))return!1;var m=l.get(t),y=l.get(e);if(m&&y)return m==e&&y==t;var b=-1,E=!0,S=i&MF?new sf:void 0;for(l.set(t,e),l.set(e,t);++b<r;){var D=t[b],R=e[b];if(n)var z=c?n(R,D,b,e,t,l):n(D,R,b,t,e,l);if(z!==void 0){if(z)continue;E=!1;break}if(S){if(!JT(e,function(H,K){if(!XT(S,K)&&(D===H||s(D,H,i,n,l)))return S.push(K)})){E=!1;break}}else if(!(D===R||s(D,R,i,n,l))){E=!1;break}}return l.delete(t),l.delete(e),E}function DF(t){var e=-1,i=Array(t.size);return t.forEach(function(n,s){i[++e]=[s,n]}),i}function xy(t){var e=-1,i=Array(t.size);return t.forEach(function(n){i[++e]=n}),i}var RF=1,LF=2,PF="[object Boolean]",NF="[object Date]",zF="[object Error]",BF="[object Map]",VF="[object Number]",FF="[object RegExp]",UF="[object Set]",jF="[object String]",GF="[object Symbol]",HF="[object ArrayBuffer]",KF="[object DataView]",u2=ao?ao.prototype:void 0,n_=u2?u2.valueOf:void 0;function qF(t,e,i,n,s,l,c){switch(i){case KF:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case HF:return!(t.byteLength!=e.byteLength||!l(new rp(t),new rp(e)));case PF:case NF:case VF:return _f(+t,+e);case zF:return t.name==e.name&&t.message==e.message;case FF:case jF:return t==e+"";case BF:var r=DF;case UF:var f=n&RF;if(r||(r=xy),t.size!=e.size&&!f)return!1;var m=c.get(t);if(m)return m==e;n|=LF,c.set(t,e);var y=QT(r(t),r(e),n,s,l,c);return c.delete(t),y;case GF:if(n_)return n_.call(t)==n_.call(e)}return!1}var ZF=1,WF=Object.prototype,YF=WF.hasOwnProperty;function JF(t,e,i,n,s,l){var c=i&ZF,r=Y_(t),f=r.length,m=Y_(e),y=m.length;if(f!=y&&!c)return!1;for(var b=f;b--;){var E=r[b];if(!(c?E in e:YF.call(e,E)))return!1}var S=l.get(t),D=l.get(e);if(S&&D)return S==e&&D==t;var R=!0;l.set(t,e),l.set(e,t);for(var z=c;++b<f;){E=r[b];var H=t[E],K=e[E];if(n)var W=c?n(K,H,E,e,t,l):n(H,K,E,t,e,l);if(!(W===void 0?H===K||s(H,K,i,n,l):W)){R=!1;break}z||(z=E=="constructor")}if(R&&!z){var se=t.constructor,Y=e.constructor;se!=Y&&"constructor"in t&&"constructor"in e&&!(typeof se=="function"&&se instanceof se&&typeof Y=="function"&&Y instanceof Y)&&(R=!1)}return l.delete(t),l.delete(e),R}var XF=1,h2="[object Arguments]",d2="[object Array]",am="[object Object]",QF=Object.prototype,f2=QF.hasOwnProperty;function $F(t,e,i,n,s,l){var c=qs(t),r=qs(e),f=c?d2:kh(t),m=r?d2:kh(e);f=f==h2?am:f,m=m==h2?am:m;var y=f==am,b=m==am,E=f==m;if(E&&Sh(t)){if(!Sh(e))return!1;c=!0,y=!1}if(E&&!y)return l||(l=new ko),c||Op(t)?QT(t,e,i,n,s,l):qF(t,e,f,i,n,s,l);if(!(i&XF)){var S=y&&f2.call(t,"__wrapped__"),D=b&&f2.call(e,"__wrapped__");if(S||D){var R=S?t.value():t,z=D?e.value():e;return l||(l=new ko),s(R,z,i,n,l)}}return E?(l||(l=new ko),JF(t,e,i,n,s,l)):!1}function Lp(t,e,i,n,s){return t===e?!0:t==null||e==null||!Qo(t)&&!Qo(e)?t!==t&&e!==e:$F(t,e,i,n,Lp,s)}var eU=1,tU=2;function iU(t,e,i,n){var s=i.length,l=s,c=!n;if(t==null)return!l;for(t=Object(t);s--;){var r=i[s];if(c&&r[2]?r[1]!==t[r[0]]:!(r[0]in t))return!1}for(;++s<l;){r=i[s];var f=r[0],m=t[f],y=r[1];if(c&&r[2]){if(m===void 0&&!(f in t))return!1}else{var b=new ko;if(n)var E=n(m,y,f,t,e,b);if(!(E===void 0?Lp(y,m,eU|tU,n,b):E))return!1}}return!0}function $T(t){return t===t&&!oo(t)}function nU(t){for(var e=vf(t),i=e.length;i--;){var n=e[i],s=t[n];e[i]=[n,s,$T(s)]}return e}function eS(t,e){return function(i){return i==null?!1:i[t]===e&&(e!==void 0||t in Object(i))}}function rU(t){var e=nU(t);return e.length==1&&e[0][2]?eS(e[0][0],e[0][1]):function(i){return i===t||iU(i,t,e)}}function sU(t,e){return t!=null&&e in Object(t)}function aU(t,e,i){e=zT(e,t);for(var n=-1,s=e.length,l=!1;++n<s;){var c=Dp(e[n]);if(!(l=t!=null&&i(t,c)))break;t=t[c]}return l||++n!=s?l:(s=t==null?0:t.length,!!s&&hy(s)&&uy(c,s)&&(qs(t)||Th(t)))}function oU(t,e){return t!=null&&aU(t,e,sU)}var lU=1,cU=2;function uU(t,e){return fy(t)&&$T(e)?eS(Dp(t),e):function(i){var n=py(i,t);return n===void 0&&n===e?oU(i,t):Lp(e,n,lU|cU)}}function hU(t){return function(e){return e==null?void 0:e[t]}}function dU(t){return function(e){return BT(e,t)}}function fU(t){return fy(t)?hU(Dp(t)):dU(t)}function wy(t){return typeof t=="function"?t:t==null?ly:typeof t=="object"?qs(t)?uU(t[0],t[1]):rU(t):fU(t)}function mU(t){return function(e,i,n){for(var s=-1,l=Object(e),c=n(e),r=c.length;r--;){var f=c[t?r:++s];if(i(l[f],f,l)===!1)break}return e}}var pU=mU();const tS=pU;function Q_(t,e,i){(i!==void 0&&!_f(t[e],i)||i===void 0&&!(e in t))&&Ip(t,e,i)}function $_(t){return Qo(t)&&Ph(t)}function e0(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function gU(t){return yf(t,bf(t))}function _U(t,e,i,n,s,l,c){var r=e0(t,i),f=e0(e,i),m=c.get(f);if(m){Q_(t,i,m);return}var y=l?l(r,f,i+"",t,e,c):void 0,b=y===void 0;if(b){var E=qs(f),S=!E&&Sh(f),D=!E&&!S&&Op(f);y=f,E||S||D?qs(r)?y=r:$_(r)?y=IT(r):S?(b=!1,y=UT(f,!0)):D?(b=!1,y=KT(f,!0)):y=[]:GB(f)||Th(f)?(y=r,Th(r)?y=gU(r):(!oo(r)||cy(r))&&(y=qT(f))):b=!1}b&&(c.set(f,y),s(y,f,n,l,c),c.delete(f)),Q_(t,i,y)}function iS(t,e,i,n,s){t!==e&&tS(e,function(l,c){if(s||(s=new ko),oo(l))_U(t,e,c,i,iS,n,s);else{var r=n?n(e0(t,c),l,c+"",t,e,s):void 0;r===void 0&&(r=l),Q_(t,c,r)}},bf)}function yU(t,e,i){for(var n=-1,s=t==null?0:t.length;++n<s;)if(i(e,t[n]))return!0;return!1}function vU(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var bU="[object Map]",xU="[object Set]",wU=Object.prototype,AU=wU.hasOwnProperty;function EU(t){if(t==null)return!0;if(Ph(t)&&(qs(t)||typeof t=="string"||typeof t.splice=="function"||Sh(t)||Op(t)||Th(t)))return!t.length;var e=kh(t);if(e==bU||e==xU)return!t.size;if(kp(t))return!NT(t).length;for(var i in t)if(AU.call(t,i))return!1;return!0}var TU=r8(function(t,e,i){iS(t,e,i)});const mn=TU;var SU=1/0,IU=mh&&1/xy(new mh([,-0]))[1]==SU?function(t){return new mh(t)}:Pz;const kU=IU;var OU=200;function nS(t,e,i){var n=-1,s=Xz,l=t.length,c=!0,r=[],f=r;if(i)c=!1,s=yU;else if(l>=OU){var m=e?null:kU(t);if(m)return xy(m);c=!1,s=XT,f=new sf}else f=e?[]:r;e:for(;++n<l;){var y=t[n],b=e?e(y):y;if(y=i||y!==0?y:0,c&&b===b){for(var E=f.length;E--;)if(f[E]===b)continue e;e&&f.push(b),r.push(y)}else s(f,b,i)||(f!==r&&f.push(b),r.push(y))}return r}var CU=OT(function(t){var e=vU(t);return $_(e)&&(e=void 0),nS(_y(t,1,$_,!0),wy(e))});const MU=CU;function af(t){return t&&t.length?nS(t):[]}const va="cds",Il={opacity:{unselected:.05,selected:.4}},Ac={ticks:{number:7,rotateIfSmallerThan:30,verticalSpaceRatio:2.5,horizontalSpaceRatio:3.5},ratio:{reference:"value",compareTo:"marker"},paddingRatio:.1,hover:{rectanglePadding:4}},m2={duration:1e3,ease:ZE,zoomLevel:3},DU={circles:{fillOpacity:.3,hover:{stroke:"#FFF"}},padding:{mainGroup:4,children:2},hierarchyLevel:2},RU={pairingOptions:{"1-color":4,"2-color":5,"3-color":5,"4-color":3,"5-color":2,"14-color":1}},LU={defaultBins:10},ks={items:{status:{ACTIVE:1,DISABLED:0},horizontalSpace:12,verticalSpace:24,textYOffset:8,spaceAfter:4},checkbox:{radius:6.5},radius:{iconData:[{cx:7,cy:7,r:6.5},{cx:7,cy:10,r:3.5}],fill:null,stroke:"#8c8c8c"},line:{yPosition:6,width:24,strokeWidth:1.4,fill:null,stroke:"#999999"},area:{width:24,height:14,fill:"#6f6f6f",stroke:null},size:{iconData:[{width:23,height:12},{width:13,height:6}],fill:null,stroke:"#8D8D8D"},quartile:{iconData:[{x:0,y:0,width:24,height:13},{x:11,y:4,width:1,height:4}]},zoom:{iconData:[{x:0,y:0,width:12,height:12}],color:"#8D8D8D"},color:{barWidth:300,barHeight:8,axisYTranslation:10}},r_={opacity:{unselected:.3,selected:1},weight:{selected:2,unselected:1}},Sd={radiusOffset:-15,innerRadius:2,padAngle:.007,hoverArc:{outerRadiusOffset:3},xOffset:30,yOffset:20,yOffsetCallout:10,callout:{minSliceDegree:5,offsetX:15,offsetY:12,horizontalLineLength:8,textMargin:2}},p2={default:{size:24}},PU={horizontalOffset:10},g2={default:{duration:300},pie_slice_mouseover:{duration:100},pie_chart_titles:{duration:375},graph_element_mouseover_fill_update:{duration:100},graph_element_mouseout_fill_update:{duration:100}},Ba={height:{[Yo.GRAPH_VIEW]:32,[Yo.SLIDER_VIEW]:10},spacerHeight:8,handleWidth:5,handleBarWidth:1,handleBarHeight:12},NU=[{type:ys.RADIUS,name:"Radius"},{type:ys.AREA,name:"Poor area"},{type:ys.AREA,name:"Satisfactory area"},{type:ys.AREA,name:"Great area"},{type:ys.QUARTILE,name:"Quartiles"}],lh={type:Io.END_LINE,threshold:16,numCharacter:14},zU={enabled:!0,position:Fd.BOTTOM,clickable:!0,truncation:lh,alignment:Oo.LEFT,order:null,additionalItems:[]},BU={x:{enabled:!0,numberOfTicks:15,alignWithAxisTicks:!1},y:{enabled:!0,numberOfTicks:5,alignWithAxisTicks:!1}},VU={enabled:!0},rS={enabled:!0,showTotal:!0,truncation:lh,groupLabel:"Group"},sS={top:{visible:!0,includeZero:!0,truncation:lh},bottom:{visible:!0,includeZero:!0,truncation:lh},left:{visible:!0,includeZero:!0,truncation:lh},right:{visible:!0,includeZero:!0,truncation:lh}},Pp={addSpaceOnEdges:1,showDayName:!1,localeObject:AT,timeIntervalFormats:{"15seconds":{primary:"MMM d, pp",secondary:"pp"},minute:{primary:"MMM d, p",secondary:"p"},"30minutes":{primary:"MMM d, p",secondary:"p"},hourly:{primary:"MMM d, hh a",secondary:"hh a"},daily:{primary:"MMM d",secondary:"d"},weekly:{primary:"eee, MMM d",secondary:"eee"},monthly:{primary:"MMM yyyy",secondary:"MMM"},quarterly:{primary:"QQQ ''yy",secondary:"QQQ"},yearly:{primary:"yyyy",secondary:"yyyy"}}},FU=typeof document<"u"&&(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled),Zs={width:null,height:null,resizable:!0,theme:mE.WHITE,tooltip:rS,legend:zU,style:{prefix:"cc"},data:{groupMapsTo:"group",loading:!1,selectedGroups:[]},color:{scale:null,pairing:{numberOfVariants:null,option:1},gradient:{enabled:!1}},toolbar:{enabled:!0,numberOfIcons:3,controls:[{type:Pr.SHOW_AS_DATATABLE},...FU?[{type:Pr.MAKE_FULLSCREEN}]:[],{type:Pr.EXPORT_CSV},{type:Pr.EXPORT_PNG},{type:Pr.EXPORT_JPG}]}},aS=mn({},Zs,{thematic:{projection:yE.geoNaturalEarth1}}),xf=mn({},Zs,{axes:sS,timeScale:Pp,grid:BU,ruler:VU,zoomBar:{zoomRatio:.4,minZoomRatio:.01,top:{enabled:!1,type:Yo.GRAPH_VIEW}}}),uu=mn({},xf,{bars:{maxWidth:16,spacingFactor:.25},timeScale:mn(Pp,{addSpaceOnEdges:1})}),UU=mn({},uu,{}),jU=mn({},uu,{}),GU=mn({},uu,{bars:mn({},uu.bars,{dividerSize:1.5})}),HU=mn({},uu,{}),Ay=mn({},xf,{points:{radius:4,fillOpacity:.3,filled:!0,enabled:!0}}),KU=Ay,oS=mn({},Ay,{points:{radius:3,filled:!1,enabled:!0}}),lS=mn({},oS,{timeScale:mn(Pp,{addSpaceOnEdges:0})}),qU=lS,ZU=mn({},xf,{bubble:{radiusMapsTo:"radius",radiusLabel:"Radius",radiusRange:t=>{const e=Math.min(t.width,t.height);return[e*3/400,e*25/400]},fillOpacity:.2,enabled:!0},points:{filled:!0},legend:{additionalItems:[{type:ys.RADIUS,name:"Radius"}]}}),WU=mn({},xf,{bullet:{performanceAreaTitles:["Poor","Satisfactory","Great"]},grid:{x:{enabled:!1},y:{enabled:!1}},legend:{additionalItems:[{type:ys.AREA,name:"Poor area"},{type:ys.AREA,name:"Satisfactory area"},{type:ys.AREA,name:"Great area"},{type:ys.QUARTILE,name:"Quartiles"}]}}),YU=mn({},uu,{bars:{dividerSize:1.5},timeScale:mn(Pp,{addSpaceOnEdges:0})}),JU=mn({},Zs,{tooltip:mn({},rS,{wordLabel:"Word",valueLabel:"Value"}),wordCloud:{fontSizeMapsTo:"value",fontSizeRange:t=>{const e=Math.min(t.width,t.height);return[e*20/400,e*75/400]},wordMapsTo:"word"}}),cS=mn({},Zs,{pie:{labels:{formatter:null,enabled:!0},alignment:Oo.LEFT,sortFunction:null,valueMapsTo:"value"}}),XU=mn({},Zs,{legend:{enabled:!1},gauge:{type:gE.SEMI,arcWidth:16,deltaArrow:{size:t=>t/8,enabled:!0},showPercentageSymbol:!0,status:null,numberSpacing:10,deltaFontSize:t=>t/8,valueFontSize:t=>t/2.5,numberFormatter:t=>Number(t.toFixed(2))%1!==0?t.toFixed(2).toLocaleString():t.toFixed().toLocaleString(),alignment:Oo.LEFT}}),QU=mn({},cS,{donut:{center:{numberFontSize:t=>`${Math.min(t/100*24,24)}px`,titleFontSize:t=>`${Math.min(t/100*15,15)}px`,titleYPosition:t=>Math.min(t/80*20,20),numberFormatter:t=>Math.floor(t).toLocaleString()},alignment:Oo.LEFT}}),uS=mn({},Zs,{legend:{enabled:!1,clickable:!1},meter:{showLabels:!0,proportional:null,statusBar:{percentageIndicator:{enabled:!0}}}}),$U=mn({},uS,{legend:{enabled:!0}}),e9=mn({},Zs,{radar:{axes:{angle:"key",value:"value"},alignment:Oo.LEFT},tooltip:{gridline:{enabled:!0},valueFormatter:t=>t??"N/A"}}),t9=mn({},uu,{comboChartTypes:[]}),i9=mn({tree:{type:pE.TREE}},Zs,{}),n9=mn({},Zs,{data:mn(Zs.data,{groupMapsTo:"name"})}),r9=mn({},Zs,DU,{data:mn(Zs.data,{groupMapsTo:"name"})}),s9=mn({},Zs,{alluvial:{data:mn(Zs.data,{groupMapsTo:"source"}),nodeAlignment:Oo.CENTER,nodePadding:24,monochrome:!1,nodes:[]}}),a9=mn({},Zs,{axes:sS,heatmap:{divider:{state:_E.AUTO},colorLegend:{type:"linear"}}}),o9=mn({},aS,{choropleth:{colorLegend:{type:"linear"}}}),l9={alluvialChart:s9,areaChart:lS,axisChart:xf,boxplotChart:HU,bubbleChart:ZU,bulletChart:WU,chart:Zs,circlePackChart:r9,choroplethChart:o9,comboChart:t9,donutChart:QU,gaugeChart:XU,groupedBarChart:jU,heatmapChart:a9,histogramChart:YU,lineChart:oS,lollipopChart:KU,meterChart:uS,pieChart:cS,proportionalMeterChart:$U,radarChart:e9,scatterChart:Ay,simpleBarChart:UU,stackedAreaChart:qU,stackedBarChart:GU,thematicChart:aS,treeChart:i9,treemapChart:n9,wordCloudChart:JU};function c9(t,e,i){let n=null;return function(...s){const l=this;l.mousePosition=su(s[0],i),clearTimeout(n),n=setTimeout(function(){t.apply(l,s)},e)}}function u9(t,e){var i;const n=Rp(t),s=Object.keys(e.axes||{});(i=e==null?void 0:e.toolbar)!=null&&i.controls&&delete n.toolbar.controls,s.length===0&&delete n.axes;for(const l in n.axes)if(s.includes(l)){const c=e.axes[l];if((c.primary||c.secondary)&&console.warn("`primary` & `secondary` are no longer needed for axis configurations. Read more here https://charts.carbondesignsystem.com/?path=/story/docs-tutorials--tabular-data-format"),c.mapsTo==null){const f=c.scaleType;f==null?c.mapsTo="value":f===Hi.TIME?c.mapsTo="date":f===Hi.LABELS&&(c.mapsTo="key")}}else delete n.axes[l];return hS(n,e),mn(n,e)}function Sl(t){if(!t)return;const e=/translate\([0-9]+\.?[0-9]*,[0-9]+\.?[0-9]*\)/,i=t.getAttribute("transform").match(e);if(!i)return null;if(i[0]){const n=i[0].replace(/translate\(/,"").replace(/\)/,"").split(",");return{tx:n[0],ty:n[1]}}return null}function of(t,e,i){if(i>t.length)return t;if(e===Io.MID_LINE)return t.substr(0,i/2)+"..."+t.substr(-i/2);if(e===Io.FRONT_LINE)return"..."+t.substr(-i);if(e===Io.END_LINE)return t.substr(0,i)+"..."}function hS(t,e){const i=Ne(t,"legend","additionalItems"),n=Ne(e,"legend","additionalItems");if(i&&n){const s=n.map(r=>r.type),l=i.map(r=>r.type),c=NU.filter(r=>l.includes(r.type)&&!s.includes(r.type));t.legend.additionalItems=c,e.legend.additionalItems=MU(c,n,"name")}}const Ne=(t,...e)=>{let i=t;if(i){for(const n of e)if(i[n]!==null&&i[n]!==void 0)i=i[n];else return null;return i}return null},dS=(t,e)=>e===wa.HORIZONTAL?{y0:t.x0,y1:t.x1,x0:t.y0,x1:t.y1}:t,Ey=(t,e)=>{const{x0:i,x1:n,y0:s,y1:l}=dS(t,e);return`M${i},${s}L${i},${l}L${n},${l}L${n},${s}L${i},${s}`};function ph(t,e,i){return i===wa.VERTICAL?[t,e]:[e,t]}function h9(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function d9(t){if(!h9(t)&&typeof t!="number")return!1;const e=jn(t);return!isNaN(Number(e))}const fS=6048e5,f9=864e5,mS=6e4,pS=36e5;function _2(t){const e=jn(t);return e.setHours(0,0,0,0),e}function y2(t){const e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function gS(t,e){const i=_2(t),n=_2(e),s=i.getTime()-y2(i),l=n.getTime()-y2(n);return Math.round((s-l)/f9)}function Co(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function m9(t){const e=jn(t),i=Co(t,0);return i.setFullYear(e.getFullYear(),0,1),i.setHours(0,0,0,0),i}function p9(t){const e=jn(t);return gS(e,m9(e))+1}function sp(t){return tf(t,{weekStartsOn:1})}function _S(t){const e=jn(t),i=e.getFullYear(),n=Co(t,0);n.setFullYear(i+1,0,4),n.setHours(0,0,0,0);const s=sp(n),l=Co(t,0);l.setFullYear(i,0,4),l.setHours(0,0,0,0);const c=sp(l);return e.getTime()>=s.getTime()?i+1:e.getTime()>=c.getTime()?i:i-1}function g9(t){const e=_S(t),i=Co(t,0);return i.setFullYear(e,0,4),i.setHours(0,0,0,0),sp(i)}function _9(t){const e=jn(t),i=sp(e).getTime()-g9(e).getTime();return Math.round(i/fS)+1}function yS(t,e){var i,n,s,l;const c=jn(t),r=c.getFullYear(),f=Tp(),m=(e==null?void 0:e.firstWeekContainsDate)??((n=(i=e==null?void 0:e.locale)==null?void 0:i.options)==null?void 0:n.firstWeekContainsDate)??f.firstWeekContainsDate??((l=(s=f.locale)==null?void 0:s.options)==null?void 0:l.firstWeekContainsDate)??1,y=Co(t,0);y.setFullYear(r+1,0,m),y.setHours(0,0,0,0);const b=tf(y,e),E=Co(t,0);E.setFullYear(r,0,m),E.setHours(0,0,0,0);const S=tf(E,e);return c.getTime()>=b.getTime()?r+1:c.getTime()>=S.getTime()?r:r-1}function y9(t,e){var i,n,s,l;const c=Tp(),r=(e==null?void 0:e.firstWeekContainsDate)??((n=(i=e==null?void 0:e.locale)==null?void 0:i.options)==null?void 0:n.firstWeekContainsDate)??c.firstWeekContainsDate??((l=(s=c.locale)==null?void 0:s.options)==null?void 0:l.firstWeekContainsDate)??1,f=yS(t,e),m=Co(t,0);return m.setFullYear(f,0,r),m.setHours(0,0,0,0),tf(m,e)}function v9(t,e){const i=jn(t),n=tf(i,e).getTime()-y9(i,e).getTime();return Math.round(n/fS)+1}function Qn(t,e){const i=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return i+n}const yc={y(t,e){const i=t.getFullYear(),n=i>0?i:1-i;return Qn(e==="yy"?n%100:n,e.length)},M(t,e){const i=t.getMonth();return e==="M"?String(i+1):Qn(i+1,2)},d(t,e){return Qn(t.getDate(),e.length)},a(t,e){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];case"aaaa":default:return i==="am"?"a.m.":"p.m."}},h(t,e){return Qn(t.getHours()%12||12,e.length)},H(t,e){return Qn(t.getHours(),e.length)},m(t,e){return Qn(t.getMinutes(),e.length)},s(t,e){return Qn(t.getSeconds(),e.length)},S(t,e){const i=e.length,n=t.getMilliseconds(),s=Math.floor(n*Math.pow(10,i-3));return Qn(s,e.length)}},Zu={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},b9={G:function(t,e,i){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return i.era(n,{width:"abbreviated"});case"GGGGG":return i.era(n,{width:"narrow"});case"GGGG":default:return i.era(n,{width:"wide"})}},y:function(t,e,i){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return i.ordinalNumber(s,{unit:"year"})}return yc.y(t,e)},Y:function(t,e,i,n){const s=yS(t,n),l=s>0?s:1-s;if(e==="YY"){const c=l%100;return Qn(c,2)}return e==="Yo"?i.ordinalNumber(l,{unit:"year"}):Qn(l,e.length)},R:function(t,e){const i=_S(t);return Qn(i,e.length)},u:function(t,e){const i=t.getFullYear();return Qn(i,e.length)},Q:function(t,e,i){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Qn(n,2);case"Qo":return i.ordinalNumber(n,{unit:"quarter"});case"QQQ":return i.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,i){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Qn(n,2);case"qo":return i.ordinalNumber(n,{unit:"quarter"});case"qqq":return i.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,i){const n=t.getMonth();switch(e){case"M":case"MM":return yc.M(t,e);case"Mo":return i.ordinalNumber(n+1,{unit:"month"});case"MMM":return i.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,i){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return Qn(n+1,2);case"Lo":return i.ordinalNumber(n+1,{unit:"month"});case"LLL":return i.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,i,n){const s=v9(t,n);return e==="wo"?i.ordinalNumber(s,{unit:"week"}):Qn(s,e.length)},I:function(t,e,i){const n=_9(t);return e==="Io"?i.ordinalNumber(n,{unit:"week"}):Qn(n,e.length)},d:function(t,e,i){return e==="do"?i.ordinalNumber(t.getDate(),{unit:"date"}):yc.d(t,e)},D:function(t,e,i){const n=p9(t);return e==="Do"?i.ordinalNumber(n,{unit:"dayOfYear"}):Qn(n,e.length)},E:function(t,e,i){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return i.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(n,{width:"short",context:"formatting"});case"EEEE":default:return i.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,i,n){const s=t.getDay(),l=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(l);case"ee":return Qn(l,2);case"eo":return i.ordinalNumber(l,{unit:"day"});case"eee":return i.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(s,{width:"short",context:"formatting"});case"eeee":default:return i.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,i,n){const s=t.getDay(),l=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(l);case"cc":return Qn(l,e.length);case"co":return i.ordinalNumber(l,{unit:"day"});case"ccc":return i.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(s,{width:"narrow",context:"standalone"});case"cccccc":return i.day(s,{width:"short",context:"standalone"});case"cccc":default:return i.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,i){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return Qn(s,e.length);case"io":return i.ordinalNumber(s,{unit:"day"});case"iii":return i.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(n,{width:"short",context:"formatting"});case"iiii":default:return i.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,i){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,e,i){const n=t.getHours();let s;switch(n===12?s=Zu.noon:n===0?s=Zu.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,i){const n=t.getHours();let s;switch(n>=17?s=Zu.evening:n>=12?s=Zu.afternoon:n>=4?s=Zu.morning:s=Zu.night,e){case"B":case"BB":case"BBB":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,i){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),i.ordinalNumber(n,{unit:"hour"})}return yc.h(t,e)},H:function(t,e,i){return e==="Ho"?i.ordinalNumber(t.getHours(),{unit:"hour"}):yc.H(t,e)},K:function(t,e,i){const n=t.getHours()%12;return e==="Ko"?i.ordinalNumber(n,{unit:"hour"}):Qn(n,e.length)},k:function(t,e,i){let n=t.getHours();return n===0&&(n=24),e==="ko"?i.ordinalNumber(n,{unit:"hour"}):Qn(n,e.length)},m:function(t,e,i){return e==="mo"?i.ordinalNumber(t.getMinutes(),{unit:"minute"}):yc.m(t,e)},s:function(t,e,i){return e==="so"?i.ordinalNumber(t.getSeconds(),{unit:"second"}):yc.s(t,e)},S:function(t,e){return yc.S(t,e)},X:function(t,e,i,n){const s=(n._originalDate||t).getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return b2(s);case"XXXX":case"XX":return Wc(s);case"XXXXX":case"XXX":default:return Wc(s,":")}},x:function(t,e,i,n){const s=(n._originalDate||t).getTimezoneOffset();switch(e){case"x":return b2(s);case"xxxx":case"xx":return Wc(s);case"xxxxx":case"xxx":default:return Wc(s,":")}},O:function(t,e,i,n){const s=(n._originalDate||t).getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+v2(s,":");case"OOOO":default:return"GMT"+Wc(s,":")}},z:function(t,e,i,n){const s=(n._originalDate||t).getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+v2(s,":");case"zzzz":default:return"GMT"+Wc(s,":")}},t:function(t,e,i,n){const s=n._originalDate||t,l=Math.floor(s.getTime()/1e3);return Qn(l,e.length)},T:function(t,e,i,n){const s=(n._originalDate||t).getTime();return Qn(s,e.length)}};function v2(t,e=""){const i=t>0?"-":"+",n=Math.abs(t),s=Math.floor(n/60),l=n%60;return l===0?i+String(s):i+String(s)+e+Qn(l,2)}function b2(t,e){return t%60===0?(t>0?"-":"+")+Qn(Math.abs(t)/60,2):Wc(t,e)}function Wc(t,e=""){const i=t>0?"-":"+",n=Math.abs(t),s=Qn(Math.floor(n/60),2),l=Qn(n%60,2);return i+s+e+l}const x2=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},vS=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},x9=(t,e)=>{const i=t.match(/(P+)(p+)?/)||[],n=i[1],s=i[2];if(!s)return x2(t,e);let l;switch(n){case"P":l=e.dateTime({width:"short"});break;case"PP":l=e.dateTime({width:"medium"});break;case"PPP":l=e.dateTime({width:"long"});break;case"PPPP":default:l=e.dateTime({width:"full"});break}return l.replace("{{date}}",x2(n,e)).replace("{{time}}",vS(s,e))},w9={p:vS,P:x9},A9=["D","DD"],E9=["YY","YYYY"];function T9(t){return A9.indexOf(t)!==-1}function S9(t){return E9.indexOf(t)!==-1}function w2(t,e,i){if(t==="YYYY")throw new RangeError(`Use \`yyyy\` instead of \`YYYY\` (in \`${e}\`) for formatting years to the input \`${i}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`);if(t==="YY")throw new RangeError(`Use \`yy\` instead of \`YY\` (in \`${e}\`) for formatting years to the input \`${i}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`);if(t==="D")throw new RangeError(`Use \`d\` instead of \`D\` (in \`${e}\`) for formatting days of the month to the input \`${i}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`);if(t==="DD")throw new RangeError(`Use \`dd\` instead of \`DD\` (in \`${e}\`) for formatting days of the month to the input \`${i}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`)}const I9=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,k9=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,O9=/^'([^]*?)'?$/,C9=/''/g,M9=/[a-zA-Z]/;function Oh(t,e,i){var n,s,l,c,r,f,m,y;const b=Tp(),E=(i==null?void 0:i.locale)??b.locale??AT,S=(i==null?void 0:i.firstWeekContainsDate)??((s=(n=i==null?void 0:i.locale)==null?void 0:n.options)==null?void 0:s.firstWeekContainsDate)??b.firstWeekContainsDate??((c=(l=b.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??1,D=(i==null?void 0:i.weekStartsOn)??((f=(r=i==null?void 0:i.locale)==null?void 0:r.options)==null?void 0:f.weekStartsOn)??b.weekStartsOn??((y=(m=b.locale)==null?void 0:m.options)==null?void 0:y.weekStartsOn)??0,R=jn(t);if(!d9(R))throw new RangeError("Invalid time value");const z={firstWeekContainsDate:S,weekStartsOn:D,locale:E,_originalDate:R};return e.match(k9).map(function(H){const K=H[0];if(K==="p"||K==="P"){const W=w9[K];return W(H,E.formatLong)}return H}).join("").match(I9).map(function(H){if(H==="''")return"'";const K=H[0];if(K==="'")return D9(H);const W=b9[K];if(W)return!(i!=null&&i.useAdditionalWeekYearTokens)&&S9(H)&&w2(H,e,String(t)),!(i!=null&&i.useAdditionalDayOfYearTokens)&&T9(H)&&w2(H,e,String(t)),W(R,H,E.localize,z);if(K.match(M9))throw new RangeError("Format string contains an unescaped latin alphabet character `"+K+"`");return H}).join("")}function D9(t){const e=t.match(O9);return e?e[1].replace(C9,"'"):t}var bS=(t=>(t["15seconds"]="15seconds",t.minute="minute",t["30minutes"]="30minutes",t.hourly="hourly",t.daily="daily",t.weekly="weekly",t.monthly="monthly",t.quarterly="quarterly",t.yearly="yearly",t))(bS||{});const s_=[["15seconds",15*1e3],["minute",60*1e3],["30minutes",30*60*1e3],["hourly",60*60*1e3],["daily",24*60*60*1e3],["monthly",30*24*60*60*1e3],["quarterly",3*30*24*60*60*1e3],["yearly",12*30*24*60*60*1e3]];function xS(t,e,i,n,s){const l=e===0,c=Number(Oh(new Date(t),"c"))===2,r=Number(Oh(new Date(t),"q"))===1,f=e!==0?i[e-1]:null;switch(n){case"15seconds":return l||om(t)||Id(t,f)||vc(t);case"minute":return l||om(t)||Id(t,f)||vc(t);case"30minutes":return l||om(t)||Id(t,f)||vc(t);case"hourly":return l||om(t)||Id(t,f)||vc(t);case"daily":return s?l||c||vc(t):l||Id(t,f)||vc(t);case"weekly":return l||c||vc(t);case"monthly":return l||vc(t);case"quarterly":return l||r;case"yearly":return!1;default:throw new Error(`${n} is not a valid time interval.`)}}function t0(t,e,i,n,s){const l=s.showDayName,c=n==="daily"&&l?"weekly":n,r=new Date(t),f=Ne(s,"timeIntervalFormats")[c],m=Ne(f,"primary"),y=Ne(f,"secondary");let b=xS(t,e,i,n,l)?m:y;n==="15seconds"&&r.getMilliseconds()!==0&&(b=b.replace("pp","h:mm:ss.SSS a"));const E=s.localeObject;return Oh(r,b,{locale:E})}function ap(t){const e=new Date(t);return{M:e.getMonth()+1,d:e.getDate(),H:e.getHours(),m:e.getMinutes(),s:e.getSeconds()}}function R9(t){if(t)return t.slice(1).map((e,i)=>e-t[i])}function L9(t){const e=s_.reduce((i,[,n],s)=>{const l=s_[i][1],c=Math.abs(l-t),r=Math.abs(n-t);return c<r?i:s},0);return s_[e][0]}function i0(t,e){if(bS[e])return e;if(t.length===1)return"15seconds";const i=R9(t),n=hL(i);return L9(n)}function om(t){const{s:e,m:i,H:n}=ap(t);return n===0&&i===0&&e===0}function Id(t,e){const i=ap(t).M,n=ap(e).M;return i!==n}function vc(t){const{M:e,d:i,s:n,m:s,H:l}=ap(t);return e===1&&i===1&&l===0&&s===0&&n===0}function A2(t){return t===void 0?"":t.toISOString()}var ts=(t=>(t.GRAPHICS_DOCUMENT="graphics-document",t.GRAPHICS_OBJECT="graphics-object",t.GRAPHICS_SYMBOL="graphics-symbol",t.GROUP="group",t.DOCUMENT="document",t.CHECKBOX="checkbox",t.BUTTON="button",t.MENU="menu",t.MENU_ITEM="menuitem",t.IMG="img",t))(ts||{});function P9(t,e){return t&&tS(t,e,vf)}function N9(t,e){return function(i,n){if(i==null)return i;if(!Ph(i))return t(i,n);for(var s=i.length,l=e?s:-1,c=Object(i);(e?l--:++l<s)&&n(c[l],l,c)!==!1;);return i}}var z9=N9(P9);const wS=z9;function B9(t,e,i,n){for(var s=-1,l=t==null?0:t.length;++s<l;){var c=t[s];e(n,c,i(c),t)}return n}function V9(t,e,i,n){return wS(t,function(s,l,c){e(n,s,i(s),c)}),n}function F9(t,e){return function(i,n){var s=qs(i)?B9:V9,l=e?e():{};return s(i,t,wy(n),l)}}function U9(t){for(var e=-1,i=t==null?0:t.length,n={};++e<i;){var s=t[e];n[s[0]]=s[1]}return n}var j9=Object.prototype,G9=j9.hasOwnProperty,H9=F9(function(t,e,i){G9.call(t,i)?t[i].push(e):Ip(t,i,[e])});const K9=H9;function q9(t){const e=t.trim();return["=","+","-","@","	","\r"].includes(e.charAt(0))?`${e}`:/[,\"\n]/.test(e)?`"${e}"`:e}class AS{constructor(e){this.state={options:{}},this.colorScale={},this.colorClassNames={},this.services=e}getAllDataFromDomain(e){if(!this.getData())return null;const i=this.getOptions();let n=this.getData();const s=this.getDataGroups(),{groupMapsTo:l}=Ne(i,"data"),c=Ne(i,"axes");return e&&(n=n.filter(r=>e.includes(r[l]))),c&&Object.keys(c).forEach(r=>{const f=c[r].mapsTo,m=c[r].scaleType;if((m===Hi.LINEAR||m===Hi.LOG)&&(n=n.map(y=>({...y,[f]:y[f]===null?y[f]:Number(y[f])}))),f&&c[r].domain)if(m===Hi.LABELS)n=n.filter(y=>c[r].domain.includes(y[f]));else{const[y,b]=c[r].domain;n=n.filter(E=>!(f in E)||E[f]>=y&&E[f]<=b)}}),n.filter(r=>s.find(f=>f.name===r[l]))}getDisplayData(e){if(!this.get("data"))return null;const{ACTIVE:i}=ks.items.status,n=this.getDataGroups(e),{groupMapsTo:s}=this.getOptions().data;return this.getAllDataFromDomain(e).filter(l=>n.find(c=>c.name===l[s]&&c.status===i))}getData(){return this.get("data")}isDataEmpty(){return!this.getData().length}setData(e){const i=this.sanitize(Rp(e)),n=this.generateDataGroups(i);return this.set({data:i,dataGroups:n}),i}getDataGroups(e){return Ne(this.getOptions(),"data","loading")?[]:e?this.get("dataGroups").filter(i=>e.includes(i.name)):this.get("dataGroups")}getActiveDataGroups(e){const{ACTIVE:i}=ks.items.status;return this.getDataGroups(e).filter(n=>n.status===i)}getDataGroupNames(e){return this.getDataGroups(e).map(i=>i.name)}getActiveDataGroupNames(e){return this.getActiveDataGroups(e).map(i=>i.name)}aggregateBinDataByGroup(e){return K9(e,"group")}getBinConfigurations(){const e=this.getDisplayData(),i=this.getOptions(),n=this.services.cartesianScales.getMainXAxisPosition(),s=this.services.cartesianScales.getDomainIdentifier(),l=i.axes[n],{groupMapsTo:c}=i.data,{bins:r=LU.defaultBins}=l,f=Array.isArray(r),m=cL().value(S=>S[s]).thresholds(r)(e);if(f)m[m.length-1].x1=r[r.length-1];else{const S=m[0].x1-m[0].x0;m[m.length-1].x1=+m[m.length-1].x0+S}const y=f?[r[0],r[r.length-1]]:[m[0].x0,m[m.length-1].x1],b=Array.from(new Set(e.map(S=>S[c]))),E=[];return m.forEach(S=>{const D=`${S.x0}-${S.x1}`,R=this.aggregateBinDataByGroup(S);b.forEach(z=>{E.push({group:z,key:D,value:R[z]||0,bin:S.x0})})}),{bins:m,binsDomain:y}}getBinnedStackedData(){const e=this.getOptions(),{groupMapsTo:i}=e.data,n=this.getActiveDataGroupNames(),{bins:s}=this.getBinConfigurations(),l=this.getDataValuesGroupedByKeys({bins:s});return $g().keys(n)(l).map((c,r)=>Object.keys(c).filter(f=>!isNaN(f)).map(f=>{const m=c[f];return m[i]=n[r],m}))}getGroupedData(e){const i=this.getDisplayData(e),n={},{groupMapsTo:s}=this.getOptions().data;return i.map(l=>{const c=l[s];n[c]!==null&&n[c]!==void 0?n[c].push(l):n[c]=[l]}),Object.keys(n).map(l=>({name:l,data:n[l]}))}getStackKeys({bins:e=null,groups:i=null}={bins:null,groups:null}){const n=this.getOptions(),s=this.getDisplayData(i);let l;e?l=e.map(f=>`${f.x0}:${f.x1}`):l=af(s.map(f=>{const m=this.services.cartesianScales.getDomainIdentifier(f);return f[m]instanceof Date?A2(f[m]):f[m]&&typeof f[m].toString=="function"?f[m].toString():f[m]}));const c=this.services.cartesianScales.domainAxisPosition,r=n.axes[c].scaleType;return r===Hi.TIME?l.sort((f,m)=>{const y=new Date(f),b=new Date(m);return y-b}):(r===Hi.LOG||r===Hi.LINEAR)&&l.sort((f,m)=>f-m),l}getDataValuesGroupedByKeys({bins:e=null,groups:i=null}){const n=this.getOptions(),{groupMapsTo:s}=n.data,l=this.getDisplayData(i),c=this.getDataGroupNames(),r=this.getStackKeys({bins:e,groups:i});return e?r.map(f=>{const[m,y]=f.split(":"),b={x0:m,x1:y},E=e.find(S=>S.x0.toString()===m.toString());return c.forEach(S=>{b[S]=E.filter(D=>D[s]===S).length}),b}):r.map(f=>{const m={sharedStackKey:f};return c.forEach(y=>{const b=l.find(S=>{const D=this.services.cartesianScales.getDomainIdentifier(S);return S[s]===y&&Object.prototype.hasOwnProperty.call(S,D)&&(S[D]instanceof Date?A2(S[D])===f:S[D].toString()===f)}),E=this.services.cartesianScales.getRangeIdentifier(m);m[y]=b?b[E]:null}),m})}getStackedData({percentage:e=!1,groups:i=null,divergent:n=!1}){const s=this.getOptions(),{groupMapsTo:l}=s.data,c=this.getActiveDataGroupNames(i),r=this.getDataValuesGroupedByKeys({groups:i});if(e){const f=U9(r.map(m=>[m.sharedStackKey,0]));r.forEach(m=>{c.forEach(y=>{f[m.sharedStackKey]+=m[y]})}),r.forEach(m=>{c.forEach(y=>{const b=f[m.sharedStackKey];f[m.sharedStackKey]?m[y]=m[y]/b*100:m[y]=0})})}return(n?$g().offset(y6):$g()).keys(c)(r).map((f,m)=>Object.keys(f).filter(y=>!isNaN(y)).map(y=>{const b=f[y];return b[l]=c[m],b}))}getOptions(){return this.state.options}set(e,i){this.state=Object.assign({},this.state,e);const n=Object.assign({skipUpdate:!1,animate:!0},i);n.skipUpdate||this.update(n.animate)}get(e){return e?this.state[e]:this.state}setOptions(e){const i=this.getOptions();hS(i,e),this.set({options:mn(i,e)})}update(e=!0){this.getDisplayData()&&(this.updateAllDataGroups(),this.setCustomColorScale(),this.setColorClassNames(),this.services.events.dispatchEvent(yt.Model.UPDATE,{animate:e}))}toggleDataLabel(e){const{ACTIVE:i,DISABLED:n}=ks.items.status,s=this.getDataGroups(),l=s.some(m=>m.status===n),c=s.filter(m=>m.status===i);if(l)if(c.length===1&&c[0].name===e)s.forEach((m,y)=>{s[y].status=i});else{const m=s.findIndex(y=>y.name===e);s[m].status=s[m].status===n?i:n}else s.forEach((m,y)=>{s[y].status=m.name===e?i:n});const r=s.filter(m=>m.status===i),f=this.getOptions();s.some(m=>m.status===n)?f.data.selectedGroups=r.map(m=>m.name):f.data.selectedGroups=[],this.services.events.dispatchEvent(yt.Legend.ITEMS_UPDATE,{dataGroups:s}),this.set({dataGroups:s})}getIsFilled(e,i,n,s){const l=this.getOptions();return l.getIsFilled?l.getIsFilled(e,i,n,s):s}getFillColor(e,i,n){const s=this.getOptions(),l=Ne(this.colorScale,e);return s.getFillColor?s.getFillColor(e,i,n,l):l}getStrokeColor(e,i,n){const s=this.getOptions(),l=Ne(this.colorScale,e);return s.getStrokeColor?s.getStrokeColor(e,i,n,l):l}isUserProvidedColorScaleValid(){const e=Ne(this.getOptions(),"color","scale"),i=this.getDataGroups();return e==null||Object.keys(e).length==0?!1:i.some(n=>Object.keys(e).includes(n.name))}getColorClassName(e){const i=this.colorClassNames(e.dataGroupName);let n=e.originalClassName;return e.classNameTypes.forEach(s=>n=e.originalClassName?`${n} ${s}-${i}`:`${s}-${i}`),n||""}getStatus(){return null}getAllDataGroupsNames(){return this.allDataGroups}transformToTabularData(e){console.warn("We've updated the charting data format to be tabular by default. The current format you're using is deprecated and will be removed in v1.0, read more here https://charts.carbondesignsystem.com/?path=/story/docs-tutorials--tabular-data-format");const i=[],{datasets:n,labels:s}=e;return n.forEach(l=>{l.data.forEach((c,r)=>{let f;const m=Ne(l,"label");if(m===null){const b=Ne(s,r);b?f=b:f="Ungrouped"}else f=m;const y={group:f,key:s[r]};isNaN(c)?(y.value=c.value,y.date=c.date):y.value=c,i.push(y)})}),i}getTabularDataArray(){return[]}exportToCSV(){const e=this.getTabularDataArray().map(l=>l.map(c=>`"${(c==="&ndash;"?"":c).split(/[,;'"`]/).map(r=>q9(r)).join("")}"`)).map(l=>l.join(",")).join(`
`),i=this.getOptions();let n="myChart";const s=Ne(i,"fileDownload","fileName");typeof s=="function"?n=s("csv"):typeof s=="string"&&(n=s),this.services.files.downloadCSV(e,`${n}.csv`)}getTabularData(e){return Array.isArray(e)?e:this.transformToTabularData(e)}sanitize(e){return e=this.getTabularData(e),e}updateAllDataGroups(){this.allDataGroups?this.getDataGroupNames().forEach(e=>{this.allDataGroups.indexOf(e)===-1&&this.allDataGroups.push(e)}):this.allDataGroups=this.getDataGroupNames()}generateDataGroups(e){const{groupMapsTo:i}=this.getOptions().data,{ACTIVE:n,DISABLED:s}=ks.items.status,l=this.getOptions(),c=af(e.map(f=>f[i]));l.data.selectedGroups.length&&(l.data.selectedGroups.every(f=>c.includes(f))||(l.data.selectedGroups=[]));const r=f=>!l.data.selectedGroups.length||l.data.selectedGroups.includes(f)?n:s;return c.map(f=>({name:f,status:r(f)}))}setCustomColorScale(){if(!this.isUserProvidedColorScaleValid())return;const e=this.getOptions(),i=Ne(e,"color","scale");Object.keys(i).forEach(n=>{this.allDataGroups.includes(n)||console.warn(`"${n}" does not exist in data groups.`)}),this.allDataGroups.filter(n=>i[n]).forEach(n=>this.colorScale[n]=i[n])}setColorClassNames(){const e=Ne(this.getOptions(),"color","pairing");let i=Ne(e,"numberOfVariants");(!i||i<this.allDataGroups.length)&&(i=this.allDataGroups.length);let n=Ne(e,"option");const s=RU.pairingOptions,l=i>5?14:i,c=`${l}-color`;n=n<=s[c]?n:1;const r=this.allDataGroups.map((f,m)=>`${l}-${n}-${m%14+1}`);this.colorClassNames=K0().range(r).domain(this.allDataGroups)}}let Z9=class extends AS{constructor(e){super(e),this.axisFlavor=R0.DEFAULT}assignRangeAndDomains(){const{cartesianScales:e}=this.services,i=this.getOptions(),n=e.isDualAxes(),s={primaryDomain:e.domainAxisPosition,primaryRange:e.rangeAxisPosition,secondaryDomain:null,secondaryRange:null};return n&&(s.secondaryDomain=e.secondaryDomainAxisPosition,s.secondaryRange=e.secondaryRangeAxisPosition),Object.keys(s).forEach(l=>{const c=s[l];e.scales[c]?s[l]={position:c,label:e.getScaleLabel(c),identifier:Ne(i,"axes",c,"mapsTo")}:s[l]=null}),s}getTabularDataArray(){const e=this.getDisplayData(),i=this.getOptions(),{groupMapsTo:n}=i.data,{cartesianScales:s}=this.services,{primaryDomain:l,primaryRange:c,secondaryDomain:r,secondaryRange:f}=this.assignRangeAndDomains(),m=s.getDomainAxisScaleType();let y;return m===Hi.TIME&&(y=b=>Oh(b,"MMM d, yyyy")),[["Group",l.label,c.label,...r?[r.label]:[],...f?[f.label]:[]],...e.map(b=>[b[n],b[l.identifier]===null?"&ndash;":y?y(b[l.identifier]):b[l.identifier],b[c.identifier]===null||isNaN(b[c.identifier])?"&ndash;":b[c.identifier].toLocaleString(),...r?[b[r.identifier]===null?"&ndash;":b[r.identifier]]:[],...f?[b[f.identifier]===null||isNaN(b[f.identifier])?"&ndash;":b[f.identifier]]:[]])]}setData(e){let i;if(e&&(i=super.setData(e),Ne(this.getOptions(),"zoomBar",Ft.TOP,"enabled"))){const n=Ne(this.getOptions(),"zoomBar",Ft.TOP,"data");this.setZoomBarData(n)}return i}setZoomBarData(e){const i=e?this.sanitize(Rp(e)):this.getDisplayData();let n=i;const{cartesianScales:s}=this.services;if(i&&s.domainAxisPosition&&s.rangeAxisPosition){const l=s.getDomainIdentifier(),c=s.getRangeIdentifier();let r=i.map(f=>f[l].getTime());r=af(r).sort(),n=r.map(f=>{let m=0;const y={};return i.forEach(b=>{b[l].getTime()===f&&(m+=b[c])}),y[l]=new Date(f),y[c]=m,y})}this.set({zoomBarData:n})}getZoomBarData(){return this.get("zoomBarData")}sanitizeDateValues(e){const i=this.getOptions();if(!i.axes)return e;const n=[];return Object.keys(Ft).forEach(s=>{const l=Ft[s],c=i.axes[l];if(c&&c.scaleType===Hi.TIME){const r=c.mapsTo;(r!==null||r!==void 0)&&n.push(r)}}),n.length>0&&e.forEach(s=>{n.forEach(l=>{Ne(s,l,"getTime")===null&&(s[l]=new Date(s[l]))})}),e}sanitize(e){return e=super.sanitize(e),e=this.sanitizeDateValues(e),e}};var W9=/\s/;function Y9(t){for(var e=t.length;e--&&W9.test(t.charAt(e)););return e}var J9=/^\s+/;function X9(t){return t&&t.slice(0,Y9(t)+1).replace(J9,"")}var E2=NaN,Q9=/^[-+]0x[0-9a-f]+$/i,$9=/^0b[01]+$/i,ej=/^0o[0-7]+$/i,tj=parseInt;function jd(t){if(typeof t=="number")return t;if(Sp(t))return E2;if(oo(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=oo(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=X9(t);var i=$9.test(t);return i||ej.test(t)?tj(t.slice(2),i?2:8):Q9.test(t)?E2:+t}var ij=function(){return Ro.Date.now()};const a_=ij;var nj="Expected a function",rj=Math.max,sj=Math.min;function aj(t,e,i){var n,s,l,c,r,f,m=0,y=!1,b=!1,E=!0;if(typeof t!="function")throw new TypeError(nj);e=jd(e)||0,oo(i)&&(y=!!i.leading,b="maxWait"in i,l=b?rj(jd(i.maxWait)||0,e):l,E="trailing"in i?!!i.trailing:E);function S(ne){var ue=n,ve=s;return n=s=void 0,m=ne,c=t.apply(ve,ue),c}function D(ne){return m=ne,r=setTimeout(H,e),y?S(ne):c}function R(ne){var ue=ne-f,ve=ne-m,_e=e-ue;return b?sj(_e,l-ve):_e}function z(ne){var ue=ne-f,ve=ne-m;return f===void 0||ue>=e||ue<0||b&&ve>=l}function H(){var ne=a_();if(z(ne))return K(ne);r=setTimeout(H,R(ne))}function K(ne){return r=void 0,E&&n?S(ne):(n=s=void 0,c)}function W(){r!==void 0&&clearTimeout(r),m=0,n=f=s=r=void 0}function se(){return r===void 0?c:K(a_())}function Y(){var ne=a_(),ue=z(ne);if(n=arguments,s=this,f=ne,ue){if(r===void 0)return D(f);if(b)return clearTimeout(r),r=setTimeout(H,e),S(f)}return r===void 0&&(r=setTimeout(H,e)),c}return Y.cancel=W,Y.flush=se,Y}function oj(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const i=document.implementation.createHTMLDocument(),n=i.createElement("base"),s=i.createElement("a");return i.head.appendChild(n),i.body.appendChild(s),e&&(n.href=e),s.href=t,s.href}const lj=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function Cl(t){const e=[];for(let i=0,n=t.length;i<n;i++)e.push(t[i]);return e}function op(t,e){const i=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return i?parseFloat(i.replace("px","")):0}function cj(t){const e=op(t,"border-left-width"),i=op(t,"border-right-width");return t.clientWidth+e+i}function uj(t){const e=op(t,"border-top-width"),i=op(t,"border-bottom-width");return t.clientHeight+e+i}function ES(t,e={}){const i=e.width||cj(t),n=e.height||uj(t);return{width:i,height:n}}function hj(){let t,e;try{e=process}catch{}const i=e&&e.env?e.env.devicePixelRatio:null;return i&&(t=parseInt(i,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const La=16384;function dj(t){(t.width>La||t.height>La)&&(t.width>La&&t.height>La?t.width>t.height?(t.height*=La/t.width,t.width=La):(t.width*=La/t.height,t.height=La):t.width>La?(t.height*=La/t.width,t.width=La):(t.width*=La/t.height,t.height=La))}function lp(t){return new Promise((e,i)=>{const n=new Image;n.decode=()=>e(n),n.onload=()=>e(n),n.onerror=i,n.crossOrigin="anonymous",n.decoding="async",n.src=t})}async function fj(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function mj(t,e,i){const n="http://www.w3.org/2000/svg",s=document.createElementNS(n,"svg"),l=document.createElementNS(n,"foreignObject");return s.setAttribute("width",`${e}`),s.setAttribute("height",`${i}`),s.setAttribute("viewBox",`0 0 ${e} ${i}`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("externalResourcesRequired","true"),s.appendChild(l),l.appendChild(t),fj(s)}const xa=(t,e)=>{if(t instanceof e)return!0;const i=Object.getPrototypeOf(t);return i===null?!1:i.constructor.name===e.name||xa(i,e)};function pj(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function gj(t){return Cl(t).map(e=>{const i=t.getPropertyValue(e),n=t.getPropertyPriority(e);return`${e}: ${i}${n?" !important":""};`}).join(" ")}function _j(t,e,i){const n=`.${t}:${e}`,s=i.cssText?pj(i):gj(i);return document.createTextNode(`${n}{${s}}`)}function T2(t,e,i){const n=window.getComputedStyle(t,i),s=n.getPropertyValue("content");if(s===""||s==="none")return;const l=lj();try{e.className=`${e.className} ${l}`}catch{return}const c=document.createElement("style");c.appendChild(_j(l,i,n)),e.appendChild(c)}function yj(t,e){T2(t,e,":before"),T2(t,e,":after")}const S2="application/font-woff",I2="image/jpeg",vj={woff:S2,woff2:S2,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:I2,jpeg:I2,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function bj(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function Ty(t){const e=bj(t).toLowerCase();return vj[e]||""}function xj(t){return t.split(/,/)[1]}function n0(t){return t.search(/^(data:)/)!==-1}function TS(t,e){return`data:${e};base64,${t}`}async function SS(t,e,i){const n=await fetch(t,e);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const s=await n.blob();return new Promise((l,c)=>{const r=new FileReader;r.onerror=c,r.onloadend=()=>{try{l(i({res:n,result:r.result}))}catch(f){c(f)}},r.readAsDataURL(s)})}const o_={};function wj(t,e,i){let n=t.replace(/\?.*/,"");return i&&(n=t),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),e?`[${e}]${n}`:n}async function Sy(t,e,i){const n=wj(t,e,i.includeQueryParams);if(o_[n]!=null)return o_[n];i.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let s;try{const l=await SS(t,i.fetchRequestInit,({res:c,result:r})=>(e||(e=c.headers.get("Content-Type")||""),xj(r)));s=TS(l,e)}catch(l){s=i.imagePlaceholder||"";let c=`Failed to fetch resource: ${t}`;l&&(c=typeof l=="string"?l:l.message),c&&console.warn(c)}return o_[n]=s,s}async function Aj(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):lp(e)}async function Ej(t,e){if(t.currentSrc){const l=document.createElement("canvas"),c=l.getContext("2d");l.width=t.clientWidth,l.height=t.clientHeight,c==null||c.drawImage(t,0,0,l.width,l.height);const r=l.toDataURL();return lp(r)}const i=t.poster,n=Ty(i),s=await Sy(i,n,e);return lp(s)}async function Tj(t){var e;try{if(!((e=t==null?void 0:t.contentDocument)===null||e===void 0)&&e.body)return await Np(t.contentDocument.body,{},!0)}catch{}return t.cloneNode(!1)}async function Sj(t,e){return xa(t,HTMLCanvasElement)?Aj(t):xa(t,HTMLVideoElement)?Ej(t,e):xa(t,HTMLIFrameElement)?Tj(t):t.cloneNode(!1)}const Ij=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT";async function kj(t,e,i){var n,s;let l=[];return Ij(t)&&t.assignedNodes?l=Cl(t.assignedNodes()):xa(t,HTMLIFrameElement)&&!((n=t.contentDocument)===null||n===void 0)&&n.body?l=Cl(t.contentDocument.body.childNodes):l=Cl(((s=t.shadowRoot)!==null&&s!==void 0?s:t).childNodes),l.length===0||xa(t,HTMLVideoElement)||await l.reduce((c,r)=>c.then(()=>Np(r,i)).then(f=>{f&&e.appendChild(f)}),Promise.resolve()),e}function Oj(t,e){const i=e.style;if(!i)return;const n=window.getComputedStyle(t);n.cssText?(i.cssText=n.cssText,i.transformOrigin=n.transformOrigin):Cl(n).forEach(s=>{let l=n.getPropertyValue(s);s==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),xa(t,HTMLIFrameElement)&&s==="display"&&l==="inline"&&(l="block"),s==="d"&&e.getAttribute("d")&&(l=`path(${e.getAttribute("d")})`),i.setProperty(s,l,n.getPropertyPriority(s))})}function Cj(t,e){xa(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),xa(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function Mj(t,e){if(xa(t,HTMLSelectElement)){const i=e,n=Array.from(i.children).find(s=>t.value===s.getAttribute("value"));n&&n.setAttribute("selected","")}}function Dj(t,e){return xa(e,Element)&&(Oj(t,e),yj(t,e),Cj(t,e),Mj(t,e)),e}async function Rj(t,e){const i=t.querySelectorAll?t.querySelectorAll("use"):[];if(i.length===0)return t;const n={};for(let l=0;l<i.length;l++){const c=i[l].getAttribute("xlink:href");if(c){const r=t.querySelector(c),f=document.querySelector(c);!r&&f&&!n[c]&&(n[c]=await Np(f,e,!0))}}const s=Object.values(n);if(s.length){const l="http://www.w3.org/1999/xhtml",c=document.createElementNS(l,"svg");c.setAttribute("xmlns",l),c.style.position="absolute",c.style.width="0",c.style.height="0",c.style.overflow="hidden",c.style.display="none";const r=document.createElementNS(l,"defs");c.appendChild(r);for(let f=0;f<s.length;f++)r.appendChild(s[f]);t.appendChild(c)}return t}async function Np(t,e,i){return!i&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(n=>Sj(n,e)).then(n=>kj(t,n,e)).then(n=>Dj(t,n)).then(n=>Rj(n,e))}const IS=/url\((['"]?)([^'"]+?)\1\)/g,Lj=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Pj=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Nj(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function zj(t){const e=[];return t.replace(IS,(i,n,s)=>(e.push(s),i)),e.filter(i=>!n0(i))}async function Bj(t,e,i,n,s){try{const l=i?oj(e,i):e,c=Ty(e);let r;if(s){const f=await s(l);r=TS(f,c)}else r=await Sy(l,c,n);return t.replace(Nj(e),`$1${r}$3`)}catch{}return t}function Vj(t,{preferredFontFormat:e}){return e?t.replace(Pj,i=>{for(;;){const[n,,s]=Lj.exec(i)||[];if(!s)return"";if(s===e)return`src: ${n};`}}):t}function kS(t){return t.search(IS)!==-1}async function OS(t,e,i){if(!kS(t))return t;const n=Vj(t,i);return zj(n).reduce((s,l)=>s.then(c=>Bj(c,l,e,i)),Promise.resolve(n))}async function lm(t,e,i){var n;const s=(n=e.style)===null||n===void 0?void 0:n.getPropertyValue(t);if(s){const l=await OS(s,null,i);return e.style.setProperty(t,l,e.style.getPropertyPriority(t)),!0}return!1}async function Fj(t,e){await lm("background",t,e)||await lm("background-image",t,e),await lm("mask",t,e)||await lm("mask-image",t,e)}async function Uj(t,e){const i=xa(t,HTMLImageElement);if(!(i&&!n0(t.src))&&!(xa(t,SVGImageElement)&&!n0(t.href.baseVal)))return;const n=i?t.src:t.href.baseVal,s=await Sy(n,Ty(n),e);await new Promise((l,c)=>{t.onload=l,t.onerror=c;const r=t;r.decode&&(r.decode=l),r.loading==="lazy"&&(r.loading="eager"),i?(t.srcset="",t.src=s):t.href.baseVal=s})}async function jj(t,e){const i=Cl(t.childNodes).map(n=>CS(n,e));await Promise.all(i).then(()=>t)}async function CS(t,e){xa(t,Element)&&(await Fj(t,e),await Uj(t,e),await jj(t,e))}function Gj(t,e){const{style:i}=t;e.backgroundColor&&(i.backgroundColor=e.backgroundColor),e.width&&(i.width=`${e.width}px`),e.height&&(i.height=`${e.height}px`);const n=e.style;return n!=null&&Object.keys(n).forEach(s=>{i[s]=n[s]}),t}const k2={};async function O2(t){let e=k2[t];if(e!=null)return e;const i=await(await fetch(t)).text();return e={url:t,cssText:i},k2[t]=e,e}async function C2(t,e){let i=t.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,s=(i.match(/url\([^)]+\)/g)||[]).map(async l=>{let c=l.replace(n,"$1");return c.startsWith("https://")||(c=new URL(c,t.url).href),SS(c,e.fetchRequestInit,({result:r})=>(i=i.replace(l,`url(${r})`),[l,r]))});return Promise.all(s).then(()=>i)}function M2(t){if(t==null)return[];const e=[],i=/(\/\*[\s\S]*?\*\/)/gi;let n=t.replace(i,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const f=s.exec(n);if(f===null)break;e.push(f[0])}n=n.replace(s,"");const l=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,c="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",r=new RegExp(c,"gi");for(;;){let f=l.exec(n);if(f===null){if(f=r.exec(n),f===null)break;l.lastIndex=r.lastIndex}else r.lastIndex=l.lastIndex;e.push(f[0])}return e}async function Hj(t,e){const i=[],n=[];return t.forEach(s=>{if("cssRules"in s)try{Cl(s.cssRules||[]).forEach((l,c)=>{if(l.type===CSSRule.IMPORT_RULE){let r=c+1;const f=l.href,m=O2(f).then(y=>C2(y,e)).then(y=>M2(y).forEach(b=>{try{s.insertRule(b,b.startsWith("@import")?r+=1:s.cssRules.length)}catch(E){console.error("Error inserting rule from remote css",{rule:b,error:E})}})).catch(y=>{console.error("Error loading remote css",y.toString())});n.push(m)}})}catch(l){const c=t.find(r=>r.href==null)||document.styleSheets[0];s.href!=null&&n.push(O2(s.href).then(r=>C2(r,e)).then(r=>M2(r).forEach(f=>{c.insertRule(f,s.cssRules.length)})).catch(r=>{console.error("Error loading remote stylesheet",r)})),console.error("Error inlining remote css file",l)}}),Promise.all(n).then(()=>(t.forEach(s=>{if("cssRules"in s)try{Cl(s.cssRules||[]).forEach(l=>{i.push(l)})}catch(l){console.error(`Error while reading CSS rules from ${s.href}`,l)}}),i))}function Kj(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>kS(e.style.getPropertyValue("src")))}async function qj(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const i=Cl(t.ownerDocument.styleSheets),n=await Hj(i,e);return Kj(n)}async function Zj(t,e){const i=await qj(t,e);return(await Promise.all(i.map(n=>{const s=n.parentStyleSheet?n.parentStyleSheet.href:null;return OS(n.cssText,s,e)}))).join(`
`)}async function Wj(t,e){const i=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await Zj(t,e);if(i){const n=document.createElement("style"),s=document.createTextNode(i);n.appendChild(s),t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)}}async function Yj(t,e={}){const{width:i,height:n}=ES(t,e),s=await Np(t,e,!0);return await Wj(s,e),await CS(s,e),Gj(s,e),await mj(s,i,n)}async function MS(t,e={}){const{width:i,height:n}=ES(t,e),s=await Yj(t,e),l=await lp(s),c=document.createElement("canvas"),r=c.getContext("2d"),f=e.pixelRatio||hj(),m=e.canvasWidth||i,y=e.canvasHeight||n;return c.width=m*f,c.height=y*f,e.skipAutoScale||dj(c),c.style.width=`${m}`,c.style.height=`${y}`,e.backgroundColor&&(r.fillStyle=e.backgroundColor,r.fillRect(0,0,c.width,c.height)),r.drawImage(l,0,0,c.width,c.height),c}async function Jj(t,e={}){return(await MS(t,e)).toDataURL()}async function Xj(t,e={}){return(await MS(t,e)).toDataURL("image/jpeg",e.quality||1)}class Bl{constructor(e,i){this.model=e,this.services=i,this.init()}init(){}update(){}setModel(e){this.model=e}setServices(e){this.services=e}}const Qj="DONT_STYLE_ME_css_styles_verifier";let hi=class r0 extends Bl{constructor(e,i){super(e,i),this.chartID=""}static getHTMLElementSize(e){return{width:e.clientWidth,height:e.clientHeight}}static getSVGElementSize(e,i={useAttrs:!1,useClientDimensions:!1,useBBox:!1,useBoundingRect:!1}){e.attr||(e=Jt(e));const n={width:0,height:0},s=E=>{E&&Object.keys(n).forEach(S=>{if(E[S]){const D=E[S],R=parseFloat(D);D&&R>n[S]&&(""+D).indexOf("%")===-1&&(n[S]=R)}})},l={width:e.attr("width"),height:e.attr("height")},c=e.node();let r,f,m,y;try{typeof c.getBBox=="function"&&(r=c.getBBox(),f={width:r.width,height:r.height})}catch(E){console.error(E)}try{typeof(c==null?void 0:c.getBoundingClientRect)=="function"&&(m=c.getBoundingClientRect(),y={width:m.width,height:m.height})}catch(E){console.error(E)}let b;if(c instanceof SVGSVGElement&&(b={width:c.clientWidth,height:c.clientHeight}),i){if(i.useAttrs&&(s(l),n.width>0&&n.height>0))return n;if(i.useClientDimensions&&(s(b),n.width>0&&n.height>0))return b;if(i.useBBox&&(s(f),n.width>0&&n.height>0))return f;if(i.useBoundingRect&&(s(y),n.width>0&&n.height>0))return y}try{const E={width:Ne(e.node(),"width","baseVal","value"),height:Ne(e.node(),"height","baseVal","value")};s(E)}catch{s(b),s(f),s(l)}return n}static appendOrSelect(e,i){const n=e.select(`${i}`);if(n.empty()){let s=i.split("#"),l,c;return s.length===2?(l=s[0],s=s[1].split("."),c=s[0]):(s=i.split("."),l=s[0]),e.append(l).attr("id",c).attr("class",s.slice(1).join(" "))}return n}init(){this.styleHolderElement(),this.initializeID(),this.addMainContainer(),this.model.getOptions().resizable&&this.addResizeListener(),this.addHolderListeners(),this.handleFullscreenChange()}getChartID(){return this.chartID}generateElementIDString(e){return`chart-${this.chartID}-${e}`}initializeID(){this.chartID=Math.floor((1+Math.random())*281474976710656).toString(16)}addMainContainer(){const e=this.model.getOptions(),i=Ne(e,"style","prefix"),n=Jt(this.getHolder()).append("div").classed(`${va}--${i}--chart-wrapper`,!0).attr("id",`chart-${this.getChartID()}`).style("height","100%").style("width","100%");n.append("g").attr("class",Qj),this.mainContainer=n.node()}update(){this.styleHolderElement()}styleHolderElement(){const e=this.getHolder(),{width:i,height:n,theme:s}=this.model.getOptions();i!==this.width&&(e.style.width=i,this.width=i),n!==this.height&&(e.style.height=n,this.height=n),Jt(this.getHolder()).classed(`${va}--chart-holder`,!0).attr("data-carbon-theme",s)}getHolder(){return this.model.get("holder")}exportToJPG(){const e=this,i=this.model.getOptions(),n=this.getHolder(),s=Jt(n);s.classed("filled",!0),Xj(this.getMainContainer(),{quality:1,filter:l=>!(l.classList&&l.classList.contains("cds--cc--toolbar"))}).then(function(l){var c;let r="myChart";const f=Ne(i,"fileDownload","fileName");typeof f=="function"?r=f("jpg"):typeof f=="string"&&(r=f),(c=e.services.files)==null||c.downloadImage(l,`${r}.jpg`),s.classed("filled",!1)})}exportToPNG(){const e=this,i=this.model.getOptions(),n=this.getHolder(),s=Jt(n);s.classed("filled",!0),Jj(this.getMainContainer(),{quality:1,filter:l=>!(l.classList&&l.classList.contains("cds--cc--toolbar"))}).then(function(l){var c;let r="myChart";const f=Ne(i,"fileDownload","fileName");typeof f=="function"?r=f("png"):typeof f=="string"&&(r=f),(c=e.services.files)==null||c.downloadImage(l,`${r}.png`),s.classed("filled",!1)}).catch(function(l){console.error("oops, something went wrong!",l)})}toggleFullscreen(){const e=this.getHolder();Jt(e).classed("fullscreen")&&(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()}handleFullscreenChange(){document.addEventListener("fullscreenchange",()=>{const e=Jt(this.getHolder()),i=e.classed("fullscreen");e.classed("fullscreen",!i)})}setSVGMaxHeight(){if(!this.model.getOptions().height){const{height:e}=r0.getSVGElementSize(Jt(this.mainContainer),{useBBox:!0}),i=Jt(this.mainContainer).attr("class"),n=Jt(this.mainContainer).selectAll(`.${i} > svg`);let s=0;n.nodes().forEach(function(l){s+=Number(r0.getSVGElementSize(Jt(l),{useBBox:!0}).height)}),s<=e?Jt(this.mainContainer).attr("height",s):Jt(this.mainContainer).attr("height","100%")}}getMainContainer(){return this.mainContainer}addHolderListeners(){const e=this.getHolder();e&&Jt(e).on("mouseover",()=>{var i;(i=this.services.events)==null||i.dispatchEvent(yt.Chart.MOUSEOVER)}).on("mouseout",()=>{var i;(i=this.services.events)==null||i.dispatchEvent(yt.Chart.MOUSEOUT)})}addResizeListener(){const e=this.getHolder();if(!e)return;let i=e.clientWidth,n=e.clientHeight;const s=aj(()=>{var l;e&&(Math.abs(i-e.clientWidth)>1||Math.abs(n-e.clientHeight)>1)&&(i=e.clientWidth,n=e.clientHeight,(l=this.services.events)==null||l.dispatchEvent(yt.Chart.RESIZE))},12.5);new ResizeObserver(s).observe(e)}};class lf extends Bl{static appendOrUpdateLinearGradient(e){let i=e.svg.select(`defs linearGradient#${e.id}`);i.empty()&&(i=e.svg.append("defs").append("linearGradient").attr("id",e.id).attr("x1",e.x1).attr("x2",e.x2).attr("y1",e.y1).attr("y2",e.y2)),i.selectAll("stop").remove(),i.selectAll("stop").data(e.stops).enter().append("stop").attr("offset",n=>n.offset).style("stop-color",n=>n.color).style("stop-opacity",n=>n.opacity)}static getOffsetRatio(e){return(Math.abs(e[1])*100/Math.abs(e[0]-e[1])).toFixed(2)+"%"}static getStops(e,i){const n=e[0]<0&&e[1]>0;let s=[{offset:"0%",color:i,opacity:"0.6"},{offset:"80%",color:i,opacity:"0"}];return n&&(s=[{offset:"0%",color:i,opacity:"0.6"},{offset:lf.getOffsetRatio(e),color:i,opacity:"0"},{offset:"100%",color:i,opacity:"0.6"}]),s}}var $j={value:function(){}};function DS(){for(var t=0,e=arguments.length,i={},n;t<e;++t){if(!(n=arguments[t]+"")||n in i||/[\s.]/.test(n))throw new Error("illegal type: "+n);i[n]=[]}return new km(i)}function km(t){this._=t}function eG(t,e){return t.trim().split(/^|\s+/).map(function(i){var n="",s=i.indexOf(".");if(s>=0&&(n=i.slice(s+1),i=i.slice(0,s)),i&&!e.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:n}})}km.prototype=DS.prototype={constructor:km,on:function(t,e){var i=this._,n=eG(t+"",i),s,l=-1,c=n.length;if(arguments.length<2){for(;++l<c;)if((s=(t=n[l]).type)&&(s=tG(i[s],t.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++l<c;)if(s=(t=n[l]).type)i[s]=D2(i[s],t.name,e);else if(e==null)for(s in i)i[s]=D2(i[s],t.name,null);return this},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new km(t)},call:function(t,e){if((s=arguments.length-2)>0)for(var i=new Array(s),n=0,s,l;n<s;++n)i[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(l=this._[t],n=0,s=l.length;n<s;++n)l[n].value.apply(e,i)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],s=0,l=n.length;s<l;++s)n[s].value.apply(e,i)}};function tG(t,e){for(var i=0,n=t.length,s;i<n;++i)if((s=t[i]).name===e)return s.value}function D2(t,e,i){for(var n=0,s=t.length;n<s;++n)if(t[n].name===e){t[n]=$j,t=t.slice(0,n).concat(t.slice(n+1));break}return i!=null&&t.push({name:e,value:i}),t}const iG=Object.freeze(Object.defineProperty({__proto__:null,dispatch:DS},Symbol.toStringTag,{value:"Module"})),nG=RR(iG);nG.dispatch;function rG(t,e,i){return t===t&&(i!==void 0&&(t=t<=i?t:i),e!==void 0&&(t=t>=e?t:e)),t}function sG(t,e,i){return i===void 0&&(i=e,e=void 0),i!==void 0&&(i=jd(i),i=i===i?i:0),e!==void 0&&(e=jd(e),e=e===e?e:0),rG(jd(t),e,i)}function aG(t,e){return Lp(t,e)}function oG(t,e){var i;return wS(t,function(n,s,l){return i=e(n,s,l),!i}),!!i}function lG(t,e,i){var n=qs(t)?JT:oG;return i&&CT(t,e,i)&&(e=void 0),n(t,wy(e))}let Nr=class{constructor(e,i,n){if(this.type="",this.renderType=Yn.HTML,this.id="",this.parent=void 0,this.configs={},this.model=e,this.services=i,n&&(this.configs=n,this.configs.id)){const s=Ne(this.model.getOptions(),"style","prefix");this.id=`${s}--${this.configs.id}`}this.parent||this.setParent(Jt(this.services.domUtils.getMainContainer()))}init(){}render(e=!0){console.error("Error: Component did not provide the required render function.")}destroy(){}setModel(e){this.model=e}setServices(e){this.services=e}setParent(e){var i;const n=this.parent;if(this.parent=e,!(n&&n.node()===e.node())&&this.type){const s=Ne(this.model.getOptions(),"style","prefix");(i=this.parent)==null||i.classed(`${va}--${s}--${this.type}`,!0),n&&n.classed(`${va}--${s}--${this.type}`,!1)}}getParent(){return this.parent}getComponentContainer(e={withinChartClip:!1}){if(this.type){const i=Ne(this.model.getOptions(),"style","prefix"),n=this.id?`#${this.id}`:"",s=hi.appendOrSelect(this.parent,`${this.renderType===Yn.SVG?"svg":"div"}${n}.${va}--${i}--${this.type}`);if(e.withinChartClip){const l=this.model.get("chartClipId");if(l){const c=Jt(`#${l}`).select("rect");c.size()!==0&&parseFloat(c.attr("height"))>0&&s.attr("clip-path",`url(#${l})`)}}return s.attr("width","100%").attr("height","100%")}return this.parent}getOptions(){return this.configs.options?mn({},this.model.getOptions(),this.configs.options):this.model.getOptions()}};/*! @license DOMPurify 3.0.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.6/LICENSE */const{entries:RS,setPrototypeOf:R2,isFrozen:cG,getPrototypeOf:uG,getOwnPropertyDescriptor:LS}=Object;let{freeze:oa,seal:Mo,create:PS}=Object,{apply:s0,construct:a0}=typeof Reflect<"u"&&Reflect;oa||(oa=function(t){return t});Mo||(Mo=function(t){return t});s0||(s0=function(t,e,i){return t.apply(e,i)});a0||(a0=function(t,e){return new t(...e)});const cm=lo(Array.prototype.forEach),L2=lo(Array.prototype.pop),kd=lo(Array.prototype.push),Om=lo(String.prototype.toLowerCase),l_=lo(String.prototype.toString),hG=lo(String.prototype.match),Od=lo(String.prototype.replace),dG=lo(String.prototype.indexOf),fG=lo(String.prototype.trim),Pa=lo(RegExp.prototype.test),Cd=mG(TypeError);function lo(t){return function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];return s0(t,e,n)}}function mG(t){return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return a0(t,i)}}function pn(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Om;R2&&R2(t,null);let n=e.length;for(;n--;){let s=e[n];if(typeof s=="string"){const l=i(s);l!==s&&(cG(e)||(e[n]=l),s=l)}t[s]=!0}return t}function Wu(t){const e=PS(null);for(const[i,n]of RS(t))LS(t,i)!==void 0&&(e[i]=n);return e}function um(t,e){for(;t!==null;){const n=LS(t,e);if(n){if(n.get)return lo(n.get);if(typeof n.value=="function")return lo(n.value)}t=uG(t)}function i(n){return console.warn("fallback value for",n),null}return i}const P2=oa(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),c_=oa(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),u_=oa(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),pG=oa(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),h_=oa(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),gG=oa(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),N2=oa(["#text"]),z2=oa(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),d_=oa(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),B2=oa(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),hm=oa(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),_G=Mo(/\{\{[\w\W]*|[\w\W]*\}\}/gm),yG=Mo(/<%[\w\W]*|[\w\W]*%>/gm),vG=Mo(/\${[\w\W]*}/gm),bG=Mo(/^data-[\-\w.\u00B7-\uFFFF]/),xG=Mo(/^aria-[\-\w]+$/),NS=Mo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wG=Mo(/^(?:\w+script|data):/i),AG=Mo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zS=Mo(/^html$/i);var V2=Object.freeze({__proto__:null,MUSTACHE_EXPR:_G,ERB_EXPR:yG,TMPLIT_EXPR:vG,DATA_ATTR:bG,ARIA_ATTR:xG,IS_ALLOWED_URI:NS,IS_SCRIPT_OR_DATA:wG,ATTR_WHITESPACE:AG,DOCTYPE_NAME:zS});const EG=function(){return typeof window>"u"?null:window},TG=function(t,e){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let i=null;const n="data-tt-policy-suffix";e&&e.hasAttribute(n)&&(i=e.getAttribute(n));const s="dompurify"+(i?"#"+i:"");try{return t.createPolicy(s,{createHTML(l){return l},createScriptURL(l){return l}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function BS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:EG();const e=ke=>BS(ke);if(e.version="3.0.6",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;let{document:i}=t;const n=i,s=n.currentScript,{DocumentFragment:l,HTMLTemplateElement:c,Node:r,Element:f,NodeFilter:m,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:b,DOMParser:E,trustedTypes:S}=t,D=f.prototype,R=um(D,"cloneNode"),z=um(D,"nextSibling"),H=um(D,"childNodes"),K=um(D,"parentNode");if(typeof c=="function"){const ke=i.createElement("template");ke.content&&ke.content.ownerDocument&&(i=ke.content.ownerDocument)}let W,se="";const{implementation:Y,createNodeIterator:ne,createDocumentFragment:ue,getElementsByTagName:ve}=i,{importNode:_e}=n;let oe={};e.isSupported=typeof RS=="function"&&typeof K=="function"&&Y&&Y.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Be,ERB_EXPR:mt,TMPLIT_EXPR:Le,DATA_ATTR:rt,ARIA_ATTR:tt,IS_SCRIPT_OR_DATA:We,ATTR_WHITESPACE:Ve}=V2;let{IS_ALLOWED_URI:St}=V2,zt=null;const mi=pn({},[...P2,...c_,...u_,...h_,...N2]);let vt=null;const pt=pn({},[...z2,...d_,...B2,...hm]);let Pt=Object.seal(PS(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),qe=null,Ht=null,lt=!0,Gt=!0,Mi=!1,bt=!0,ze=!1,$t=!1,dt=!1,_t=!1,ni=!1,Wi=!1,ct=!1,et=!0,zi=!1;const zn="user-content-";let Xe=!0,On=!1,Rt={},Xi=null;const Ui=pn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Gn=null;const mr=pn({},["audio","video","img","source","image","track"]);let vr=null;const jr=pn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Cr="http://www.w3.org/1998/Math/MathML",lr="http://www.w3.org/2000/svg",Hn="http://www.w3.org/1999/xhtml";let Nt=Hn,Qi=!1,Qe=null;const Ki=pn({},[Cr,lr,Hn],l_);let Gi=null;const Lt=["application/xhtml+xml","text/html"],Bi="text/html";let ii=null,Bn=null;const st=i.createElement("form"),Q=function(ke){return ke instanceof RegExp||ke instanceof Function},ge=function(){let ke=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Bn&&Bn===ke)){if((!ke||typeof ke!="object")&&(ke={}),ke=Wu(ke),Gi=Lt.indexOf(ke.PARSER_MEDIA_TYPE)===-1?Gi=Bi:Gi=ke.PARSER_MEDIA_TYPE,ii=Gi==="application/xhtml+xml"?l_:Om,zt="ALLOWED_TAGS"in ke?pn({},ke.ALLOWED_TAGS,ii):mi,vt="ALLOWED_ATTR"in ke?pn({},ke.ALLOWED_ATTR,ii):pt,Qe="ALLOWED_NAMESPACES"in ke?pn({},ke.ALLOWED_NAMESPACES,l_):Ki,vr="ADD_URI_SAFE_ATTR"in ke?pn(Wu(jr),ke.ADD_URI_SAFE_ATTR,ii):jr,Gn="ADD_DATA_URI_TAGS"in ke?pn(Wu(mr),ke.ADD_DATA_URI_TAGS,ii):mr,Xi="FORBID_CONTENTS"in ke?pn({},ke.FORBID_CONTENTS,ii):Ui,qe="FORBID_TAGS"in ke?pn({},ke.FORBID_TAGS,ii):{},Ht="FORBID_ATTR"in ke?pn({},ke.FORBID_ATTR,ii):{},Rt="USE_PROFILES"in ke?ke.USE_PROFILES:!1,lt=ke.ALLOW_ARIA_ATTR!==!1,Gt=ke.ALLOW_DATA_ATTR!==!1,Mi=ke.ALLOW_UNKNOWN_PROTOCOLS||!1,bt=ke.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ze=ke.SAFE_FOR_TEMPLATES||!1,$t=ke.WHOLE_DOCUMENT||!1,ni=ke.RETURN_DOM||!1,Wi=ke.RETURN_DOM_FRAGMENT||!1,ct=ke.RETURN_TRUSTED_TYPE||!1,_t=ke.FORCE_BODY||!1,et=ke.SANITIZE_DOM!==!1,zi=ke.SANITIZE_NAMED_PROPS||!1,Xe=ke.KEEP_CONTENT!==!1,On=ke.IN_PLACE||!1,St=ke.ALLOWED_URI_REGEXP||NS,Nt=ke.NAMESPACE||Hn,Pt=ke.CUSTOM_ELEMENT_HANDLING||{},ke.CUSTOM_ELEMENT_HANDLING&&Q(ke.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Pt.tagNameCheck=ke.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ke.CUSTOM_ELEMENT_HANDLING&&Q(ke.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Pt.attributeNameCheck=ke.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ke.CUSTOM_ELEMENT_HANDLING&&typeof ke.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Pt.allowCustomizedBuiltInElements=ke.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ze&&(Gt=!1),Wi&&(ni=!0),Rt&&(zt=pn({},[...N2]),vt=[],Rt.html===!0&&(pn(zt,P2),pn(vt,z2)),Rt.svg===!0&&(pn(zt,c_),pn(vt,d_),pn(vt,hm)),Rt.svgFilters===!0&&(pn(zt,u_),pn(vt,d_),pn(vt,hm)),Rt.mathMl===!0&&(pn(zt,h_),pn(vt,B2),pn(vt,hm))),ke.ADD_TAGS&&(zt===mi&&(zt=Wu(zt)),pn(zt,ke.ADD_TAGS,ii)),ke.ADD_ATTR&&(vt===pt&&(vt=Wu(vt)),pn(vt,ke.ADD_ATTR,ii)),ke.ADD_URI_SAFE_ATTR&&pn(vr,ke.ADD_URI_SAFE_ATTR,ii),ke.FORBID_CONTENTS&&(Xi===Ui&&(Xi=Wu(Xi)),pn(Xi,ke.FORBID_CONTENTS,ii)),Xe&&(zt["#text"]=!0),$t&&pn(zt,["html","head","body"]),zt.table&&(pn(zt,["tbody"]),delete qe.tbody),ke.TRUSTED_TYPES_POLICY){if(typeof ke.TRUSTED_TYPES_POLICY.createHTML!="function")throw Cd('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof ke.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Cd('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');W=ke.TRUSTED_TYPES_POLICY,se=W.createHTML("")}else W===void 0&&(W=TG(S,s)),W!==null&&typeof se=="string"&&(se=W.createHTML(""));oa&&oa(ke),Bn=ke}},Z=pn({},["mi","mo","mn","ms","mtext"]),V=pn({},["foreignobject","desc","title","annotation-xml"]),q=pn({},["title","style","font","a","script"]),J=pn({},c_);pn(J,u_),pn(J,pG);const le=pn({},h_);pn(le,gG);const ce=function(ke){let Dt=K(ke);(!Dt||!Dt.tagName)&&(Dt={namespaceURI:Nt,tagName:"template"});const It=Om(ke.tagName),yi=Om(Dt.tagName);return Qe[ke.namespaceURI]?ke.namespaceURI===lr?Dt.namespaceURI===Hn?It==="svg":Dt.namespaceURI===Cr?It==="svg"&&(yi==="annotation-xml"||Z[yi]):!!J[It]:ke.namespaceURI===Cr?Dt.namespaceURI===Hn?It==="math":Dt.namespaceURI===lr?It==="math"&&V[yi]:!!le[It]:ke.namespaceURI===Hn?Dt.namespaceURI===lr&&!V[yi]||Dt.namespaceURI===Cr&&!Z[yi]?!1:!le[It]&&(q[It]||!J[It]):!!(Gi==="application/xhtml+xml"&&Qe[ke.namespaceURI]):!1},Oe=function(ke){kd(e.removed,{element:ke});try{ke.parentNode.removeChild(ke)}catch{ke.remove()}},Ae=function(ke,Dt){try{kd(e.removed,{attribute:Dt.getAttributeNode(ke),from:Dt})}catch{kd(e.removed,{attribute:null,from:Dt})}if(Dt.removeAttribute(ke),ke==="is"&&!vt[ke])if(ni||Wi)try{Oe(Dt)}catch{}else try{Dt.setAttribute(ke,"")}catch{}},ye=function(ke){let Dt=null,It=null;if(_t)ke="<remove></remove>"+ke;else{const Zi=hG(ke,/^[\r\n\t ]+/);It=Zi&&Zi[0]}Gi==="application/xhtml+xml"&&Nt===Hn&&(ke='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ke+"</body></html>");const yi=W?W.createHTML(ke):ke;if(Nt===Hn)try{Dt=new E().parseFromString(yi,Gi)}catch{}if(!Dt||!Dt.documentElement){Dt=Y.createDocument(Nt,"template",null);try{Dt.documentElement.innerHTML=Qi?se:yi}catch{}}const gn=Dt.body||Dt.documentElement;return ke&&It&&gn.insertBefore(i.createTextNode(It),gn.childNodes[0]||null),Nt===Hn?ve.call(Dt,$t?"html":"body")[0]:$t?Dt.documentElement:gn},Ce=function(ke){return ne.call(ke.ownerDocument||ke,ke,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT,null)},ot=function(ke){return ke instanceof b&&(typeof ke.nodeName!="string"||typeof ke.textContent!="string"||typeof ke.removeChild!="function"||!(ke.attributes instanceof y)||typeof ke.removeAttribute!="function"||typeof ke.setAttribute!="function"||typeof ke.namespaceURI!="string"||typeof ke.insertBefore!="function"||typeof ke.hasChildNodes!="function")},gt=function(ke){return typeof r=="function"&&ke instanceof r},ht=function(ke,Dt,It){oe[ke]&&cm(oe[ke],yi=>{yi.call(e,Dt,It,Bn)})},di=function(ke){let Dt=null;if(ht("beforeSanitizeElements",ke,null),ot(ke))return Oe(ke),!0;const It=ii(ke.nodeName);if(ht("uponSanitizeElement",ke,{tagName:It,allowedTags:zt}),ke.hasChildNodes()&&!gt(ke.firstElementChild)&&Pa(/<[/\w]/g,ke.innerHTML)&&Pa(/<[/\w]/g,ke.textContent))return Oe(ke),!0;if(!zt[It]||qe[It]){if(!qe[It]&&ai(It)&&(Pt.tagNameCheck instanceof RegExp&&Pa(Pt.tagNameCheck,It)||Pt.tagNameCheck instanceof Function&&Pt.tagNameCheck(It)))return!1;if(Xe&&!Xi[It]){const yi=K(ke)||ke.parentNode,gn=H(ke)||ke.childNodes;if(gn&&yi){const Zi=gn.length;for(let In=Zi-1;In>=0;--In)yi.insertBefore(R(gn[In],!0),z(ke))}}return Oe(ke),!0}return ke instanceof f&&!ce(ke)||(It==="noscript"||It==="noembed"||It==="noframes")&&Pa(/<\/no(script|embed|frames)/i,ke.innerHTML)?(Oe(ke),!0):(ze&&ke.nodeType===3&&(Dt=ke.textContent,cm([Be,mt,Le],yi=>{Dt=Od(Dt,yi," ")}),ke.textContent!==Dt&&(kd(e.removed,{element:ke.cloneNode()}),ke.textContent=Dt)),ht("afterSanitizeElements",ke,null),!1)},Oi=function(ke,Dt,It){if(et&&(Dt==="id"||Dt==="name")&&(It in i||It in st))return!1;if(!(Gt&&!Ht[Dt]&&Pa(rt,Dt))&&!(lt&&Pa(tt,Dt))){if(!vt[Dt]||Ht[Dt]){if(!(ai(ke)&&(Pt.tagNameCheck instanceof RegExp&&Pa(Pt.tagNameCheck,ke)||Pt.tagNameCheck instanceof Function&&Pt.tagNameCheck(ke))&&(Pt.attributeNameCheck instanceof RegExp&&Pa(Pt.attributeNameCheck,Dt)||Pt.attributeNameCheck instanceof Function&&Pt.attributeNameCheck(Dt))||Dt==="is"&&Pt.allowCustomizedBuiltInElements&&(Pt.tagNameCheck instanceof RegExp&&Pa(Pt.tagNameCheck,It)||Pt.tagNameCheck instanceof Function&&Pt.tagNameCheck(It))))return!1}else if(!vr[Dt]&&!Pa(St,Od(It,Ve,""))&&!((Dt==="src"||Dt==="xlink:href"||Dt==="href")&&ke!=="script"&&dG(It,"data:")===0&&Gn[ke])&&!(Mi&&!Pa(We,Od(It,Ve,"")))&&It)return!1}return!0},ai=function(ke){return ke.indexOf("-")>0},_i=function(ke){ht("beforeSanitizeAttributes",ke,null);const{attributes:Dt}=ke;if(!Dt)return;const It={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:vt};let yi=Dt.length;for(;yi--;){const gn=Dt[yi],{name:Zi,namespaceURI:In,value:Cn}=gn,cr=ii(Zi);let Er=Zi==="value"?Cn:fG(Cn);if(It.attrName=cr,It.attrValue=Er,It.keepAttr=!0,It.forceKeepAttr=void 0,ht("uponSanitizeAttribute",ke,It),Er=It.attrValue,It.forceKeepAttr||(Ae(Zi,ke),!It.keepAttr))continue;if(!bt&&Pa(/\/>/i,Er)){Ae(Zi,ke);continue}ze&&cm([Be,mt,Le],la=>{Er=Od(Er,la," ")});const Ws=ii(ke.nodeName);if(Oi(Ws,cr,Er)){if(zi&&(cr==="id"||cr==="name")&&(Ae(Zi,ke),Er=zn+Er),W&&typeof S=="object"&&typeof S.getAttributeType=="function"&&!In)switch(S.getAttributeType(Ws,cr)){case"TrustedHTML":{Er=W.createHTML(Er);break}case"TrustedScriptURL":{Er=W.createScriptURL(Er);break}}try{In?ke.setAttributeNS(In,Zi,Er):ke.setAttribute(Zi,Er),L2(e.removed)}catch{}}}ht("afterSanitizeAttributes",ke,null)},ji=function ke(Dt){let It=null;const yi=Ce(Dt);for(ht("beforeSanitizeShadowDOM",Dt,null);It=yi.nextNode();)ht("uponSanitizeShadowNode",It,null),!di(It)&&(It.content instanceof l&&ke(It.content),_i(It));ht("afterSanitizeShadowDOM",Dt,null)};return e.sanitize=function(ke){let Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},It=null,yi=null,gn=null,Zi=null;if(Qi=!ke,Qi&&(ke="<!-->"),typeof ke!="string"&&!gt(ke))if(typeof ke.toString=="function"){if(ke=ke.toString(),typeof ke!="string")throw Cd("dirty is not a string, aborting")}else throw Cd("toString is not a function");if(!e.isSupported)return ke;if(dt||ge(Dt),e.removed=[],typeof ke=="string"&&(On=!1),On){if(ke.nodeName){const cr=ii(ke.nodeName);if(!zt[cr]||qe[cr])throw Cd("root node is forbidden and cannot be sanitized in-place")}}else if(ke instanceof r)It=ye("<!---->"),yi=It.ownerDocument.importNode(ke,!0),yi.nodeType===1&&yi.nodeName==="BODY"||yi.nodeName==="HTML"?It=yi:It.appendChild(yi);else{if(!ni&&!ze&&!$t&&ke.indexOf("<")===-1)return W&&ct?W.createHTML(ke):ke;if(It=ye(ke),!It)return ni?null:ct?se:""}It&&_t&&Oe(It.firstChild);const In=Ce(On?ke:It);for(;gn=In.nextNode();)di(gn)||(gn.content instanceof l&&ji(gn.content),_i(gn));if(On)return ke;if(ni){if(Wi)for(Zi=ue.call(It.ownerDocument);It.firstChild;)Zi.appendChild(It.firstChild);else Zi=It;return(vt.shadowroot||vt.shadowrootmode)&&(Zi=_e.call(n,Zi,!0)),Zi}let Cn=$t?It.outerHTML:It.innerHTML;return $t&&zt["!doctype"]&&It.ownerDocument&&It.ownerDocument.doctype&&It.ownerDocument.doctype.name&&Pa(zS,It.ownerDocument.doctype.name)&&(Cn="<!DOCTYPE "+It.ownerDocument.doctype.name+`>
`+Cn),ze&&cm([Be,mt,Le],cr=>{Cn=Od(Cn,cr," ")}),W&&ct?W.createHTML(Cn):Cn},e.setConfig=function(){let ke=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ge(ke),dt=!0},e.clearConfig=function(){Bn=null,dt=!1},e.isValidAttribute=function(ke,Dt,It){Bn||ge({});const yi=ii(ke),gn=ii(Dt);return Oi(yi,gn,It)},e.addHook=function(ke,Dt){typeof Dt=="function"&&(oe[ke]=oe[ke]||[],kd(oe[ke],Dt))},e.removeHook=function(ke){if(oe[ke])return L2(oe[ke])},e.removeHooks=function(ke){oe[ke]&&(oe[ke]=[])},e.removeAllHooks=function(){oe={}},e}var Iy=BS();const dm=t=>Iy.sanitize(t,{USE_PROFILES:{html:!0,svg:!0,svgFilters:!0}}),SG=t=>Iy.sanitize(t,{NAMESPACE:"http://www.w3.org/2000/svg",USE_PROFILES:{html:!0,svg:!0,svgFilters:!0}}),Xo=t=>Iy.sanitize(t,{ALLOWED_TAGS:[]}),VS=class FS extends Nr{constructor(){super(...arguments),this.type="toolbar",this.renderType=Yn.HTML}init(){const e=()=>this.updateOverflowMenu(!1);this.services.events.addEventListener(yt.Toolbar.SHOW_OVERFLOW_MENU,()=>{this.renderOverflowMenu(),document.body.addEventListener("click",e)}),this.services.events.addEventListener(yt.Toolbar.HIDE_OVERFLOW_MENU,()=>{document.body.removeEventListener("click",e)})}render(e=!0){const i=this.getComponentContainer().attr("role","toolbar").attr("aria-label",`chart-${this.services.domUtils.getChartID()} toolbar`);if(Ne(this.getOptions(),"data","loading"))i.html(""),this.overflowMenu=null;else{this.overflowMenu||(this.overflowMenu=i.append("div").attr("class","cds--overflow-menu-options cds--overflow-menu--flip cds--overflow-menu-options cds--overflow-menu--flip").attr("tabindex",-1).html("<ul role='menu'></ul>"));const{buttonList:n,overflowMenuItemList:s}=this.getControlConfigs();s&&n.push(this.getOverflowButtonConfig());const l=i.selectAll("div.toolbar-control").data(n,f=>f.id);l.exit().remove();const c=l.enter().append("div").attr("class","toolbar-control cds--overflow-menu cds--overflow-menu"),r=this;c.merge(l).classed("disabled",f=>f.shouldBeDisabled()).attr("aria-disabled",f=>f.shouldBeDisabled()).attr("aria-label",f=>f.title).html(f=>`
			<button
				class="cds--overflow-menu__trigger cds--overflow-menu__trigger"
				aria-haspopup="true" aria-expanded="false" id="${this.services.domUtils.generateElementIDString(`control-${Xo(f.id)}`)}" aria-label="${Xo(f.title)}">
				<svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" class="cds--overflow-menu__icon cds--overflow-menu__icon" viewBox="0 0 32 32" aria-hidden="true">
					${SG(f.iconSVG.content)}
				</svg>
			</button>`).each(function(f,m){Jt(this).select("svg").style("will-change","transform").style("width",f.iconSVG.width!==void 0?f.iconSVG.width:"20px").style("height",f.iconSVG.height!==void 0?f.iconSVG.height:"20px"),Jt(this).select("button").on("click",y=>{f.shouldBeDisabled()||r.triggerFunctionAndEvent(f,y,this)}).on("keydown",y=>{y.key&&y.key==="Enter"||y.key===" "?(y.preventDefault(),r.triggerFunctionAndEvent(f,y,this)):y.key&&y.key==="ArrowLeft"?r.focusOnPreviousEnabledToolbarItem(m):y.key&&y.key==="ArrowRight"&&r.focusOnNextEnabledToolbarItem(m)})}),this.overflowButton=this.getComponentContainer().select(`button.cds--overflow-menu__trigger#${this.services.domUtils.generateElementIDString("control-toolbar-overflow-menu")}`)}}renderOverflowMenu(){const{overflowMenuItemList:e}=this.getControlConfigs(),i=this.overflowMenu.select("ul").selectAll("li.cds--overflow-menu-options__option").data(e,s=>Ne(s,"id"));i.exit().remove();const n=i.enter().append("li").attr("id",s=>this.services.domUtils.generateElementIDString(`control-${s.id}`)).attr("class","cds--overflow-menu-options__option cds--overflow-menu-options__option").attr("role","menuitem").attr("tabindex",1);n.append("button").attr("class","cds--overflow-menu-options__btn cds--overflow-menu-options__btn"),n.merge(i).classed("cds--overflow-menu-options__option--disabled",s=>s.shouldBeDisabled()).classed("cds--overflow-menu-options__option--disabled",s=>s.shouldBeDisabled()).attr("aria-disabled",s=>s.shouldBeDisabled()).selectAll("button").text(s=>s.text)}isOverflowMenuOpen(){return this.overflowMenu.classed("is-open")}updateOverflowMenu(e){this.overflowMenu&&(this.overflowMenu.classed("is-open",e),this.overflowButton&&(this.overflowButton.attr("aria-expanded",e),Jt(this.overflowButton.node().parentNode).classed("cds--overflow-menu--open",e).classed("cds--overflow-menu--open",e)),e?this.services.events.dispatchEvent(yt.Toolbar.SHOW_OVERFLOW_MENU):this.services.events.dispatchEvent(yt.Toolbar.HIDE_OVERFLOW_MENU))}focusOnPreviousEnabledToolbarItem(e){const i=this.getToolbarButtonItems();let n=i.length;for(let s=e-1;s>=0;s--)if(!i[s].shouldBeDisabled()){n=s;break}if(n<i.length){const s=Jt(`button#${this.services.domUtils.generateElementIDString(`control-${i[n].id}`)}`).node();"focus"in s&&s.focus()}}focusOnNextEnabledToolbarItem(e){const i=this.getToolbarButtonItems();let n=-1;for(let s=e+1;s<i.length;s++)if(!i[s].shouldBeDisabled()){n=s;break}if(n>-1){const s=Jt(`button#${this.services.domUtils.generateElementIDString(`control-${i[n].id}`)}`).node();"focus"in s&&s.focus()}}focusOnPreviousEnabledMenuItem(e){const i=this.getOverflowMenuItems();let n=i.length;for(let s=e-1;s>=0;s--)if(!i[s].shouldBeDisabled()){n=s;break}if(n<i.length){const s=Jt(`#${this.services.domUtils.generateElementIDString(`control-${i[n].id}`)} button`).node();"focus"in s&&s.focus()}}focusOnNextEnabledMenuItem(e){const i=this.getOverflowMenuItems();let n=-1;for(let s=e+1;s<i.length;s++)if(!i[s].shouldBeDisabled()){n=s;break}if(n>-1){const s=Jt(`#${this.services.domUtils.generateElementIDString(`control-${i[n].id}`)} button`).node();"focus"in s&&s.focus()}}toggleOverflowMenu(e){if(this.isOverflowMenuOpen())this.updateOverflowMenu(!1);else{this.updateOverflowMenu(!0);const i=this;this.getOverflowMenuItems().forEach((n,s)=>{const l=Jt(`#${this.services.domUtils.generateElementIDString(`control-${n.id}`)}`);l!==null&&(l.on("click",()=>{i.triggerFunctionAndEvent(n,e,l.node()),i.updateOverflowMenu(!1)}),l.on("keydown",c=>{c&&c.key==="Enter"?i.triggerFunctionAndEvent(n,e,l.node()):c&&c.key==="ArrowUp"?i.focusOnPreviousEnabledMenuItem(s):c&&c.key==="ArrowDown"?i.focusOnNextEnabledMenuItem(s):c&&c.key==="Escape"&&i.updateOverflowMenu(!1),c.preventDefault()}))}),i.focusOnNextEnabledMenuItem(-1)}e&&e.stopImmediatePropagation()}triggerFunctionAndEvent(e,i,n){typeof e.shouldBeDisabled=="function"&&e.shouldBeDisabled()||(typeof e.clickFunction=="function"&&e.clickFunction(i),this.services.events.dispatchEvent(yt.Toolbar.BUTTON_CLICK,{control:e,event:i,element:n}))}getControlConfigs(){const e=Ne(this.getOptions(),"toolbar","numberOfIcons")-1,i=Ne(this.getOptions(),"toolbar","controls"),n=[],s=[],l=[];return i.forEach(c=>{let r=null;c.type===Pr.CUSTOM?(Ne(c,"id")===null&&(c.id=`toolbar-button-${FS.buttonID++}`),Ne(c,"shouldBeDisabled")===null&&(c.shouldBeDisabled=()=>!1),r=c):r=this.getControlConfigByType(c.type),r&&(r.text=c.text?c.text:c.type,r.id.indexOf("toolbar-export")!==-1?n.push(r):s.length<e?Ne(r,"iconSVG","content")===null?l.push(r):s.push(r):l.push(r))}),l.push(...n),l.length?{buttonList:s,overflowMenuItemList:l}:{buttonList:s}}getToolbarButtonItems(){const{buttonList:e,overflowMenuItemList:i}=this.getControlConfigs();return i&&e.push(this.getOverflowButtonConfig()),e||[]}getOverflowMenuItems(){const{overflowMenuItemList:e}=this.getControlConfigs();return e||[]}getOverflowButtonConfig(){return{id:"toolbar-overflow-menu",title:"More options",shouldBeDisabled:()=>!1,iconSVG:{content:`<circle cx="16" cy="8" r="2"></circle>
				<circle cx="16" cy="16" r="2"></circle>
				<circle cx="16" cy="24" r="2"></circle>`},clickFunction:e=>this.toggleOverflowMenu(e)}}getControlConfigByType(e){const i=this.services.zoom&&this.services.zoom.isZoomBarEnabled()&&!this.services.zoom.isEmptyState(),n=this.model.getDisplayData();let s;switch(e){case Pr.ZOOM_IN:i&&(s={id:"toolbar-zoomIn",title:"Zoom in",shouldBeDisabled:()=>this.services.zoom.isMinZoomDomain(),iconSVG:{content:this.getControlIconByType(e)},clickFunction:()=>this.services.zoom.zoomIn()});break;case Pr.ZOOM_OUT:i&&(s={id:"toolbar-zoomOut",title:"Zoom out",shouldBeDisabled:()=>this.services.zoom.isMaxZoomDomain(),iconSVG:{content:this.getControlIconByType(e)},clickFunction:()=>this.services.zoom.zoomOut()});break;case Pr.RESET_ZOOM:i&&(s={id:"toolbar-resetZoom",title:"Reset zoom",shouldBeDisabled:()=>this.services.zoom.isMaxZoomDomain(),iconSVG:{content:this.getControlIconByType(e)},clickFunction:()=>this.services.zoom.resetZoomDomain()});break;case Pr.MAKE_FULLSCREEN:s={id:"toolbar-makefullscreen",iconSVG:{content:this.getControlIconByType(e),width:"15px",height:"15px"},title:"Make fullscreen",shouldBeDisabled:()=>!1,clickFunction:()=>{this.services.domUtils.toggleFullscreen()}};break;case Pr.SHOW_AS_DATATABLE:s={id:"toolbar-showasdatatable",iconSVG:{content:this.getControlIconByType(e)},title:"Show as table",shouldBeDisabled:()=>n.length===0,clickFunction:()=>this.services.events.dispatchEvent(yt.Modal.SHOW)};break;case Pr.EXPORT_CSV:s={id:"toolbar-export-CSV",title:"Export as CSV",shouldBeDisabled:()=>!1,iconSVG:{content:this.getControlIconByType(e)},clickFunction:()=>this.model.exportToCSV()};break;case Pr.EXPORT_PNG:s={id:"toolbar-export-PNG",title:"Export as PNG",shouldBeDisabled:()=>!1,iconSVG:{content:this.getControlIconByType(e)},clickFunction:()=>this.services.domUtils.exportToPNG()};break;case Pr.EXPORT_JPG:s={id:"toolbar-export-JPG",title:"Export as JPG",shouldBeDisabled:()=>!1,iconSVG:{content:this.getControlIconByType(e)},clickFunction:()=>this.services.domUtils.exportToJPG()};break;default:throw Error("Not supported toolbar control type: "+e)}return s}getControlIconByType(e){switch(e){case Pr.ZOOM_IN:return`<polygon points="19 13 15 13 15 9 13 9 13 13 9 13 9 15 13 15 13 19 15 19 15 15 19 15 19 13"/>
						<path d="M22.45,21A10.87,10.87,0,0,0,25,14,11,11,0,1,0,14,25a10.87,10.87,0,0,0,7-2.55L28.59,30,30,28.59ZM14,23a9,9,0,1,1,9-9A9,9,0,0,1,14,23Z"/>`;case Pr.ZOOM_OUT:return`<rect x="9" y="13" width="10" height="2"/>
						<path d="M22.45,21A10.87,10.87,0,0,0,25,14,11,11,0,1,0,14,25a10.87,10.87,0,0,0,7-2.55L28.59,30,30,28.59ZM14,23a9,9,0,1,1,9-9A9,9,0,0,1,14,23Z"/>`;case Pr.RESET_ZOOM:return'<path d="M22.4478,21A10.855,10.855,0,0,0,25,14,10.99,10.99,0,0,0,6,6.4658V2H4v8h8V8H7.332a8.9768,8.9768,0,1,1-2.1,8H3.1912A11.0118,11.0118,0,0,0,14,25a10.855,10.855,0,0,0,7-2.5522L28.5859,30,30,28.5859Z"/>';case Pr.MAKE_FULLSCREEN:return'<polygon points="21 2 21 4 26.59 4 17 13.58 18.41 15 28 5.41 28 11 30 11 30 2 21 2"/><polygon points="15 18.42 13.59 17 4 26.59 4 21 2 21 2 30 11 30 11 28 5.41 28 15 18.42"/>';case Pr.SHOW_AS_DATATABLE:return'<rect x="4" y="6" width="18" height="2"/><rect x="4" y="12" width="18" height="2"/><rect x="4" y="18" width="18" height="2"/><rect x="4" y="24" width="18" height="2"/><rect x="26" y="6" width="2" height="2"/><rect x="26" y="12" width="2" height="2"/><rect x="26" y="18" width="2" height="2"/><rect x="26" y="24" width="2" height="2"/>';case Pr.EXPORT_CSV:return'<path d="M22.4478,21A10.855,10.855,0,0,0,25,14,10.99,10.99,0,0,0,6,6.4658V2H4v8h8V8H7.332a8.9768,8.9768,0,1,1-2.1,8H3.1912A11.0118,11.0118,0,0,0,14,25a10.855,10.855,0,0,0,7-2.5522L28.5859,30,30,28.5859Z"/>';case Pr.EXPORT_JPG:return'<path d="M22.4478,21A10.855,10.855,0,0,0,25,14,10.99,10.99,0,0,0,6,6.4658V2H4v8h8V8H7.332a8.9768,8.9768,0,1,1-2.1,8H3.1912A11.0118,11.0118,0,0,0,14,25a10.855,10.855,0,0,0,7-2.5522L28.5859,30,30,28.5859Z"/>';case Pr.EXPORT_PNG:return'<path d="M22.4478,21A10.855,10.855,0,0,0,25,14,10.99,10.99,0,0,0,6,6.4658V2H4v8h8V8H7.332a8.9768,8.9768,0,1,1-2.1,8H3.1912A11.0118,11.0118,0,0,0,14,25a10.855,10.855,0,0,0,7-2.5522L28.5859,30,30,28.5859Z"/>';default:throw Error("Not supported toolbar control type: "+e)}}};VS.buttonID=0;let US=VS;const jS=class GS extends Nr{constructor(e,i,n,s){super(e,i,s),this.type="layout",this.configs=s,this.children=n,this._instanceID=GS.instanceID++,this.init()}init(){this.children.forEach(e=>{e.components.forEach(i=>{i.init()})})}getPreferedAndFixedSizeSum(){const e=this.parent;let i=0;return e.selectAll(`div.layout-child-${this._instanceID}`).filter(n=>{const s=Ne(n,"growth");return s===yr.PREFERRED||s===yr.FIXED}).each(function(n){i+=n.size}),i}getNumOfStretchChildren(){return this.parent.selectAll(`div.layout-child-${this._instanceID}`).filter(e=>Ne(e,"growth")===yr.STRETCH).size()}render(e=!0){const i=this.parent,{width:n,height:s}=hi.getHTMLElementSize(i.node()),l=this.configs.direction===os.ROW||this.configs.direction===os.ROW_REVERSE,c=Ne(this.model.getOptions(),"style","prefix"),r=i.classed(`${va}--${c}--layout-row`,this.configs.direction===os.ROW).classed(`${va}--${c}--layout-row-reverse`,this.configs.direction===os.ROW_REVERSE).classed(`${va}--${c}--layout-column`,this.configs.direction===os.COLUMN).classed(`${va}--${c}--layout-column-reverse`,this.configs.direction===os.COLUMN_REVERSE).classed(`${va}--${c}--layout-alignitems-center`,this.configs.alignItems===gp.CENTER).selectAll(`div.layout-child-${this._instanceID}`).data(this.children,m=>m.id);r.enter().append("div").merge(i.selectAll(`div.layout-child-${this._instanceID}`)).attr("class",m=>`layout-child layout-child-${this._instanceID} ${m.id}`).each(function(m){m.components.forEach(y=>{const b=Jt(this),E=Ne(m,"renderType")===Yn.SVG;y.setParent(E?hi.appendOrSelect(b,"svg.layout-svg-wrapper").attr("width","100%").attr("height","100%"):b);const S=Ne(m,"growth");(S===yr.PREFERRED||S===yr.FIXED)&&y.render(e)})}),i.selectAll(`div.layout-child-${this._instanceID}`).style("height",null).style("width",null).each(function(m){const y=Ne(m,"growth"),b=Ne(m,"renderType")===Yn.SVG?hi.getSVGElementSize(Jt(this).select("svg.layout-svg-wrapper"),{useBBox:!0}):hi.getHTMLElementSize(this);if(y===yr.PREFERRED){const E=l?b.width:b.height,S=l?n:s;m.size=E/S*100}}),r.exit().remove(),this.children.filter(m=>Ne(m,"growth")===yr.STRETCH).forEach(m=>{m.size=(100-+this.getPreferedAndFixedSizeSum())/+this.getNumOfStretchChildren()});const f=i.selectAll(`div.layout-child-${this._instanceID}`).data(this.children,m=>m.id);l?f.style("width",m=>`${m.size/100*n}px`).style("height","100%"):f.style("height",m=>`${m.size/100*s}px`).style("width","100%"),f.each(function(m){m.components.forEach(y=>{Ne(m,"growth")===yr.STRETCH&&y.render(e)})})}setModel(e){super.setModel(e),this.children.forEach(i=>{i.components.forEach(n=>n.setModel(e))})}setServices(e){super.setServices(e),this.children.forEach(i=>{i.components.forEach(n=>n.setServices(e))})}destroy(){this.children.forEach(e=>{e.components.forEach(i=>i.destroy())})}};jS.instanceID=Math.floor(Math.random()*99999999999);let gh=jS;class cp extends Nr{constructor(){super(...arguments),this.type="spacer"}render(e=!1){this.getComponentContainer().style("width",`${this.configs.size||p2.default.size}px`).style("height",`${this.configs.size||p2.default.size}px`).attr("opacity",0)}}var IG={prefix:"bx",selectorTabbable:`
    a[href], area[href], input:not([disabled]):not([tabindex='-1']),
    button:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),
    textarea:not([disabled]):not([tabindex='-1']),
    iframe, object, embed, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]
  `,selectorFocusable:`
    a[href], area[href], input:not([disabled]),
    button:not([disabled]),select:not([disabled]),
    textarea:not([disabled]),
    iframe, object, embed, *[tabindex], *[contenteditable=true]
  `},f_=IG;function F2(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kG(t,e,i){return e&&F2(t.prototype,e),i&&F2(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function OG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CG(t){return LG(t)||RG(t)||DG(t)||MG()}function MG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DG(t,e){if(t){if(typeof t=="string")return o0(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return o0(t,e)}}function RG(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function LG(t){if(Array.isArray(t))return o0(t)}function o0(t,e){(e==null||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function HS(t){return t.reduce(function(e,i){return Array.isArray(i)?e.push.apply(e,CG(HS(i))):e.push(i),e},[])}function PG(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return HS(e).reduce(function(n,s){return s(n)},function(){function n(){OG(this,n)}return kG(n)}())}function l0(t){"@babel/helpers - typeof";return l0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l0(t)}function NG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U2(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zG(t,e,i){return e&&U2(t.prototype,e),i&&U2(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function BG(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c0(t,e)}function c0(t,e){return c0=Object.setPrototypeOf||function(i,n){return i.__proto__=n,i},c0(t,e)}function VG(t){var e=UG();return function(){var i=up(t),n;if(e){var s=up(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return FG(this,n)}}function FG(t,e){if(e&&(l0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KS(t)}function KS(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function UG(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function up(t){return up=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},up(t)}function jG(t){var e=function(i){BG(s,i);var n=VG(s);function s(l){var c,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(NG(this,s),c=n.call(this,l,r),c.children=[],!l||l.nodeType!==Node.ELEMENT_NODE)throw new TypeError("DOM element should be given to initialize this widget.");return c.element=l,c.options=Object.assign(Object.create(c.constructor.options),r),c.constructor.components.set(c.element,KS(c)),c}return zG(s,[{key:"release",value:function(){for(var l=this.children.pop();l;l=this.children.pop())l.release();return this.constructor.components.delete(this.element),null}}],[{key:"create",value:function(l,c){return this.components.get(l)||new this(l,c)}}]),s}(t);return e}function u0(t){"@babel/helpers - typeof";return u0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u0(t)}function GG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j2(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function HG(t,e,i){return e&&j2(t.prototype,e),i&&j2(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cm(){return typeof Reflect<"u"&&Reflect.get?Cm=Reflect.get:Cm=function(t,e,i){var n=KG(t,e);if(n){var s=Object.getOwnPropertyDescriptor(n,e);return s.get?s.get.call(arguments.length<3?t:i):s.value}},Cm.apply(this,arguments)}function KG(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ch(t),t!==null););return t}function qG(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h0(t,e)}function h0(t,e){return h0=Object.setPrototypeOf||function(i,n){return i.__proto__=n,i},h0(t,e)}function ZG(t){var e=JG();return function(){var i=Ch(t),n;if(e){var s=Ch(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return WG(this,n)}}function WG(t,e){if(e&&(u0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YG(t)}function YG(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function JG(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ch(t){return Ch=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ch(t)}function XG(t){var e=function(i){qG(s,i);var n=ZG(s);function s(){var l;GG(this,s);for(var c=arguments.length,r=new Array(c),f=0;f<c;f++)r[f]=arguments[f];return l=n.call.apply(n,[this].concat(r)),l.handles=new Set,l}return HG(s,[{key:"manage",value:function(l){return this.handles.add(l),l}},{key:"unmanage",value:function(l){return this.handles.delete(l),l}},{key:"release",value:function(){var l=this;return this.handles.forEach(function(c){c.release(),l.handles.delete(c)}),Cm(Ch(s.prototype),"release",this).call(this)}}]),s}(t);return e}function Nd(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return t.addEventListener.apply(t,i),{release:function(){return t.removeEventListener.apply(t,i),null}}}function d0(t){"@babel/helpers - typeof";return d0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d0(t)}function QG(t){return iH(t)||tH(t)||eH(t)||$G()}function $G(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eH(t,e){if(t){if(typeof t=="string")return f0(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f0(t,e)}}function tH(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function iH(t){if(Array.isArray(t))return f0(t)}function f0(t,e){(e==null||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function nH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G2(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rH(t,e,i){return e&&G2(t.prototype,e),i&&G2(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function sH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m0(t,e)}function m0(t,e){return m0=Object.setPrototypeOf||function(i,n){return i.__proto__=n,i},m0(t,e)}function aH(t){var e=cH();return function(){var i=hp(t),n;if(e){var s=hp(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return oH(this,n)}}function oH(t,e){if(e&&(d0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lH(t)}function lH(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hp(t){return hp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hp(t)}function uH(t){var e=function(i){sH(s,i);var n=aH(s);function s(){return nH(this,s),n.apply(this,arguments)}return rH(s,[{key:"_changeState",value:function(){throw new Error("_changeState() should be overridden to perform actual change in state.")}},{key:"changeState",value:function(){for(var l=this,c=arguments.length,r=new Array(c),f=0;f<c;f++)r[f]=arguments[f];var m=typeof r[0]=="string"?r.shift():void 0,y=Object(r[0])===r[0]&&typeof r[0]!="function"?r.shift():void 0,b=typeof r[0]=="function"?r.shift():void 0;if(typeof this.shouldStateBeChanged=="function"&&!this.shouldStateBeChanged(m,y)){b&&b(null,!0);return}var E={group:y&&y.group,state:m},S=[E.group,m].filter(Boolean).join("-").split("-").map(function(W){return W[0].toUpperCase()+W.substr(1)}).join(""),D=new CustomEvent(this.options["eventBefore".concat(S)],{bubbles:!0,cancelable:!0,detail:y}),R=y&&y.delegatorNode||this.element,z=!R.dispatchEvent(D);if(z){if(b){var H=new Error("Changing state (".concat(JSON.stringify(E),") has been canceled."));H.canceled=!0,b(H)}}else{var K=[m,y].filter(Boolean);this._changeState.apply(this,QG(K).concat([function(){R.dispatchEvent(new CustomEvent(l.options["eventAfter".concat(S)],{bubbles:!0,cancelable:!0,detail:y})),b&&b()}]))}}}]),s}(t);return e}function p0(t,e){var i=t.target,n=t.currentTarget;if(typeof i.matches=="function"){if(i.matches(e))return i;if(i.matches("".concat(e," *"))){var s=i.closest(e);if((n.nodeType===Node.DOCUMENT_NODE?n.documentElement:n).contains(s))return s}}}function H2(t){if(!t||typeof t=="function")return{launchingElement:null,launchingEvent:null};var e=t.delegateTarget||t.currentTarget||t,i=t.currentTarget&&t;if(e&&!e.nodeType)throw new TypeError("DOM Node should be given for launching element.");if(i&&!i.type)throw new TypeError("DOM event should be given for launching event.");return{launchingElement:e,launchingEvent:i}}function g0(t){"@babel/helpers - typeof";return g0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g0(t)}function hH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K2(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function dH(t,e,i){return e&&K2(t.prototype,e),i&&K2(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function fH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_0(t,e)}function _0(t,e){return _0=Object.setPrototypeOf||function(i,n){return i.__proto__=n,i},_0(t,e)}function mH(t){var e=_H();return function(){var i=dp(t),n;if(e){var s=dp(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return pH(this,n)}}function pH(t,e){if(e&&(g0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gH(t)}function gH(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _H(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dp(t){return dp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},dp(t)}function yH(t){var e=function(i){fH(s,i);var n=mH(s);function s(){return hH(this,s),n.apply(this,arguments)}return dH(s,[{key:"show",value:function(l,c){(!l||typeof l=="function")&&(c=l),this.changeState("shown",H2(l),c)}},{key:"hide",value:function(l,c){(!l||typeof l=="function")&&(c=l),this.changeState("hidden",H2(l),c)}}]),s}(t);return e}var vH=[uH,yH];const bH=vH;function y0(t){"@babel/helpers - typeof";return y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y0(t)}function xH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function q2(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wH(t,e,i){return e&&q2(t.prototype,e),i&&q2(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function AH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v0(t,e)}function v0(t,e){return v0=Object.setPrototypeOf||function(i,n){return i.__proto__=n,i},v0(t,e)}function EH(t){var e=IH();return function(){var i=fp(t),n;if(e){var s=fp(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return TH(this,n)}}function TH(t,e){if(e&&(y0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SH(t)}function SH(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function IH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fp(t){return fp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fp(t)}function kH(t){var e=function(i){AH(s,i);var n=EH(s);function s(){return xH(this,s),n.apply(this,arguments)}return wH(s,null,[{key:"init",value:function(){var l=this,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=Object.assign(Object.create(this.options),r);if(!c||c.nodeType!==Node.ELEMENT_NODE&&c.nodeType!==Node.DOCUMENT_NODE)throw new TypeError("DOM document or DOM element should be given to search for and initialize this widget.");if(c.nodeType===Node.ELEMENT_NODE&&c.matches(f.selectorInit))this.create(c,r);else{var m=f.initEventNames.map(function(y){return Nd(c,y,function(b){var E=p0(b,"[".concat(f.attribInitTarget,"]"));if(E){b.delegateTarget=E;var S=E.ownerDocument.querySelectorAll(E.getAttribute(f.attribInitTarget));if(S.length>1)throw new Error("Target widget must be unique.");if(S.length===1){E.tagName==="A"&&b.preventDefault();var D=l.create(S[0],r);typeof D.createdByLauncher=="function"&&D.createdByLauncher(b)}}})});return{release:function(){for(var y=m.pop();y;y=m.pop())y.release()}}}return""}}]),s.forLazyInit=!0,s}(t);return e}function b0(t){"@babel/helpers - typeof";return b0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b0(t)}function OH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z2(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function CH(t,e,i){return e&&Z2(t.prototype,e),i&&Z2(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function MH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x0(t,e)}function x0(t,e){return x0=Object.setPrototypeOf||function(i,n){return i.__proto__=n,i},x0(t,e)}function DH(t){var e=PH();return function(){var i=mp(t),n;if(e){var s=mp(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return RH(this,n)}}function RH(t,e){if(e&&(b0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LH(t)}function LH(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mp(t){return mp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mp(t)}var NH=function(t){MH(i,t);var e=DH(i);function i(n,s){var l;return OH(this,i),l=e.call(this,n,s),l._handleFocusinListener=void 0,l._handleKeydownListener=void 0,l._handleFocusin=function(c){var r=l.element.querySelector(l.options.selectorModalContainer)||l.element;l.element.classList.contains(l.options.classVisible)&&!r.contains(c.target)&&l.options.selectorsFloatingMenus.every(function(f){return!p0(c,f)})&&l.element.querySelector(f_.selectorTabbable).focus()},l._hookCloseActions(),l}return CH(i,[{key:"createdByLauncher",value:function(n){this.show(n)}},{key:"shouldStateBeChanged",value:function(n){return n==="shown"?!this.element.classList.contains(this.options.classVisible):this.element.classList.contains(this.options.classVisible)}},{key:"_changeState",value:function(n,s,l){var c=this,r,f=function(){if(r&&(r=c.unmanage(r).release()),n==="shown"&&c.element.offsetWidth>0&&c.element.offsetHeight>0){c.previouslyFocusedNode=c.element.ownerDocument.activeElement;var b=c.element.querySelector(c.options.selectorPrimaryFocus)||c.element.querySelector(f_.selectorTabbable);b.focus()}l()};if(this._handleFocusinListener&&(this._handleFocusinListener=this.unmanage(this._handleFocusinListener).release()),n==="shown"){var m="onfocusin"in this.element.ownerDocument.defaultView,y=m?"focusin":"focus";this._handleFocusinListener=this.manage(Nd(this.element.ownerDocument,y,this._handleFocusin,!m))}n==="hidden"?(this.element.classList.toggle(this.options.classVisible,!1),this.element.ownerDocument.body.classList.toggle(this.options.classBody,!1),(this.options.selectorFocusOnClose||this.previouslyFocusedNode)&&(this.element.ownerDocument.querySelector(this.options.selectorFocusOnClose)||this.previouslyFocusedNode).focus()):n==="shown"&&(this.element.classList.toggle(this.options.classVisible,!0),this.element.ownerDocument.body.classList.toggle(this.options.classBody,!0)),r=this.manage(Nd(this.element,"transitionend",f))}},{key:"_hookCloseActions",value:function(){var n=this;this.manage(Nd(this.element,"click",function(s){var l=p0(s,n.options.selectorModalClose);l&&(s.delegateTarget=l),(l||s.target===n.element)&&n.hide(s)})),this._handleKeydownListener&&(this._handleKeydownListener=this.unmanage(this._handleKeydownListener).release()),this._handleKeydownListener=this.manage(Nd(this.element.ownerDocument.body,"keydown",function(s){s.which===27&&n.shouldStateBeChanged("hidden")&&(s.stopPropagation(),n.hide(s))}))}}],[{key:"options",get:function(){var n=f_.prefix;return{selectorInit:"[data-modal]",selectorModalClose:"[data-modal-close]",selectorPrimaryFocus:"[data-modal-primary-focus]",selectorsFloatingMenus:[".".concat(n,"--overflow-menu-options"),".".concat(n,"--tooltip"),".flatpickr-calendar"],selectorModalContainer:".".concat(n,"--modal-container"),classVisible:"is-visible",classBody:"".concat(n,"--body--with-modal-open"),attribInitTarget:"data-modal-target",initEventNames:["click"],eventBeforeShown:"modal-beingshown",eventAfterShown:"modal-shown",eventBeforeHidden:"modal-beinghidden",eventAfterHidden:"modal-hidden"}}}]),i.components=new WeakMap,i}(PG(jG,kH,bH,XG));const zH=NH;class qS extends Nr{constructor(e,i,n){super(e,i,n),this.type="modal",this.isEventListenerAdded=!1,this.handleShowModal=()=>{this.modal.attr("data-modal",!0).attr("class","cds--modal").attr("role","dialog").attr("aria-modal",!0).attr("aria-labelledby","modal-title").attr("aria-describedby","modal-description").attr("tabindex",-1),this.modal.html(this.getModalHTML()),this.modal.select("div.cds--modal-footer button.cds--btn").on("click",()=>this.model.exportToCSV()),zH.create(this.modal.node()).show(),document.addEventListener("modal-hidden",this.handleHideModal)},this.handleHideModal=()=>{this.modal.attr("role",null).attr("aria-modal",null).attr("aria-labelledby",null).attr("aria-describedby",null).attr("tabindex",null),document.removeEventListener("modal-hidden",this.handleHideModal)},this.init()}addEventListeners(){this.services.events.addEventListener(yt.Modal.SHOW,this.handleShowModal)}removeEventListeners(){this.services.events.removeEventListener(yt.Modal.SHOW,this.handleShowModal)}getModalHTML(){const e=this.model.getOptions(),i=Ne(e,"style","prefix"),n=this.model.getTabularDataArray();return`
		<div class="cds--modal-container cds--modal-container">
			<div class="cds--modal-header cds--modal-header">
				<p class="cds--modal-header__label cds--type-delta cds--modal-header__label cds--type-delta" id="modal-title">Tabular representation</p>

				<p class="cds--modal-header__heading cds--type-beta cds--modal-header__heading cds--type-beta" id="modal-description">${Xo(e.title)}</p>

				<button class="cds--modal-close cds--modal-close" type="button" data-modal-close aria-label="close modal"  data-modal-primary-focus>
					<svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-label="Close" width="20" height="20" viewBox="0 0 32 32" role="img" class="cds--modal-close__icon cds--modal-close__icon">
						<path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"></path>
					</svg>
				</button>
			</div>

			<div class="cds--modal-content cds--modal-content">
				<table class="cds--data-table cds--data-table--no-border cds--data-table cds--data-table--no-border">
					<thead>
						<tr>
							${py(n,0).map(s=>`<th scope="col">
								<div class="cds--table-header-label cds--table-header-label">${Xo(s)}</div>
							</th>`).join("")}
						</tr>
					</thead>

					<tbody>${n.slice(1).map(s=>`
							<tr>
								${s.map(l=>`<td>${Xo(l)}</td>`).join("")}
							</tr>`).join("")}
					</tbody>
				</table>
			</div>

			<div class="cds--modal-footer cds--modal-footer">
			  <div class="${va}--${i}-modal-footer-spacer"></div>
			  <button class="cds--btn cds--btn--primary cds--btn cds--btn--primary" type="button" data-modal-primary-focus>Download as CSV</button>
			</div>
		</div>`}render(e=!1){const i=this.model.getOptions();if(!this.isEventListenerAdded){const n=Jt(this.services.domUtils.getHolder()),s=Ne(i,"style","prefix");this.modal=hi.appendOrSelect(n,`div.${va}--${s}--modal`),this.addEventListeners(),this.isEventListenerAdded=!0}}destroy(){this.removeEventListeners(),this.isEventListenerAdded=!1}}class ZS extends Nr{constructor(){super(...arguments),this.type="title",this.renderType=Yn.HTML}render(e=!1){const i=this.getComponentContainer(),n=Ne(this.getOptions(),"title"),s=i.selectAll("p.title").data([n]);if(s.enter().append("p").classed("title",!0).attr("role","heading").attr("aria-level",2).merge(s).html(l=>Xo(l)),s.node()&&s.node().offsetWidth<s.node().scrollWidth){const l=this;s.on("mouseover",function(c){l.services.events.dispatchEvent(yt.Tooltip.SHOW,{event:c,hoveredElement:s,content:s.text()})}).on("mousemove",function(c){l.services.events.dispatchEvent(yt.Tooltip.MOVE,{event:c})}).on("mouseout",function(){l.services.events.dispatchEvent(yt.Tooltip.HIDE)})}s.exit().remove()}truncateTitle(e,i){if(i<=0)return;const n=e.text();if(e.node().getComputedTextLength()>i){e.append("tspan").text("...");const s=hi.appendOrSelect(e,"tspan").node().getComputedTextLength(),l=e.text(),c=this.getSubstringIndex(e.node(),0,l.length-1,i-s);e.html(l.substring(0,c-1)).append("tspan").text("...");const r=this;e.on("mouseover",function(f){r.services.events.dispatchEvent(yt.Tooltip.SHOW,{event:f,hoveredElement:e,content:n})}).on("mousemove",function(f){r.services.events.dispatchEvent(yt.Tooltip.MOVE,{event:f})}).on("mouseout",function(){r.services.events.dispatchEvent(yt.Tooltip.HIDE)})}}getMaxTitleWidth(){return hi.getSVGElementSize(this.parent.node(),{useAttrs:!0}).width}getSubstringIndex(e,i,n,s){const l=Math.floor((n+i)/2);return e.getSubStringLength(0,l)>s?this.getSubstringIndex(e,i,l,s):e.getSubStringLength(0,l)<s?e.getSubStringLength(0,l+1)>s?l:this.getSubstringIndex(e,l,n,s):l}}class WS extends Nr{constructor(){super(...arguments),this.type="legend",this.renderType=Yn.HTML}render(e=!1){const i=this.getOptions(),n=Ne(i,"legend"),s=Ne(n,"alignment"),l=Ne(i,"legend","orientation");let c=this.model.getDataGroups();const{DISABLED:r}=ks.items.status,f=c.some(K=>K.status===r),m=Ne(n,"order"),y=this.getComponentContainer().classed("center-aligned",s===Oo.CENTER).classed("right-aligned",s===Oo.RIGHT).classed(l,!0).classed("has-deactivated-items",f).attr("role",ts.GROUP).attr("aria-label","Data groups").attr("data-name","legend-items");m&&(c=this.sortDataGroups(c,m));const b=y.selectAll("div.legend-item").data(c,K=>K.name),E=b.enter().append("div").attr("class","legend-item");E.merge(y.selectAll("div.legend-item")).classed("active",function(K){return K.status===ks.items.status.ACTIVE});const S=Ne(this.getOptions(),"legend","clickable");y.classed("clickable",S&&c.length>1);const D=ks.checkbox.radius,R=E.append("div").classed("checkbox",!0),z=R.merge(b.select("div.checkbox")).attr("role",ts.CHECKBOX).attr("tabindex",S?0:-1).attr("aria-labelledby",(K,W)=>this.services.domUtils.generateElementIDString(`legend-datagroup-${W}-title`)).attr("aria-checked",({status:K})=>K===ks.items.status.ACTIVE).attr("width",D*2).attr("height",D*2).attr("class",K=>this.model.getColorClassName({classNameTypes:[Cs.BACKGROUND],dataGroupName:K.name,originalClassName:"checkbox"})).style("background",K=>K.status===ks.items.status.ACTIVE?this.model.getFillColor(K.name)||this.model.getStrokeColor(K.name):null).classed("active",function(K){return K.status===ks.items.status.ACTIVE});R.append("svg").attr("focusable",!1).attr("preserveAspectRatio","xMidYMid meet").attr("xmlns","http://www.w3.org/2000/svg").attr("width","11").attr("height","11").attr("viewBox","0 0 31 28").attr("aria-hidden",!0).style("will-change","transform").append("path").attr("d","M13 21.2l-7.1-7.1-1.4 1.4 7.1 7.1L13 24 27.1 9.9l-1.4-1.5z"),E.append("p").merge(b.select("p"));const H=Ne(i,"legend","additionalItems");if(H&&c.length){const K=this,W=y.selectAll("div.additional-item").data(H);W.exit().remove();const se=W.enter().append("div").merge(W).classed("legend-item",!0).classed("additional",!0).attr("aria-labelledby",(ue,ve)=>this.services.domUtils.generateElementIDString(`legend-datagroup-${z.size()+ve}-title`));se.selectAll("*").remove();let Y,ne=1;se.append("svg").classed("icon",!0).each(function(ue){const ve=Jt(this);!Y||Y!=ue.type?(Y=ue.type,ne=1):ne++,K.addAdditionalItem(ve,ue,ne)}),se.append("p").merge(se.select("p")),this.truncateLegendText()}b.exit().on("mouseover",null).on("click",null).on("mouseout",null).remove(),S&&E.size()>1&&this.addEventListeners()}sortDataGroups(e,i){if(e.sort((n,s)=>i.indexOf(n.name)-i.indexOf(s.name)),i.length<e.length){const n=e.length-i.length;return e.slice(n).concat(e.slice(0,n))}return e}addAdditionalItem(e,i,n){const{width:s,height:l}=ks.area;if(i.type===ys.RADIUS?e.style("width",`${l}px`).style("height",`${l}px`):e.style("width",`${s}px`).style("height",`${l}px`),i.type===ys.RADIUS){const{iconData:c,fill:r,stroke:f}=ks.radius;e.attr("fill","none").selectAll("circle").data(c).enter().append("circle").classed("radius",!0).attr("role",ts.IMG).attr("aria-label","radius").attr("cx",m=>m.cx).attr("cy",m=>m.cy).attr("r",m=>m.r).style("fill",i.fill?i.fill:r).style("stroke",i.stroke?i.stroke:f)}else if(i.type===ys.LINE){const c=ks.line;e.select("line.line").empty()&&e.append("line").classed(`line-${n}`,!0).attr("role",ts.IMG).attr("aria-label","line").attr("x1",0).attr("y1",c.yPosition).attr("x2",s).attr("y2",c.yPosition).style("stroke",i.stroke?i.stroke:c.stroke).style("stroke-width",c.strokeWidth)}else if(i.type===ys.AREA)e.select("rect.area").empty()&&e.append("rect").classed(`area-${n}`,!0).attr("role",ts.IMG).attr("aria-label","area").attr("width",s).attr("height",l).style("fill",n>3&&!i.fill?ks.area.fill:i.fill).style("stroke",i.stroke);else if(i.type===ys.SIZE){const{iconData:c,fill:r,stroke:f}=ks.size;e.attr("fill","none").attr("role",ts.IMG).attr("aria-label","size").selectAll("rect").data(c).enter().append("rect").classed("size",!0).attr("width",m=>m.width).attr("height",m=>m.height).attr("y",()=>0).style("fill",i.fill?i.fill:r).style("stroke",i.stroke?i.stroke:f).style("stroke-width",1)}else if(i.type===ys.QUARTILE){const{iconData:c}=ks.quartile;e.selectAll("rect").attr("role",ts.IMG).attr("aria-label","quartile").data(c).enter().append("rect").attr("class",(r,f)=>`quartile-${f===0?"wrapper":"line"}`).attr("x",r=>r.x).attr("y",r=>r.y).attr("width",r=>r.width).attr("height",r=>r.height)}else if(i.type===ys.ZOOM){const{iconData:c,color:r}=Ne(ks,"zoom"),f=e.attr("role",ts.IMG).attr("aria-label","zoom").selectAll("g.icon").data(c).enter();f.append("g").attr("x",m=>m.x).attr("y",m=>m.y).attr("width",m=>m.width).attr("height",m=>m.height).append("polygon").attr("points","7.7 4.82 5.78 4.82 5.78 2.89 4.82 2.89 4.82 4.82 2.89 4.82 2.89 5.78 4.82 5.78 4.82 7.7 5.78 7.7 5.78 5.78 7.7 5.78 7.7 4.82").attr("fill",()=>i.color?i.color:r),f.append("path").attr("d","M9.36,8.67A5.22,5.22,0,0,0,10.59,5.3,5.3,5.3,0,1,0,5.3,10.59,5.22,5.22,0,0,0,8.67,9.36L12.32,13l.68-.68Zm-4.06,1A4.34,4.34,0,1,1,9.63,5.3,4.33,4.33,0,0,1,5.3,9.63Z").attr("fill",()=>i.color?i.color:r)}}truncateLegendText(){const e=this.getComponentContainer(),i=Ne(this.getOptions(),"legend","truncation"),n=Ne(i,"type"),s=Ne(i,"threshold"),l=Ne(i,"numCharacter"),c=e.selectAll("div.legend-item p");c.attr("id",function(){return(this.parentNode.querySelector("div.checkbox")||this.parentNode).getAttribute("aria-labelledby")}),n!==Io.NONE?c.html(function(r){const f=Xo(r.name);return f.length>s&&f.length!==l?of(f,n,l):f}):c.html(r=>Xo(r.name))}addEventListeners(){const e=this,i=this.getComponentContainer(),n=this.getOptions(),s=Ne(n,"legend"),l=Ne(s,"truncation");i.selectAll("div.legend-item").on("mouseover",function(c){e.services.events.dispatchEvent(yt.Legend.ITEM_HOVER,{hoveredElement:Jt(this)});const r=Jt(this);r.select("div.checkbox").classed("hovered",!0);const f=r.datum();f.name.length>l.threshold&&l.numCharacter<f.name.length&&l.type!==Io.NONE&&e.services.events.dispatchEvent(yt.Tooltip.SHOW,{event:c,hoveredElement:r,content:f.name})}).on("mousemove",function(c){Jt(this).datum().name.length>l.threshold&&l.type!==Io.NONE&&e.services.events.dispatchEvent(yt.Tooltip.MOVE,{event:c})}).on("click",function(){e.services.events.dispatchEvent(yt.Legend.ITEM_CLICK,{clickedElement:Jt(this)});const c=Jt(this).datum();e.model.toggleDataLabel(c.name)}).on("mouseout",function(){const c=Jt(this);c.select("div.checkbox").classed("hovered",!1),c.datum().name.length>l.threshold&&l.type!==Io.NONE&&e.services.events.dispatchEvent(yt.Tooltip.HIDE),e.services.events.dispatchEvent(yt.Legend.ITEM_MOUSEOUT,{hoveredElement:c})}),i.selectAll("div.legend-item div.checkbox").on("keyup",function(c){c.key&&c.key==="Tab"&&e.services.events.dispatchEvent(yt.Legend.ITEM_HOVER,{hoveredElement:Jt(this)})}),i.selectAll("div.legend-item div.checkbox").on("keydown",function(c,r){c.key&&c.key===" "?(c.preventDefault(),e.model.toggleDataLabel(r.name)):c.key&&c.key==="Tab"&&e.services.events.dispatchEvent(yt.Legend.ITEM_MOUSEOUT,{hoveredElement:Jt(this)})}),i.selectAll("g.additional-item").on("mouseover",function(c){const r=Jt(this),f=r.datum();f.name.length>l.threshold&&e.services.events.dispatchEvent(yt.Tooltip.SHOW,{event:c,hoveredElement:r,content:f.name})})}}class YS extends Nr{constructor(e,i,n){super(e,i,n),this.type="chart-clip",this.renderType=Yn.SVG,this.chartClipId="chart-clip-id-"+Math.floor(Math.random()*99999999999),this.init()}init(){this.model.set({chartClipId:this.chartClipId},{skipUpdate:!0})}render(e=!0){this.createClipPath()}createClipPath(){const e=this.parent,{cartesianScales:i}=this.services;if(!i)throw new Error("Service cartesianScales was undefined");const n=i.getMainXScale(),s=i.getMainYScale(),[l,c]=n.range(),[r,f]=s.range();if(!e)throw new Error("svg is undefined");this.chartClipPath=hi.appendOrSelect(e,`clipPath.${this.type}`).attr("id",this.chartClipId);const m=hi.appendOrSelect(this.chartClipPath,`rect.${this.type}`);c-l>0&&m.attr("x",l).attr("y",f).attr("width",c-l).attr("height",r-f),this.chartClipPath.merge(m).lower()}}class BH extends YS{constructor(){super(...arguments),this.type="canvas-chart-clip",this.chartClipId="canvas-chart-clip-id-"+Math.floor(Math.random()*99999999999)}createClipPath(){const e=this.parent,{width:i,height:n}=hi.getSVGElementSize(this.parent,{useAttrs:!0});this.chartClipPath=hi.appendOrSelect(e,`clipPath.${this.type}`).attr("id",this.chartClipId);const s=hi.appendOrSelect(this.chartClipPath,`rect.${this.type}`);s.attr("x",0).attr("y",0).attr("width",i).attr("height",n),this.chartClipPath.merge(s).lower()}}var Yu,Os;(function(t){t.LEFT="left",t.RIGHT="right",t.TOP="top",t.BOTTOM="bottom"})(Os||(Os={}));var W2=(Yu={},Yu[Os.LEFT]=function(t,e,i){return{top:t.top-Math.round(e.offsetHeight/2)+Math.round(i.height/2),left:Math.round(t.left-e.offsetWidth)}},Yu[Os.RIGHT]=function(t,e,i){return{top:t.top-Math.round(e.offsetHeight/2)+Math.round(i.height/2),left:Math.round(t.left+i.width)}},Yu[Os.TOP]=function(t,e,i){return{top:Math.round(t.top-e.offsetHeight),left:t.left-Math.round(e.offsetWidth/2)+Math.round(i.width/2)}},Yu[Os.BOTTOM]=function(t,e,i){return{top:Math.round(t.top+i.height),left:t.left-Math.round(e.offsetWidth/2)+Math.round(i.width/2)}},Yu),Y2=typeof window<"u"?window:{innerHeight:0,scrollY:0,innerWidth:0,scrollX:0},zp=function(){function t(e){e===void 0&&(e={}),this.positions=W2,this.positions=Object.assign({},W2,e)}return t.prototype.getRelativeOffset=function(e){for(var i={left:e.offsetLeft,top:e.offsetTop};e.offsetParent&&getComputedStyle(e.offsetParent).position==="static";)i.left+=e.offsetLeft,i.top+=e.offsetTop,e=e.offsetParent;return i},t.prototype.getAbsoluteOffset=function(e){for(var i=e,n={top:0,left:0};i.offsetParent;){var s=getComputedStyle(i.offsetParent);s.position==="static"&&s.marginLeft&&s.marginTop&&(parseInt(s.marginTop,10)&&(n.top+=parseInt(s.marginTop,10)),parseInt(s.marginLeft,10)&&(n.left+=parseInt(s.marginLeft,10))),i=i.offsetParent}var l=e.getBoundingClientRect(),c=document.body.getBoundingClientRect();return{top:l.top-c.top+n.top,left:l.left-c.left+n.left}},t.prototype.findRelative=function(e,i,n){var s=this.getRelativeOffset(e),l=e.getBoundingClientRect();return this.calculatePosition(s,l,i,n)},t.prototype.findAbsolute=function(e,i,n){var s=this.getAbsoluteOffset(e),l=e.getBoundingClientRect();return this.calculatePosition(s,l,i,n)},t.prototype.findPosition=function(e,i,n,s){s===void 0&&(s=this.getAbsoluteOffset.bind(this));var l=s(e),c=e.getBoundingClientRect();return this.calculatePosition(l,c,i,n)},t.prototype.findPositionAt=function(e,i,n){return this.calculatePosition(e,{top:0,left:0,height:0,width:0},i,n)},t.prototype.getPlacementBox=function(e,i){var n=e.offsetHeight+i.top,s=e.offsetWidth+i.left;return{top:i.top,bottom:n,left:i.left,right:s}},t.prototype.addOffset=function(e,i,n){return i===void 0&&(i=0),n===void 0&&(n=0),Object.assign({},e,{top:e.top+i,left:e.left+n})},t.prototype.setElement=function(e,i){e.style.top=i.top+"px",e.style.left=i.left+"px"},t.prototype.findBestPlacement=function(e,i,n,s,l){var c=this;s===void 0&&(s=this.defaultContainerFunction.bind(this)),l===void 0&&(l=this.findPosition.bind(this));var r=n.map(function(f){var m=l(e,i,f),y=c.getPlacementBox(i,m),b=0,E=0,S=s();y.top<S.top?b=S.top-y.top:y.bottom>S.height&&(b=y.bottom-S.height),y.left<S.left?E=S.left-y.left:y.right>S.width&&(E=y.right-S.width),b&&!E?E=1:E&&!b&&(b=1);var D=i.offsetHeight*i.offsetWidth,R=b*E,z=D-R,H=z/D;return{placement:f,weight:H}});return r.sort(function(f,m){return m.weight-f.weight}),r[0].placement},t.prototype.findBestPlacementAt=function(e,i,n,s){var l=this;s===void 0&&(s=this.defaultContainerFunction.bind(this));var c=function(r,f,m){return l.findPositionAt(e,f,m)};return this.findBestPlacement(null,i,n,s,c)},t.prototype.defaultContainerFunction=function(){return{top:0,left:0,height:Y2.innerHeight,width:Y2.innerWidth}},t.prototype.calculatePosition=function(e,i,n,s){return this.positions[s]?this.positions[s](e,n,i):(console.error("No function found for placement, defaulting to 0,0"),{left:0,top:0})},t}();new zp;class JS extends Nr{constructor(e,i,n){super(e,i,n),this.type="tooltip",this.renderType=Yn.HTML,this.isEventListenerAdded=!1,this.positionService=new zp,this.handleShowTooltip=s=>{const l=s.detail.data||s.detail.items;let c;const r=this.formatItems(this.getItems(s));s.detail.content?c=`<div class="title-tooltip"><p>${dm(s.detail.content)}</p></div>`:c=dm(this.getTooltipHTML(r));const f=hi.appendOrSelect(this.tooltip,"div.content-box");if(Ne(this.getOptions(),"tooltip","customHTML"))if(s.detail.content){const m=`<div class="title-tooltip"><p>${dm(s.detail.content)}</p></div>`;f.html(m)}else f.html(`<div class="title-tooltip"><p>${dm(this.model.getOptions().tooltip.customHTML(l,c))}</p></div>`);else f.html(c);f.selectAll(".datapoint-tooltip").each(function(m,y){const b=r[y];r[y]&&r[y].color&&Jt(this).select(".tooltip-color").attr("class","tooltip-color").style("background-color",b.color)}),this.positionTooltip(s),this.tooltip.classed("hidden",!1).attr("aria-hidden",!1)},this.handleHideTooltip=()=>{this.tooltip.classed("hidden",!0).attr("aria-hidden",!0)},this.init()}addTooltipEventListener(){this.services.events.addEventListener(yt.Tooltip.MOVE,e=>{this.tooltip.classed("hidden")===!1&&this.positionTooltip(e)}),this.services.events.addEventListener(yt.Tooltip.SHOW,this.handleShowTooltip),this.services.events.addEventListener(yt.Tooltip.HIDE,this.handleHideTooltip),this.services.events.addEventListener(yt.Chart.MOUSEOUT,this.handleHideTooltip)}removeTooltipEventListener(){this.services.events.removeEventListener(yt.Tooltip.MOVE,null),this.services.events.removeEventListener(yt.Tooltip.SHOW,this.handleShowTooltip),this.services.events.removeEventListener(yt.Tooltip.HIDE,this.handleHideTooltip),this.services.events.removeEventListener(yt.Chart.MOUSEOUT,this.handleHideTooltip)}getItems(e){return e.detail.items?e.detail.items:[]}formatItems(e){const i=this.getOptions(),n=Ne(i,"tooltip","truncation","type"),s=Ne(i,"tooltip","truncation","threshold"),l=Ne(i,"tooltip","truncation","numCharacter");return n!==Io.NONE?e.map(c=>{const r=c.labelIcon?12:0;return c.value=c.value?this.valueFormatter(c.value,c.label):c.value,c.label&&c.label.length+r>s&&(c.label=of(c.label,n,l)),c.value&&c.value.length>s&&(c.value=of(c.value,n,l)),c}):e.map(c=>(c.value=c.value?this.valueFormatter(c.value,c.label):c.value,c))}getTooltipHTML(e){return'<ul class="multi-tooltip">'+e.map(i=>`<li>
					<div class="datapoint-tooltip${i.bold?" bold":""}">
						${i.class||i.color?`<div class="tooltip-color ${i.class}"></div>`:""}
						<div class="label">
						<p>${i.label||""}</p>
						${i.labelIcon?`<span class="label-icon"/>${i.labelIcon}</span>`:""}
						</div>
						${i.value===void 0||i.value===null?"":`<p class="value"/>${i.value}</p>`}
					</div>
				</li>`).join("")+"</ul>"}valueFormatter(e,i){const n=this.getOptions(),s=Ne(n,"tooltip","valueFormatter");if(s)return s(e,i);if(typeof e.getTime=="function")return Oh(e,"MMM d, yyyy");try{if(typeof e=="string"&&/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/.test(e))return Oh(Date.parse(e),"MMM d, yyyy")}catch{}return e.toLocaleString()}render(e=!1){const i=this.getOptions(),n=Ne(i,"tooltip","enabled");if(n){const s=Jt(this.services.domUtils.getHolder()),l=Ne(i,"style","prefix");this.tooltip=hi.appendOrSelect(s,`div.${va}--${l}--tooltip`),this.tooltip.style("max-width",null).attr("role","tooltip"),this.isEventListenerAdded||(this.addTooltipEventListener(),this.isEventListenerAdded=!0),this.tooltip.classed("hidden",!0)}else!n&&this.isEventListenerAdded&&(this.removeTooltipEventListener(),this.isEventListenerAdded=!1)}positionTooltip(e){const i=this.services.domUtils.getHolder(),n=this.tooltip.node(),s=this.getOptions(),l=Ne(s,"zoomBar","top","enabled");let c=Ne(e,"detail","mousePosition");if(!c)c=su(Ne(e,"detail","event"),i);else{const E=Ne(s,"zoomBar","top","type"),S=Ba.height[E];l&&(c[1]+=S+Ba.spacerHeight)}const r=i.offsetWidth,f=i.offsetHeight;let m;c[0]/r>.9?m=Os.LEFT:c[0]/r<.1?m=Os.RIGHT:m=this.positionService.findBestPlacementAt({left:c[0],top:c[1]},n,[Os.RIGHT,Os.LEFT,Os.TOP,Os.BOTTOM],()=>({top:void 0,left:void 0,width:r,height:f}));let{horizontalOffset:y}=PU;m===Os.LEFT&&(y*=-1);const b=this.positionService.findPositionAt({left:c[0]+y,top:c[1]},n,m);this.positionService.setElement(n,b)}}const XS=class Mm extends Nr{constructor(){super(...arguments),this.type="grid-brush",this.renderType=Yn.SVG,this.selectionSelector="rect.selection",this.frontSelectionSelector="rect.frontSelection"}render(e=!0){const i=this.parent,n=this.getComponentContainer();if(!i)throw new Error("SVG was not defined");const s=hi.appendOrSelect(i,"svg.chart-grid-backdrop"),l=hi.appendOrSelect(s,`g.${this.type}`),c=hi.appendOrSelect(l,this.selectionSelector),{width:r,height:f}=hi.getSVGElementSize(s,{useAttrs:!0}),{cartesianScales:m}=this.services,y=m.getMainXScaleType(),b=m.getMainXScale(),[E]=b.range();n.attr("transform",`translate(${E},0)`);const S=hi.appendOrSelect(n,this.frontSelectionSelector);if(b&&y===Hi.TIME){let D=this.model.get("zoomDomain");D===void 0&&(D=this.services.zoom.getDefaultZoomBarDomain(),D&&this.model.set({zoomDomain:D},{animate:!1}));const R=Y=>{const ne=Y[1]-Y[0];let ue="0,"+ne.toString();const ve=Math.floor(f/Mm.DASH_LENGTH),_e=ve*Mm.DASH_LENGTH;for(let oe=0;oe<ve;oe++)ue+=","+Mm.DASH_LENGTH;ue+=","+(f-_e),ve%2===1&&(ue+=",0"),ue+=","+ne.toString(),ue+=","+f.toString(),S.attr("stroke-dasharray",ue)},z=Y=>{const ne=Y.selection;ne===null||ne[0]===ne[1]||(S.attr("x",parseFloat(c.attr("x"))+parseFloat(s.attr("x"))).attr("y",c.attr("y")).attr("width",c.attr("width")).attr("height",c.attr("height")).style("cursor","pointer").style("display",null),R(ne))},H=(Y,ne)=>{const ue=cT().range([0,r]).domain(D);let ve=[ue.invert(Y),ue.invert(ne)];ve[0].valueOf()===ve[1].valueOf()&&(ve=this.services.zoom.getDefaultZoomBarDomain()),(D[0].valueOf()!==ve[0].valueOf()||D[1].valueOf()!==ve[1].valueOf())&&this.services.zoom.handleDomainChange(ve)};let K;const W=Y=>{const ne=Y.selection;ne!==null&&(H(ne[0],ne[1]),l.call(K.move,null),S.style("display","none"))};f!=0&&r!=0&&(K=WE().extent([[0,0],[r-1,f]]).on("start brush end",z).on("end.brushed",W),l.call(K));const se=this.services.zoom.getZoomRatio();s.on("click",function(Y){if(Y.shiftKey){const ne=this.services.domUtils.getHolder(),ue=su(l.node(),ne)[0];let ve=ue-r*se/2;ve<0&&(ve=0);let _e=ue+r*se/2;_e>r&&(_e=r),H(ve,_e)}})}}};XS.DASH_LENGTH=4;let VH=XS;class FH extends Nr{constructor(){super(...arguments),this.type="zoom-bar",this.renderType=Yn.SVG,this.MIN_SELECTION_DIFF=9e-10,this.brushSelector="g.zoom-bar-brush",this.clipId="zoomBarClip-"+Math.floor(Math.random()*99999999999),this.brush=WE(),this.highlightStrokeWidth=1}init(){this.services.events.addEventListener(yt.ZoomBar.UPDATE,this.render.bind(this));const e=Ne(this.getOptions(),"zoomBar",Ft.TOP,"data");this.model.setZoomBarData(e)}render(e=!0){const i=this.getComponentContainer(),n=this.services.zoom.isZoomBarLoading(Ft.TOP),s=this.services.zoom.isZoomBarLocked(Ft.TOP),l=Ne(this.getOptions(),"zoomBar",Ft.TOP,"type"),c=Ne(this.getOptions(),"axes",Ft.BOTTOM,"highlights"),r=Ba.height[l],{width:f}=hi.getSVGElementSize(this.parent,{useAttrs:!0});if(f===0)return;let m=0;const y=this.model.get("axesMargins");y&&y.left&&(m=y.left);const b=hi.appendOrSelect(i,"svg.zoom-container").attr("width","100%").attr("height",r).attr("opacity",1);if(hi.appendOrSelect(i,"rect.zoom-spacer").attr("x",0).attr("y",r).attr("width","100%").attr("height",Ba.spacerHeight).attr("opacity",1).attr("fill","none"),l===Yo.GRAPH_VIEW?hi.appendOrSelect(b,"rect.zoom-bg").attr("x",m).attr("y",0).attr("width",f-m).attr("height","100%").classed("zoom-bg-skeleton",n).style("stroke",n?`url(#${this.services.domUtils.generateElementIDString("shimmer-lines")})`:null):l===Yo.SLIDER_VIEW&&hi.appendOrSelect(b,"rect.zoom-slider-bg").attr("x",m).attr("y",r/2-1).attr("width",f-m).attr("height",2).classed("zoom-slider-bg-skeleton",n).style("stroke",n?`url(#${this.services.domUtils.generateElementIDString("shimmer-lines")})`:null),n){this.renderSkeleton(b,m,f);return}const{cartesianScales:E}=this.services,S=E.getMainXScale(),D=E.getMainYScale(),R=E.getMainXScaleType();if(S&&R===Hi.TIME){let z=this.services.zoom.getZoomBarData();if(EU(z)||z.length===1)return;this.xScale=S.copy(),this.yScale=D.copy();const H=this.services.zoom.getDefaultZoomBarDomain(z);z=this.compensateDataForDefaultDomain(z,H);const K=this.model.get("initialZoomDomain"),W=Ne(this.getOptions(),"zoomBar",Ft.TOP,"initialZoomDomain");W&&W[0]&&W[1]&&(W[0]=new Date(W[0]),W[1]=new Date(W[1])),W&&!(K&&K[0].valueOf()===W[0].valueOf()&&K[1].valueOf()===W[1].valueOf())?this.model.set({initialZoomDomain:mn([],W),zoomDomain:W?mn([],W):H},{skipUpdate:!0}):W===null&&K!==null&&this.model.set({initialZoomDomain:null,zoomDomain:mn([],H)},{skipUpdate:!0}),this.xScale.range([m,f]).domain(H),this.maxSelectionRange=this.xScale.range(),this.yScale.range([0,r-6]).domain(dh(z,ne=>ne.value));const se=this.model.get("zoomDomain");if(l===Yo.GRAPH_VIEW&&(this.renderZoomBarArea(b,"path.zoom-graph-area-unselected",z,null),this.updateClipPath(i,this.clipId,0,0,0,0),this.renderZoomBarArea(b,"path.zoom-graph-area",z,this.clipId),this.renderZoomBarBaseline(b,m,f),c)){const ne=c.highlightStartMapsTo,ue=c.highlightEndMapsTo,ve=c.color,_e=c.labelMapsTo;c.data.forEach((oe,Be)=>{hi.appendOrSelect(b,`rect.highlight-${Be}`).attr("height",r-2*this.highlightStrokeWidth).attr("y",this.highlightStrokeWidth).attr("x",this.xScale(oe[ne])).attr("width",this.xScale(oe[ue])-this.xScale(oe[ne])).style("fill",ve&&ve.scale[oe[_e]]?ve.scale[oe[_e]]:null).style("fill-opacity",.1).style("stroke",ve&&ve.scale[oe[_e]]?ve.scale[oe[_e]]:null).style("stroke-dasharray","2, 2").attr("stroke-width","1px")})}this.addBrushEventListener(se,m,f);const Y=hi.appendOrSelect(i,this.brushSelector).call(this.brush);if(se!==void 0)if(se[0].valueOf()===se[1].valueOf())Y.call(this.brush.move,this.xScale.range()),this.updateBrushHandle(this.getComponentContainer(),this.xScale.range());else{const ne=se.map(ue=>this.xScale(ue));ne[1]-ne[0]<this.MIN_SELECTION_DIFF||(Y.call(this.brush.move,ne),this.updateBrushHandle(this.getComponentContainer(),ne))}s&&(this.brush.filter(()=>!1),Y.selectAll("rect").attr("cursor","auto"))}}addBrushEventListener(e,i,n){const s=r=>{const f=r.selection;f===null?this.handleBrushedEvent(r,e,this.xScale,this.xScale.range()):f[0]===f[1]||this.handleBrushedEvent(r,e,this.xScale,f)},l=Ne(this.getOptions(),"zoomBar",Ft.TOP,"type"),c=Ba.height[l];this.brush.extent([[i,0],[n,c]]).on("start brush end",null).on("start brush end",s)}handleBrushedEvent(e,i,n,s){const l=[n.invert(s[0]),n.invert(s[1])];if(this.updateBrushHandle(this.getComponentContainer(),s),e.sourceEvent!=null&&(e.sourceEvent.type==="mousemove"||e.sourceEvent.type==="mouseup"||e.sourceEvent.type==="mousedown"||e.sourceEvent.type==="touchstart"||e.sourceEvent.type==="touchmove"||e.sourceEvent.type==="touchend")){(i===void 0||i[0]!==l[0]||i[1]!==l[1])&&this.services.zoom.handleDomainChange(l,{dispatchEvent:!1});let c;e.type==="start"?c=yt.ZoomBar.SELECTION_START:e.type==="brush"?c=yt.ZoomBar.SELECTION_IN_PROGRESS:e.type==="end"&&(c=yt.ZoomBar.SELECTION_END,this.services.events.dispatchEvent(yt.ZoomDomain.CHANGE,{newDomain:l})),this.services.events.dispatchEvent(c,{selection:s,newDomain:l})}}updateBrushHandle(e,i){const n=this,s=Ba.handleWidth,l=Ne(this.getOptions(),"zoomBar",Ft.TOP,"type"),c=Ba.height[l],r=-s/2,f=Ba.handleBarWidth,m=l===Yo.GRAPH_VIEW?Ba.handleBarHeight:6,y=-f/2,b=(c-m)/2;e.select(this.brushSelector).selectAll("rect.handle").data([{type:"w"},{type:"e"}]).attr("x",function(S){if(S.type==="w")return Math.max(i[0]+r,n.maxSelectionRange[0]);if(S.type==="e")return Math.min(i[1]+r,n.maxSelectionRange[1]-s)}).attr("y",0).attr("width",s).attr("height",c).attr("cursor","ew-resize").style("display",null);const E=e.select(this.brushSelector).selectAll("rect.handle-bar").data([{type:"w"},{type:"e"}]);E.enter().append("rect").attr("class",function(S){return"handle-bar handle-bar--"+S.type}),E.attr("x",function(S){if(S.type==="w")return Math.max(i[0]+y,n.maxSelectionRange[0]-r+y);if(S.type==="e")return Math.min(i[1]+y,n.maxSelectionRange[1]+r+y)}).attr("y",b).attr("width",f).attr("height",m).attr("cursor","ew-resize"),l===Yo.SLIDER_VIEW&&this.updateSliderSelectedArea(i),this.updateClipPath(e,this.clipId,i[0],0,i[1]-i[0],c)}updateSliderSelectedArea(e){const i=Ne(this.getOptions(),"zoomBar",Ft.TOP,"type"),n=Ba.height[i],s=this.getComponentContainer().select("svg.zoom-container");hi.appendOrSelect(s,"rect.zoom-slider-selected-area").attr("x",e[0]).attr("y",n/2-1).attr("width",e[1]-e[0]).attr("height",2)}renderZoomBarArea(e,i,n,s){const{cartesianScales:l}=this.services,c=l.getMainXAxisPosition(),r=l.getMainYAxisPosition(),f=l.getMainXScaleType(),m=l.getMainYScaleType(),y=(H,K,W)=>se=>l.getValueFromScale(H,K,W,se),b=y(this.xScale,f,c),E=y(this.yScale,m,r),S=Ne(this.getOptions(),"zoomBar",Ft.TOP,"type"),D=Ba.height[S],R=ny().x(H=>b(H)).y0(D).y1(H=>D-E(H)),z=hi.appendOrSelect(e,i).datum(n).attr("d",R);s&&z.attr("clip-path",`url(#${s})`)}updateClipPath(e,i,n,s,l,c){const r=hi.appendOrSelect(e,"clipPath").attr("id",i);hi.appendOrSelect(r,"rect").attr("x",n).attr("y",s).attr("width",l).attr("height",c)}compensateDataForDefaultDomain(e,i){if(!e||e.length<2)return;const n=Rp(e),s=this.services.cartesianScales.getDomainIdentifier(),l=this.services.cartesianScales.getRangeIdentifier();if(Number(i[0])<Number(n[0][s])){const c={};c[s]=i[0],c[l]=0,n.unshift(c)}if(Number(i[1])>Number(n[n.length-1][s])){const c={};c[s]=i[1],c[l]=0,n.push(c)}return n}renderZoomBarBaseline(e,i,n,s=!1){const l=Ne(this.model.getOptions(),"zoomBar",Ft.TOP,"type"),c=Ba.height[l],r=iy()([[i,c],[n,c]]);hi.appendOrSelect(e,"path.zoom-bg-baseline").attr("d",r).classed("zoom-bg-baseline-skeleton",s).style("stroke",s?`url(#${this.services.domUtils.generateElementIDString("shimmer-lines")})`:null)}renderSkeleton(e,i,n){this.renderZoomBarArea(e,"path.zoom-graph-area-unselected",[],null),this.renderZoomBarArea(e,"path.zoom-graph-area",[],this.clipId),this.brush.on("start brush end",null),hi.appendOrSelect(this.getComponentContainer(),this.brushSelector).html(null),Ne(this.getOptions(),"zoomBar",Ft.TOP,"type")===Yo.GRAPH_VIEW&&this.renderZoomBarBaseline(e,i,n,!0)}destroy(){this.brush.on("start brush end",null),this.services.events.removeEventListener(yt.ZoomBar.UPDATE,this.render.bind(this))}}class UH extends Nr{constructor(e,i){super(e,i),this.type="threshold",this.renderType=Yn.SVG,this.positionService=new zp}render(e=!1){const i=Ne(this.getOptions(),"axes"),n=[];Object.keys(i).forEach(m=>{if(Object.values(Ft).includes(m)){const y=i[m];y.thresholds&&y.thresholds.length>0&&n.push({axisPosition:m,thresholds:y.thresholds,correspondingDatasets:y==null?void 0:y.correspondingDatasets,mapsTo:y==null?void 0:y.mapsTo})}});const s=this.getComponentContainer({withinChartClip:!0}).selectAll("g.axis-thresholds").data(n,m=>m.axisPosition);s.exit().attr("opacity",0).remove();const l=s.enter().append("g").merge(s);l.attr("class",m=>`axis-thresholds ${m.axisPosition}`);const c=l.selectAll("g.threshold-group").data(m=>m.thresholds.map(y=>(y.axisPosition=m.axisPosition,y.datum=this.constructDatumObj(m,y),y)));c.exit().attr("opacity",0).remove();const r=c.enter().append("g");r.append("line").attr("class","threshold-line"),r.append("rect").attr("class","threshold-hoverable-area"),r.merge(c).attr("class","threshold-group");const f=this;l.each(function({axisPosition:m}){const y=f.services.cartesianScales.getScaleByPosition(m),b=f.services.cartesianScales.getScaleTypeByPosition(m);let E=null,S=null;m===Ft.LEFT||m===Ft.RIGHT?(S=y,E=f.services.cartesianScales.getMainXScale()):(E=y,S=f.services.cartesianScales.getMainYScale());const D=b===Hi.LABELS,[R,z]=E.range(),[H,K]=S.range(),{cartesianScales:W}=f.services,se=W.getOrientation(),Y=oe=>W.getDomainValue(oe),ne=oe=>W.getRangeValue(oe),[ue,ve]=ph(Y,ne,se),_e=Jt(this);m===Ft.TOP||m===Ft.BOTTOM?(_e.selectAll("line.threshold-line").transition().call(oe=>f.services.transitions.setupTransition({transition:oe,name:"threshold-line-update",animate:e})).attr("y1",K).attr("y2",H).attr("x1",({datum:oe})=>ue(oe)+(D?y.step()/2:0)).attr("x2",({datum:oe})=>ue(oe)+(D?y.step()/2:0)).style("stroke",({fillColor:oe})=>oe),_e.selectAll("rect.threshold-hoverable-area").attr("x",0).attr("y",({datum:oe})=>-ue(oe)).attr("width",Math.abs(H-K)).classed("rotate",!0)):(_e.selectAll("line.threshold-line").transition().call(oe=>f.services.transitions.setupTransition({transition:oe,name:"threshold-line-update",animate:e})).attr("x1",R).attr("x2",z).attr("y1",({datum:oe})=>ve(oe)+(D?y.step()/2:0)).attr("y2",({datum:oe})=>ve(oe)+(D?y.step()/2:0)).style("stroke",({fillColor:oe})=>oe),_e.selectAll("rect.threshold-hoverable-area").attr("x",R).attr("y",({datum:oe})=>ve(oe)).attr("width",Math.abs(z-R)).classed("rotate",!1))}),this.services.events.addEventListener(yt.Threshold.SHOW,m=>{this.setThresholdLabelPosition(m.detail),this.label.classed("hidden",!1)}),this.services.events.addEventListener(yt.Threshold.HIDE,()=>{this.label.classed("hidden",!0)}),this.appendThresholdLabel(),this.addEventListeners()}getFormattedValue(e){const{value:i,axisPosition:n}=e,s=this.getOptions();if(this.services.cartesianScales.getScaleTypeByPosition(n)===Hi.TIME){const l=[Ft.LEFT,Ft.RIGHT].includes(n),c=this.services.cartesianScales.getMainXScale(),r=this.services.cartesianScales.getMainYScale(),f=l?r:c,m=Ne(s,"timeScale"),y=i0(f.ticks(),Ne(m,"timeInterval"));return t0(i,0,f.ticks(),y,m)}return i.toLocaleString("en")}appendThresholdLabel(){const e=Jt(this.services.domUtils.getHolder()),i=Ne(this.getOptions(),"style","prefix");this.label=hi.appendOrSelect(e,`div.${va}--${i}--threshold--label`).classed("hidden",!0)}setThresholdLabelPosition({event:e,datum:i}){const n=this.services.domUtils.getHolder(),s=su(e,n),l=i.valueFormatter?i.valueFormatter(i.value):this.getFormattedValue(i);this.label.html(Xo(`${i.label||"Threshold"}: ${l}`)).style("background-color",i.fillColor);const c=this.label.node(),r=this.positionService.findBestPlacementAt({left:s[0],top:s[1]},c,[Os.RIGHT,Os.LEFT,Os.TOP,Os.BOTTOM],()=>({top:void 0,left:void 0,width:n.offsetWidth,height:n.offsetHeight})),f=this.positionService.findPositionAt({left:s[0],top:s[1]},c,r);this.positionService.setElement(c,f)}constructDatumObj(e,i){const n={};return e.correspondingDatasets&&(n.group=Ne(e,"correspondingDatasets",0)),n[e.mapsTo]=i.value,n}addEventListeners(){const e=this;this.getComponentContainer({withinChartClip:!0}).selectAll("rect.threshold-hoverable-area").on("mouseover mousemove",function(i){Jt(this.parentNode).select("line.threshold-line").classed("active",!0),e.services.events.dispatchEvent(yt.Threshold.SHOW,{event:i,hoveredElement:Jt(this),datum:Jt(this).datum()})}).on("mouseout",function(i){Jt(this.parentNode).select("line.threshold-line").classed("active",!1),e.services.events.dispatchEvent(yt.Threshold.HIDE,{event:i,hoveredElement:Jt(this),datum:Jt(this).datum()})})}}class jH extends Nr{constructor(e,i){super(e,i),this.type="highlight",this.renderType=Yn.SVG,this.positionService=new zp,this.highlightStrokeWidth=1}render(e=!1){const i=Ne(this.getOptions(),"axes"),n=[];Object.keys(i).forEach(m=>{if(Object.values(Ft).includes(m)){const y=i[m];y.highlights&&y.highlights.data.length>0&&n.push({axisPosition:m,highlightStartMapsTo:y.highlights.highlightStartMapsTo,highlightEndMapsTo:y.highlights.highlightEndMapsTo,labelMapsTo:y.highlights.labelMapsTo,highlight:y.highlights.data,color:y.highlights.color})}});const s=this.getComponentContainer({withinChartClip:!0}).selectAll("g.axis-highlight").data(n,m=>m.axisPosition);s.exit().attr("opacity",0).remove();const l=s.enter().append("g").merge(s);l.attr("class",m=>`axis-highlight ${m.axisPosition}`);const c=l.selectAll("g.highlight-group").data(m=>m.highlight.map(y=>(y.axisPosition=m.axisPosition,y.highlightStartMapsTo=m.highlightStartMapsTo,y.labelMapsTo=m.labelMapsTo,y.color=m.color,y.highlightEndMapsTo=m.highlightEndMapsTo,y)));c.exit().attr("opacity",0).remove();const r=c.enter().append("g");r.append("rect").attr("class","highlight-bar"),r.append("line").attr("class","highlight-line"),r.merge(c).attr("class","highlight-group");const f=this;l.each(function({axisPosition:m}){const y=f.services.cartesianScales.getMainXScale(),b=f.services.cartesianScales.getMainYScale(),[E,S]=y.range(),[D,R]=b.range(),{cartesianScales:z}=f.services,H=z.getOrientation(),K=ue=>z.getDomainValue(ue),W=ue=>z.getRangeValue(ue),[se,Y]=ph(K,W,H),ne=Jt(this);m===Ft.TOP||m===Ft.BOTTOM?ne.selectAll("rect.highlight-bar").transition().call(ue=>f.services.transitions.setupTransition({transition:ue,name:"highlight-bar-update",animate:e})).attr("y",Math.max(R+f.highlightStrokeWidth,0)).attr("height",Math.max(D-2*f.highlightStrokeWidth,0)).attr("x",({highlightStartMapsTo:ue,...ve})=>se(ve[ue])).attr("width",({highlightStartMapsTo:ue,highlightEndMapsTo:ve,..._e})=>Math.max(se(_e[ve])-se(_e[ue]),0)).style("stroke",({color:ue,labelMapsTo:ve,..._e})=>ue&&ue.scale[_e[ve]]?ue.scale[_e[ve]]:null).style("stroke-dasharray","2, 2").attr("stroke-width",f.highlightStrokeWidth+"px").style("fill-opacity",.1).style("fill",({color:ue,labelMapsTo:ve,..._e})=>ue&&ue.scale[_e[ve]]?ue.scale[_e[ve]]:null):ne.selectAll("rect.highlight-bar").transition().call(ue=>f.services.transitions.setupTransition({transition:ue,name:"highlight-bar-update",animate:e})).attr("x",E).attr("width",Math.max(S-E,0)).attr("y",({highlightEndMapsTo:ue,...ve})=>Y(ve[ue])).attr("height",({highlightStartMapsTo:ue,highlightEndMapsTo:ve,..._e})=>Math.max(Y(_e[ue])-Y(_e[ve]),0)).style("stroke",({color:ue,labelMapsTo:ve,..._e})=>ue&&ue.scale[_e[ve]]?ue.scale[_e[ve]]:null).style("stroke-dasharray","2, 2").attr("stroke-width",f.highlightStrokeWidth+"px").style("fill-opacity",.1).style("fill",({color:ue,labelMapsTo:ve,..._e})=>ue&&ue.scale[_e[ve]]?ue.scale[_e[ve]]:null)})}}class GH extends JS{getItems(e){if(e.detail.items)return e.detail.items;const{data:i}=e.detail;if(!i||!i.length||!i[0])return[];const n=this.getOptions(),{cartesianScales:s}=this.services,l=s.getDomainIdentifier(),c=s.isDualAxes(),{groupMapsTo:r}=n.data,f=s.getDomainLabel();let m=s.getRangeLabel();const y=i[0][l];let b;if(i.length===1){const E=i[0],S=s.getRangeIdentifier(E);if(c){const R=s.getRangeAxisPosition({datum:E,groups:[E[r]]});m=s.getScaleLabel(R)}const D=E[S];b=[{label:f,value:y},...Array.isArray(D)&&D.length===2?[{label:"Start",value:D[0]},{label:"End",value:D[1]}]:[{label:m,value:E[S]}]],e.detail.additionalItems&&e.detail.additionalItems.forEach(R=>b.push({label:R.label,value:R.value})),b.push({label:n.tooltip.groupLabel,value:E[r],color:this.model.getFillColor(E[r]),class:this.model.getColorClassName({classNameTypes:[Cs.TOOLTIP],dataGroupName:E[r]})})}else if(i.length>1&&(b=[{label:f,value:y}],b=b.concat(i.map(E=>{const S=E[s.getRangeIdentifier(E)];return{label:E[r],value:Array.isArray(S)&&S.length===2?`${S[0]} - ${S[1]}`:S,color:this.model.getFillColor(E[r]),class:this.model.getColorClassName({classNameTypes:[Cs.TOOLTIP],dataGroupName:E[r]})}}).sort((E,S)=>S.value-E.value)),!c&&Ne(n,"tooltip","showTotal")===!0)){const E=s.getRangeIdentifier();b.push({label:py(n,"tooltip.totalLabel")||"Total",value:i.reduce((S,D)=>S+D[E],0),bold:!0})}return b}}class HH extends Nr{constructor(){super(...arguments),this.type="grid",this.renderType=Yn.SVG}render(e=!0){const i=Ne(this.getOptions(),"grid","x","enabled"),n=Ne(this.getOptions(),"grid","y","enabled");this.drawBackdrop(i,n),!(!i&&!n)&&(i&&(hi.appendOrSelect(this.backdrop,"g.x.grid"),this.drawXGrid(e)),n&&(hi.appendOrSelect(this.backdrop,"g.y.grid"),this.drawYGrid(e)))}drawXGrid(e){const i=this.parent,n=this.backdrop.attr("height"),s=this.services.cartesianScales.getMainXScale(),l=bE(s).tickSizeInner(-n).tickSizeOuter(0);if(Ne(this.getOptions(),"grid","x","alignWithAxisTicks")){const r=this.services.cartesianScales.getDomainAxisPosition(),f=Ne(this.getOptions(),"axes",r,"ticks","values");f&&l.tickValues(f)}else{const r=Ne(this.getOptions(),"grid","x","numberOfTicks");l.ticks(r)}const c=i.select(".x.grid").attr("transform",`translate(${-this.backdrop.attr("x")}, ${n})`);e?c.transition().call(r=>this.services.transitions.setupTransition({transition:r,name:"grid-update",animate:e})).call(l):c.call(l),this.cleanGrid(c)}drawYGrid(e){const i=this.parent,n=this.backdrop.attr("width"),s=this.services.cartesianScales.getMainYScale(),l=xE(s).tickSizeInner(-n).tickSizeOuter(0);if(Ne(this.getOptions(),"grid","y","alignWithAxisTicks")){const r=this.services.cartesianScales.getRangeAxisPosition(),f=Ne(this.getOptions(),"axes",r,"ticks","values");f&&l.tickValues(f)}else{const r=Ne(this.getOptions(),"grid","y","numberOfTicks");l.ticks(r)}const c=i.select(".y.grid").attr("transform",`translate(0, ${-this.backdrop.attr("y")})`);e?c.transition().call(r=>this.services.transitions.setupTransition({transition:r,name:"grid-update",animate:e})).call(l):c.call(l),this.cleanGrid(c)}getGridlineThreshold(e){const i=this.parent,n=i.selectAll(".x.grid .tick").nodes().sort((y,b)=>Number(Sl(y).tx)-Number(Sl(b).tx));let s=-1;if(!n.length)return;n.forEach(y=>{e[0]>=+Sl(y).tx&&s++});const l=s+1<n.length?s+1:n.length,c=n[s],r=n[l];let f;if(!c)f=+Sl(r).tx;else if(r)f=+Sl(r).tx-+Sl(c).tx;else{const y=i.select("rect.chart-grid-backdrop").node();f=hi.getSVGElementSize(y).width-+Sl(c).tx}const{threshold:m}=this.getOptions().tooltip.gridline;return f*m}getActiveGridline(e){const i=Ne(this.getOptions,"tooltip","gridline","threshold"),n=i||this.getGridlineThreshold(e);return this.parent.selectAll(".x.grid .tick").filter(function(){const s=Sl(this),l={min:Number(s.tx)-n,max:Number(s.tx)+n};return l.min<=e[0]&&e[0]<=l.max})}drawBackdrop(e,i){const n=this.parent,s=this.services.cartesianScales.getMainXScale(),l=this.services.cartesianScales.getMainYScale(),[c,r]=s.range(),[f,m]=l.range();this.backdrop=hi.appendOrSelect(n,"svg.chart-grid-backdrop");const y=hi.appendOrSelect(this.backdrop,e||i?"rect.chart-grid-backdrop.stroked":"rect.chart-grid-backdrop");this.backdrop.merge(y).attr("x",c).attr("y",m).attr("width",Math.abs(r-c)).attr("height",Math.abs(f-m)).lower(),y.attr("width","100%").attr("height","100%")}cleanGrid(e){e.selectAll("text").remove(),e.select(".domain").remove()}}class KH extends Nr{constructor(){super(...arguments),this.type="area",this.renderType=Yn.SVG,this.gradient_id="gradient-id-"+Math.floor(Math.random()*99999999999),this.handleLegendOnHover=e=>{const{hoveredElement:i}=e.detail;this.parent.selectAll("path.area").transition("legend-hover-area").call(n=>this.services.transitions.setupTransition({transition:n,name:"legend-hover-area"})).attr("opacity",n=>n.name!==i.datum().name?Il.opacity.unselected:Il.opacity.selected)},this.handleLegendMouseOut=()=>{this.parent.selectAll("path.area").transition("legend-mouseout-area").call(e=>this.services.transitions.setupTransition({transition:e,name:"legend-mouseout-area"})).attr("opacity",Il.opacity.selected)}}init(){const e=this.services.events;e.addEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.addEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}render(e=!0){const i=this.getComponentContainer({withinChartClip:!0}),n=this.getOptions();let s=[0,0];const{cartesianScales:l}=this.services,c=l.getOrientation(),r=ny().curve(this.services.curves.getD3Curve()).defined(Y=>{const ne=l.getRangeIdentifier();return Y[ne]!=null}),f=this.model.getGroupedData(this.configs.groups),m=Ne(n,"bounds"),y=m&&f&&f.length===1;!y&&m&&console.warn(`Bounds can only be shown when having 1 single datagroup, you've supplied ${f.length}`);let b=0;const E=(Y,ne)=>{Ne(n,"axes",Y,"includeZero")===!1&&ne[0]>0&&ne[1]>0&&(b=ne[0])},S=Y=>y?l.getBoundedScaledValues(Y)[0]:l.getRangeValue(b),D=Y=>y?l.getBoundedScaledValues(Y)[1]:l.getRangeValue(Y);c===wa.VERTICAL?(s=l.getMainYScale().domain(),E(l.getMainYAxisPosition(),s),r.x(Y=>l.getDomainValue(Y)).y0(Y=>S(Y)).y1(Y=>D(Y))):(s=l.getMainXScale().domain(),E(l.getMainXAxisPosition(),s),r.x0(Y=>S(Y)).x1(Y=>D(Y)).y(Y=>l.getDomainValue(Y)));const R=Ne(n,"color","gradient","enabled"),z=f&&f.length===1&&R;f.length>1&&R&&console.error("Gradients can only be enabled when having 1 single dataset");const H=i.selectAll("path.area").data(f,Y=>Y.name),K=Jt(this.services.domUtils.getMainContainer());if(H.exit().attr("opacity",0).remove(),!f.length)return;if(z){const Y=K.select(`path.${this.model.getColorClassName({classNameTypes:[Cs.STROKE],dataGroupName:f[0].name})}`).node();let ne;if(Y)ne=getComputedStyle(Y,null).getPropertyValue("stroke");else{const ue=Ne(this.model.getOptions(),"color","scale");if(ue!==null){const ve=Object.keys(ue);ne=ue[ve[0]]}}lf.appendOrUpdateLinearGradient({svg:this.parent,id:this.services.domUtils.generateElementIDString(`${f[0].name.replace(" ","")}_${this.gradient_id}`),x1:"0%",x2:"0%",y1:"0%",y2:"100%",stops:lf.getStops(s,ne)})}else this.parent.selectAll("defs linearGradient").empty()||this.parent.selectAll("defs linearGradient").each(function(){this.parentNode.remove()});const W=this,se=H.enter().append("path");z?se.merge(H).style("fill",Y=>`url(#${this.services.domUtils.generateElementIDString(`${Y.name.replace(" ","")}_${this.gradient_id}`)})`).attr("class","area").attr("class",Y=>this.model.getColorClassName({classNameTypes:[Cs.FILL],dataGroupName:Y.name,originalClassName:"area"})).attr("d",Y=>{const{data:ne}=Y;return r(ne)}):(se.attr("opacity",0).merge(H).attr("class","area").attr("class",Y=>this.model.getColorClassName({classNameTypes:[Cs.FILL,Cs.STROKE],dataGroupName:Y.name,originalClassName:"area"})).style("fill",Y=>W.model.getFillColor(Y.name)).transition().call(Y=>this.services.transitions.setupTransition({transition:Y,name:"area-update-enter",animate:e})).attr("opacity",y?1:Il.opacity.selected).attr("d",Y=>{const{data:ne}=Y;return r(ne)}),y&&se.attr("fill-opacity",Il.opacity.selected).style("stroke",Y=>W.model.getStrokeColor(Y.name)).style("stroke-dasharray","2, 2").attr("stroke-width",.7+"px"))}destroy(){const e=this.services.events;e.removeEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.removeEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}}class m_ extends Nr{constructor(){super(...arguments),this.type="line",this.renderType=Yn.SVG,this.handleLegendOnHover=e=>{const{hoveredElement:i}=e.detail;this.parent.selectAll("path.line").transition("legend-hover-line").call(n=>this.services.transitions.setupTransition({transition:n,name:"legend-hover-line"})).attr("opacity",n=>n.name!==i.datum().name?r_.opacity.unselected:r_.opacity.selected)},this.handleLegendMouseOut=()=>{this.parent.selectAll("path.line").transition("legend-mouseout-line").call(e=>this.services.transitions.setupTransition({transition:e,name:"legend-mouseout-line"})).attr("opacity",r_.opacity.selected)}}init(){const{events:e}=this.services;e.addEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.addEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}render(e=!0){const i=this.getComponentContainer({withinChartClip:!0}),{cartesianScales:n,curves:s}=this.services,l=S=>n.getDomainValue(S),c=S=>n.getRangeValue(S),[r,f]=ph(l,c,n.getOrientation()),m=this.getOptions(),y=iy().x(r).y(f).curve(s.getD3Curve()).defined(S=>{const D=n.getRangeIdentifier(S);return S[D]!=null});let b=[];if(this.configs.stacked){const S=Object.keys(m.axes).some(R=>m.axes[R].percentage),{groupMapsTo:D}=m.data;b=this.model.getStackedData({groups:this.configs.groups,percentage:S}).map(R=>{const z=this.services.cartesianScales.getDomainIdentifier(R),H=this.services.cartesianScales.getRangeIdentifier(R);return{name:Ne(R,0,D),data:R.map(K=>({[z]:K.data.sharedStackKey,[D]:K[D],[H]:K[1]})),hidden:!lG(R,K=>K[0]!==K[1])}})}else b=this.model.getGroupedData(this.configs.groups);const E=i.selectAll("path.line").data(b,S=>S.name);E.exit().attr("opacity",0).remove(),E.enter().append("path").classed("line",!0).attr("opacity",0).merge(E).data(b,S=>S.name).attr("class",S=>this.model.getColorClassName({classNameTypes:[Cs.STROKE],dataGroupName:S.name,originalClassName:"line"})).style("stroke",S=>this.model.getStrokeColor(S.name)).attr("role",ts.GRAPHICS_SYMBOL).attr("aria-roledescription","line").attr("aria-label",S=>{const{data:D}=S;return D.map(R=>{const z=this.services.cartesianScales.getRangeIdentifier(R);return R[z]}).join(",")}).transition().call(S=>this.services.transitions.setupTransition({transition:S,name:"line-update-enter",animate:e})).attr("opacity",S=>S.hidden?0:1).attr("d",S=>{const{data:D}=S;return y(D)})}destroy(){const e=this.services.events;e.removeEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.removeEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}}const J2=5;function qH(t,e){return t>e-J2&&t<e+J2}class ZH extends Nr{constructor(){super(...arguments),this.type="ruler",this.renderType=Yn.SVG,this.isXGridEnabled=Ne(this.getOptions(),"grid","x","enabled"),this.isYGridEnabled=Ne(this.getOptions(),"grid","y","enabled"),this.isEventListenerAdded=!1}render(e=!1){const i=Ne(this.getOptions(),"ruler","enabled");this.drawBackdrop(),i&&!this.isEventListenerAdded?this.addBackdropEventListeners():!i&&this.isEventListenerAdded&&this.removeBackdropEventListeners()}removeBackdropEventListeners(){this.isEventListenerAdded=!1,this.backdrop.on("mousemove mouseover mouseout",null)}formatTooltipData(e){return e}showRuler(e,[i,n]){const s=this.parent,l=this.services.cartesianScales.getOrientation(),c=this.model.getDisplayData(),r=this.services.cartesianScales.getRangeScale(),[f,m]=r.range(),y=l===wa.HORIZONTAL?n:i,b=hi.appendOrSelect(s,"g.ruler").attr("aria-label","ruler"),E=hi.appendOrSelect(b,"line.ruler-line"),S=s.selectAll("[role=graphics-symbol]"),D=c.map(z=>({domainValue:this.services.cartesianScales.getDomainValue(z),originalData:z})).filter(z=>qH(z.domainValue,y));if(this.pointsWithinLine&&D.length===this.pointsWithinLine.length&&D.map(z=>z.domainValue).join()===this.pointsWithinLine.map(z=>z.domainValue).join())return this.pointsWithinLine=D,this.services.events.dispatchEvent(yt.Tooltip.MOVE,{mousePosition:[i,n]});this.pointsWithinLine=D;const R=this.pointsWithinLine.reduce((z,H)=>{if(z.length===0)return z.push(H),z;const K=z[0].domainValue,W=Math.abs(y-H.domainValue),se=Math.abs(y-K);return W>se||(W<se?z=[H]:z.push(H)),z},[]);if(R.length>0){const z=R.map(se=>se.originalData).filter(se=>{const Y=this.services.cartesianScales.getRangeIdentifier(se);return se[Y]!=null}),H=R.map(se=>se.domainValue),K=S.filter(se=>{const Y=this.services.cartesianScales.getDomainValue(se);return H.includes(Y)});this.elementsToHighlight&&this.elementsToHighlight.size()>0&&!aG(this.elementsToHighlight,K)&&this.hideRuler(),K.dispatch("mouseover"),this.elementsToHighlight=K,this.services.events.dispatchEvent(yt.Tooltip.SHOW,{mousePosition:[i,n],hoveredElement:E,data:this.formatTooltipData(z)}),b.attr("opacity",1);const W=R[0];l==="horizontal"?E.attr("x1",m).attr("x2",f).attr("y1",W.domainValue).attr("y2",W.domainValue):E.attr("y1",m).attr("y2",f).attr("x1",W.domainValue).attr("x2",W.domainValue)}else this.hideRuler()}hideRuler(){const e=this.parent,i=hi.appendOrSelect(e,"g.ruler");e.selectAll("[role=graphics-symbol]").dispatch("mouseout"),this.services.events.dispatchEvent(yt.Tooltip.HIDE),i.attr("opacity",0)}addBackdropEventListeners(){this.isEventListenerAdded=!0;const e=this,i=this.services.domUtils.getHolder(),n=this.model.getDisplayData();let s=function(l){const c=su(l,e.parent.node());e.showRuler(l,c)};if(n.length>100){const l=n.length%50*12.5;s=c9(function(c){const{mousePosition:r}=this;e.showRuler(c,r)},l,i)}this.backdrop.on("mousemove mouseover",s).on("mouseout",this.hideRuler.bind(this))}drawBackdrop(){const e=this.parent;this.backdrop=hi.appendOrSelect(e,"svg.chart-grid-backdrop")}}class Dm extends Nr{constructor(){super(...arguments),this.type="scatter",this.renderType=Yn.SVG,this.handleChartHolderOnHover=()=>{if(!this.parent)throw new Error("Parent not defined");this.parent.selectAll("circle.dot").transition("chart-holder-hover-scatter").call(e=>{var i;return(i=this.services.transitions)==null?void 0:i.setupTransition({transition:e,name:"chart-holder-hover-scatter"})}).attr("opacity",1)},this.handleChartHolderOnMouseOut=()=>{if(!this.parent)throw new Error("Parent not defined");this.parent.selectAll("circle.dot").transition("chart-holder-mouseout-scatter").call(e=>{var i;return(i=this.services.transitions)==null?void 0:i.setupTransition({transition:e,name:"chart-holder-mouseout-scatter"})}).attr("opacity",0)},this.handleLegendOnHover=e=>{const{hoveredElement:i}=e.detail,{groupMapsTo:n}=this.getOptions().data;if(!this.parent)throw new Error("Parent not defined");this.parent.selectAll("circle.dot").transition("legend-hover-scatter").call(s=>{var l;return(l=this.services.transitions)==null?void 0:l.setupTransition({transition:s,name:"legend-hover-scatter"})}).attr("opacity",s=>s[n]!==i.datum().name?.3:1)},this.handleLegendMouseOut=()=>{if(!this.parent)throw new Error("Parent not defined");this.parent.selectAll("circle.dot").transition("legend-mouseout-scatter").call(e=>{var i;return(i=this.services.transitions)==null?void 0:i.setupTransition({transition:e,name:"legend-mouseout-scatter"})}).attr("opacity",1)}}init(){const{events:e}=this.services;if(!e)throw new Error("Services events are undefined.");e.addEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.addEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut);const{fadeInOnChartHolderMouseover:i}=this.configs;i&&(e.addEventListener(yt.Chart.MOUSEOVER,this.handleChartHolderOnHover),e.addEventListener(yt.Chart.MOUSEOUT,this.handleChartHolderOnMouseOut))}filterBasedOnZoomDomain(e){const{cartesianScales:i}=this.services;if(!i)throw new Error("Services cartesianScales are undefined.");const n=i.getDomainIdentifier(e),s=this.model.get("zoomDomain");return s!==void 0?e.filter(l=>l[n].getTime()>=s[0].getTime()&&l[n].getTime()<=s[1].getTime()):e}getScatterData(){const e=this.getOptions(),{stacked:i}=this.configs;let n;if(i){const s=Object.keys(e.axes).some(l=>e.axes[l].percentage);n=this.model.getStackedData({groups:this.configs.groups,percentage:s})}else{const{cartesianScales:s}=this.services;if(!s)throw new Error("Services cartesianScales are undefined.");n=this.model.getDisplayData(this.configs.groups).filter(l=>{const c=s.getRangeIdentifier(l);return l[c]!==void 0&&l[c]!==null})}return this.filterBasedOnZoomDomain(n)}render(e){if(!(Ne(this.getOptions(),"points","enabled")||Ne(this.getOptions(),"bubble","enabled")))return;const i=this.getComponentContainer({withinChartClip:!0}),n=this.getOptions(),{groupMapsTo:s}=n.data,{cartesianScales:l}=this.services;if(!l)throw new Error("Services cartesianScales are undefined.");const c=l.getDomainIdentifier(),r=i.selectAll("circle.dot").data(this.getScatterData(),m=>`${m[s]}-${m[c]}`);r.exit().attr("opacity",0).remove();const f=r.enter().append("circle").classed("dot",!0).attr("opacity",0).merge(r);this.styleCircles(f,e),this.addEventListeners()}isDatapointThresholdAnomaly(e){const{handleThresholds:i}=this.configs;if(!i)return!1;const{cartesianScales:n}=this.services;if(!n)throw new Error("Cartesian scales service is undefined");const s=n.getOrientation(),[l,c]=ph(n.getHighestDomainThreshold(),n.getHighestRangeThreshold(),s),[r,f]=ph(b=>n.getDomainValue(b),b=>n.getRangeValue(b),s),m=r(e),y=f(e);return c&&l?y<=c.scaleValue&&m>=l.scaleValue:c?y<=c.scaleValue:l?m>=l.scaleValue:!1}styleCircles(e,i){const n=this.getOptions(),{filled:s,fillOpacity:l}=n.points,{cartesianScales:c}=this.services;if(!c)throw new Error("Cartesian scales service is undefined");const{groupMapsTo:r}=n.data,f=S=>c.getDomainValue(S),m=S=>c.getRangeValue(S),[y,b]=ph(f,m,c.getOrientation()),{fadeInOnChartHolderMouseover:E}=this.configs;e.raise().classed("dot",!0).attr("class",S=>{const D=c.getDomainIdentifier(S),R=this.model.getIsFilled(S[r],S[D],S,s)?[Cs.FILL,Cs.STROKE]:[Cs.STROKE];return this.model.getColorClassName({classNameTypes:R,dataGroupName:S[r],originalClassName:"dot"})||""}).classed("threshold-anomaly",S=>this.isDatapointThresholdAnomaly(S)).classed("filled",S=>{const D=c.getDomainIdentifier(S);return this.model.getIsFilled(S[r],S[D],S,s)}).classed("unfilled",S=>{const D=c.getDomainIdentifier(S);return!this.model.getIsFilled(S[r],S[D],S,s)}).transition().call(S=>{var D;return(D=this.services.transitions)==null?void 0:D.setupTransition({transition:S,name:"scatter-update-enter",animate:i})}).attr("cx",y).attr("cy",b).attr("r",n.points.radius).style("fill",S=>{const D=c.getDomainIdentifier(S);if(this.model.getIsFilled(S[r],S[D],S,s))return this.model.getFillColor(S[r],S[D],S)}).style("stroke",S=>{const D=c.getDomainIdentifier(S);return this.model.getStrokeColor(S[r],S[D],S)}).attr("fill-opacity",s?l:1).attr("opacity",E?0:1).attr("role",ts.GRAPHICS_SYMBOL).attr("aria-roledescription","point").attr("aria-label",S=>{const D=c.getRangeIdentifier(S);return S[D]}),this.addEventListeners()}getTooltipAdditionalItems(e){return null}addEventListeners(){const e=this,{groupMapsTo:i}=e.getOptions().data;if(!this.parent)throw new Error("Parent not defined");this.parent.selectAll("circle").on("mouseover",function(n,s){var l,c;const r=Jt(this);r.classed("hovered",!0).attr("class",f=>e.model.getColorClassName({classNameTypes:[Cs.FILL],dataGroupName:f[i],originalClassName:r.attr("class")})).style("fill",f=>{var m;const y=(m=e.services.cartesianScales)==null?void 0:m.getDomainIdentifier(f);return e.model.getFillColor(f[i],f[y],f)}).classed("unfilled",!1),(l=e.services.events)==null||l.dispatchEvent(yt.Tooltip.SHOW,{event:n,hoveredElement:r,data:[s],additionalItems:e.getTooltipAdditionalItems(s)}),(c=e.services.events)==null||c.dispatchEvent(yt.Scatter.SCATTER_MOUSEOVER,{event:n,element:r,datum:s})}).on("mousemove",function(n,s){var l,c;const r=Jt(this);(l=e.services.events)==null||l.dispatchEvent(yt.Scatter.SCATTER_MOUSEMOVE,{event:n,element:r,datum:s}),(c=e.services.events)==null||c.dispatchEvent(yt.Tooltip.MOVE,{event:n})}).on("click",function(n,s){var l;(l=e.services.events)==null||l.dispatchEvent(yt.Scatter.SCATTER_CLICK,{event:n,element:Jt(this),datum:s})}).on("mouseout",function(n,s){var l,c,r;const f=Jt(this);if(f.classed("hovered",!1),!e.configs.filled){const{filled:m}=e.getOptions().points,y=(l=e.services.cartesianScales)==null?void 0:l.getDomainIdentifier(s),b=e.model.getIsFilled(s[i],s[y],s,m);f.classed("unfilled",!b).style("fill",E=>b||m?e.model.getFillColor(E[i],E[y],E):null)}(c=e.services.events)==null||c.dispatchEvent(yt.Scatter.SCATTER_MOUSEOUT,{event:n,element:f,datum:s}),(r=e.services.events)==null||r.dispatchEvent(yt.Tooltip.HIDE,{hoveredElement:f})})}destroy(){var e;(e=this.parent)==null||e.selectAll("circle").on("mousemove",null).on("mouseout",null);const{events:i}=this.services;if(!i)throw new Error("Services events undefined");i.removeEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),i.removeEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut),i.removeEventListener(yt.Chart.MOUSEOVER,this.handleChartHolderOnHover),i.removeEventListener(yt.Chart.MOUSEOUT,this.handleChartHolderOnMouseOut)}}class QS extends Nr{constructor(e,i,n){super(e,i,n),this.type="axes",this.renderType=Yn.SVG,this.truncation={[Ft.LEFT]:!1,[Ft.RIGHT]:!1,[Ft.TOP]:!1,[Ft.BOTTOM]:!1},n&&(this.configs=n),this.margins=this.configs.margins}render(e=!0){const{position:i}=this.configs,n=this.getOptions(),s=Ne(n,"axes",i,"visible"),l=this.getComponentContainer(),{width:c,height:r}=hi.getSVGElementSize(l,{useAttrs:!0}),f=hi.appendOrSelect(l,`g.axis.${i}`);let m,y;if(i===Ft.BOTTOM||i===Ft.TOP?(m=this.configs.axes[Ft.LEFT]?this.margins.left:0,y=this.configs.axes[Ft.RIGHT]?c-this.margins.right:c):(m=r-this.margins.bottom,y=this.margins.top),!this.services.cartesianScales)throw new Error("Services cartesianScales undefined");const b=this.services.cartesianScales.getScaleByPosition(i);this.scaleType===Hi.LABELS||this.scaleType===Hi.LABELS_RATIO?b.rangeRound([m,y]):b.range([m,y]);let E;switch(i){case Ft.LEFT:E=xE;break;case Ft.BOTTOM:E=bE;break;case Ft.RIGHT:E=bL;break;case Ft.TOP:E=vL;break}f.attr("aria-label",`${i} axis`);const S=!f.select("g.ticks").empty();let D=hi.appendOrSelect(f,"g.ticks");S||(D.attr("role",`${ts.GRAPHICS_OBJECT} ${ts.GROUP}`),D.attr("aria-label",`${i} ticks`));const R=hi.appendOrSelect(f,"g.ticks.invisible").style("opacity","0").style("pointer-events","none").attr("aria-hidden",!0).attr("aria-label",`invisible ${i} ticks`),z=Ne(n,"axes",i),H=this.scaleType===Hi.TIME||z.scaleType===Hi.TIME,K=i===Ft.LEFT||i===Ft.RIGHT,W=this.model.get("zoomDomain");if(W&&H&&!K&&b.domain(W),!s){D.attr("aria-hidden",!0);return}const se=Ne(z,"scaleType"),Y=Ne(n,"data","loading"),ne=Ne(z,"ticks","number"),ue=Ne(z,"ticks","values"),ve=Ne(z,"truncation","type"),_e=Ne(z,"truncation","threshold"),oe=Ne(z,"truncation","numCharacter"),Be=ne!==null,mt=Ne(n,"timeScale"),Le=hi.appendOrSelect(R,"g.tick"),rt=hi.appendOrSelect(Le,"text").text("0"),tt=hi.getSVGElementSize(rt.node(),{useBBox:!0}).height;Le.remove();const We=this.scaleType||z.scaleType||Hi.LINEAR,Ve=E(b).tickSizeOuter(0);if(b.ticks){let qe;if(Be?qe=ne:(qe=Ac.ticks.number,K&&(qe=this.getNumberOfFittingTicks(r,tt,Ac.ticks.verticalSpaceRatio))),b.ticks().length===1&&b.ticks()[0]===0&&(qe=0),Ve.ticks(qe),H)if(!b.ticks(qe).length)Ve.tickValues([]);else{const Ht=Ne(n,"timeScale","addSpaceOnEdges"),lt=Ne(n,"axes",i,"domain"),Gt=b.copy();Ht&&!lt&&Gt.nice(qe);const Mi=Gt.ticks(qe);Ht&&Mi.length>2&&!lt&&(Mi.splice(Mi.length-1,1),Mi.splice(0,1)),Ve.tickValues(Mi)}}let St;const zt=Ne(z,"ticks","formatter");if(H){const qe=i0(Ve.tickValues(),Ne(n,"timeScale","timeInterval"));zt===null?St=(Ht,lt)=>t0(Ht,lt,Ve.tickValues(),qe,mt):St=(Ht,lt)=>{const Gt=t0(Ht,lt,Ve.tickValues(),qe,mt);return zt(Ht,lt,Gt)}}else zt===null?We===Hi.LINEAR&&(St=qe=>qe.toLocaleString()):St=zt;Ve.tickFormat(St);const[mi,vt]=this.services.cartesianScales.getScaleByPosition(i).domain();let pt;if(ue){if(H)ue.forEach((qe,Ht)=>{qe.getTime===void 0&&(ue[Ht]=new Date(qe))}),pt=ue.filter(qe=>{const Ht=qe.getTime();return Ht>=new Date(mi).getTime()&&Ht<=new Date(vt).getTime()});else if(se===Hi.LABELS){const qe=this.services.cartesianScales.getScaleByPosition(i).domain();pt=ue.filter(Ht=>qe.includes(Ht))}else pt=ue.filter(qe=>qe>=mi&&qe<=vt);Ve.tickValues(pt)}switch(i){case Ft.LEFT:D.attr("transform",`translate(${this.margins.left}, 0)`);break;case Ft.BOTTOM:D.attr("transform",`translate(0, ${r-this.margins.bottom})`);break;case Ft.RIGHT:D.attr("transform",`translate(${c-this.margins.right}, 0)`);break;case Ft.TOP:D.attr("transform",`translate(0, ${this.margins.top})`);break}const Pt=this.model.isDataEmpty();if(z.title){const qe=hi.appendOrSelect(f,"text.axis-title").html(Pt||Y?"":Xo(z.title)),Ht=Ne(z,"titleOrientation");let lt;switch(i){case Ft.LEFT:Ht===D_.RIGHT?qe.attr("transform","rotate(90)").attr("y",0).attr("x",b.range()[0]/2).attr("dy","-0.5em").style("text-anchor","middle"):qe.attr("transform","rotate(-90)").attr("y",0).attr("x",-(b.range()[0]/2)).attr("dy","0.75em").style("text-anchor","middle");break;case Ft.BOTTOM:qe.attr("transform",`translate(${this.margins.left/2+b.range()[1]/2}, ${r+4})`).style("text-anchor","middle");break;case Ft.RIGHT:Ht===D_.LEFT?qe.attr("transform","rotate(-90)").attr("y",c).attr("x",-(b.range()[0]/2)).style("text-anchor","middle"):qe.attr("transform","rotate(90)").attr("y",-c).attr("x",b.range()[0]/2).attr("dy","0.75em").style("text-anchor","middle");break;case Ft.TOP:lt=hi.getSVGElementSize(qe,{useBBox:!0}).height,qe.attr("transform",`translate(${this.margins.left/2+b.range()[1]/2}, ${lt/2})`).style("text-anchor","middle");break}}if(H){const qe=i0(Ve.tickValues(),Ne(n,"timeScale","timeInterval")),Ht=mt.showDayName,lt=D;e&&(D=D.transition().call(Gt=>this.services.transitions.setupTransition({transition:Gt,name:"axis-update",animate:e}))),D=D.call(Ve),lt.selectAll(".tick").data(Ve.tickValues(),b).order().select("text").style("font-weight",(Gt,Mi)=>xS(Gt,Mi,Ve.tickValues(),qe,Ht)?"bold":"normal")}else!e||!S?D=D.call(Ve):D=D.transition().call(qe=>this.services.transitions.setupTransition({transition:qe,name:"axis-update",animate:e})).call(Ve);if(R.call(Ve),i===Ft.BOTTOM||i===Ft.TOP){let qe=!1;const Ht=Ne(z,"ticks","rotation");if(Ht===vm.ALWAYS)qe=!0;else if(Ht===vm.NEVER)qe=!1;else if(!Ht||Ht===vm.AUTO)if(b.step)qe=R.selectAll("g.tick text").nodes().some(lt=>hi.getSVGElementSize(lt,{useBBox:!0}).width>=b.step());else{qe=!1;const lt=R.append("text").text("A"),Gt=hi.getSVGElementSize(lt.node(),{useBBox:!0}).width;let Mi;R.selectAll("g.tick").each(function(){const bt=Jt(this),ze=parseFloat(Ne(Sl(this),"tx"));ze!==null&&Mi+bt.text().length*Gt*.8>=ze&&(qe=!0),Mi=ze}),lt.remove()}qe?(Be||(Ve.ticks(this.getNumberOfFittingTicks(c,tt,Ac.ticks.horizontalSpaceRatio)),R.call(Ve),D.call(Ve)),f.selectAll("g.ticks g.tick text").attr("transform","rotate(-45)").attr("text-anchor",i===Ft.TOP?"start":"end")):f.selectAll("g.ticks g.tick text").attr("transform",null).attr("text-anchor",null)}if(Y?f.attr("opacity",0):f.attr("opacity",1),D.selectAll("g.tick").attr("aria-label",qe=>qe),R.selectAll("g.tick").attr("aria-label",qe=>qe),ve!==Io.NONE&&se===Hi.LABELS&&!ue){const qe=this.services.cartesianScales.getScaleDomain(i);if(qe.length>0){const Ht=l.select(`g.axis.${i} g.ticks g.tick`).html();f.selectAll("g.ticks g.tick").html(Ht);const lt=this;f.selectAll("g.tick text").data(qe).text(function(Gt){return Gt.length>_e?(lt.truncation[i]=!0,of(Gt,ve,oe)):Gt}),this.getInvisibleAxisRef().selectAll("g.tick text").data(qe).text(function(Gt){return Gt.length>_e?of(Gt,ve,oe):Gt}),f.selectAll("g.ticks").html(this.getInvisibleAxisRef().html()),f.selectAll("g.tick text").data(qe)}}this.addEventListeners()}addEventListeners(){const e=this.getComponentContainer(),{position:i}=this.configs,n=hi.appendOrSelect(e,`g.axis.${i}`),s=this.getOptions(),l=Ne(s,"axes",i),c=Ne(l,"scaleType"),r=Ne(l,"truncation","threshold"),f=this;n.selectAll("g.tick text").on("mouseover",function(m,y){f.services.events.dispatchEvent(yt.Axis.LABEL_MOUSEOVER,{event:m,element:Jt(this),datum:y}),c===Hi.LABELS&&y.length>r&&f.services.events.dispatchEvent(yt.Tooltip.SHOW,{event:m,hoveredElement:Jt(this),content:y})}).on("mousemove",function(m,y){f.services.events.dispatchEvent(yt.Axis.LABEL_MOUSEMOVE,{event:m,element:Jt(this),datum:y}),c===Hi.LABELS&&y.length>r&&f.services.events.dispatchEvent(yt.Tooltip.MOVE,{event:m})}).on("click",function(m,y){f.services.events.dispatchEvent(yt.Axis.LABEL_CLICK,{event:m,element:Jt(this),datum:y})}).on("mouseout",function(m,y){f.services.events.dispatchEvent(yt.Axis.LABEL_MOUSEOUT,{event:m,element:Jt(this),datum:y}),c===Hi.LABELS&&f.services.events.dispatchEvent(yt.Tooltip.HIDE)})}getInvisibleAxisRef(){const{position:e}=this.configs;return this.getComponentContainer().select(`g.axis.${e} g.ticks.invisible`)}getTitleRef(){const{position:e}=this.configs;return this.getComponentContainer().select(`g.axis.${e} text.axis-title`)}getNumberOfFittingTicks(e,i,n){const s=Math.floor(e/(i*n));return sG(s,2,Ac.ticks.number)}destroy(){const e=this.getComponentContainer(),{position:i}=this.configs;hi.appendOrSelect(e,`g.axis.${i}`).selectAll("g.tick text").on("mouseover",null).on("mousemove",null).on("mouseout",null)}}class WH extends QS{constructor(e,i,n){super(e,i,n)}render(e=!0){super.render(e),super.destroy();const i=this.configs.position,n=this.getComponentContainer(),s=hi.appendOrSelect(n,`g.axis.${i}`),l=this;s.selectAll("g.tick").each(function(c,r){const f=Jt(this);f.classed("tick-hover",!0).attr("tabindex",r===0?0:-1);const m=f.select("text"),{width:y,height:b}=hi.getSVGElementSize(m,{useBBox:!0}),E=hi.appendOrSelect(f,"rect.axis-holder");let S=0,D=0;switch(i){case Ft.LEFT:S=-y+Number(m.attr("x")),D=-(b/2);break;case Ft.RIGHT:S=Math.abs(Number(m.attr("x"))),D=-(b/2);break;case Ft.TOP:S=-(y/2),D=-b+Number(m.attr("y"))/2,l.truncation[i]&&(S=0,E.attr("transform","rotate(-45)"));break;case Ft.BOTTOM:S=-(y/2),D=b/2-2,l.truncation[i]&&(S=-y,E.attr("transform","rotate(-45)"));break}E.attr("x",S-Ac.hover.rectanglePadding).attr("y",D).attr("width",y+Ac.hover.rectanglePadding*2).attr("height",b).lower()}),this.addEventListeners()}addEventListeners(){const e=this.getComponentContainer(),{position:i}=this.configs,n=hi.appendOrSelect(e,`g.axis.${i}`),s=this.getOptions(),l=Ne(s,"axes",i),c=Ne(l,"scaleType"),r=Ne(l,"truncation","threshold"),f=this;n.selectAll("g.tick.tick-hover").on("mouseover",function(m){const y=Jt(this).select("text"),b=y.datum();f.services.events.dispatchEvent(yt.Axis.LABEL_MOUSEOVER,{event:m,element:y,datum:b}),c===Hi.LABELS&&b.length>r&&f.services.events.dispatchEvent(yt.Tooltip.SHOW,{event:m,element:y,datum:b})}).on("mousemove",function(m){const y=Jt(this).select("text"),b=y.datum();f.services.events.dispatchEvent(yt.Axis.LABEL_MOUSEMOVE,{event:m,element:y,datum:b}),f.services.events.dispatchEvent(yt.Tooltip.MOVE,{event:m})}).on("click",function(m){f.services.events.dispatchEvent(yt.Axis.LABEL_CLICK,{event:m,element:Jt(this).select("text"),datum:Jt(this).select("text").datum()})}).on("mouseout",function(m){f.services.events.dispatchEvent(yt.Axis.LABEL_MOUSEOUT,{event:m,element:Jt(this).select("text"),datum:Jt(this).select("text").datum()}),c===Hi.LABELS&&f.services.events.dispatchEvent(yt.Tooltip.HIDE)}).on("focus",function(m){const y={clientX:0,clientY:0};if(m.target){m.target.focus();const b=m.target.getBoundingClientRect();y.clientX=b.x,y.clientY=b.y}f.services.events.dispatchEvent(yt.Axis.LABEL_FOCUS,{event:{...m,...y},element:Jt(this),datum:Jt(this).select("text").datum()})}).on("blur",function(m){f.services.events.dispatchEvent(yt.Axis.LABEL_BLUR,{event:m,element:Jt(this),datum:Jt(this).select("text").datum()})}).on("keydown",function(m){m.key&&m.key==="Escape"&&(f.services.events.dispatchEvent(yt.Tooltip.HIDE),f.services.events.dispatchEvent(yt.Axis.LABEL_BLUR,{event:m,element:Jt(this),datum:Jt(this).select("text").datum()})),i===Ft.LEFT||i===Ft.RIGHT?m.key&&m.key==="ArrowUp"?f.goNext(this,m):m.key&&m.key==="ArrowDown"&&f.goPrevious(this,m):m.key&&m.key==="ArrowLeft"?f.goPrevious(this,m):m.key&&m.key==="ArrowRight"&&f.goNext(this,m)})}goNext(e,i){e.nextElementSibling&&e.nextElementSibling.tagName!=="path"&&e.nextElementSibling.dispatchEvent(new Event("focus")),i.preventDefault()}goPrevious(e,i){e.previousElementSibling&&e.previousElementSibling.tagName!=="path"&&e.previousElementSibling.dispatchEvent(new Event("focus")),i.preventDefault()}destroy(){const e=this.getComponentContainer(),{position:i}=this.configs;hi.appendOrSelect(e,`g.axis.${i}`).selectAll("g.tick.tick-hover").on("mouseover",null).on("mousemove",null).on("mouseout",null).on("focus",null).on("blur",null)}}class YH extends Nr{constructor(){super(...arguments),this.type="2D-axes",this.renderType=Yn.SVG,this.children={},this.thresholds=[],this.margins={top:0,right:0,bottom:0,left:0}}render(e=!1){const i={},n=Object.keys(Ft),s=Ne(this.getOptions(),"axes");n.forEach(c=>{s[Ft[c]]&&(i[Ft[c]]=!0)}),this.configs.axes=i,n.forEach(c=>{const r=Ft[c];if(this.configs.axes[r]&&!this.children[r]){const f={position:r,axes:this.configs.axes,margins:this.margins},m=this.model.axisFlavor===R0.DEFAULT?new QS(this.model,this.services,f):new WH(this.model,this.services,f);m.setModel(this.model),m.setServices(this.services),m.setParent(this.parent),this.children[r]=m}}),Object.keys(this.children).forEach(c=>{this.children[c].render(e)});const l={};Object.keys(this.children).forEach(c=>{const r=this.children[c],f=r.configs.position,m=r.getInvisibleAxisRef(),{width:y,height:b}=hi.getSVGElementSize(m,{useBBox:!0});let E;switch(r.getTitleRef().empty()?E=0:(E=hi.getSVGElementSize(r.getTitleRef(),{useBBox:!0}).height,(f===Ft.LEFT||f===Ft.RIGHT)&&(E+=5)),f){case Ft.TOP:l.top=b+E;break;case Ft.BOTTOM:l.bottom=b+E;break;case Ft.LEFT:l.left=y+E;break;case Ft.RIGHT:l.right=y+E;break}}),this.services.events.dispatchEvent(yt.Axis.RENDER_COMPLETE),Object.keys(l).some(c=>this.margins[c]!==l[c])&&(this.margins=Object.assign(this.margins,l),this.model.set({axesMargins:this.margins},{skipUpdate:!0}),this.services.events.dispatchEvent(yt.ZoomBar.UPDATE),Object.keys(this.children).forEach(c=>{const r=this.children[c];r.margins=this.margins}),this.render(!0))}}class JH extends Nr{constructor(){super(...arguments),this.type="skeleton"}render(e=!0){const i=Ne(this.getOptions(),"data","loading");i?this.renderSkeleton(i):this.removeSkeleton()}renderSkeleton(e){if(this.configs.skeleton===rh.GRID)this.renderGridSkeleton(e);else if(this.configs.skeleton===rh.VERT_OR_HORIZ)this.renderVertOrHorizSkeleton(e);else if(this.configs.skeleton===rh.PIE)this.renderPieSkeleton(e);else if(this.configs.skeleton===rh.DONUT)this.renderDonutSkeleton(e);else throw new Error(`"${this.configs.skeleton}" is not a valid Skeleton type.`)}renderGridSkeleton(e){this.setScales(),this.drawBackdrop(e),this.drawXGrid(e),this.drawYGrid(e),e&&this.setShimmerEffect("shimmer-lines")}renderVertOrHorizSkeleton(e){const i=this.services.cartesianScales.getOrientation();this.setScales(),this.drawBackdrop(e),i===wa.VERTICAL&&this.drawYGrid(e),i===wa.HORIZONTAL&&this.drawXGrid(e),this.setShimmerEffect("shimmer-lines")}renderPieSkeleton(e){const i=this.computeOuterRadius();this.drawRing(i,0,e),e&&this.setShimmerEffect("shimmer-areas")}renderDonutSkeleton(e){const i=this.computeOuterRadius(),n=this.computeInnerRadius();this.drawRing(i,n,e),e&&this.setShimmerEffect("shimmer-areas")}setScales(){const e=this.services.cartesianScales.getMainXScale().range(),i=this.services.cartesianScales.getMainYScale().range();this.xScale=Ym().domain([0,1]).range(e),this.yScale=Ym().domain([0,1]).range(i)}drawBackdrop(e){const i=this.parent,{width:n,height:s}=hi.getSVGElementSize(i,{useAttrs:!0});this.backdrop=hi.appendOrSelect(i,"svg.chart-skeleton.DAII").attr("width",n).attr("height",s);const l=hi.appendOrSelect(this.backdrop,"rect.chart-skeleton-backdrop");l.attr("width","100%").attr("height","100%");const[c]=this.xScale.range(),[,r]=this.yScale.range();this.backdrop.merge(l).attr("x",c).attr("y",r),l.classed("shimmer-effect-lines",e).classed("empty-state-lines",!e).style("stroke",e?`url(#${this.services.domUtils.generateElementIDString("shimmer-lines")})`:null)}drawXGrid(e){const i=+this.backdrop.attr("width"),n=Ne(this.getOptions(),"grid","x","numberOfTicks"),s=this.xScale.ticks(n).map(r=>r*i),l=hi.appendOrSelect(this.backdrop,"g.x.skeleton"),c=l.selectAll("line").data(s);c.enter().append("line").merge(c).attr("x1",r=>r).attr("x2",r=>r).attr("y1",0).attr("y2","100%"),l.selectAll("line").classed("shimmer-effect-lines",e).classed("empty-state-lines",!e).style("stroke",e?`url(#${this.services.domUtils.generateElementIDString("shimmer-lines")})`:null)}drawYGrid(e){const i=+this.backdrop.attr("height"),n=this.backdrop.attr("width"),s=Ne(this.getOptions(),"grid","y","numberOfTicks"),l=this.xScale.ticks(s).map(f=>f*i),c=hi.appendOrSelect(this.backdrop,"g.y.skeleton"),r=c.selectAll("line").data(l);r.enter().append("line").merge(r).attr("x1",0).attr("x2",n).attr("y1",f=>f).attr("y2",f=>f),c.selectAll("line").classed("shimmer-effect-lines",e).classed("empty-state-lines",!e).style("stroke",e?`url(#${this.services.domUtils.generateElementIDString("shimmer-lines")})`:null)}drawRing(e,i,n=!0){const s=this.parent,{width:l,height:c}=hi.getSVGElementSize(s,{useAttrs:!0}),r=hi.appendOrSelect(s,"svg.chart-skeleton").attr("width",l).attr("height",c),f=i===0?"pie":"donut",m=Ne(this.getOptions(),f,"alignment");hi.appendOrSelect(r,"rect.chart-skeleton-area-container").attr("width",l).attr("height",c).attr("fill","none");const y=QN().innerRadius(i).outerRadius(e).startAngle(0).endAngle(Math.PI*2),b=e+Math.abs(Sd.radiusOffset),E=e+(Math.min(l,c)-e*2)/2,S=hi.appendOrSelect(r,"path").attr("class","skeleton-area-shape").attr("transform",`translate(${b}, ${E})`).attr("d",y).classed("shimmer-effect-areas",n).classed("empty-state-areas",!n).style("fill",n?`url(#${this.services.domUtils.generateElementIDString("shimmer-areas")})`:null);let D=e+Sd.xOffset;m===Oo.CENTER?D=l/2:m===Oo.RIGHT&&(D=l-e-Sd.xOffset);const R=e+Sd.yOffset;S.attr("transform",`translate(${D}, ${R})`)}computeOuterRadius(){const{width:e,height:i}=hi.getSVGElementSize(this.parent,{useAttrs:!0});return Math.min(e,i)/2+Sd.radiusOffset}computeInnerRadius(){return this.computeOuterRadius()*(3/4)}setShimmerEffect(e){const i="stop-bg-shimmer",n="stop-shimmer",s=this.parent.select(".chart-skeleton"),{width:l}=hi.getSVGElementSize(this.parent,{useAttrs:!0}),c=0,r=l,f=hi.appendOrSelect(s,"defs").lower(),m=hi.appendOrSelect(f,"linearGradient").attr("id",this.services.domUtils.generateElementIDString(e)).attr("class",e).attr("x1",c-3*.2*l).attr("x2",r).attr("y1",0).attr("y2",0).attr("gradientUnits","userSpaceOnUse").attr("gradientTransform","translate(0, 0)"),y=`
			<stop class="${i}" offset="${c}"></stop>
			<stop class="${n}" offset="${c+.2}"></stop>
			<stop class="${i}" offset="${c+2*.2}"></stop>
		`;m.html(y),b();function b(){m.attr("gradientTransform",`translate(${c-3*.2*l}, 0)`).transition().duration(2e3).delay(1e3).ease(V7).attr("gradientTransform",`translate(${r+3*.2*l}, 0)`).on("end",b)}}removeSkeleton(){this.parent.select(".chart-skeleton").remove()}}class $S extends Nr{constructor(){super(...arguments),this.type="zero-line",this.renderType=Yn.SVG}render(e){const i=this.services.cartesianScales.getRangeAxisPosition({groups:this.configs.groups}),n=this.services.cartesianScales.getScaleByPosition(i),[s,l]=n.domain(),c=s>0&&l<0||s<0&&l>0,r=this.getComponentContainer();if(!c){r.selectAll("line.domain").remove();return}const[f,m]=this.services.cartesianScales.getDomainScale().range();let y=+n(0)+.5;y||(y=n.range()[0]);const b=dS({x0:f,x1:m,y0:y,y1:y},this.services.cartesianScales.getOrientation());hi.appendOrSelect(r,"line.domain").transition().call(E=>this.services.transitions.setupTransition({transition:E,name:"zero-line-update",animate:e})).attr("y1",b.y0).attr("y2",b.y1).attr("x1",b.x0).attr("x2",b.x1)}}class X2 extends ZH{formatTooltipData(e){return e.reverse()}}class ky extends Nr{getBarWidth(){const e=this.getOptions();if(e.bars.width)return e.bars.width;const i=this.model.getDisplayData().length,n=this.services.cartesianScales.getMainXScale(),s=hi.getSVGElementSize(this.parent,{useAttrs:!0}).width;if(!n.step){const l=Ne(e,"bars","spacingFactor");return Math.min(e.bars.maxWidth,s*l/i)}return Math.min(e.bars.maxWidth,n.step()/2)}isOutsideZoomedDomain(e,i){if(this.model.getDisplayData().length<=1)return!1;const n=this.model.get("zoomDomain");if(n!==void 0){const s=this.services.cartesianScales.getDomainScale();return e<s(n[0])||i>s(n[1])}return!1}}class XH extends ky{constructor(){super(...arguments),this.type="grouped-bar",this.renderType=Yn.SVG,this.padding=5,this.defaultStepFactor=70,this.handleLegendOnHover=e=>{const{hoveredElement:i}=e.detail,{groupMapsTo:n}=this.getOptions().data;this.parent.selectAll("path.bar").transition("legend-hover-bar").call(s=>this.services.transitions.setupTransition({transition:s,name:"legend-hover-bar"})).attr("opacity",s=>s[n]!==i.datum().name?.3:1)},this.handleLegendMouseOut=()=>{this.parent.selectAll("path.bar").transition("legend-mouseout-bar").call(e=>this.services.transitions.setupTransition({transition:e,name:"legend-mouseout-bar"})).attr("opacity",1)}}init(){const e=this.services.events;e.addEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.addEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}render(e){const i=this.model.getDisplayData(this.configs.groups),n=this.getOptions(),{groupMapsTo:s}=n.data;this.setGroupScale();const l=this.getComponentContainer({withinChartClip:!0}),c=af(i.map(y=>{const b=this.services.cartesianScales.getDomainIdentifier(y);return y[b]&&typeof y[b].toString=="function"?y[b].toString():y[b]})),r=l.selectAll("g.bars").data(c,y=>y);r.exit().attr("opacity",0).remove();const f=r.enter().append("g").classed("bars",!0).attr("role",ts.GROUP).attr("data-name","bars").merge(r);f.transition().call(y=>this.services.transitions.setupTransition({transition:y,name:"bar-group-update-enter",animate:e})).attr("transform",y=>{const b=this.services.cartesianScales.getDomainValue(y)-this.getGroupWidth()/2;return this.services.cartesianScales.getOrientation()===wa.VERTICAL?`translate(${b}, 0)`:`translate(0, ${b})`});const m=f.selectAll("path.bar").data(y=>this.getDataCorrespondingToLabel(y),y=>y[s]);m.exit().attr("opacity",0).remove(),m.enter().append("path").attr("opacity",0).merge(m).classed("bar",!0).transition().call(y=>this.services.transitions.setupTransition({transition:y,name:"bar-update-enter",animate:e})).attr("class",y=>this.model.getColorClassName({classNameTypes:[Cs.FILL],dataGroupName:y[s],originalClassName:"bar"})).style("fill",y=>this.model.getFillColor(y[s])).attr("d",y=>{const b=this.groupScale(y[s]),E=this.getBarWidth(),S=b,D=b+E,R=this.services.cartesianScales.getRangeAxisPosition({datum:y}),z=this.services.cartesianScales.getValueThroughAxisPosition(R,0),H=this.services.cartesianScales.getRangeValue(y),K=this.services.cartesianScales.getDomainValue(y)-E/2,W=K+E;if(!this.isOutsideZoomedDomain(K,W))return Ey({x0:S,x1:D,y0:z,y1:H},this.services.cartesianScales.getOrientation())}).attr("opacity",1).attr("role",ts.GRAPHICS_SYMBOL).attr("aria-roledescription","bar").attr("aria-label",y=>y.value),this.addEventListeners()}addEventListeners(){const e=this;this.parent.selectAll("path.bar").on("mouseover",function(i,n){const s=Jt(this);s.classed("hovered",!0),e.services.events.dispatchEvent(yt.Bar.BAR_MOUSEOVER,{event:i,element:s,datum:n}),e.services.events.dispatchEvent(yt.Tooltip.SHOW,{event:i,hoveredElement:s,data:[n]})}).on("mousemove",function(i,n){const s=Jt(this);e.services.events.dispatchEvent(yt.Bar.BAR_MOUSEMOVE,{event:i,element:s,datum:n}),e.services.events.dispatchEvent(yt.Tooltip.MOVE,{event:i})}).on("click",function(i,n){e.services.events.dispatchEvent(yt.Bar.BAR_CLICK,{event:i,element:Jt(this),datum:n})}).on("mouseout",function(i,n){const s=Jt(this);s.classed("hovered",!1),e.services.events.dispatchEvent(yt.Bar.BAR_MOUSEOUT,{event:i,element:s,datum:n}),e.services.events.dispatchEvent(yt.Tooltip.HIDE,{hoveredElement:s})})}destroy(){this.parent.selectAll("path.bar").on("mouseover",null).on("mousemove",null).on("mouseout",null);const e=this.services.events;e.removeEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.removeEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}getDataCorrespondingToLabel(e){return this.model.getDisplayData(this.configs.groups).filter(i=>{const n=this.services.cartesianScales.getDomainIdentifier(i);return i[n].toString()===e})}getGroupWidth(){const e=this.model.getGroupedData(this.configs.groups),i=this.getTotalGroupPadding();return this.getBarWidth()*e.length+i}getDomainScaleStep(){const e=this.services.cartesianScales.getDomainScale(),i=this.model.getGroupedData(this.configs.groups);let n=this.defaultStepFactor;if(typeof e.step=="function")n=e.step();else if(i.length>0){const s=i.find(l=>{var c;return((c=l.data)==null?void 0:c.length)>1});if(s){const l=this.services.cartesianScales.getDomainIdentifier(s.data[0]);n=Math.abs(e(s.data[1][l])-e(s.data[0][l]))}}return n}getTotalGroupPadding(){const e=this.model.getGroupedData(this.configs.groups);return e.length===1?0:Math.min(5,5*(this.getDomainScaleStep()/this.defaultStepFactor))*(e.length-1)}getBarWidth(){const e=this.getOptions(),i=Ne(e,"bars","width"),n=Ne(e,"bars","maxWidth");if(i!==null&&(n===null||i<=n))return i;const s=this.model.getGroupedData(this.configs.groups).length,l=this.getTotalGroupPadding();return Math.min(n,(this.getDomainScaleStep()-l)/s)}setGroupScale(){const e=this.model.getActiveDataGroupNames(this.configs.groups);this.groupScale=q0().domain(e).rangeRound([0,this.getGroupWidth()])}}class eI extends ky{constructor(){super(...arguments),this.type="simple-bar",this.renderType=Yn.SVG,this.handleLegendOnHover=e=>{const{hoveredElement:i}=e.detail,{groupMapsTo:n}=this.getOptions().data;this.parent.selectAll("path.bar").transition("legend-hover-simple-bar").call(s=>this.services.transitions.setupTransition({transition:s,name:"legend-hover-simple-bar"})).attr("opacity",s=>s[n]!==i.datum().name?.3:1)},this.handleLegendMouseOut=()=>{this.parent.selectAll("path.bar").transition("legend-mouseout-simple-bar").call(e=>this.services.transitions.setupTransition({transition:e,name:"legend-mouseout-simple-bar"})).attr("opacity",1)}}init(){const e=this.services.events;e.addEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.addEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}render(e){const i=this.getOptions(),{groupMapsTo:n}=i.data,s=this.getComponentContainer({withinChartClip:!0}),l=this.model.getDisplayData(this.configs.groups),c=this.services.cartesianScales.getOrientation(),r=s.selectAll("path.bar").data(l,f=>f[n]);r.exit().attr("opacity",0).remove(),r.enter().append("path").attr("opacity",0).merge(r).classed("bar",!0).attr("width",this.getBarWidth.bind(this)).transition().call(f=>this.services.transitions.setupTransition({transition:f,name:"bar-update-enter",animate:e})).attr("class",f=>this.model.getColorClassName({classNameTypes:[Cs.FILL],dataGroupName:f[n],originalClassName:"bar"})).style("fill",f=>this.model.getFillColor(f[n])).attr("d",f=>{const m=this.services.cartesianScales.getRangeIdentifier(),y=this.getBarWidth(),b=f[m],E=this.services.cartesianScales.getDomainValue(f)-y/2,S=E+y;let D,R;if(Array.isArray(b)&&b.length===2)D=this.services.cartesianScales.getRangeValue(b[0]),R=this.services.cartesianScales.getRangeValue(b[1]);else{const H=this.services.cartesianScales.getRangeScale().domain()[0];D=this.services.cartesianScales.getRangeValue(Math.max(0,H)),R=this.services.cartesianScales.getRangeValue(f)}const z=Math.abs(R-D);if(z!==0&&z<2&&(b>0&&c===wa.VERTICAL||b<0&&c===wa.HORIZONTAL?R=D-2:R=D+2),!this.isOutsideZoomedDomain(E,S))return Ey({x0:E,x1:S,y0:D,y1:R},c)}).attr("opacity",1).attr("role",ts.GRAPHICS_SYMBOL).attr("aria-roledescription","bar").attr("aria-label",f=>f.value),this.addEventListeners()}addEventListeners(){const e=this;this.parent.selectAll("path.bar").on("mouseover",function(i,n){const s=Jt(this);s.classed("hovered",!0),e.services.events.dispatchEvent(yt.Bar.BAR_MOUSEOVER,{event:i,element:s,datum:n}),e.services.events.dispatchEvent(yt.Tooltip.SHOW,{event:i,hoveredElement:s,data:[n]})}).on("mousemove",function(i,n){e.services.events.dispatchEvent(yt.Bar.BAR_MOUSEMOVE,{event:i,element:Jt(this),datum:n}),e.services.events.dispatchEvent(yt.Tooltip.MOVE,{event:i})}).on("click",function(i,n){e.services.events.dispatchEvent(yt.Bar.BAR_CLICK,{event:i,element:Jt(this),datum:n})}).on("mouseout",function(i,n){const s=Jt(this);s.classed("hovered",!1),e.services.events.dispatchEvent(yt.Bar.BAR_MOUSEOUT,{event:i,element:s,datum:n}),e.services.events.dispatchEvent(yt.Tooltip.HIDE,{hoveredElement:s})})}destroy(){this.parent.selectAll("path.bar").on("mouseover",null).on("mousemove",null).on("mouseout",null);const e=this.services.events;e.removeEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.removeEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}}class QH extends Nr{constructor(){super(...arguments),this.type="area-stacked",this.renderType=Yn.SVG,this.handleLegendOnHover=e=>{const{hoveredElement:i}=e.detail,n=this.getOptions(),{groupMapsTo:s}=n.data;this.parent.selectAll("path.area").transition("legend-hover-area").call(l=>this.services.transitions.setupTransition({transition:l,name:"legend-hover-area"})).attr("opacity",l=>Ne(l,0,s)!==i.datum().name?Il.opacity.unselected:Il.opacity.selected)},this.handleLegendMouseOut=()=>{this.parent.selectAll("path.area").transition("legend-mouseout-area").call(e=>this.services.transitions.setupTransition({transition:e,name:"legend-mouseout-area"})).attr("opacity",Il.opacity.selected)}}init(){const e=this.services.events;e.addEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.addEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}render(e=!0){const i=this.getComponentContainer({withinChartClip:!0}),n=this,s=this.getOptions(),{groupMapsTo:l}=s.data,c=Object.keys(s.axes).some(S=>s.axes[S].percentage),r=this.model.getStackedData({percentage:c,groups:this.configs.groups}),f=Ne(r,0,0),m=this.services.cartesianScales.getDomainAxisPosition({datum:f}),y=this.services.cartesianScales.getRangeAxisPosition({datum:f}),b=this.services.cartesianScales.getScaleByPosition(y),E=i.selectAll("path.area").data(r,S=>Ne(S,0,l));this.areaGenerator=ny().x(S=>this.services.cartesianScales.getValueThroughAxisPosition(m,S.data.sharedStackKey)).y0(S=>b(S[0])).y1(S=>b(S[1])).curve(this.services.curves.getD3Curve()),E.exit().attr("opacity",0).remove(),E.enter().append("path").attr("opacity",0).merge(E).data(r,S=>Ne(S,0,l)).attr("class","area").attr("class",S=>this.model.getColorClassName({classNameTypes:[Cs.FILL],dataGroupName:Ne(S,0,l),originalClassName:"area"})).style("fill",S=>n.model.getFillColor(Ne(S,0,l))).attr("role",ts.GRAPHICS_SYMBOL).attr("aria-roledescription","area").attr("aria-label",S=>Ne(S,0,l)).transition().call(S=>this.services.transitions.setupTransition({transition:S,name:"area-update-enter",animate:e})).attr("opacity",Il.opacity.selected).attr("d",this.areaGenerator)}}class $H extends ky{constructor(){super(...arguments),this.type="stacked-bar",this.renderType=Yn.SVG,this.handleLegendOnHover=e=>{const{hoveredElement:i}=e.detail,{groupMapsTo:n}=this.model.getOptions().data;this.parent.selectAll("path.bar").transition("legend-hover-bar").call(s=>this.services.transitions.setupTransition({transition:s,name:"legend-hover-bar"})).attr("opacity",s=>s[n]!==i.datum().name?.3:1)},this.handleLegendMouseOut=()=>{this.parent.selectAll("path.bar").transition("legend-mouseout-bar").call(e=>this.services.transitions.setupTransition({transition:e,name:"legend-mouseout-bar"})).attr("opacity",1)}}init(){const e=this.services.events;e.addEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.addEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}render(e){const i=this.getComponentContainer({withinChartClip:!0}),n=this.getOptions(),{groupMapsTo:s}=n.data,l=this.model.getStackedData({groups:this.configs.groups,divergent:!0}),c=this.model.getActiveDataGroupNames(),r=i.selectAll("g.bars").data(l,m=>Ne(m,0,s));r.exit().attr("opacity",0).remove(),r.enter().append("g").classed("bars",!0).attr("role",ts.GROUP).attr("data-name","bars");const f=i.selectAll("g.bars").selectAll("path.bar").data(m=>m,m=>m.data.sharedStackKey);f.exit().remove(),f.enter().append("path").merge(f).classed("bar",!0).transition().call(m=>this.services.transitions.setupTransition({transition:m,name:"bar-update-enter",animate:e})).attr("class",m=>this.model.getColorClassName({classNameTypes:[Cs.FILL],dataGroupName:m[s],originalClassName:"bar"})).style("fill",m=>this.model.getFillColor(m[s])).attr("d",m=>{const y=m.data.sharedStackKey,b=this.getBarWidth(),E=this.services.cartesianScales.getDomainValue(y)-b/2,S=E+b,D=this.services.cartesianScales.getRangeValue(m[0]);let R=this.services.cartesianScales.getRangeValue(m[1]);if(!this.isOutsideZoomedDomain(E,S)){if(Math.abs(R-D)>0&&Math.abs(R-D)>n.bars.dividerSize){const z=m[0]<0&&m[1]<=0;z&&c.length>1?this.services.cartesianScales.getOrientation()===wa.VERTICAL?R+=m[1]===0?2:1:R-=1:z||(this.services.cartesianScales.getOrientation()===wa.VERTICAL?R+=1:R-=1)}return Ey({x0:E,x1:S,y0:D,y1:R},this.services.cartesianScales.getOrientation())}}).attr("opacity",1).attr("role",ts.GRAPHICS_SYMBOL).attr("aria-roledescription","bar").attr("aria-label",m=>m[1]-m[0]),this.addEventListeners()}addEventListeners(){const e=this.getOptions(),{groupMapsTo:i}=e.data,n=this;this.parent.selectAll("path.bar").on("mouseover",function(s,l){const c=Jt(this);c.classed("hovered",!0),n.services.events.dispatchEvent(yt.Bar.BAR_MOUSEOVER,{event:s,element:c,datum:l});let r=n.model.getDisplayData(n.configs.groups).find(f=>{const m=n.services.cartesianScales.getDomainIdentifier(f),y=n.services.cartesianScales.getRangeIdentifier(f);return f[y]===l.data[l[i]]&&f[m].toString()===l.data.sharedStackKey&&f[i]===l[i]});if(r===void 0){const f=n.services.cartesianScales.getDomainIdentifier(),m=n.services.cartesianScales.getRangeIdentifier();r={[f]:l.data.sharedStackKey,[m]:l.data[l[i]],[i]:l[i]}}n.services.events.dispatchEvent(yt.Tooltip.SHOW,{event:s,hoveredElement:c,data:[r]})}).on("mousemove",function(s,l){const c=Jt(this);n.services.events.dispatchEvent(yt.Bar.BAR_MOUSEMOVE,{event:s,element:c,datum:l}),n.services.events.dispatchEvent(yt.Tooltip.MOVE,{event:s})}).on("click",function(s,l){n.services.events.dispatchEvent(yt.Bar.BAR_CLICK,{event:s,element:Jt(this),datum:l})}).on("mouseout",function(s,l){const c=Jt(this);c.classed("hovered",!1),n.services.events.dispatchEvent(yt.Bar.BAR_MOUSEOUT,{event:s,element:c,datum:l}),n.services.events.dispatchEvent(yt.Tooltip.HIDE,{hoveredElement:c})})}getBarWidth(){const e=this.getOptions();if(Ne(e,"bars","width"))return e.bars.width;const i=this.services.cartesianScales.getMainXScale(),n=hi.getSVGElementSize(this.parent,{useAttrs:!0}).width,s=this.model.getStackKeys().length,l=Ne(e,"bars","spacingFactor");return i.step?Math.min(e.bars.maxWidth,i.step()/2):Math.min(e.bars.maxWidth,n*l/s)}destroy(){this.parent.selectAll("path.bar").on("mouseover",null).on("mousemove",null).on("mouseout",null);const e=this.services.events;e.removeEventListener(yt.Legend.ITEM_HOVER,this.handleLegendOnHover),e.removeEventListener(yt.Legend.ITEM_MOUSEOUT,this.handleLegendMouseOut)}}class eK extends Dm{constructor(){super(...arguments),this.type="scatter-stacked",this.renderType=Yn.SVG}render(e){if(!Ne(this.getOptions(),"points","enabled"))return;const i=this.getComponentContainer({withinChartClip:!0}),n=this.getOptions(),{groupMapsTo:s}=n.data,l=Object.keys(n.axes).some(y=>n.axes[y].percentage),c=this.model.getStackedData({groups:this.configs.groups,percentage:l}),r=i.selectAll("g.dots").data(c,y=>Ne(y,0,s));r.exit().attr("opacity",0).remove();const f=r.enter().append("g").classed("dots",!0).attr("role",ts.GROUP).merge(r).selectAll("circle.dot").data(y=>y);f.exit().attr("opacity",0).remove();const m=f.enter().append("circle").classed("dot",!0).attr("opacity",0).merge(f).datum(y=>{const b=y[s],E=this.services.cartesianScales.getDomainIdentifier(y),S=this.services.cartesianScales.getRangeIdentifier(y);return{[s]:b,[E]:y.data.sharedStackKey,[S]:y[1]}});this.styleCircles(m,e),this.addEventListeners()}getTooltipData(e,i){const n=this.getOptions(),{groupMapsTo:s}=n.data,l=Object.keys(n.axes).some(f=>n.axes[f].percentage),c=this.model.getStackedData({groups:this.configs.groups,percentage:l}),r=[];return c.forEach((f,m)=>{f.forEach((y,b)=>{const E=y[s],S=y.data.sharedStackKey;let D=y.data[E];const R=y[1],z=this.services.cartesianScales.getDomainIdentifier(y),H=this.services.cartesianScales.getRangeIdentifier(y);D!=null&&e===this.services.cartesianScales.getDomainValue(S)&&i===this.services.cartesianScales.getRangeValue(R)&&(l&&(D=this.model.getStackedData({groups:this.configs.groups})[m][b].data[E]),D!==null&&r.push({[s]:E,[z]:S,[H]:D}))})}),this.model.getDisplayData(this.configs.groups).filter(f=>{const m=this.services.cartesianScales.getDomainIdentifier(f),y=this.services.cartesianScales.getRangeIdentifier(f);return r.find(b=>b[s]==f[s]&&b[m]==f[m]&&b[y]==f[y])!==void 0})}}function tK(t){var e=t==null?0:t.length;return e?_y(t,1):[]}class iK extends Bl{zoomIn(e,i,n){let s,l,c;const r=n||m2;e&&(s=e.x,l=e.y,c=2);const{width:f,height:m}=hi.getSVGElementSize(this.services.domUtils.getHolder(),{useClientDimensions:!0});i.transition().duration(r.duration).ease(r.ease).attr("transform",`translate(${f/2}, ${m/2}) scale(${c}) translate(${-s},${-l})`),this.services.events.dispatchEvent(yt.CanvasZoom.CANVAS_ZOOM_IN,{element:Jt(e)})}zoomOut(e,i){const n=i||m2;e.transition().duration(n.duration).ease(n.ease).attr("transform",""),this.services.events.dispatchEvent(yt.CanvasZoom.CANVAS_ZOOM_OUT)}}class nK extends Bl{init(){this.documentFragment=document.createDocumentFragment()}addEventListener(e,i){this.documentFragment.addEventListener(e,i)}removeEventListener(e,i){this.documentFragment.removeEventListener(e,i)}dispatchEvent(e,i){let n;i?n=new CustomEvent(e,{detail:i}):(n=document.createEvent("Event"),n.initEvent(e,!1,!0)),this.documentFragment.dispatchEvent(n)}}class rK extends Bl{constructor(e,i){super(e,i)}downloadCSV(e,i){const n=document.createElement("a"),s="text/csv;encoding:utf-8";if(navigator.msSaveBlob)navigator.msSaveBlob(new Blob([e],{type:s}),i);else if(URL&&"download"in n){const l=URL.createObjectURL(new Blob([e],{type:s}));n.href=l,n.setAttribute("download",i),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l)}else location.href=`data:application/octet-stream,${encodeURIComponent(e)}`}downloadImage(e,i){const n=document.createElement("a");n.download=i,n.href=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}}class sK extends Bl{constructor(){super(...arguments),this.pendingTransitions={}}init(){var e;(e=this.services.events)==null||e.addEventListener(yt.Model.UPDATE,()=>{this.pendingTransitions={}})}setupTransition({transition:e,name:i,animate:n}){return this.pendingTransitions[e._id]=e,e.on("end interrupt cancel",()=>{delete this.pendingTransitions[e._id]}),this.model.getOptions().animations===!1||n===!1?e.duration(0):e.duration(Ne(g2,i,"duration")||g2.default.duration)}getPendingTransitions(){return this.pendingTransitions}}function Gd(t,e){const i=jn(t),n=jn(e),s=i.getTime()-n.getTime();return s<0?-1:s>0?1:s}function aK(t,e){const i=jn(t),n=jn(e);return i.getFullYear()-n.getFullYear()}function oK(t,e){const i=jn(t),n=jn(e),s=Gd(i,n),l=Math.abs(aK(i,n));i.setFullYear(1584),n.setFullYear(1584);const c=Gd(i,n)===-s,r=s*(l-+c);return r===0?0:r}function Oy(t,e){const i=jn(t);if(isNaN(e))return Co(t,NaN);if(!e)return i;const n=i.getDate(),s=Co(t,i.getTime());s.setMonth(i.getMonth()+e+1,0);const l=s.getDate();return n>=l?s:(i.setFullYear(s.getFullYear(),s.getMonth(),n),i)}function tI(t,e){return Oy(t,e*12)}function lK(t,e){return tI(t,-e)}function cK(t,e){const i=jn(t),n=jn(e),s=i.getFullYear()-n.getFullYear(),l=i.getMonth()-n.getMonth();return s*12+l}function uK(t){const e=jn(t);return e.setHours(23,59,59,999),e}function hK(t){const e=jn(t),i=e.getMonth();return e.setFullYear(e.getFullYear(),i+1,0),e.setHours(23,59,59,999),e}function dK(t){const e=jn(t);return+uK(e)==+hK(e)}function fK(t,e){const i=jn(t),n=jn(e),s=Gd(i,n),l=Math.abs(cK(i,n));let c;if(l<1)c=0;else{i.getMonth()===1&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-s*l);let r=Gd(i,n)===-s;dK(jn(t))&&l===1&&Gd(t,n)===1&&(r=!1),c=s*(l-Number(r))}return c===0?0:c}function mK(t,e){return Oy(t,-e)}function pK(t,e){const i=jn(t),n=jn(e),s=Q2(i,n),l=Math.abs(gS(i,n));i.setDate(i.getDate()-s*l);const c=+(Q2(i,n)===-s),r=s*(l-c);return r===0?0:r}function Q2(t,e){const i=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return i<0?-1:i>0?1:i}function iI(t,e){const i=jn(t);return isNaN(e)?Co(t,NaN):(e&&i.setDate(i.getDate()+e),i)}function gK(t,e){return iI(t,-e)}function Cy(t,e){return jn(t).getTime()-jn(e).getTime()}function My(t){return t?Math[t]:Math.trunc}function _K(t,e,i){const n=Cy(t,e)/pS;return My(i==null?void 0:i.roundingMethod)(n)}function Dy(t,e){const i=+jn(t);return Co(t,i+e)}function nI(t,e){return Dy(t,e*pS)}function yK(t,e){return nI(t,-e)}function $2(t,e,i){const n=Cy(t,e)/mS;return My(i==null?void 0:i.roundingMethod)(n)}function w0(t,e){return Dy(t,e*mS)}function eA(t,e){return w0(t,-e)}function tA(t,e,i){const n=Cy(t,e)/1e3;return My(i==null?void 0:i.roundingMethod)(n)}function A0(t,e){return Dy(t,e*1e3)}function iA(t,e){return A0(t,-e)}class vK extends Bl{constructor(){super(...arguments),this.scaleTypes={top:null,right:null,bottom:null,left:null},this.scales={top:null,right:null,bottom:null,left:null}}getDomainAxisPosition({datum:e=null}={}){if(this.dualAxes&&e){const i=this.model.getOptions(),{groupMapsTo:n}=i.data,s=Ne(i,"axes",this.secondaryDomainAxisPosition),l=e[n];if(s!=null&&s.correspondingDatasets&&s.correspondingDatasets.includes(l))return this.secondaryDomainAxisPosition}return this.domainAxisPosition}getRangeAxisPosition({datum:e=null,groups:i=null}={}){if(this.dualAxes){const n=this.model.getOptions(),{groupMapsTo:s}=n.data,l=Ne(n,"axes",this.secondaryRangeAxisPosition);let c;if(e!==null?c=e[s]:i&&i.length>0&&(c=i[0]),l!=null&&l.correspondingDatasets&&l.correspondingDatasets.includes(c))return this.secondaryRangeAxisPosition}return this.rangeAxisPosition}getAxisOptions(e){return Ne(this.model.getOptions(),"axes",e)}getDomainAxisOptions(){const e=this.getDomainAxisPosition();return this.getAxisOptions(e)}getRangeAxisOptions(){const e=this.getRangeAxisPosition();return this.getAxisOptions(e)}getScaleLabel(e){return this.getAxisOptions(e).title||(e===Ft.BOTTOM||e===Ft.TOP?"x-value":"y-value")}getDomainLabel(){return this.getScaleLabel(this.getDomainAxisPosition())}getRangeLabel(){return this.getScaleLabel(this.getRangeAxisPosition())}update(){this.determineAxisDuality(),this.findDomainAndRangeAxes(),this.determineOrientation(),Object.keys(Ft).map(e=>Ft[e]).forEach(e=>{this.scales[e]=this.createScale(e)})}findDomainAndRangeAxes(){const e=this.findVerticalAxesPositions(),i=this.findHorizontalAxesPositions(),n=this.findDomainAndRangeAxesPositions(e,i);this.domainAxisPosition=n.primaryDomainAxisPosition,this.rangeAxisPosition=n.primaryRangeAxisPosition,this.isDualAxes()&&(this.secondaryDomainAxisPosition=n.secondaryDomainAxisPosition,this.secondaryRangeAxisPosition=n.secondaryRangeAxisPosition)}determineOrientation(){(this.rangeAxisPosition===Ft.LEFT||this.rangeAxisPosition===Ft.RIGHT)&&(this.domainAxisPosition===Ft.BOTTOM||this.domainAxisPosition===Ft.TOP)?this.orientation=wa.VERTICAL:this.orientation=wa.HORIZONTAL}isDualAxes(){return this.dualAxes}determineAxisDuality(){var e,i,n,s;const l=this.model.getOptions(),c=Ne(l,"axes");((e=c[Ft.LEFT])!=null&&e.correspondingDatasets&&c[Ft.RIGHT]||(i=c[Ft.RIGHT])!=null&&i.correspondingDatasets&&c[Ft.LEFT]||(n=c[Ft.TOP])!=null&&n.correspondingDatasets&&c[Ft.BOTTOM]||(s=c[Ft.BOTTOM])!=null&&s.correspondingDatasets&&c[Ft.TOP])&&(this.dualAxes=!0)}getCustomDomainValuesByposition(e){const i=Ne(this.model.getOptions(),"axes",e,"domain");if(i&&!Array.isArray(i))throw new Error(`Domain in ${e} axis is not a valid array`);if(Array.isArray(i)&&(this.scaleTypes[e]===Hi.LINEAR||this.scaleTypes[e]===Hi.TIME)&&i.length!==2)throw new Error(`There can only be 2 elements in domain for scale type: ${this.scaleTypes[e]}`);return i}getOrientation(){return this.orientation}getScaleByPosition(e){return this.scales[e]}getScaleTypeByPosition(e){return this.scaleTypes[e]}getDomainAxisScaleType(){const e=this.getDomainAxisPosition();return this.getScaleTypeByPosition(e)}getRangeAxisScaleType(){const e=this.getRangeAxisPosition();return this.getScaleTypeByPosition(e)}getDomainScale(){return this.scales[this.domainAxisPosition]}getRangeScale(){return this.scales[this.rangeAxisPosition]}getMainXAxisPosition(){const e=[Ft.BOTTOM,Ft.TOP];return[this.domainAxisPosition,this.rangeAxisPosition].find(i=>e.indexOf(i)>-1)}getMainYAxisPosition(){const e=[Ft.LEFT,Ft.RIGHT];return[this.domainAxisPosition,this.rangeAxisPosition].find(i=>e.indexOf(i)>-1)}getMainXScale(){return this.scales[this.getMainXAxisPosition()]}getMainYScale(){return this.scales[this.getMainYAxisPosition()]}getValueFromScale(e,i,n,s){const l=this.model.getOptions(),c=Ne(l,"axes")[n],{mapsTo:r}=c,f=Ne(s,r)!==null?s[r]:s;let m;switch(i){case Hi.LABELS:m=e(f)+e.step()/2;break;case Hi.TIME:m=e(new Date(f));break;default:m=e(f)}return m}getBoundedScaledValues(e){const{bounds:i}=this.model.getOptions(),n=this.getRangeAxisPosition({datum:e}),s=this.scales[n],l=this.model.getOptions(),c=Ne(l,"axes")[n],{mapsTo:r}=c,f=e[r]!==void 0?e[r]:e;return[s(Ne(e,i.upperBoundMapsTo)!==null?e[i.upperBoundMapsTo]:f),s(Ne(e,i.lowerBoundMapsTo)!==null?e[i.lowerBoundMapsTo]:f)]}getValueThroughAxisPosition(e,i){const n=this.scaleTypes[e],s=this.scales[e];return this.getValueFromScale(s,n,e,i)}getDomainValue(e){const i=this.getDomainAxisPosition({datum:e});return this.getValueThroughAxisPosition(i,e)}getRangeValue(e){const i=this.getRangeAxisPosition({datum:e});return this.getValueThroughAxisPosition(i,e)}getMainXScaleType(){return this.getScaleTypeByPosition(this.getMainXAxisPosition())}getMainYScaleType(){return this.getScaleTypeByPosition(this.getMainYAxisPosition())}getDomainIdentifier(e){const i=this.model.getOptions();return Ne(i,"axes",this.getDomainAxisPosition({datum:e}),"mapsTo")}getRangeIdentifier(e){const i=this.model.getOptions();return Ne(i,"axes",this.getRangeAxisPosition({datum:e}),"mapsTo")}extendsDomain(e,i){const n=this.model.getOptions(),s=Ne(n,"axes",e);if(s.scaleType===Hi.TIME){const l=Ne(n,"timeScale","addSpaceOnEdges");return bK(i,l)}else return xK(i,Ac.paddingRatio,s.scaleType)}findVerticalAxesPositions(){const e=this.model.getOptions(),i=Ne(e,"axes"),n=this.isDualAxes();return Ne(i,Ft.LEFT)===null&&Ne(i,Ft.RIGHT)!==null||Ne(i,Ft.RIGHT,"main")===!0||n&&Ne(i,Ft.LEFT,"correspondingDatasets")?{primary:Ft.RIGHT,secondary:Ft.LEFT}:{primary:Ft.LEFT,secondary:Ft.RIGHT}}findHorizontalAxesPositions(){const e=this.model.getOptions(),i=Ne(e,"axes"),n=this.isDualAxes();return Ne(i,Ft.BOTTOM)===null&&Ne(i,Ft.TOP)!==null||Ne(i,Ft.TOP,"main")===!0||n&&Ne(i,Ft.BOTTOM,"correspondingDatasets")?{primary:Ft.TOP,secondary:Ft.BOTTOM}:{primary:Ft.BOTTOM,secondary:Ft.TOP}}findDomainAndRangeAxesPositions(e,i){const n=this.model.getOptions(),s=Ne(n,"axes",e.primary),l=Ne(n,"axes",i.primary),c=s.scaleType||Hi.LINEAR,r=l.scaleType||Hi.LINEAR,f={primaryDomainAxisPosition:null,secondaryDomainAxisPosition:null,primaryRangeAxisPosition:null,secondaryRangeAxisPosition:null};return f.primaryDomainAxisPosition=i.primary,f.primaryRangeAxisPosition=e.primary,f.secondaryDomainAxisPosition=i.secondary,f.secondaryRangeAxisPosition=e.secondary,(!(r===Hi.LABELS||r===Hi.TIME)&&c===Hi.LABELS||c===Hi.TIME)&&(f.primaryDomainAxisPosition=e.primary,f.primaryRangeAxisPosition=i.primary,f.secondaryDomainAxisPosition=e.secondary,f.secondaryRangeAxisPosition=i.secondary),f}getScaleDomain(e){const i=this.model.getOptions(),n=Ne(i,"axes",e),s=Ne(i,"bounds"),{includeZero:l}=n,c=Ne(n,"scaleType")||Hi.LINEAR;if(this.model.isDataEmpty())return[];if(n.binned){const{bins:H}=this.model.getBinConfigurations();return[0,uL(H,K=>K.length)]}else if(n.limitDomainToBins){const{bins:H}=this.model.getBinConfigurations(),K=this.model.getStackKeys({bins:H});return[K[0].split(":")[0],K[K.length-1].split(":")[1]]}const r=this.model.getDisplayData(),{extendLinearDomainBy:f,mapsTo:m,percentage:y,thresholds:b}=n,{reference:E,compareTo:S}=Ac.ratio;if(n.domain)return c===Hi.LABELS?n.domain:(c===Hi.TIME&&(n.domain=n.domain.map(H=>H.getTime===void 0?new Date(H):H)),this.extendsDomain(e,n.domain));if(y)return[0,100];if(n&&c===Hi.LABELS)return af(r.map(H=>H[m]));let D,R;const z=this.model.getDataGroupNames();if(c===Hi.LABELS_RATIO)return r.map(H=>`${H[E]}/${H[S]}`);if(c===Hi.TIME)R=r.map(H=>+new Date(H[m]));else if(s&&i.axes)R=[],r.forEach(H=>{R.push(H[m]),H[s.upperBoundMapsTo]&&R.push(H[s.upperBoundMapsTo]),H[s.lowerBoundMapsTo]&&R.push(H[s.lowerBoundMapsTo])});else if(n.stacked===!0&&z&&e===this.getRangeAxisPosition()){const{groupMapsTo:H}=i.data,K=this.model.getDataValuesGroupedByKeys({groups:z}),W=r.filter(Y=>!z.includes(Y[H])),se=[];K.forEach(Y=>{const{...ne}=Y;let ue=0,ve=0;Object.values(ne).forEach(_e=>{isNaN(_e)||(_e<0?ve+=_e:ue+=_e)}),se.push([ve,ue])}),R=[...tK(se),...W.map(Y=>Y[m])]}else R=[],r.forEach(H=>{const K=H[m];Array.isArray(K)&&K.length===2?(R.push(K[0]),R.push(K[1])):(f&&R.push(Math.max(H[m],H[f])),R.push(K))});return c!==Hi.TIME&&c!==Hi.LOG&&l&&R.push(0),b&&b.length>0&&b.forEach(H=>{const K=Ne(H,"value");K!==null&&R.push(K)}),D=dh(R),D=this.extendsDomain(e,D),D}createScale(e){const i=this.model.getOptions(),n=Ne(i,"axes",e);if(!n)return null;const s=Ne(n,"scaleType")||Hi.LINEAR;this.scaleTypes[e]=s;let l;return s===Hi.TIME?l=cT():s===Hi.LOG?l=tT().base(n.base||10):s===Hi.LABELS||s===Hi.LABELS_RATIO?l=q0():l=Ym(),l.domain(this.getScaleDomain(e)),l}getHighestDomainThreshold(){const e=Ne(this.model.getOptions(),"axes"),i=this.getDomainAxisPosition(),{thresholds:n}=e[i];if(!Array.isArray(n)||Array.isArray(n)&&!n.length)return null;const s=this.getDomainScale(),l=n.sort((c,r)=>r.value-c.value)[0];return this.getScaleTypeByPosition(i)===Hi.TIME&&(typeof l.value=="string"||l.value.getTime===void 0)&&(l.value=new Date(l.value)),{threshold:l,scaleValue:s(l.value)}}getHighestRangeThreshold(){const e=Ne(this.model.getOptions(),"axes"),i=this.getRangeAxisPosition(),{thresholds:n}=e[i];if(!Array.isArray(n)||Array.isArray(n)&&!n.length)return null;const s=this.getRangeScale(),l=n.sort((c,r)=>r.value-c.value)[0];return{threshold:l,scaleValue:s(l.value)}}}function bK(t,e){const i=new Date(t[0]),n=new Date(t[1]);return oK(n,i)>1?[lK(i,e),tI(n,e)]:fK(n,i)>1?[mK(i,e),Oy(n,e)]:pK(n,i)>1?[gK(i,e),iI(n,e)]:_K(n,i)>1?[yK(i,e),nI(n,e)]:$2(n,i)>30?[eA(i,e*30),w0(n,e*30)]:$2(n,i)>1?[eA(i,e),w0(n,e)]:tA(n,i)>15?[iA(i,e*15),A0(n,e*15)]:tA(n,i)>1?[iA(i,e),A0(n,e)]:[i,n]}function xK([t,e],i,n){const s=(e-t)*i,l=e<=0&&e+s>0?0:e+s;let c=t>=0&&t-s<0?0:t-s;if(n===Hi.LOG&&c<=0){if(t<=0)throw Error("Data must have values greater than 0 if log scale type is used.");c=t}return[c,l]}class wK extends Bl{constructor(){super(...arguments),this.curveTypes={curveLinear:ty,curveLinearClosed:c6,curveBasis:$N,curveBasisClosed:e6,curveBasisOpen:t6,curveBundle:i6,curveCardinal:n6,curveCardinalClosed:r6,curveCardinalOpen:s6,curveCatmullRom:a6,curveCatmullRomClosed:o6,curveCatmullRomOpen:l6,curveMonotoneX:u6,curveMonotoneY:h6,curveNatural:d6,curveStep:f6,curveStepAfter:p6,curveStepBefore:m6}}getD3Curve(){let e="curveLinear";const i=this.model.getOptions().curve;if(i&&(typeof i=="string"?e=i:e=i.name),this.curveTypes[e]){let n=this.curveTypes[e];return i&&Object.keys(i).forEach(s=>{n[s]&&(n=n[s](i[s]))}),n}return console.warn(`The curve type '${e}' is invalid, using 'curveLinear' instead`),this.curveTypes.curveLinear}}class AK extends Bl{isZoomBarEnabled(){if(!this.services.cartesianScales||!Ne(this.model.getOptions(),"zoomBar","top","enabled"))return!1;this.services.cartesianScales.findDomainAndRangeAxes();const e=this.services.cartesianScales.getMainXAxisPosition(),i=Ne(this.model.getOptions(),"axes",e,"scaleType");return e===Ft.BOTTOM&&i===Hi.TIME}getZoomBarData(){const e=this.model.getZoomBarData();return e&&e.length>1?e:this.model.getDisplayData()}getDefaultZoomBarDomain(e){if(!this.services.zoom)throw new Error("Services zoom not defined");const i=e||this.services.zoom.getZoomBarData(),{cartesianScales:n}=this.services;if(!n)throw new Error("Services cartesianScales undefined");const s=n.getMainXAxisPosition(),l=n.getDomainIdentifier(),c=Ne(this.model.getOptions(),"axes",s,"domain");if(Array.isArray(c)&&c.length===2)return c;if(!s)throw new Error("Not defined: mainXAxisPosition");return n.extendsDomain(s,dh(i,r=>r[l]))}handleDomainChange(e,i={dispatchEvent:!0}){var n;this.model.set({zoomDomain:e},{animate:!1}),i.dispatchEvent&&((n=this.services.events)==null||n.dispatchEvent(yt.ZoomDomain.CHANGE,{newDomain:e}))}getZoomRatio(){return Ne(this.model.getOptions(),"zoomBar","zoomRatio")}filterDataForRangeAxis(e,i){var n;const s=this.model.get("zoomDomain"),l=Object.assign({stacked:!1},i),c=Ne(this.model.getOptions(),"zoomBar","updateRangeAxis");if(this.isZoomBarEnabled()&&c&&s){const r=l.stacked?"sharedStackKey":(n=this.services.cartesianScales)==null?void 0:n.getDomainIdentifier(),f=e.filter(m=>new Date(m[r])>=s[0]&&new Date(m[r])<=s[1]);if(f.length>0)return f}return e}zoomIn(e=this.getZoomRatio()){var i;const n=this.model.get("zoomDomain"),s=Ba.handleWidth,l=(i=this.services.cartesianScales)==null?void 0:i.getMainXScale().copy();l.domain(this.getDefaultZoomBarDomain());const c=l(n[0]),r=l(n[1]);if(r-c<s+1)return;const f=l.range(),m=r-c,y=Math.min((f[1]-f[0])/2*(e/2),m/2);let b=c+y,E=r-y;b>=E&&(b=c+m/2-s/2,E=r-m/2+s/2);const S=[l.invert(b),l.invert(E)];(n[0].valueOf()!==S[0].valueOf()||n[1].valueOf()!==S[1].valueOf())&&this.handleDomainChange(S)}zoomOut(e=this.getZoomRatio()){const i=this.model.get("zoomDomain");if(!this.services.cartesianScales)throw new Error("Services cartesianScales undefined");const n=this.services.cartesianScales.getMainXScale().copy();n.domain(this.getDefaultZoomBarDomain());const s=n(i[0]),l=n(i[1]),c=n.range(),r=(c[1]-c[0])/2*(e/2),f=Math.max(s-r,c[0]),m=Math.min(l+r,c[1]),y=[n.invert(f),n.invert(m)];(i[0].valueOf()!==y[0].valueOf()||i[1].valueOf()!==y[1].valueOf())&&this.handleDomainChange(y)}resetZoomDomain(){const e=this.model.get("zoomDomain"),i=this.getDefaultZoomBarDomain();(e[0].valueOf()!==i[0].valueOf()||e[1].valueOf()!==i[1].valueOf())&&this.handleDomainChange(i)}isMinZoomDomain(){const e=this.model.get("zoomDomain"),i=this.getDefaultZoomBarDomain();if(!e||!i)return!1;const n=e[1].valueOf()-e[0].valueOf(),s=i[1].valueOf()-i[0].valueOf(),l=Ne(this.model.getOptions(),"zoomBar","minZoomRatio");return n/s<l}isMaxZoomDomain(){const e=this.model.get("zoomDomain"),i=this.getDefaultZoomBarDomain();return!!(e&&i&&e[0].valueOf()===i[0].valueOf()&&e[1].valueOf()===i[1].valueOf())}isEmptyState(){return this.getZoomBarData().length===0}isZoomBarLoading(e){return Ne(this.model.getOptions(),"zoomBar",e,"loading")}isZoomBarLocked(e){return Ne(this.model.getOptions(),"zoomBar",e,"locked")}}class EK{constructor(e,i){this.components=[],this.services={canvasZoom:iK,domUtils:hi,events:nK,files:rK,gradientUtils:lf,transitions:sK},this.model=new AS(this.services)}init(e,i){this.model.set({holder:e},{skipUpdate:!0}),Object.keys(this.services).forEach(n=>{const s=this.services[n];this.services[n]=new s(this.model,this.services)}),this.services.events.addEventListener(yt.Model.UPDATE,n=>{const s=!!Ne(n,"detail","animate");this.update(s)}),this.model.setData(i.data),this.services.events.addEventListener(yt.Chart.RESIZE,()=>{this.update(!1)}),this.components=this.getComponents(),this.update()}getComponents(){return console.error("getComponents() method is not implemented"),[]}update(e=!0){if(!this.components)return;Object.keys(this.services).forEach(s=>{this.services[s].update()}),this.components.forEach(s=>s.render(e));const i=this.services.transitions.getPendingTransitions(),n=Object.keys(i).map(s=>i[s].end().catch(l=>l));Promise.all(n).then(()=>this.services.events.dispatchEvent(yt.Chart.RENDER_FINISHED))}destroy(){this.components.forEach(e=>e.destroy()),this.services.domUtils.getHolder().remove(),this.model.set({destroyed:!0},{skipUpdate:!0})}getChartComponents(e,i){const n=this.model.getOptions(),s=Ne(n,"toolbar","enabled"),l={id:"legend",components:[new WS(this.model,this.services)],growth:yr.PREFERRED},c=Ne(n,"canvasZoom","enabled");c&&c===!0&&e.push(new BH(this.model,this.services));const r=!!this.model.getOptions().title,f={id:"title",components:[new ZS(this.model,this.services)],growth:yr.STRETCH},m={id:"toolbar",components:[new US(this.model,this.services)],growth:yr.PREFERRED},y={id:"header",components:[new gh(this.model,this.services,[f,...s?[m]:[]],{direction:os.ROW,alignItems:gp.CENTER})],growth:yr.PREFERRED},b={id:"graph-frame",components:e,growth:yr.STRETCH,renderType:Ne(i,"graphFrameRenderType")||Yn.SVG},E=Ne(i,"excludeLegend")!==!0&&n.legend.enabled!==!1;let S=os.COLUMN;if(E){const H=Ne(n,"legend","position");H==="left"?(S=os.ROW,n.legend.orientation||(n.legend.orientation=Yd.VERTICAL)):H==="right"?(S=os.ROW_REVERSE,n.legend.orientation||(n.legend.orientation=Yd.VERTICAL)):H==="bottom"&&(S=os.COLUMN_REVERSE)}const D={id:"spacer",components:[new cp(this.model,this.services)],growth:yr.PREFERRED},R={id:"full-frame",components:[new gh(this.model,this.services,[...E?[l]:[],...E?[D]:[],b],{direction:S})],growth:yr.STRETCH},z=[];if(r||s){z.push(y);const H={id:"spacer",components:[new cp(this.model,this.services,s?{size:15}:void 0)],growth:yr.PREFERRED};z.push(H)}return z.push(R),[new JS(this.model,this.services),new qS(this.model,this.services),new gh(this.model,this.services,z,{direction:os.COLUMN})]}}class TK extends EK{constructor(e,i){super(e,i),this.services=Object.assign(this.services,{cartesianScales:vK,curves:wK,zoom:AK}),this.model=new Z9(this.services)}getAxisChartComponents(e,i){const n=this.model.getOptions(),s=Ne(n,"zoomBar",Ft.TOP,"enabled"),l=Ne(n,"toolbar","enabled");this.services.cartesianScales.determineAxisDuality(),this.services.cartesianScales.findDomainAndRangeAxes(),this.services.cartesianScales.determineOrientation();const c=this.services.cartesianScales.getMainXAxisPosition(),r=Ne(n,"axes",c,"scaleType"),f=s&&c===Ft.BOTTOM&&r===Hi.TIME,m=this.services.zoom.isZoomBarLocked(Ft.TOP),y=!!this.model.getOptions().title,b={id:"title",components:[new ZS(this.model,this.services)],growth:yr.STRETCH},E={id:"toolbar",components:[new US(this.model,this.services)],growth:yr.PREFERRED},S={id:"header",components:[new gh(this.model,this.services,[b,...l?[E]:[]],{direction:os.ROW,alignItems:gp.CENTER})],growth:yr.PREFERRED},D={id:"legend",components:[new WS(this.model,this.services)],growth:yr.PREFERRED};f&&!m&&e.push(new YS(this.model,this.services),new VH(this.model,this.services)),e.push(new UH(this.model,this.services)),e.push(new jH(this.model,this.services));const R={id:"graph-frame",components:e,growth:yr.STRETCH,renderType:Yn.SVG},z=Ne(i,"legend","enabled")!==!1&&this.model.getOptions().legend.enabled!==!1;let H=os.COLUMN;if(z){const ne=Ne(this.model.getOptions(),"legend","position");ne===Fd.LEFT?(H=os.ROW,this.model.getOptions().legend.orientation||(this.model.getOptions().legend.orientation=Yd.VERTICAL)):ne===Fd.RIGHT?(H=os.ROW_REVERSE,this.model.getOptions().legend.orientation||(this.model.getOptions().legend.orientation=Yd.VERTICAL)):ne===Fd.BOTTOM&&(H=os.COLUMN_REVERSE)}const K={id:"spacer",components:[new cp(this.model,this.services)],growth:yr.PREFERRED},W={id:"full-frame",components:[new gh(this.model,this.services,[...z?[D]:[],...z?[K]:[],R],{direction:H})],growth:yr.STRETCH},se={id:"zoom-bar",components:[new FH(this.model,this.services)],growth:yr.PREFERRED,renderType:Yn.SVG},Y=[];if(y||l){Y.push(S);const ne={id:"spacer",components:[new cp(this.model,this.services,l?{size:15}:void 0)],growth:yr.PREFERRED};Y.push(ne)}return f&&Y.push(se),Y.push(W),[new GH(this.model,this.services),new qS(this.model,this.services),new gh(this.model,this.services,Y,{direction:os.COLUMN})]}}bc.LINE+"",bc.SCATTER+"",bc.AREA+"",bc.STACKED_AREA+"",bc.SIMPLE_BAR+"",bc.GROUPED_BAR+"",bc.STACKED_BAR+"";class SK extends TK{constructor(e,i){super(e,i),this.model.setOptions(u9(l9.simpleBarChart,i.options)),this.init(e,i)}getComponents(){const e=[new YH(this.model,this.services),new HH(this.model,this.services),new eI(this.model,this.services),new $S(this.model,this.services),new JH(this.model,this.services,{skeleton:rh.VERT_OR_HORIZ})];return this.getAxisChartComponents(e)}}function IK(t){let e,i=[{id:t[1]},{class:nA},t[2]],n={};for(let s=0;s<i.length;s+=1)n=Ye(n,i[s]);return{c(){e=nt("div"),ui(e,n)},m(s,l){Se(s,e,l),t[7](e)},p(s,[l]){ui(e,n=Ni(i,[l&2&&{id:s[1]},{class:nA},l&4&&s[2]]))},i:ki,o:ki,d(s){s&&Te(e),t[7](null)}}}const nA="cds--chart-holder";function kK(t,e,i){const n=["data","options","Chart","chart","ref","id"];let s=Ut(e,n),{data:l=[]}=e,{options:c={}}=e,{Chart:r=void 0}=e,{chart:f=null}=e,{ref:m=null}=e,{id:y=`chart-${Math.random().toString(36)}`}=e;const b=co();Pl(()=>{try{i(3,f=new r(m,{data:l,options:c})),b("load")}catch(S){console.error("Failed to initialize chart:",S)}}),Rh(()=>{if(f)try{f.model.setData(l),f.model.setOptions(c),b("update",{data:l,options:c})}catch(S){console.error("Failed to update chart:",S)}}),EA(()=>{f&&(b("destroy"),f.components.forEach(S=>S.destroy()),f.model.set({destroyed:!0},{skipUpdate:!0}),i(3,f=null))});function E(S){sn[S?"unshift":"push"](()=>{m=S,i(0,m)})}return t.$$set=S=>{e=Ye(Ye({},e),fi(S)),i(2,s=Ut(e,n)),"data"in S&&i(4,l=S.data),"options"in S&&i(5,c=S.options),"Chart"in S&&i(6,r=S.Chart),"chart"in S&&i(3,f=S.chart),"ref"in S&&i(0,m=S.ref),"id"in S&&i(1,y=S.id)},[m,y,s,f,l,c,r,E]}class OK extends Ri{constructor(e){super(),Di(this,e,kK,IK,Ci,{data:4,options:5,Chart:6,chart:3,ref:0,id:1})}}function CK(t){let e,i,n,s;const l=[t[4],{Chart:SK},{options:t[2]},{data:t[3]}];function c(m){t[5](m)}function r(m){t[6](m)}let f={};for(let m=0;m<l.length;m+=1)f=Ye(f,l[m]);return t[1]!==void 0&&(f.ref=t[1]),t[0]!==void 0&&(f.chart=t[0]),e=new OK({props:f}),sn.push(()=>Fa(e,"ref",c)),sn.push(()=>Fa(e,"chart",r)),e.$on("load",t[7]),e.$on("update",t[8]),e.$on("destroy",t[9]),{c(){Mt(e.$$.fragment)},m(m,y){Ot(e,m,y),s=!0},p(m,[y]){const b=y&28?Ni(l,[y&16&&hf(m[4]),l[1],y&4&&{options:m[2]},y&8&&{data:m[3]}]):{};!i&&y&2&&(i=!0,b.ref=m[1],Va(()=>i=!1)),!n&&y&1&&(n=!0,b.chart=m[0],Va(()=>n=!1)),e.$set(b)},i(m){s||(ae(e.$$.fragment,m),s=!0)},o(m){pe(e.$$.fragment,m),s=!1},d(m){Ct(e,m)}}}function MK(t,e,i){const n=["options","data","chart","ref"];let s=Ut(e,n),{options:l}=e,{data:c}=e,{chart:r=null}=e,{ref:f=null}=e;function m(D){f=D,i(1,f)}function y(D){r=D,i(0,r)}function b(D){At.call(this,t,D)}function E(D){At.call(this,t,D)}function S(D){At.call(this,t,D)}return t.$$set=D=>{e=Ye(Ye({},e),fi(D)),i(4,s=Ut(e,n)),"options"in D&&i(2,l=D.options),"data"in D&&i(3,c=D.data),"chart"in D&&i(0,r=D.chart),"ref"in D&&i(1,f=D.ref)},[r,f,l,c,s,m,y,b,E,S]}class DK extends Ri{constructor(e){super(),Di(this,e,MK,CK,Ci,{options:2,data:3,chart:0,ref:1})}}function RK(t){let e,i;return e=new DK({props:{data:[{group:"Qty",value:65e3},{group:"More",value:29123},{group:"Sold",value:35213},{group:"Restocking",value:51213},{group:"Misc",value:16932}],options:{theme:"white",title:"Simple bar (discrete)",height:"400px",axes:{left:{mapsTo:"value"},bottom:{mapsTo:"group",scaleType:"labels"}}}}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p:ki,i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}class LK extends Ri{constructor(e){super(),Di(this,e,null,RK,Ci,{})}}let Rm=[{id:79014,ime:"BEOGRAD",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70092,ime:"BARAJEVO",katopstine:[{id:"*",ime:"Sve"},{id:703451,ime:"ARNAJEVO"},{id:703460,ime:"BARAJEVO"},{id:703478,ime:"BAEVAC"},{id:703508,ime:"BELjINA"},{id:703516,ime:"BODAREVAC"},{id:703567,ime:"VELIKI BORAK"},{id:703630,ime:"VRANI"},{id:703672,ime:"GUNCATI"},{id:703826,ime:"LISOVI"},{id:703869,ime:"MANI"},{id:703877,ime:"MELjAK"},{id:703974,ime:"ROANCI"},{id:704091,ime:"ILjAKOVAC"}]},{id:70106,ime:"VODOVAC",katopstine:[{id:"*",ime:"Sve"},{id:703494,ime:"BELI POTOK"},{id:703621,ime:"VODOVAC"},{id:703753,ime:"ZUCE"},{id:703761,ime:"JAJINCI"},{id:703800,ime:"KUMODRA"},{id:703915,ime:"PINOSAVA"},{id:703931,ime:"RAKOVICA SELO"},{id:703958,ime:"RIPANj"}]},{id:70114,ime:"VRAAR",katopstine:[{id:"*",ime:"Sve"},{id:703648,ime:"VRAAR"}]},{id:70122,ime:"GROCKA",katopstine:[{id:"*",ime:"Sve"},{id:703486,ime:"BEGALjICA"},{id:703524,ime:"BOLE"},{id:703532,ime:"BRESTOVIK"},{id:703605,ime:"VINA"},{id:703656,ime:"VRIN"},{id:703664,ime:"GROCKA"},{id:703699,ime:"DRAANj"},{id:703737,ime:"ZAKLOPAA"},{id:703770,ime:"KALUERICA"},{id:703788,ime:"KAMENDOL"},{id:703818,ime:"LETANE"},{id:703923,ime:"PUDARCI"},{id:703966,ime:"RITOPEK"},{id:745243,ime:"UMARI"}]},{id:70149,ime:"ZVEZDARA",katopstine:[{id:"*",ime:"Sve"},{id:703583,ime:"VELIKI MOKRI LUG"},{id:703745,ime:"ZVEZDARA"},{id:703842,ime:"MALI MOKRI LUG"},{id:703885,ime:"MIRIJEVO"}]},{id:70157,ime:"ZEMUN",katopstine:[{id:"*",ime:"Sve"},{id:716014,ime:"BATAJNICA"},{id:716065,ime:"ZEMUN"},{id:716073,ime:"ZEMUN POLjE"},{id:716138,ime:"UGRINOVCI"}]},{id:70165,ime:"LAZAREVAC",katopstine:[{id:"*",ime:"Sve"},{id:722898,ime:"ARAPOVAC"},{id:722901,ime:"BARZILOVICA"},{id:722910,ime:"BAROEVAC"},{id:722928,ime:"BISTRICA"},{id:722936,ime:"BRAJKOVAC"},{id:722944,ime:"BUROVO"},{id:722952,ime:"VELIKI CRLjENI"},{id:722987,ime:"VRBOVNO"},{id:722995,ime:"VREOCI"},{id:723002,ime:"DREN"},{id:723029,ime:"DUDOVICA"},{id:723037,ime:"UPANjAC"},{id:723045,ime:"ZEOKE"},{id:723053,ime:"JUNKOVAC"},{id:723061,ime:"KRUEVICA"},{id:723070,ime:"LAZAREVAC"},{id:723088,ime:"LESKOVAC"},{id:723096,ime:"LUKAVICA"},{id:723100,ime:"MALI CRLjENI"},{id:723118,ime:"MEDOEVAC"},{id:723126,ime:"MIROSALjCI"},{id:723142,ime:"PETKA"},{id:723169,ime:"PRKOSAVA"},{id:723185,ime:"RUDOVCI"},{id:723193,ime:"SAKULjA"},{id:723207,ime:"SOKOLOVO"},{id:723215,ime:"STEPOJEVAC"},{id:723223,ime:"STRMOVO"},{id:723231,ime:"STUBICA"},{id:723240,ime:"TRBUNICA"},{id:723274,ime:"CVETOVAC"},{id:723282,ime:"IBUTKOVICA"},{id:723304,ime:"OPI"},{id:723312,ime:"UNjAR"}]},{id:70173,ime:"MLADENOVAC",katopstine:[{id:"*",ime:"Sve"},{id:701602,ime:"MARKOVAC"},{id:728390,ime:"AMERI"},{id:728411,ime:"VELIKA IVANA"},{id:728420,ime:"VLAKA"},{id:728489,ime:"KORAICA"},{id:728497,ime:"MALA VRBICA"},{id:728535,ime:"MEULUJE"},{id:728543,ime:"MLADENOVAC (VARO)"},{id:728551,ime:"MLADENOVAC (SELO)"},{id:728594,ime:"PRUATOVAC"},{id:728608,ime:"RAJKOVAC"},{id:728659,ime:"SENAJA"},{id:728705,ime:"EPIN"},{id:739987,ime:"DUBONA"},{id:740241,ime:"VELIKA KRSNA"},{id:740306,ime:"GRANICE"},{id:740349,ime:"JAGNjILO"},{id:740357,ime:"KOVAEVAC"},{id:740403,ime:"RABROVAC"}]},{id:70181,ime:"NOVI BEOGRAD",katopstine:[{id:"*",ime:"Sve"},{id:716090,ime:"NOVI BEOGRAD"}]},{id:70190,ime:"OBRENOVAC",katopstine:[{id:"*",ime:"Sve"},{id:703834,ime:"MALA MOTANICA"},{id:731536,ime:"BALjEVAC"},{id:731544,ime:"BARI"},{id:731552,ime:"BELO POLjE"},{id:731579,ime:"BRGULICE"},{id:731587,ime:"BROVI"},{id:731595,ime:"VELIKO POLjE"},{id:731609,ime:"VUKIEVICA"},{id:731617,ime:"GRABOVAC"},{id:731625,ime:"DRAEVAC"},{id:731633,ime:"DREN"},{id:731641,ime:"ZABREJE"},{id:731650,ime:"ZVEKA"},{id:731668,ime:"JASENAK"},{id:731684,ime:"KONATICE"},{id:731692,ime:"KRTINSKA"},{id:731714,ime:"LjUBINI"},{id:731749,ime:"MISLOIN"},{id:731757,ime:"OBRENOVAC"},{id:731765,ime:"ORAAC"},{id:731773,ime:"PIROMAN"},{id:731781,ime:"POLjANE"},{id:731790,ime:"RATARI"},{id:731803,ime:"RVATI"},{id:731811,ime:"SKELA"},{id:731820,ime:"STUBLINE"},{id:731838,ime:"TRSTENICA"},{id:731846,ime:"UROVCI"},{id:731854,ime:"UE"}]},{id:70203,ime:"PALILULA (BEOGRAD)",katopstine:[{id:"*",ime:"Sve"},{id:703591,ime:"VELIKO SELO"},{id:703613,ime:"VINjICA"},{id:703907,ime:"PALILULA"},{id:704016,ime:"SLANCI"},{id:732176,ime:"BESNI FOK"},{id:732184,ime:"BORA"},{id:732192,ime:"KOVILOVO"},{id:732206,ime:"KOMAREVA HUMKA"},{id:732214,ime:"KRNjAA"},{id:732222,ime:"LEPUNICA"},{id:732249,ime:"OVA"}]},{id:70211,ime:"RAKOVICA",katopstine:[{id:"*",ime:"Sve"},{id:703796,ime:"KNEEVAC"},{id:703940,ime:"RESNIK"},{id:704032,ime:"STARA RAKOVICA"}]},{id:70220,ime:"SAVSKI VENAC",katopstine:[{id:"*",ime:"Sve"},{id:704008,ime:"SAVSKI VENAC"}]},{id:70238,ime:"SOPOT",katopstine:[{id:"*",ime:"Sve"},{id:728403,ime:"BABE"},{id:728438,ime:"GUBEREVAC"},{id:728446,ime:"DRLUPA"},{id:728454,ime:"DUINA"},{id:728462,ime:"URINCI"},{id:728519,ime:"MALA IVANA"},{id:728527,ime:"MALI POAREVAC"},{id:728560,ime:"NEMENIKUE"},{id:728578,ime:"PARCANI"},{id:728586,ime:"POPOVI"},{id:728616,ime:"RALjA"},{id:728632,ime:"ROGAA"},{id:728667,ime:"SIBNICA"},{id:728675,ime:"SLATINA"},{id:728683,ime:"SOPOT"},{id:728691,ime:"STOJNIK"}]},{id:70246,ime:"STARI GRAD",katopstine:[{id:"*",ime:"Sve"},{id:704059,ime:"STARI GRAD"}]},{id:70254,ime:"UKARICA",katopstine:[{id:"*",ime:"Sve"},{id:703559,ime:"VELIKA MOTANICA"},{id:703575,ime:"VELIKI MAKI"},{id:703702,ime:"ELEZNIK"},{id:703893,ime:"OSTRUNICA"},{id:703982,ime:"RUANj"},{id:704024,ime:"SREMICA"},{id:704067,ime:"UMKA"},{id:704083,ime:"UKARICA"}]},{id:71293,ime:"SURIN",katopstine:[{id:"*",ime:"Sve"},{id:716022,ime:"BEMEN"},{id:716049,ime:"BOLjEVCI"},{id:716057,ime:"DOBANOVCI"},{id:716081,ime:"JAKOVO"},{id:716103,ime:"PETROVI"},{id:716111,ime:"PROGAR"},{id:716120,ime:"SURIN"}]}]},{id:70360,ime:"VALjEVO",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70360,ime:"VALjEVO",katopstine:[{id:"*",ime:"Sve"},{id:707716,ime:"BABINA LUKA"},{id:707724,ime:"BALINOVI"},{id:707732,ime:"BAEVCI"},{id:707759,ime:"BELI"},{id:707767,ime:"BELOEVAC"},{id:707775,ime:"BLIZONjE"},{id:707783,ime:"BOGATI"},{id:707791,ime:"BRANGOVI"},{id:707805,ime:"BRANKOVINA"},{id:707813,ime:"BREZOVICE"},{id:707821,ime:"BUJAI"},{id:707830,ime:"VALjEVO"},{id:707848,ime:"VESELINOVAC"},{id:707856,ime:"VUJINOVAA"},{id:707864,ime:"GORNjE LESKOVICE"},{id:707872,ime:"GRABOVICA"},{id:707899,ime:"DEGURI"},{id:707902,ime:"DIVCI"},{id:707929,ime:"DIVIBARE"},{id:707937,ime:"DONjE LESKOVICE"},{id:707945,ime:"DRAI"},{id:707953,ime:"DUPLjAJ"},{id:707961,ime:"ABARI"},{id:707970,ime:"ZABRDICA"},{id:707988,ime:"ZARUBE"},{id:707996,ime:"ZLATARI"},{id:708003,ime:"JASENICA"},{id:708011,ime:"JOEVA"},{id:708020,ime:"KLANICA"},{id:708038,ime:"KLINCI"},{id:708046,ime:"KOVAICE"},{id:708054,ime:"KOZLII"},{id:708062,ime:"KOTEICA"},{id:708089,ime:"KUNICE"},{id:708097,ime:"LELI"},{id:708119,ime:"LOZNICA"},{id:708127,ime:"LUKAVAC"},{id:708135,ime:"PAKLjE"},{id:708143,ime:"PETNICA"},{id:708151,ime:"POPUKE"},{id:708160,ime:"PRIJEZDI"},{id:708178,ime:"RABAS"},{id:708186,ime:"RAVNjE"},{id:708194,ime:"RAEVO SELO"},{id:708208,ime:"REBELj"},{id:708216,ime:"ROVNI"},{id:708224,ime:"SANDALj"},{id:708232,ime:"SEDLARI"},{id:708267,ime:"SOVA"},{id:708275,ime:"STRMNA GORA"},{id:708283,ime:"STUBO"},{id:708291,ime:"SUICA"},{id:708305,ime:"TUBRAVI"},{id:719056,ime:"TAOR"},{id:728128,ime:"MRI"},{id:728179,ime:"PAUNE"},{id:731862,ime:"BEOMUEVI"},{id:731889,ime:"BOBOVA"},{id:731919,ime:"VLAI"},{id:731927,ime:"VRAGOANICA"},{id:731935,ime:"GOLA GLAVA"},{id:731943,ime:"GORNjA BUKOVICA"},{id:731960,ime:"DONjA BUKOVICA"},{id:731994,ime:"KAMENICA"},{id:732010,ime:"MAJINOVI"},{id:732028,ime:"MILIINICA"},{id:732036,ime:"OGLAENOVAC"},{id:732052,ime:"OSLADI"},{id:732095,ime:"PRIEVI"},{id:732117,ime:"SITARICE"},{id:732125,ime:"STANINA REKA"},{id:732133,ime:"STAPAR"},{id:732141,ime:"SUVODANjE"},{id:732168,ime:"TUPANCI"}]}]},{id:79057,ime:"VRANjE",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70432,ime:"VRANjE",katopstine:[{id:"*",ime:"Sve"},{id:710164,ime:"URMANICA"},{id:711098,ime:"ALEKSANDROVAC"},{id:711128,ime:"BARBARUINCE"},{id:711136,ime:"BARELI"},{id:711144,ime:"BELI BREG"},{id:711152,ime:"BOJIN DEL"},{id:711179,ime:"BRESNICA"},{id:711195,ime:"BULjESOVCE"},{id:711209,ime:"BUNUEVCE"},{id:711217,ime:"BUTRANjE"},{id:711225,ime:"VIEVCE"},{id:711233,ime:"VLASE"},{id:711241,ime:"VRANjE I"},{id:711250,ime:"VRANjE II"},{id:711276,ime:"GOLEMO SELO"},{id:711306,ime:"GORNjA OTULjA"},{id:711322,ime:"GORNjE APSKO"},{id:711349,ime:"GORNjE PUNUEVCE"},{id:711357,ime:"GORNjE TREBEINjE"},{id:711365,ime:"GORNjI VRTOGO"},{id:711373,ime:"GORNjI NERADOVAC"},{id:711390,ime:"GRADNjA"},{id:711403,ime:"GUMERITE"},{id:711411,ime:"DAVIDOVAC"},{id:711438,ime:"DOBREJANCE"},{id:711446,ime:"DONjA OTULjA"},{id:711462,ime:"DONjE APSKO"},{id:711489,ime:"DONjE PUNUEVCE"},{id:711497,ime:"DONjE TREBEINjE"},{id:711519,ime:"DONjI VRTOGO"},{id:711527,ime:"DONjI NERADOVAC"},{id:711543,ime:"DRENOVAC"},{id:711551,ime:"DUBNICA"},{id:711578,ime:"DULAN"},{id:711594,ime:"DUPELjEVO"},{id:711624,ime:"ZLATOKOP"},{id:711667,ime:"KATUN"},{id:711675,ime:"KLANjICE"},{id:711705,ime:"KOPANjANE"},{id:711730,ime:"KOURA"},{id:711756,ime:"KRUEVA GLAVA"},{id:711772,ime:"KUPININCE"},{id:711799,ime:"LALINCE"},{id:711829,ime:"LEPINCE"},{id:711853,ime:"LUKOVO"},{id:711870,ime:"MEKOVAC"},{id:711888,ime:"MIJAKOVCE"},{id:711896,ime:"MIJOVCE"},{id:711900,ime:"MILANOVO"},{id:711918,ime:"MILIVOJCE"},{id:711926,ime:"MOTANICA"},{id:711934,ime:"NASTAVCE"},{id:711969,ime:"NOVA BREZOVICA"},{id:711985,ime:"OBLIKA SENA"},{id:711993,ime:"OSTRA GLAVA"},{id:712019,ime:"PAVLOVAC"},{id:712051,ime:"PREOBRAENjE"},{id:712086,ime:"RANUTOVAC"},{id:712094,ime:"RATAJE I"},{id:712108,ime:"RATAJE II"},{id:712116,ime:"RIBINCE"},{id:712124,ime:"RISTOVAC"},{id:712132,ime:"RODACE"},{id:712159,ime:"RUSCE"},{id:712175,ime:"SIKIRJE"},{id:712191,ime:"SMILjEVI"},{id:712205,ime:"SODERCE"},{id:712213,ime:"SREDNjI DEL"},{id:712221,ime:"SRPSKO MARGANCE"},{id:712230,ime:"STANCE"},{id:712248,ime:"STARA BREZOVICA"},{id:712264,ime:"STREAK"},{id:712272,ime:"STROPSKO"},{id:712299,ime:"STRUGANICA"},{id:712302,ime:"STUDENA"},{id:712329,ime:"SUVI DOL"},{id:712337,ime:"SURDUL"},{id:712353,ime:"TESOVITE"},{id:712361,ime:"TIBUDE"},{id:712396,ime:"TRSTENA"},{id:712400,ime:"TUMBA"},{id:712418,ime:"UKOVAC"},{id:712426,ime:"URKOVICA"},{id:712434,ime:"UEVCE"},{id:712485,ime:"CRNI LUG"},{id:712507,ime:"ESTELIN"}]},{id:71358,ime:"VRANjSKA BANjA",katopstine:[{id:"*",ime:"Sve"},{id:711101,ime:"BABINA POLjANA"},{id:711187,ime:"BUJKOVAC"},{id:711268,ime:"VRANjSKA BANjA"},{id:711560,ime:"DUGA LUKA"},{id:711632,ime:"IZUMNO"},{id:711683,ime:"KLISURICA"},{id:711713,ime:"KORBEVAC"},{id:711721,ime:"KORBUL"},{id:711748,ime:"KRIVA FEJA"},{id:711764,ime:"KUMAREVO"},{id:711802,ime:"LEVA REKA"},{id:711845,ime:"LIPOVAC"},{id:711942,ime:"NESVRTA"},{id:712027,ime:"PANEVLjE"},{id:712035,ime:"PRVONEK"},{id:712043,ime:"PREVALAC"},{id:712167,ime:"SEBEVRANjE"},{id:712183,ime:"SLIVNICA"},{id:712256,ime:"STARI GLOG"},{id:712370,ime:"TOPLAC"},{id:712477,ime:"CRNI VRH"}]}]},{id:70556,ime:"ZAJEAR",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70556,ime:"ZAJEAR",katopstine:[{id:"*",ime:"Sve"},{id:705047,ime:"LASOVO"},{id:705098,ime:"PLANINICA"},{id:705152,ime:"BRUSNIK"},{id:705179,ime:"VELIKA JASIKOVA"},{id:705187,ime:"VELIKI JASENOVAC"},{id:705195,ime:"GLOGOVICA"},{id:705209,ime:"DUBOANE"},{id:705217,ime:"JELANICA"},{id:705225,ime:"KLENOVAC"},{id:705233,ime:"KOPRIVNICA"},{id:705250,ime:"MALA JASIKOVA"},{id:705268,ime:"MALI JASENOVAC"},{id:705276,ime:"METRI"},{id:705322,ime:"TABAKOVAC"},{id:705365,ime:"IPIKOVO"},{id:715727,ime:"VELIKI IZVOR"},{id:715735,ime:"VRAOGRNAC"},{id:715743,ime:"VRATARNICA"},{id:715751,ime:"GAMZIGRAD"},{id:715760,ime:"GORNjA BELA REKA"},{id:715778,ime:"GRADSKOVO"},{id:715786,ime:"GRLITE"},{id:715794,ime:"GRLjAN"},{id:715816,ime:"ZAGRAE"},{id:715859,ime:"ZVEZDAN"},{id:715875,ime:"LENOVAC"},{id:715883,ime:"LESKOVAC"},{id:715891,ime:"LUBNICA"},{id:715913,ime:"NIKOLIEVO"},{id:715930,ime:"PRLITA"},{id:715948,ime:"RGOTINA"},{id:715972,ime:"TRNAVAC"},{id:715999,ime:"HALOVO"},{id:716006,ime:"LjIVAR"},{id:717908,ime:"BOROVAC"},{id:718009,ime:"VRBICA"},{id:718378,ime:"MALI IZVOR"},{id:718394,ime:"MARINOVAC"},{id:718572,ime:"SELAKA"},{id:745022,ime:"SALA"},{id:745073,ime:"ZAJEAR"}]}]},{id:70645,ime:"KRAGUJEVAC",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70645,ime:"KRAGUJEVAC",katopstine:[{id:"*",ime:"Sve"},{id:701432,ime:"VLAKA"},{id:701564,ime:"KOTRAA"},{id:701599,ime:"LjUBIEVAC"},{id:701637,ime:"MASLOEVO"},{id:701700,ime:"STRAGARI"},{id:716928,ime:"ADINE LIVADE"},{id:717037,ime:"VELIKI ENj"},{id:717045,ime:"VINjITE"},{id:717118,ime:"GOLOELO"},{id:717126,ime:"GORNjE GRBICE I"},{id:717134,ime:"GORNjE GRBICE II"},{id:717177,ime:"GRONICA I"},{id:717185,ime:"GRONICA II"},{id:717223,ime:"DIVOSTIN"},{id:717231,ime:"DOBRAA"},{id:717240,ime:"DONjE GRBICE"},{id:717258,ime:"DRAGOBRAA"},{id:717274,ime:"DRAA"},{id:717282,ime:"DRENOVAC"},{id:717339,ime:"URISELO"},{id:717347,ime:"ERDE"},{id:717380,ime:"KAMENICA"},{id:717452,ime:"KUTLOVO"},{id:717525,ime:"MALA VRBICA"},{id:717606,ime:"POSKURICE"},{id:717614,ime:"PREKOPEA"},{id:717665,ime:"RAMAA"},{id:717681,ime:"ROGOJEVAC"},{id:717746,ime:"TRENjEVAK"},{id:717754,ime:"UGLjAREVAC"},{id:717797,ime:"LjIVOVAC"},{id:719102,ime:"BALjKOVAC"},{id:719153,ime:"BOTUNjE"},{id:719170,ime:"BUKOROVAC"},{id:719196,ime:"GORNjE KOMARICE"},{id:719200,ime:"DESIMIROVAC"},{id:719226,ime:"DONjA SABANTA"},{id:719234,ime:"DONjE KOMARICE"},{id:719285,ime:"JABUJE"},{id:719293,ime:"JOVANOVAC"},{id:719315,ime:"KORMAN"},{id:719331,ime:"LUNICE"},{id:719340,ime:"MALI ENj"},{id:719358,ime:"MARI"},{id:719374,ime:"MIRONI"},{id:719404,ime:"NOVI MILANOVAC"},{id:719412,ime:"OPORNICA"},{id:719439,ime:"PAJAZITOVO"},{id:719463,ime:"RESNIK"},{id:719498,ime:"TRMBAS"},{id:719501,ime:"CVETOJEVAC"},{id:719510,ime:"CEROVAC"},{id:719528,ime:"UMI"},{id:736481,ime:"GORNjE JARUICE"},{id:737534,ime:"VELIKA SUGUBINA"},{id:737542,ime:"VELIKE PELICE"},{id:737577,ime:"GORNjA SABANTA"},{id:737615,ime:"DULENE"},{id:745081,ime:"KRAGUJEVAC I"},{id:745090,ime:"KRAGUJEVAC II"},{id:745103,ime:"KRAGUJEVAC III"},{id:745111,ime:"KRAGUJEVAC IV"}]}]},{id:70653,ime:"KRALjEVO",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70653,ime:"KRALjEVO",katopstine:[{id:"*",ime:"Sve"},{id:717053,ime:"VITANOVAC"},{id:717061,ime:"VITKOVAC"},{id:717096,ime:"GLEDI"},{id:717100,ime:"GODAICA"},{id:717304,ime:"DRLUPA"},{id:717371,ime:"ZAKUTA"},{id:717487,ime:"LEEVO"},{id:717541,ime:"MILAVII"},{id:717550,ime:"MILAKOVAC"},{id:717584,ime:"PETROPOLjE"},{id:717592,ime:"PEENOG"},{id:717649,ime:"RAVANICA"},{id:717690,ime:"SIBNICA"},{id:717711,ime:"STUBAL"},{id:717789,ime:"UKOJEVAC"},{id:719536,ime:"ADRANI"},{id:719544,ime:"BAPSKO POLjE"},{id:719552,ime:"BOGUTOVAC"},{id:719579,ime:"BREZNA"},{id:719587,ime:"BRESNIK"},{id:719595,ime:"BUKOVICA"},{id:719617,ime:"VRBA"},{id:719625,ime:"VRDILA"},{id:719641,ime:"GOKANICA"},{id:719650,ime:"GOTOVAC"},{id:719676,ime:"GRDICA"},{id:719684,ime:"DEDEVCI"},{id:719692,ime:"DRAGOSINjCI"},{id:719706,ime:"DRAKII"},{id:719714,ime:"ZAKLOPAA"},{id:719722,ime:"ZAMANjE"},{id:719749,ime:"JARUJAK"},{id:719757,ime:"KAMENICA"},{id:719765,ime:"KOVANLUK"},{id:719773,ime:"KOVAI"},{id:719781,ime:"KONAREVO"},{id:719790,ime:"KRALjEVO"},{id:719803,ime:"KRUEVICA"},{id:719811,ime:"LAEVCI"},{id:719820,ime:"LOPATNICA"},{id:719838,ime:"MAGLI"},{id:719846,ime:"MATARUGE"},{id:719854,ime:"MELjANICA"},{id:719862,ime:"METIKO"},{id:719889,ime:"MILOAJ"},{id:719897,ime:"MRSA"},{id:719919,ime:"MUSINA REKA"},{id:719927,ime:"OBRVA"},{id:719935,ime:"OPLANII"},{id:719951,ime:"PEKANICA"},{id:719978,ime:"POPOVII"},{id:719986,ime:"PREDOLE"},{id:719994,ime:"PROGORELICA"},{id:720003,ime:"RATINA"},{id:720011,ime:"RIBNICA"},{id:720020,ime:"ROEVII"},{id:720038,ime:"RUDNjAK"},{id:720046,ime:"SAMAILA"},{id:720054,ime:"SIRA"},{id:720062,ime:"TRGOVITE"},{id:720089,ime:"CVETKE"},{id:720097,ime:"IBUKOVAC"},{id:726915,ime:"TOLINICA"},{id:736732,ime:"BARE"},{id:736775,ime:"BZOVIK"},{id:736830,ime:"BREZOVA"},{id:736864,ime:"VRH"},{id:736902,ime:"DOLAC"},{id:736937,ime:"DRAINIE"},{id:736945,ime:"AKOVO"},{id:736970,ime:"ZASAD"},{id:737127,ime:"MILIE"},{id:737135,ime:"MLANA"},{id:737178,ime:"ORLjA GLAVA"},{id:737216,ime:"PLANA"},{id:737259,ime:"POLUMIR"},{id:737313,ime:"REKA"},{id:737330,ime:"RUDNO"},{id:737348,ime:"SAVOVO"},{id:737399,ime:"TADENjE"},{id:737445,ime:"UE"},{id:737453,ime:"CERJE"},{id:744131,ime:"LAZAC"},{id:744603,ime:"TAVNIK"}]}]},{id:70670,ime:"KRUEVAC",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70670,ime:"KRUEVAC",katopstine:[{id:"*",ime:"Sve"},{id:720488,ime:"BELA VODA"},{id:720496,ime:"BELASICA"},{id:720500,ime:"BIVOLjE"},{id:720518,ime:"BOVAN"},{id:720526,ime:"BOLjEVAC"},{id:720534,ime:"BRAJKOVAC"},{id:720569,ime:"BUKOVICA"},{id:720577,ime:"BUCI"},{id:720593,ime:"VELIKA KRUEVICA"},{id:720607,ime:"VELIKI ILjEGOVAC"},{id:720615,ime:"VELIKO GOLOVODE"},{id:720623,ime:"VITANOVAC"},{id:720631,ime:"VRATARE"},{id:720640,ime:"VUAK"},{id:720658,ime:"GAVEZ"},{id:720666,ime:"GAGLOVO"},{id:720674,ime:"GARI"},{id:720682,ime:"GLOBARE"},{id:720704,ime:"GLOBODER"},{id:720712,ime:"GORNjI STEPO"},{id:720747,ime:"GREVCI"},{id:720755,ime:"GRKLjANE"},{id:720763,ime:"DVORANE"},{id:720771,ime:"DEDINA"},{id:720780,ime:"DOLjANE"},{id:720798,ime:"DONjI STEPO"},{id:720810,ime:"UNIS"},{id:720828,ime:"ZDRAVINjE"},{id:720836,ime:"ZEBICA"},{id:720844,ime:"ZUBOVAC"},{id:720852,ime:"JABLANICA"},{id:720879,ime:"JASIKA"},{id:720887,ime:"JOJE"},{id:720895,ime:"KAMENARE"},{id:720909,ime:"KAONIK"},{id:720917,ime:"KAPIDIJA"},{id:720925,ime:"KOBILjE"},{id:720933,ime:"KOMORANE"},{id:720941,ime:"KONjUH"},{id:720950,ime:"KRVAVICA"},{id:720968,ime:"KRUEVAC"},{id:720976,ime:"KRUINCE"},{id:720984,ime:"KUKLjIN"},{id:720992,ime:"KUPCI"},{id:721e3,ime:"LAZARICA"},{id:721026,ime:"LIPOVAC"},{id:721034,ime:"LOVCI"},{id:721042,ime:"LOMNICA"},{id:721069,ime:"LUKAVAC"},{id:721077,ime:"LjUBAVA"},{id:721085,ime:"MAJDEVO"},{id:721093,ime:"MAKREANE"},{id:721107,ime:"MALA VRBNICA"},{id:721115,ime:"MALA REKA"},{id:721123,ime:"MALI ILjEGOVAC"},{id:721131,ime:"MALO GOLOVODE"},{id:721140,ime:"MAKOVAC"},{id:721158,ime:"MEEVO"},{id:721166,ime:"MODRICA"},{id:721212,ime:"MUDRAKOVAC"},{id:721239,ime:"NAUPARE"},{id:721247,ime:"PADE"},{id:721255,ime:"PAKANICA"},{id:721263,ime:"PARUNOVAC"},{id:721271,ime:"PASJAK"},{id:721280,ime:"PEPELjEVAC"},{id:721298,ime:"PETINA"},{id:721301,ime:"POZLATA"},{id:721310,ime:"POLjACI"},{id:721328,ime:"RIBARE"},{id:721336,ime:"RLICA"},{id:721344,ime:"ROSICA"},{id:721352,ime:"SEBEEVAC"},{id:721379,ime:"SEZEME"},{id:721387,ime:"SLATINA"},{id:721395,ime:"SRNDALjE"},{id:721409,ime:"SRNjE"},{id:721417,ime:"STANCI"},{id:721425,ime:"SUICA"},{id:721433,ime:"TEKIJA"},{id:721441,ime:"TREBOTIN"},{id:721450,ime:"TRMARE"},{id:721476,ime:"ELIJE"},{id:721484,ime:"CEROVA"},{id:721492,ime:"CRKVINA"},{id:721506,ime:"ITLUK"},{id:721514,ime:"AVRANE"},{id:721522,ime:"ANAC"},{id:721549,ime:"AILOVAC"},{id:721557,ime:"OGOLj"},{id:721565,ime:"TITARE"},{id:741698,ime:"LAZAREVAC"}]}]},{id:70726,ime:"LESKOVAC",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70726,ime:"LESKOVAC",katopstine:[{id:"*",ime:"Sve"},{id:709620,ime:"BRIEVLjE"},{id:709824,ime:"KORAEVAC"},{id:709948,ime:"MRKOVICA"},{id:709999,ime:"PREDEJANE (VARO)"},{id:710008,ime:"PREDEJANE (SELO)"},{id:710130,ime:"SUEVLjE"},{id:710245,ime:"BOJIINA"},{id:710270,ime:"BOEVICA"},{id:710300,ime:"VILjE KOLO"},{id:710423,ime:"GRDELICA (VARO)"},{id:710431,ime:"GRDELICA (SELO)"},{id:710474,ime:"DEDINA BARA"},{id:710539,ime:"DOBROTIN"},{id:710636,ime:"KOVAEVA BARA"},{id:710644,ime:"KOZARE"},{id:710709,ime:"KRPEJCE"},{id:710741,ime:"LIIN DOL"},{id:710768,ime:"NOVO SELO"},{id:710814,ime:"PALOJCE"},{id:710890,ime:"RAJNO POLjE"},{id:710946,ime:"SEJANICA"},{id:711012,ime:"TUPALOVCE"},{id:711047,ime:"CRVENI BREG"},{id:723479,ime:"GAGINCE"},{id:723959,ime:"MELOVO"},{id:724041,ime:"ORUGLICA"},{id:724173,ime:"RAVNI DEL"},{id:724513,ime:"BABIKO"},{id:724521,ime:"BADINCE"},{id:724530,ime:"BARJE"},{id:724548,ime:"BELANOVCE"},{id:724556,ime:"BELI POTOK"},{id:724564,ime:"BISTRICA"},{id:724572,ime:"BOBITE"},{id:724599,ime:"BOGOJEVCE"},{id:724602,ime:"BRATMILOVCE"},{id:724629,ime:"BREJANOVCE"},{id:724637,ime:"BRESTOVAC"},{id:724645,ime:"BRZA"},{id:724653,ime:"BUKOVA GLAVA"},{id:724661,ime:"BUNUA"},{id:724670,ime:"VELIKA BILjANICA"},{id:724688,ime:"VELIKA GRABOVNICA"},{id:724696,ime:"VELIKA KOPANICA"},{id:724700,ime:"VELIKO TRNjANE"},{id:724718,ime:"VINA"},{id:724726,ime:"VINARCE"},{id:724734,ime:"VLASE"},{id:724742,ime:"VUJE"},{id:724769,ime:"GORINA"},{id:724777,ime:"GORNjA JAJINA"},{id:724785,ime:"GORNjA KUPINOVICA"},{id:724793,ime:"GORNjA LOKONICA"},{id:724807,ime:"GORNjA SLATINA"},{id:724823,ime:"GORNjE KRAJINCE"},{id:724831,ime:"GORNjE SINKOVCE"},{id:724840,ime:"GORNjE STOPANjE"},{id:724858,ime:"GORNjE TRNjANE"},{id:724866,ime:"GORNjI BUNIBROD"},{id:724874,ime:"GRADANICA"},{id:724882,ime:"GRAJEVCE"},{id:724904,ime:"GRAOVO"},{id:724912,ime:"GRDANICA"},{id:724939,ime:"GUBEREVAC"},{id:724947,ime:"DONjA JAJINA"},{id:724955,ime:"DONjA KUPINOVICA"},{id:724963,ime:"DONjA LOKONICA"},{id:724971,ime:"DONjA SLATINA"},{id:724980,ime:"DONjE BRIJANjE"},{id:724998,ime:"DONjE KRAJINCE"},{id:725005,ime:"DONjE SINKOVCE"},{id:725013,ime:"DONjE STOPANjE"},{id:725021,ime:"DONjE TRNjANE"},{id:725030,ime:"DONjI BUNIBROD"},{id:725048,ime:"DRAKOVAC"},{id:725056,ime:"DRVODELjA"},{id:725064,ime:"DREVAC"},{id:725072,ime:"DUANOVO"},{id:725102,ime:"ABLjANE"},{id:725129,ime:"IVKOVO"},{id:725137,ime:"IAVICA"},{id:725145,ime:"ZAGUANE"},{id:725153,ime:"ZALUNjE"},{id:725161,ime:"ZLOKUANE"},{id:725170,ime:"ZLOUDOVO"},{id:725188,ime:"ZOLjEVO"},{id:725196,ime:"IGRITE"},{id:725200,ime:"JARSENOVO"},{id:725218,ime:"JAUNjA"},{id:725226,ime:"JELANICA"},{id:725234,ime:"KALUERCE"},{id:725242,ime:"KARAOREVAC"},{id:725285,ime:"KATAVAR"},{id:725307,ime:"KUKULOVCE"},{id:725315,ime:"KUMAREVO"},{id:725323,ime:"KUTLE"},{id:725340,ime:"LESKOVAC"},{id:725358,ime:"LIPOVICA"},{id:725366,ime:"MALA BILjANICA"},{id:725374,ime:"MALA GRABOVNICA"},{id:725382,ime:"MALA KOPANICA"},{id:725404,ime:"MANOJLOVCE"},{id:725412,ime:"MEA"},{id:725439,ime:"MILANOVO"},{id:725447,ime:"MIROEVCE"},{id:725455,ime:"MRTANE"},{id:725463,ime:"NAVALIN"},{id:725471,ime:"NAKRIVANj"},{id:725480,ime:"NESVRTA"},{id:725498,ime:"NOMANICA"},{id:725510,ime:"ORAOVICA"},{id:725528,ime:"ORAAC"},{id:725536,ime:"PADE"},{id:725544,ime:"PALIKUA"},{id:725552,ime:"PETROVAC"},{id:725579,ime:"PEENjEVCE"},{id:725587,ime:"PISKUPOVO"},{id:725595,ime:"PODRIMCE"},{id:725609,ime:"PRESEINA"},{id:725617,ime:"PRIBOJ"},{id:725625,ime:"RADONjICA"},{id:725633,ime:"RAZGOJNA"},{id:725641,ime:"RUDARE"},{id:725650,ime:"SVIRCE"},{id:725668,ime:"SLAVUJEVCE"},{id:725676,ime:"SLATINA"},{id:725684,ime:"SMRDAN"},{id:725692,ime:"STROJKOVCE"},{id:725714,ime:"STUPNICA"},{id:725722,ime:"TODOROVCE"},{id:725749,ime:"TULOVO"},{id:725757,ime:"TUREKOVAC"},{id:725773,ime:"CRKOVNICA"},{id:725781,ime:"CRCAVAC"},{id:725790,ime:"EKMIN"},{id:725803,ime:"IFLUK RAZGOJNSKI"},{id:725811,ime:"UKLjENIK"},{id:725820,ime:"AINOVAC"},{id:725838,ime:"ARLINCE"},{id:725846,ime:"IINCE"}]}]},{id:70734,ime:"LOZNICA",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70734,ime:"LOZNICA",katopstine:[{id:"*",ime:"Sve"},{id:725854,ime:"BANjA KOVILjAA"},{id:725862,ime:"BRADI"},{id:725897,ime:"BRNjAC"},{id:725919,ime:"VELIKO SELO"},{id:725927,ime:"VONjAK"},{id:725935,ime:"GORNjA BADANjA"},{id:725943,ime:"GORNjA BORINA"},{id:725951,ime:"GORNjA SIPULjA"},{id:725960,ime:"GORNjE NEDELjICE"},{id:725978,ime:"GORNjI DOBRI"},{id:725986,ime:"GRNARA"},{id:726001,ime:"DONjA BADANjA"},{id:726028,ime:"DONjA SIPULjA"},{id:726036,ime:"DONjE NEDELjICE"},{id:726044,ime:"DONjI DOBRI"},{id:726052,ime:"DRAGINAC"},{id:726079,ime:"ZAJAA"},{id:726087,ime:"JADRANSKA LENICA"},{id:726095,ime:"JAREBICE"},{id:726109,ime:"JELAV"},{id:726117,ime:"JOEVA"},{id:726125,ime:"JUGOVII"},{id:726133,ime:"KAMENICA"},{id:726150,ime:"KOZJAK"},{id:726168,ime:"KORENITA"},{id:726192,ime:"LIPNICA"},{id:726222,ime:"MILINA"},{id:726249,ime:"NOVO SELO"},{id:726257,ime:"PASKOVAC"},{id:726265,ime:"POMIJAA"},{id:726273,ime:"RIBARICE"},{id:726281,ime:"RUNjANI"},{id:726290,ime:"SIMINO BRDO"},{id:726303,ime:"SLATINA"},{id:726311,ime:"STRAA"},{id:726320,ime:"STUPNICA"},{id:726338,ime:"TEKERI"},{id:726346,ime:"TRBOSILjE"},{id:726354,ime:"TRBUNICA"},{id:726362,ime:"TRI"},{id:726389,ime:"FILIPOVII"},{id:726397,ime:"CIKOTE"},{id:726419,ime:"OKEINA"},{id:726427,ime:"OR"},{id:726435,ime:"URICE"},{id:745189,ime:"LOZNICA"},{id:745197,ime:"LENICA"}]}]},{id:70874,ime:"NOVI PAZAR",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70874,ime:"NOVI PAZAR",katopstine:[{id:"*",ime:"Sve"},{id:730432,ime:"ALULOVIE"},{id:730459,ime:"BAJEVICA"},{id:730467,ime:"BANjA"},{id:730475,ime:"BARE"},{id:730483,ime:"BATNjIK"},{id:730491,ime:"BEKOVA"},{id:730505,ime:"BELE VODE"},{id:730513,ime:"BOTUROVINA"},{id:730521,ime:"BRANI"},{id:730530,ime:"BRESTOVO"},{id:730548,ime:"VAREVO"},{id:730556,ime:"VEVER"},{id:730564,ime:"VIDOVO"},{id:730572,ime:"VITKOVIE"},{id:730599,ime:"VOJKOVIE"},{id:730602,ime:"VOJNIE"},{id:730629,ime:"VRANOVINA"},{id:730637,ime:"VUINIE"},{id:730645,ime:"VUJA LOKVA"},{id:730653,ime:"GOLICE"},{id:730661,ime:"GORNjA TUIMLjA"},{id:730670,ime:"GOEVO"},{id:730688,ime:"GRAANOVIE"},{id:730696,ime:"GRAANE"},{id:730700,ime:"GRUBETIE"},{id:730718,ime:"DEEVA"},{id:730726,ime:"DOJINOVIE"},{id:730734,ime:"DOLAC"},{id:730742,ime:"DOLjANI"},{id:730769,ime:"DRAGOEVO"},{id:730777,ime:"DRAMIE"},{id:730785,ime:"UNjEVIE"},{id:730793,ime:"ZABRE"},{id:730807,ime:"ZLATARE"},{id:730815,ime:"IVANA"},{id:730823,ime:"IZBICE"},{id:730831,ime:"JABLANICA"},{id:730840,ime:"JAVOR"},{id:730858,ime:"JANA"},{id:730866,ime:"JOVA"},{id:730874,ime:"KAALj"},{id:730882,ime:"KOVAEVO"},{id:730904,ime:"KOLjE"},{id:730912,ime:"KOPRIVNICA"},{id:730939,ime:"KOSURIE"},{id:730947,ime:"KRUEVO"},{id:730955,ime:"KUZMIEVO"},{id:730963,ime:"LEA"},{id:730971,ime:"LOPUNjE"},{id:730980,ime:"LUKARE"},{id:730998,ime:"LUKARSKO GOEVO"},{id:731005,ime:"LUKOCREVO"},{id:731013,ime:"MIIE"},{id:731021,ime:"MUR"},{id:731030,ime:"MUHOVO"},{id:731048,ime:"NEGOTINAC"},{id:731056,ime:"NOVI PAZAR"},{id:731064,ime:"ODOJEVIE"},{id:731072,ime:"OKOSE"},{id:731099,ime:"OSAONICA"},{id:731102,ime:"OSOJE"},{id:731129,ime:"OHOLjE"},{id:731137,ime:"PAVLjE"},{id:731145,ime:"PARALOVO"},{id:731153,ime:"PASJI POTOK"},{id:731161,ime:"PILARETA"},{id:731170,ime:"POBRE"},{id:731188,ime:"POEGA"},{id:731196,ime:"POEINA"},{id:731200,ime:"POLOKCE"},{id:731218,ime:"POPE"},{id:731226,ime:"POSTENjE"},{id:731234,ime:"PRENOVA"},{id:731242,ime:"PUSTA TUIMLjA"},{id:731269,ime:"PUSTOVLAH"},{id:731277,ime:"RADALjICA"},{id:731285,ime:"RAJETIE"},{id:731293,ime:"RAJKOVIE"},{id:731307,ime:"RAJINOVIE"},{id:731315,ime:"RAJINOVIKA TRNAVA"},{id:731323,ime:"RAKOVAC"},{id:731331,ime:"RAST"},{id:731340,ime:"SEBEEVO"},{id:731358,ime:"SITNIE"},{id:731366,ime:"SKUKOVO"},{id:731374,ime:"SLATINA"},{id:731382,ime:"SMILOV LAZ"},{id:731404,ime:"SREDNjA TUIMLjA"},{id:731412,ime:"STRADOVO"},{id:731439,ime:"SUDSKO SELO"},{id:731447,ime:"TENKOVO"},{id:731455,ime:"TRNAVA"},{id:731463,ime:"TUNOVO"},{id:731471,ime:"HOTKOVO"},{id:731480,ime:"COKOVIE"},{id:731498,ime:"AI DOLAC"},{id:731501,ime:"AVCI"},{id:731510,ime:"ARONjE"},{id:731528,ime:"TITARE"}]}]},{id:70939,ime:"PIROT",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70939,ime:"PIROT",katopstine:[{id:"*",ime:"Sve"},{id:713732,ime:"VLASI"},{id:713783,ime:"GORNjA DRINA"},{id:714097,ime:"SLAVINjA"},{id:733105,ime:"BAZOVIK"},{id:733113,ime:"BARJE IFLIK"},{id:733121,ime:"BASARA"},{id:733130,ime:"BELA"},{id:733148,ime:"BERILOVAC"},{id:733156,ime:"BEROVICA"},{id:733164,ime:"BLATO"},{id:733172,ime:"BRLOG"},{id:733199,ime:"VELIKA LUKANjA"},{id:733202,ime:"VELIKI JOVANOVAC"},{id:733229,ime:"VELIKI SUVODOL"},{id:733237,ime:"VELIKO SELO"},{id:733245,ime:"VISOKA RANA"},{id:733253,ime:"VOJNEGOVAC"},{id:733261,ime:"VRANITE"},{id:733270,ime:"GNjILAN"},{id:733288,ime:"GOSTUA"},{id:733296,ime:"GRADANICA"},{id:733300,ime:"GRADITE"},{id:733318,ime:"DOBRI DO"},{id:733326,ime:"DOJKINCI"},{id:733334,ime:"DRINA"},{id:733342,ime:"ZAVOJ"},{id:733369,ime:"ZASKOVCI"},{id:733377,ime:"IZVOR"},{id:733385,ime:"JALBOTINA"},{id:733393,ime:"JELOVICA"},{id:733407,ime:"KAMIK"},{id:733415,ime:"KOPRIVTICA"},{id:733423,ime:"KOSTUR"},{id:733431,ime:"KRUPAC"},{id:733440,ime:"KUMANOVO"},{id:733458,ime:"MALA LUKANjA"},{id:733466,ime:"MALI JOVANOVAC"},{id:733474,ime:"MALI SUVODOL"},{id:733482,ime:"MILOJKOVAC"},{id:733504,ime:"MIRKOVCI"},{id:733512,ime:"NIOR"},{id:733539,ime:"OBRENOVAC"},{id:733547,ime:"OREOVICA"},{id:733555,ime:"ORLjA"},{id:733563,ime:"OSMAKOVO"},{id:733571,ime:"PAKLETICA"},{id:733580,ime:"PASJA"},{id:733598,ime:"PETROVAC"},{id:733601,ime:"PIROT-VAN VARO"},{id:733610,ime:"PIROT-GRAD"},{id:733628,ime:"PLANINICA"},{id:733636,ime:"POKREVENIK"},{id:733644,ime:"POLjSKA RANA"},{id:733652,ime:"PONOR"},{id:733679,ime:"PRISJAN"},{id:733687,ime:"RAGODE"},{id:733695,ime:"RASNICA"},{id:733709,ime:"ROSOMA"},{id:733717,ime:"RSOVCI"},{id:733725,ime:"RUDINjE"},{id:733733,ime:"SINjA GLAVA"},{id:733741,ime:"SOPOT"},{id:733750,ime:"SREKOVAC"},{id:733768,ime:"STANIENjE"},{id:733776,ime:"SUKOVO"},{id:733784,ime:"TEMSKA"},{id:733792,ime:"TOPLI DO"},{id:733806,ime:"TRNjANA"},{id:733814,ime:"CEREV DEL"},{id:733822,ime:"CEROVA"},{id:733849,ime:"CRVENEVO"},{id:733857,ime:"CRNOKLITE"},{id:733865,ime:"INIGLAVCI"},{id:733873,ime:"UGRIN"}]}]},{id:79049,ime:"POAREVAC",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:70947,ime:"POAREVAC",katopstine:[{id:"*",ime:"Sve"},{id:708844,ime:"KLIEVAC"},{id:709e3,ime:"REICA"},{id:733890,ime:"BARE"},{id:733903,ime:"BATOVAC"},{id:733920,ime:"BERANjE"},{id:733946,ime:"BRADARAC"},{id:733954,ime:"BRATINAC"},{id:733962,ime:"BREANE"},{id:733989,ime:"BUBUINAC"},{id:734012,ime:"DRAGOVAC"},{id:734039,ime:"DRMNO"},{id:734047,ime:"DUBRAVICA"},{id:734055,ime:"IVICA"},{id:734080,ime:"KASIDOL"},{id:734128,ime:"LUICA"},{id:734136,ime:"MALjUREVAC"},{id:734152,ime:"NABRE"},{id:734195,ime:"POAREVAC"},{id:734209,ime:"POLjANA"},{id:734268,ime:"TRNjANE"},{id:734276,ime:"IRIKOVAC"},{id:745120,ime:"PRUGOVO"}]},{id:71340,ime:"KOSTOLAC",katopstine:[{id:"*",ime:"Sve"},{id:734098,ime:"KLENOVNIK"},{id:734179,ime:"OSTROVO"},{id:734187,ime:"PETKA"},{id:734306,ime:"KOSTOLAC-GRAD"},{id:734314,ime:"KOSTOLAC SELO"}]}]},{id:71048,ime:"JAGODINA",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:71048,ime:"JAGODINA",katopstine:[{id:"*",ime:"Sve"},{id:737828,ime:"SLATINA"},{id:737836,ime:"STARO SELO"},{id:737895,ime:"BAGRDAN (VAROICA)"},{id:737909,ime:"BAGRDAN (SELO)"},{id:737917,ime:"BELICA"},{id:737933,ime:"BRESJE"},{id:737941,ime:"BUKOVE"},{id:737950,ime:"BUNAR"},{id:737968,ime:"VINORAA"},{id:737976,ime:"VOLjAVE"},{id:737984,ime:"VRANOVAC"},{id:737992,ime:"VRBA"},{id:738e3,ime:"GLAVINCI"},{id:738018,ime:"GLOGOVAC"},{id:738026,ime:"GORNjE TIPLjE"},{id:738034,ime:"GORNjI RANIK"},{id:738069,ime:"DEONICA"},{id:738077,ime:"DONjE TIPLjE"},{id:738085,ime:"DONjI RANIK"},{id:738093,ime:"DRAGOCVET"},{id:738107,ime:"DRAGOEVAC"},{id:738115,ime:"DRAMIROVAC"},{id:738123,ime:"DUBOKA"},{id:738131,ime:"IVKOVAKI PRNjAVOR"},{id:738158,ime:"JOANIKI PRNjAVOR"},{id:738166,ime:"KALENOVAC"},{id:738174,ime:"KOVAEVAC"},{id:738182,ime:"KOLARE"},{id:738204,ime:"KONAREVO"},{id:738212,ime:"KOINO SELO"},{id:738239,ime:"LANITE"},{id:738247,ime:"LOVCI"},{id:738255,ime:"LOZOVIK"},{id:738271,ime:"LUKAR"},{id:738280,ime:"MAJUR"},{id:738298,ime:"MALI POPOVI"},{id:738301,ime:"MEDOJEVAC"},{id:738310,ime:"MEURE"},{id:738336,ime:"MILOEVO"},{id:738344,ime:"MIEVI"},{id:738379,ime:"RAKITOVO"},{id:738387,ime:"RIBARE"},{id:738395,ime:"RIBNIK"},{id:738409,ime:"JAGODINA"},{id:738425,ime:"SIOKOVAC"},{id:738433,ime:"STRIILO"},{id:738441,ime:"TOPOLA"},{id:738468,ime:"TRNAVA"},{id:738476,ime:"CRNE"},{id:738484,ime:"ANTAROVAC"},{id:738492,ime:"ULjKOVAC"},{id:738581,ime:"DOBRA VODA"},{id:738719,ime:"RAJKINAC"}]}]},{id:71099,ime:"SMEDEREVO",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:71099,ime:"SMEDEREVO",katopstine:[{id:"*",ime:"Sve"},{id:708704,ime:"SARAORCI"},{id:739880,ime:"BADLjEVICA"},{id:739898,ime:"BINOVAC"},{id:739901,ime:"VODANj"},{id:739910,ime:"VRANOVO"},{id:739928,ime:"VRBOVAC"},{id:739936,ime:"VUAK"},{id:739944,ime:"DOBRI DO"},{id:739952,ime:"DRUGOVAC I"},{id:739979,ime:"DRUGOVAC II"},{id:739995,ime:"KOLARI"},{id:740004,ime:"KULI"},{id:740012,ime:"LANDOL"},{id:740039,ime:"LIPE I"},{id:740047,ime:"LIPE II"},{id:740055,ime:"LUGAVINA"},{id:740063,ime:"MALA KRSNA"},{id:740071,ime:"MALO ORAJE"},{id:740080,ime:"MIHAJLOVAC"},{id:740098,ime:"OSIPAONICA"},{id:740101,ime:"PETRIJEVO"},{id:740110,ime:"RADINAC"},{id:740128,ime:"RALjA"},{id:740136,ime:"SEONE"},{id:740144,ime:"SKOBALj"},{id:740152,ime:"SMEDEREVO"},{id:740179,ime:"SUVODOL"},{id:740187,ime:"UDOVICE"},{id:740195,ime:"ALINAC"},{id:740373,ime:"LUNjEVAC"}]}]},{id:79065,ime:"UICE",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:71145,ime:"UICE",katopstine:[{id:"*",ime:"Sve"},{id:741124,ime:"BIOSKA"},{id:741132,ime:"BUAR"},{id:741159,ime:"VRUTCI"},{id:741167,ime:"GORJANI"},{id:741175,ime:"GOSTINICA"},{id:741183,ime:"GUBIN DO"},{id:741191,ime:"DOBRODO"},{id:741205,ime:"DRENIK"},{id:741213,ime:"DRIJETANj"},{id:741221,ime:"DUBOKO"},{id:741230,ime:"ZBOJTICA"},{id:741248,ime:"ZLAKUSA"},{id:741256,ime:"KAMENICA"},{id:741264,ime:"KARAN"},{id:741272,ime:"KAER"},{id:741299,ime:"KRVAVCI"},{id:741329,ime:"LELII"},{id:741337,ime:"LjUBANjE"},{id:741353,ime:"NIKOJEVII"},{id:741361,ime:"PONIKOVICA"},{id:741370,ime:"POTOANjE"},{id:741388,ime:"POTPEE"},{id:741396,ime:"RAVNI"},{id:741400,ime:"RIBAEVINA"},{id:741426,ime:"SKRUTI"},{id:741434,ime:"STAPARI"},{id:741442,ime:"UICE"},{id:741477,ime:"TRNAVA"},{id:743810,ime:"KREMNA"},{id:743879,ime:"MOKRA GORA"}]},{id:71366,ime:"SEVOJNO",katopstine:[{id:"*",ime:"Sve"},{id:741418,ime:"SEVOJNO"}]}]},{id:71242,ime:"AAK",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:71242,ime:"AAK",katopstine:[{id:"*",ime:"Sve"},{id:726451,ime:"BREZOVICA"},{id:743984,ime:"ATENICA"},{id:743992,ime:"BALUGA (TRNAVSKA)"},{id:744e3,ime:"BANjICA"},{id:744026,ime:"VAPA"},{id:744034,ime:"VILjUA"},{id:744042,ime:"GORIANI"},{id:744069,ime:"AOANI"},{id:744077,ime:"ZABLAE"},{id:744085,ime:"JEEVICA"},{id:744093,ime:"JEZDINA"},{id:744107,ime:"KAULICE"},{id:744115,ime:"KUKII"},{id:744123,ime:"KULINOVCI"},{id:744140,ime:"LIPNICA"},{id:744158,ime:"LOZNICA"},{id:744166,ime:"MEUVRJE"},{id:744174,ime:"MRINCI"},{id:744182,ime:"PAKOVRAE"},{id:744204,ime:"PARMENAC"},{id:744212,ime:"PETNICA"},{id:744239,ime:"PREMEA"},{id:744247,ime:"PRIDVORICA"},{id:744255,ime:"RAJAC"},{id:744263,ime:"RIAGE"},{id:744271,ime:"SLATINA"},{id:744280,ime:"TRNAVA"},{id:744298,ime:"AAK"},{id:744301,ime:"BALUGA (LjUBISKA)"},{id:744310,ime:"BEANj"},{id:744336,ime:"BRESNICA"},{id:744344,ime:"VIDOVA"},{id:744352,ime:"VRANII"},{id:744379,ime:"VRNANI"},{id:744387,ime:"VUJETINCI"},{id:744395,ime:"GORNjA GOREVNICA"},{id:744409,ime:"GORNjA TREPA"},{id:744417,ime:"DONjA GOREVNICA"},{id:744425,ime:"DONjA TREPA"},{id:744433,ime:"JANII"},{id:744441,ime:"KATRGA"},{id:744450,ime:"KONjEVII"},{id:744468,ime:"LjUBI"},{id:744476,ime:"MILIEVCI"},{id:744484,ime:"MIOKOVCI"},{id:744492,ime:"MOJSINjE"},{id:744506,ime:"MRAJEVCI"},{id:744514,ime:"OSTRA"},{id:744522,ime:"PRELjINA"},{id:744549,ime:"PRIJEVOR"},{id:744557,ime:"PRISLONICA"},{id:744565,ime:"RAKOVA"},{id:744573,ime:"ROCI"},{id:744581,ime:"SOKOLII"},{id:744590,ime:"STANII"},{id:744611,ime:"TRBUANI"},{id:745162,ime:"BELjINA"}]}]},{id:71269,ime:"ABAC",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:71269,ime:"ABAC",katopstine:[{id:"*",ime:"Sve"},{id:704598,ime:"BELA REKA"},{id:704644,ime:"DRENOVAC"},{id:704679,ime:"DUVANITE"},{id:704687,ime:"ZMINjAK"},{id:704709,ime:"LIPOLIST"},{id:704717,ime:"MAVANSKI PRIINOVI"},{id:704741,ime:"PETKOVICA"},{id:704750,ime:"PETLOVAA"},{id:704768,ime:"PRNjAVOR"},{id:704776,ime:"RIBARI"},{id:704792,ime:"SLEPEVI"},{id:704814,ime:"TABANOVI"},{id:704857,ime:"EVARICE"},{id:704865,ime:"TITAR"},{id:709557,ime:"CEROVAC"},{id:744620,ime:"BOGOSAVAC"},{id:744638,ime:"BOJI"},{id:744646,ime:"BUKOR"},{id:744654,ime:"VARNA"},{id:744662,ime:"VOLUJAC"},{id:744689,ime:"GORNjA VRANjSKA"},{id:744697,ime:"GRUI"},{id:744719,ime:"DVORITE"},{id:744727,ime:"DESI"},{id:744735,ime:"DOBRI"},{id:744751,ime:"ABAR"},{id:744760,ime:"ZABLAE"},{id:744778,ime:"JEVREMOVAC"},{id:744786,ime:"JELENA"},{id:744794,ime:"KORMAN"},{id:744808,ime:"KRIVAJA"},{id:744816,ime:"MAJUR"},{id:744824,ime:"MALA VRANjSKA"},{id:744832,ime:"MAOVI"},{id:744859,ime:"POCERSKI METKOVI"},{id:744867,ime:"METLI"},{id:744875,ime:"MIOKUS"},{id:744883,ime:"MIAR"},{id:744891,ime:"MRENOVAC"},{id:744905,ime:"NAKUANI"},{id:744913,ime:"ORAAC"},{id:744921,ime:"ORID"},{id:744930,ime:"POCERSKI PRIINOVI"},{id:744948,ime:"PREDVORICA"},{id:744956,ime:"RADOVANICA"},{id:744964,ime:"RUMSKA"},{id:744972,ime:"SINOEVI"},{id:745006,ime:"CULjKOVI"},{id:745014,ime:"ABAC"}]}]},{id:79022,ime:"NI",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:71285,ime:"NIKA BANjA",katopstine:[{id:"*",ime:"Sve"},{id:729043,ime:"BANCAREVO"},{id:729221,ime:"GORNjA STUDENA"},{id:729361,ime:"DONjA STUDENA"},{id:729523,ime:"JELANICA"},{id:729639,ime:"KUNOVICA"},{id:729647,ime:"LAZAREVO SELO"},{id:729825,ime:"NIKA BANjA"},{id:729876,ime:"OSTROVICA"},{id:729949,ime:"PRVA KUTINA"},{id:729957,ime:"PROSEK-MANASTIR"},{id:729965,ime:"RAVNI DO"},{id:729973,ime:"RADIKINA BARA"},{id:729981,ime:"RAUTOVO"},{id:730025,ime:"SIEVO"},{id:730173,ime:"UKLjENIK"}]},{id:71307,ime:"PANTELEJ",katopstine:[{id:"*",ime:"Sve"},{id:729086,ime:"BRENICA"},{id:729159,ime:"VRELO"},{id:729213,ime:"GORNjA VREINA"},{id:729337,ime:"GORNjI MATEJEVAC"},{id:729353,ime:"DONjA VREINA"},{id:729469,ime:"DONjI MATEJEVAC I"},{id:729477,ime:"DONjI MATEJEVAC II"},{id:729515,ime:"JASENOVIK"},{id:729540,ime:"KAMENICA"},{id:729574,ime:"KNEZ SELO"},{id:729710,ime:"MALA"},{id:729787,ime:'NI "PANTELEJ"'},{id:729868,ime:"OREOVAC"},{id:729906,ime:"PASJAA"},{id:730106,ime:"CERJE"}]},{id:71315,ime:"CRVENI KRST",katopstine:[{id:"*",ime:"Sve"},{id:700614,ime:"VELE POLjE"},{id:700762,ime:"PALIGRACE"},{id:701246,ime:"SEANICA"},{id:701289,ime:"SUPOVAC"},{id:729078,ime:"BERINAC"},{id:729167,ime:"VRTITE"},{id:729230,ime:"GORNjA TOPONICA"},{id:729248,ime:"GORNjA TRNAVA"},{id:729329,ime:"GORNjI KOMREN"},{id:729370,ime:"DONjA TOPONICA"},{id:729388,ime:"DONjA TRNAVA"},{id:729442,ime:"DONjI KOMREN"},{id:729604,ime:"KRAVLjE"},{id:729663,ime:"LESKOVIK"},{id:729736,ime:"MEDOEVAC"},{id:729744,ime:"MEZGRAJA"},{id:729779,ime:"MILjKOVAC"},{id:729817,ime:'NI "CRVENI KRST"'},{id:729884,ime:"PALjINA"},{id:729922,ime:"POPOVAC"},{id:729990,ime:"RUJNIK"},{id:730068,ime:"TRUPALE"},{id:730092,ime:"HUM"},{id:730122,ime:"AMURLIJA"}]},{id:71323,ime:"PALILULA (NI)",katopstine:[{id:"*",ime:"Sve"},{id:715280,ime:"KRUCE"},{id:715344,ime:"MRAMOR"},{id:729060,ime:"BERBATOVO"},{id:729108,ime:"BUBANj"},{id:729175,ime:"VUKMANOVO"},{id:729183,ime:"GABROVAC"},{id:729272,ime:"GORNjE MEUROVO"},{id:729396,ime:"DONjE VLASE"},{id:729418,ime:"DONjE MEUROVO"},{id:729655,ime:"LALINAC"},{id:729841,ime:"NOVO SELO"},{id:729892,ime:"PASI POLjANA"},{id:730165,ime:"OKOT"},{id:745251,ime:"SUVI DO"}]},{id:71331,ime:"MEDIJANA",katopstine:[{id:"*",ime:"Sve"},{id:729094,ime:"BRZI BROD"},{id:729795,ime:'NI "BUBANj"'},{id:729809,ime:'NI "ELE KULA"'}]}]},{id:80128,ime:"VRAC",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:80128,ime:"VRAC",katopstine:[{id:"*",ime:"Sve"},{id:800457,ime:"IZBITE"},{id:800546,ime:"OREAC"},{id:800562,ime:"PARTA"},{id:800619,ime:"STRAA"},{id:800627,ime:"UARA"},{id:800635,ime:"ULjMA"},{id:800651,ime:"ZAGAJICA"},{id:804754,ime:"GUDURICA"},{id:804762,ime:"JABLANKA"},{id:804789,ime:"KUTILj"},{id:804797,ime:"MALI AM"},{id:804819,ime:"MARKOVAC"},{id:804827,ime:"MALO SREDITE"},{id:804835,ime:"MESI"},{id:804843,ime:"PAVLI"},{id:804851,ime:"POTPORANj"},{id:804860,ime:"RITIEVO"},{id:804878,ime:"SOICA I"},{id:804894,ime:"VATIN"},{id:804908,ime:"VELIKO SREDITE"},{id:804916,ime:"VLAJKOVAC"},{id:804924,ime:"VOJVODINCI"},{id:804932,ime:"VRAC"},{id:805823,ime:"SOICA II"}]}]},{id:80152,ime:"ZRENjANIN",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:80152,ime:"ZRENjANIN",katopstine:[{id:"*",ime:"Sve"},{id:800945,ime:"BANATSKI DESPOTOVAC"},{id:802581,ime:"BELO BLATO"},{id:802603,ime:"BOTO"},{id:802620,ime:"ENTA"},{id:802654,ime:"FARKADIN"},{id:802727,ime:"KNIANIN"},{id:802760,ime:"ORLOVAT"},{id:802794,ime:"PERLEZ"},{id:802824,ime:"TOMAEVAC"},{id:805491,ime:"SRPSKI ARADAC"},{id:805530,ime:"EKA"},{id:805548,ime:"ELEMIR"},{id:805556,ime:"JANKOV MOST"},{id:805564,ime:"KLEK"},{id:805599,ime:"LAZAREVO"},{id:805602,ime:"LUKIEVO"},{id:805629,ime:"LUKINO SELO"},{id:805637,ime:"MELENCI"},{id:805645,ime:"MIHAJLOVO"},{id:805653,ime:"MULjA"},{id:805696,ime:"SLOVAKI ARADAC"},{id:805700,ime:"SRPSKI ELEMIR"},{id:805718,ime:"STAJIEVO"},{id:805726,ime:"TARA"},{id:805742,ime:"ZRENjANIN I"},{id:805777,ime:"ZRENjANIN III"},{id:805793,ime:"TARA I"}]}]},{id:80209,ime:"KIKINDA",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:80209,ime:"KIKINDA",katopstine:[{id:"*",ime:"Sve"},{id:800759,ime:"BANATSKO VELIKO SELO"},{id:800783,ime:"NAKOVO"},{id:800791,ime:"NOVI KOZARCI"},{id:800813,ime:"RUSKO SELO"},{id:801267,ime:"BANATSKA TOPOLA"},{id:801275,ime:"BAAID"},{id:801321,ime:"IO"},{id:801356,ime:"KIKINDA"},{id:801364,ime:"MOKRIN"},{id:801402,ime:"SAJAN"}]}]},{id:80314,ime:"PANEVO",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:80314,ime:"PANEVO",katopstine:[{id:"*",ime:"Sve"},{id:802328,ime:"BANATSKI BRESTOVAC"},{id:802336,ime:"BANATSKO NOVO SELO"},{id:802379,ime:"DOLOVO"},{id:802387,ime:"GLOGONj"},{id:802409,ime:"IVANOVO"},{id:802417,ime:"JABUKA"},{id:802441,ime:"KAAREVO"},{id:802468,ime:"OMOLjICA"},{id:802484,ime:"PANEVO"},{id:802514,ime:"STAREVO"},{id:802549,ime:"VOJLOVICA"}]}]},{id:80381,ime:"SOMBOR",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:80381,ime:"SOMBOR",katopstine:[{id:"*",ime:"Sve"},{id:802867,ime:"BAKI BREG"},{id:802883,ime:"RIICA"},{id:803782,ime:"ALEKSA ANTI"},{id:803839,ime:"BAKI MONOTOR"},{id:803847,ime:"BEZDAN"},{id:803855,ime:"ONOPLjA"},{id:803863,ime:"DOROSLOVO"},{id:803871,ime:"GAKOVO"},{id:803880,ime:"KLjAJIEVO"},{id:803898,ime:"KOLUT"},{id:803944,ime:"RASTINA"},{id:803952,ime:"SOMBOR I"},{id:803987,ime:"STANII"},{id:803995,ime:"STAPAR"},{id:804002,ime:"SVETOZAR MILETI"},{id:804037,ime:"TELEKA"},{id:805866,ime:"SOMBOR II"}]}]},{id:80403,ime:"SREMSKA MITROVICA",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:80403,ime:"SREMSKA MITROVICA",katopstine:[{id:"*",ime:"Sve"},{id:801712,ime:"MAVANSKA MITROVICA"},{id:801739,ime:"NOAJ"},{id:801747,ime:"RADENKOVI"},{id:801755,ime:"RAVNjE"},{id:801763,ime:"SALA NOAJSKI"},{id:801771,ime:"ZASAVICA"},{id:802921,ime:"BEENOVO SELO"},{id:802930,ime:"BEENOVO PRNjAVOR"},{id:802964,ime:"ALMA"},{id:803014,ime:"GRGUREVCI"},{id:803138,ime:"LEIMIR"},{id:803189,ime:"MANELOS"},{id:803235,ime:"DIVO"},{id:803375,ime:"ULjAM"},{id:803391,ime:"VELIKI RADINCI"},{id:804061,ime:"BOSUT"},{id:804126,ime:"JARAK"},{id:804142,ime:"KUZMIN"},{id:804169,ime:"LAARAK"},{id:804177,ime:"MARTINCI"},{id:804231,ime:"SREMSKA MITROVICA"},{id:804240,ime:"SREMSKA RAA"},{id:804266,ime:"AINCI"}]}]},{id:80438,ime:"SUBOTICA",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:80438,ime:"SUBOTICA",katopstine:[{id:"*",ime:"Sve"},{id:804339,ime:"BAKI VINOGRADI"},{id:804347,ime:"BAJMOK"},{id:804363,ime:"BIKOVO"},{id:804371,ime:"ANTAVIR"},{id:804398,ime:"DONjI GRAD"},{id:804410,ime:"URIN"},{id:804479,ime:"NOVI GRAD"},{id:804495,ime:"PALI"},{id:804517,ime:"STARI GRAD"},{id:804525,ime:"TAVANKUT"},{id:804533,ime:"EDNIK"}]}]},{id:89010,ime:"NOVI SAD",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:89010,ime:"NOVI SAD",katopstine:[{id:"*",ime:"Sve"},{id:802077,ime:"BEGE"},{id:802085,ime:"ENEJ"},{id:802123,ime:"KISA"},{id:802158,ime:"NOVI SAD I"},{id:802166,ime:"NOVI SAD II"},{id:802174,ime:"NOVI SAD III"},{id:802182,ime:"NOVI SAD IV"},{id:802239,ime:"RUMENKA"},{id:802255,ime:"FUTOG"},{id:802263,ime:"STEPANOVIEVO"},{id:802298,ime:"VETERNIK"},{id:803120,ime:"LEDINCI"},{id:803308,ime:"SREMSKA KAMENICA"},{id:804541,ime:"BUDISAVA"},{id:804576,ime:"KOVILj"},{id:804649,ime:"KA"},{id:805203,ime:"BUKOVAC"},{id:805378,ime:"PETROVARADIN"}]}]},{id:90263,ime:"PRITINA",opstine:[{id:"*",ime:"Sve",katopstine:[{id:"*",ime:"Sve"}]},{id:90263,ime:"PRITINA",katopstine:[{id:"*",ime:"Sve"},{id:905364,ime:"MAREVCE"},{id:905917,ime:"DRENOVAC"},{id:906336,ime:"BARILjEVO"},{id:906824,ime:"SUICA"},{id:906832,ime:"TENE DO"},{id:906859,ime:"TRUDNA"},{id:906883,ime:"AGLAVICA"},{id:906913,ime:"RIMANITE"},{id:906921,ime:"SIEVO"},{id:906930,ime:"SLIVOVO"},{id:906948,ime:"SOFALIJA"},{id:907006,ime:"KUKAVICA"},{id:907049,ime:"LAPLjE SELO"},{id:907057,ime:"LEBANE"},{id:907073,ime:"LUKARE"},{id:907090,ime:"MAKOVAC"},{id:907120,ime:"MATIANE"},{id:907146,ime:"MRAMOR"},{id:907197,ime:"DRAGOVAC"},{id:907227,ime:"ZLATARE"},{id:907235,ime:"KOJLOVICA"},{id:907243,ime:"NOVO SELO"},{id:907260,ime:"ORLOVI"},{id:907286,ime:"PREOCE"},{id:907294,ime:"PRITINA"},{id:907308,ime:"PRUGOVAC"},{id:907316,ime:"RADOEVAC"},{id:907324,ime:"GRAANICA"},{id:907332,ime:"GRATICA"},{id:907359,ime:"DEVET JUGOVIA"},{id:907383,ime:"DONjA BRNjICA"},{id:907880,ime:"BALABAN"},{id:908258,ime:"KAIKOL"},{id:908274,ime:"KOLI"},{id:908428,ime:"AJVALIJA"},{id:908444,ime:"BADOVAC"},{id:908541,ime:"BESINjE"},{id:908550,ime:"BUSINjE"},{id:908592,ime:"VRANI DO"},{id:908606,ime:"GORNjA BRNjICA"},{id:908886,ime:"AJKOBILA"},{id:909025,ime:"GLOGOVICA"},{id:909122,ime:"DABIEVAC"},{id:909386,ime:"AKOVAC"},{id:910180,ime:"NIEVCE"},{id:910295,ime:"PROPATICA"},{id:914240,ime:"ARBAN"}]}]}];function PK(t){let e,i,n,s,l,c;return e=new eu({props:{selectedId:t[0].id,disabled:t[8].length>0,titleText:Wn.city,size:"sm",items:t[7],itemToString:p_}}),e.$on("select",t[9]),n=new eu({props:{disabled:!t[6]||t[8].length>0,selectedId:t[1].id,titleText:Wn.municipality,size:"sm",itemToString:p_,items:t[4]}}),n.$on("select",t[10]),l=new eu({props:{titleText:Wn.cadastre,size:"sm",selectedId:t[2].id,disabled:!t[5]||t[8].length>0,itemToString:p_,items:t[3]}}),l.$on("select",t[11]),{c(){Mt(e.$$.fragment),i=Et(),Mt(n.$$.fragment),s=Et(),Mt(l.$$.fragment)},m(r,f){Ot(e,r,f),Se(r,i,f),Ot(n,r,f),Se(r,s,f),Ot(l,r,f),c=!0},p(r,[f]){const m={};f&1&&(m.selectedId=r[0].id),f&256&&(m.disabled=r[8].length>0),f&128&&(m.items=r[7]),e.$set(m);const y={};f&320&&(y.disabled=!r[6]||r[8].length>0),f&2&&(y.selectedId=r[1].id),f&16&&(y.items=r[4]),n.$set(y);const b={};f&4&&(b.selectedId=r[2].id),f&288&&(b.disabled=!r[5]||r[8].length>0),f&8&&(b.items=r[3]),l.$set(b)},i(r){c||(ae(e.$$.fragment,r),ae(n.$$.fragment,r),ae(l.$$.fragment,r),c=!0)},o(r){pe(e.$$.fragment,r),pe(n.$$.fragment,r),pe(l.$$.fragment,r),c=!1},d(r){r&&(Te(i),Te(s)),Ct(e,r),Ct(n,r),Ct(l,r)}}}function p_(t){return t.ime}function NK(t,e,i){let n,s,l,c,r,f;Ln(t,zm,R=>i(8,f=R));for(let R of Rm){R.id=R.id.toString(),R.text=R.ime;for(let z of R.opstine){z.id=z.id.toString(),z.text=z.ime;for(let H of z.katopstine)H.id=H.id.toString(),H.text=H.ime}}let m=Rm[0],y=m.opstine[0],b=y.katopstine[0];function E(R){i(0,m=R.detail.selectedItem),i(1,y=m.opstine[0]),i(2,b=m.opstine[0].katopstine[0]),Eo.setPropToValue(["grad_id",m.id]),Eo.setPropToValue(["ops_id",y.id]),Eo.setPropToValue(["kat_id",b.id])}function S(R){i(1,y=R.detail.selectedItem),i(2,b=y.katopstine[0]),Eo.setPropToValue(["ops_id",y.id]),Eo.setPropToValue(["kat_id",b.id])}function D(R){i(2,b=R.detail.selectedItem),Eo.setPropToValue(["kat_id",b.id])}return t.$$.update=()=>{t.$$.dirty&1&&i(6,s=(m==null?void 0:m.ime.length)>0),t.$$.dirty&2&&i(5,l=(y==null?void 0:y.ime.length)>0),t.$$.dirty&1&&i(4,c=m==null?void 0:m.opstine),t.$$.dirty&2&&i(3,r=y==null?void 0:y.katopstine)},i(7,n=Rm),[m,y,b,r,c,l,s,n,f,E,S,D]}class zK extends Ri{constructor(e){super(),Di(this,e,NK,PK,Ci,{})}}const BK=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...i)=>ru(()=>Promise.resolve().then(()=>wf),void 0).then(({default:n})=>n(...i)):e=fetch,(...i)=>e(...i)};class Ry extends Error{constructor(e,i="FunctionsError",n){super(e),this.name=i,this.context=n}}class VK extends Ry{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class FK extends Ry{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class UK extends Ry{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var jK=function(t,e,i,n){function s(l){return l instanceof i?l:new i(function(c){c(l)})}return new(i||(i=Promise))(function(l,c){function r(y){try{m(n.next(y))}catch(b){c(b)}}function f(y){try{m(n.throw(y))}catch(b){c(b)}}function m(y){y.done?l(y.value):s(y.value).then(r,f)}m((n=n.apply(t,e||[])).next())})};class GK{constructor(e,{headers:i={},customFetch:n}={}){this.url=e,this.headers=i,this.fetch=BK(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,i={}){var n;return jK(this,void 0,void 0,function*(){try{const{headers:s,method:l,body:c}=i;let r={},f;c&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(r["Content-Type"]="application/octet-stream",f=c):typeof c=="string"?(r["Content-Type"]="text/plain",f=c):typeof FormData<"u"&&c instanceof FormData?f=c:(r["Content-Type"]="application/json",f=JSON.stringify(c)));const m=yield this.fetch(`${this.url}/${e}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},r),this.headers),s),body:f}).catch(S=>{throw new VK(S)}),y=m.headers.get("x-relay-error");if(y&&y==="true")throw new FK(m);if(!m.ok)throw new UK(m);let b=((n=m.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),E;return b==="application/json"?E=yield m.json():b==="application/octet-stream"?E=yield m.blob():b==="multipart/form-data"?E=yield m.formData():E=yield m.text(),{data:E,error:null}}catch(s){return{data:null,error:s}}})}}var HK=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Mh=HK();const KK=Mh.fetch,Ly=Mh.fetch.bind(Mh),rI=Mh.Headers,qK=Mh.Request,ZK=Mh.Response,wf=Object.freeze(Object.defineProperty({__proto__:null,Headers:rI,Request:qK,Response:ZK,default:Ly,fetch:KK},Symbol.toStringTag,{value:"Module"}));class WK{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Ly:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var c,r,f;let m=null,y=null,b=null,E=l.status,S=l.statusText;if(l.ok){if(this.method!=="HEAD"){const H=await l.text();H===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?y=H:y=JSON.parse(H))}const R=(c=this.headers.Prefer)===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),z=(r=l.headers.get("content-range"))===null||r===void 0?void 0:r.split("/");R&&z&&z.length>1&&(b=parseInt(z[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(m={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,b=null,E=406,S="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const R=await l.text();try{m=JSON.parse(R),Array.isArray(m)&&l.status===404&&(y=[],m=null,E=200,S="OK")}catch{l.status===404&&R===""?(E=204,S="No Content"):m={message:R}}if(m&&this.isMaybeSingle&&(!((f=m==null?void 0:m.details)===null||f===void 0)&&f.includes("0 rows"))&&(m=null,E=200,S="OK"),m&&this.shouldThrowOnError)throw m}return{error:m,data:y,count:b,status:E,statusText:S}});return this.shouldThrowOnError||(s=s.catch(l=>{var c,r,f;return{error:{message:`${(c=l==null?void 0:l.name)!==null&&c!==void 0?c:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(r=l==null?void 0:l.stack)!==null&&r!==void 0?r:""}`,hint:"",code:`${(f=l==null?void 0:l.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,i)}}class YK extends WK{select(e){let i=!1;const n=(e??"*").split("").map(s=>/\s/.test(s)&&!i?"":(s==='"'&&(i=!i),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:i=!0,nullsFirst:n,foreignTable:s,referencedTable:l=s}={}){const c=l?`${l}.order`:"order",r=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${r?`${r},`:""}${e}.${i?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:i,referencedTable:n=i}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,i,{foreignTable:n,referencedTable:s=n}={}){const l=typeof s>"u"?"offset":`${s}.offset`,c=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(l,`${e}`),this.url.searchParams.set(c,`${i-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:i=!1,settings:n=!1,buffers:s=!1,wal:l=!1,format:c="text"}={}){var r;const f=[e?"analyze":null,i?"verbose":null,n?"settings":null,s?"buffers":null,l?"wal":null].filter(Boolean).join("|"),m=(r=this.headers.Accept)!==null&&r!==void 0?r:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${m}"; options=${f};`,c==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class ih extends YK{eq(e,i){return this.url.searchParams.append(e,`eq.${i}`),this}neq(e,i){return this.url.searchParams.append(e,`neq.${i}`),this}gt(e,i){return this.url.searchParams.append(e,`gt.${i}`),this}gte(e,i){return this.url.searchParams.append(e,`gte.${i}`),this}lt(e,i){return this.url.searchParams.append(e,`lt.${i}`),this}lte(e,i){return this.url.searchParams.append(e,`lte.${i}`),this}like(e,i){return this.url.searchParams.append(e,`like.${i}`),this}likeAllOf(e,i){return this.url.searchParams.append(e,`like(all).{${i.join(",")}}`),this}likeAnyOf(e,i){return this.url.searchParams.append(e,`like(any).{${i.join(",")}}`),this}ilike(e,i){return this.url.searchParams.append(e,`ilike.${i}`),this}ilikeAllOf(e,i){return this.url.searchParams.append(e,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(e,i){return this.url.searchParams.append(e,`ilike(any).{${i.join(",")}}`),this}is(e,i){return this.url.searchParams.append(e,`is.${i}`),this}in(e,i){const n=i.map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,i){return typeof i=="string"?this.url.searchParams.append(e,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(e,`cs.{${i.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(i)}`),this}containedBy(e,i){return typeof i=="string"?this.url.searchParams.append(e,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(e,`cd.{${i.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(i)}`),this}rangeGt(e,i){return this.url.searchParams.append(e,`sr.${i}`),this}rangeGte(e,i){return this.url.searchParams.append(e,`nxl.${i}`),this}rangeLt(e,i){return this.url.searchParams.append(e,`sl.${i}`),this}rangeLte(e,i){return this.url.searchParams.append(e,`nxr.${i}`),this}rangeAdjacent(e,i){return this.url.searchParams.append(e,`adj.${i}`),this}overlaps(e,i){return typeof i=="string"?this.url.searchParams.append(e,`ov.${i}`):this.url.searchParams.append(e,`ov.{${i.join(",")}}`),this}textSearch(e,i,{config:n,type:s}={}){let l="";s==="plain"?l="pl":s==="phrase"?l="ph":s==="websearch"&&(l="w");const c=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${l}fts${c}.${i}`),this}match(e){return Object.entries(e).forEach(([i,n])=>{this.url.searchParams.append(i,`eq.${n}`)}),this}not(e,i,n){return this.url.searchParams.append(e,`not.${i}.${n}`),this}or(e,{foreignTable:i,referencedTable:n=i}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,i,n){return this.url.searchParams.append(e,`${i}.${n}`),this}}class JK{constructor(e,{headers:i={},schema:n,fetch:s}){this.url=e,this.headers=i,this.schema=n,this.fetch=s}select(e,{head:i=!1,count:n}={}){const s=i?"HEAD":"GET";let l=!1;const c=(e??"*").split("").map(r=>/\s/.test(r)&&!l?"":(r==='"'&&(l=!l),r)).join("");return this.url.searchParams.set("select",c),n&&(this.headers.Prefer=`count=${n}`),new ih({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:i,defaultToNull:n=!0}={}){const s="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),n||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((r,f)=>r.concat(Object.keys(f)),[]);if(c.length>0){const r=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",r.join(","))}}return new ih({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:i,ignoreDuplicates:n=!1,count:s,defaultToNull:l=!0}={}){const c="POST",r=[`resolution=${n?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&r.push(this.headers.Prefer),s&&r.push(`count=${s}`),l||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const f=e.reduce((m,y)=>m.concat(Object.keys(y)),[]);if(f.length>0){const m=[...new Set(f)].map(y=>`"${y}"`);this.url.searchParams.set("columns",m.join(","))}}return new ih({method:c,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:i}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),i&&s.push(`count=${i}`),this.headers.Prefer=s.join(","),new ih({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const i="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new ih({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const XK="1.9.1",QK={"X-Client-Info":`postgrest-js/${XK}`};class Py{constructor(e,{headers:i={},schema:n,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},QK),i),this.schemaName=n,this.fetch=s}from(e){const i=new URL(`${this.url}/${e}`);return new JK(i,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Py(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,i={},{head:n=!1,count:s}={}){let l;const c=new URL(`${this.url}/rpc/${e}`);let r;n?(l="HEAD",Object.entries(i).forEach(([m,y])=>{c.searchParams.append(m,`${y}`)})):(l="POST",r=i);const f=Object.assign({},this.headers);return s&&(f.Prefer=`count=${s}`),new ih({method:l,url:c,headers:f,schema:this.schemaName,body:r,fetch:this.fetch,allowEmpty:!1})}}const $K="2.9.1",eq={"X-Client-Info":`realtime-js/${$K}`},tq="1.0.0",sI=1e4,iq=1e3;var _h;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(_h||(_h={}));var za;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(za||(za={}));var Ao;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ao||(Ao={}));var E0;(function(t){t.websocket="websocket"})(E0||(E0={}));var Xc;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Xc||(Xc={}));class aI{constructor(e,i){this.callback=e,this.timerCalc=i,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=i}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class nq{constructor(){this.HEADER_LENGTH=1}decode(e,i){return e.constructor===ArrayBuffer?i(this._binaryDecode(e)):i(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const i=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,i,n)}_decodeBroadcast(e,i,n){const s=i.getUint8(1),l=i.getUint8(2);let c=this.HEADER_LENGTH+2;const r=n.decode(e.slice(c,c+s));c=c+s;const f=n.decode(e.slice(c,c+l));c=c+l;const m=JSON.parse(n.decode(e.slice(c,e.byteLength)));return{ref:null,topic:r,event:f,payload:m}}}class g_{constructor(e,i,n={},s=sI){this.channel=e,this.event=i,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,i){var n;return this._hasReceived(e)&&i((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:i}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=i=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=i,this._matchReceive(i)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,i){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:i})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:i}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(i))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var rA;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(rA||(rA={}));class Hd{constructor(e,i){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(i==null?void 0:i.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:l,onLeave:c,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Hd.syncState(this.state,s,l,c),this.pendingDiffs.forEach(f=>{this.state=Hd.syncDiff(this.state,f,l,c)}),this.pendingDiffs=[],r()}),this.channel._on(n.diff,{},s=>{const{onJoin:l,onLeave:c,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Hd.syncDiff(this.state,s,l,c),r())}),this.onJoin((s,l,c)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:c})}),this.onLeave((s,l,c)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,i,n,s){const l=this.cloneDeep(e),c=this.transformState(i),r={},f={};return this.map(l,(m,y)=>{c[m]||(f[m]=y)}),this.map(c,(m,y)=>{const b=l[m];if(b){const E=y.map(z=>z.presence_ref),S=b.map(z=>z.presence_ref),D=y.filter(z=>S.indexOf(z.presence_ref)<0),R=b.filter(z=>E.indexOf(z.presence_ref)<0);D.length>0&&(r[m]=D),R.length>0&&(f[m]=R)}else r[m]=y}),this.syncDiff(l,{joins:r,leaves:f},n,s)}static syncDiff(e,i,n,s){const{joins:l,leaves:c}={joins:this.transformState(i.joins),leaves:this.transformState(i.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(l,(r,f)=>{var m;const y=(m=e[r])!==null&&m!==void 0?m:[];if(e[r]=this.cloneDeep(f),y.length>0){const b=e[r].map(S=>S.presence_ref),E=y.filter(S=>b.indexOf(S.presence_ref)<0);e[r].unshift(...E)}n(r,y,f)}),this.map(c,(r,f)=>{let m=e[r];if(!m)return;const y=f.map(b=>b.presence_ref);m=m.filter(b=>y.indexOf(b.presence_ref)<0),e[r]=m,s(r,m,f),m.length===0&&delete e[r]}),e}static map(e,i){return Object.getOwnPropertyNames(e).map(n=>i(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((i,n)=>{const s=e[n];return"metas"in s?i[n]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):i[n]=s,i},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var gr;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(gr||(gr={}));const sA=(t,e,i={})=>{var n;const s=(n=i.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((l,c)=>(l[c]=rq(c,t,e,s),l),{})},rq=(t,e,i,n)=>{const s=e.find(r=>r.name===t),l=s==null?void 0:s.type,c=i[t];return l&&!n.includes(l)?oI(l,c):T0(c)},oI=(t,e)=>{if(t.charAt(0)==="_"){const i=t.slice(1,t.length);return lq(e,i)}switch(t){case gr.bool:return sq(e);case gr.float4:case gr.float8:case gr.int2:case gr.int4:case gr.int8:case gr.numeric:case gr.oid:return aq(e);case gr.json:case gr.jsonb:return oq(e);case gr.timestamp:return cq(e);case gr.abstime:case gr.date:case gr.daterange:case gr.int4range:case gr.int8range:case gr.money:case gr.reltime:case gr.text:case gr.time:case gr.timestamptz:case gr.timetz:case gr.tsrange:case gr.tstzrange:return T0(e);default:return T0(e)}},T0=t=>t,sq=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},aq=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},oq=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},lq=(t,e)=>{if(typeof t!="string")return t;const i=t.length-1,n=t[i];if(t[0]==="{"&&n==="}"){let l;const c=t.slice(1,i);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(r=>oI(e,r))}return t},cq=t=>typeof t=="string"?t.replace(" ","T"):t;var aA;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(aA||(aA={}));var oA;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes"})(oA||(oA={}));var lA;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(lA||(lA={}));class Ny{constructor(e,i={config:{}},n){this.topic=e,this.params=i,this.socket=n,this.bindings={},this.state=za.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},i.config),this.timeout=this.socket.timeout,this.joinPush=new g_(this,Ao.join,this.params,this.timeout),this.rejoinTimer=new aI(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=za.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=za.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=za.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=za.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ao.reply,{},(s,l)=>{this._trigger(this._replyEventName(l),s)}),this.presence=new Hd(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,i=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:l,presence:c}}=this.params;this._onError(m=>e&&e("CHANNEL_ERROR",m)),this._onClose(()=>e&&e("CLOSED"));const r={},f={broadcast:l,presence:c,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&s!==void 0?s:[]};this.socket.accessToken&&(r.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:f},r)),this.joinedOnce=!0,this._rejoin(i),this.joinPush.receive("ok",({postgres_changes:m})=>{var y;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),m===void 0){e&&e("SUBSCRIBED");return}else{const b=this.bindings.postgres_changes,E=(y=b==null?void 0:b.length)!==null&&y!==void 0?y:0,S=[];for(let D=0;D<E;D++){const R=b[D],{filter:{event:z,schema:H,table:K,filter:W}}=R,se=m&&m[D];if(se&&se.event===z&&se.schema===H&&se.table===K&&se.filter===W)S.push(Object.assign(Object.assign({},R),{id:se.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,e&&e("SUBSCRIBED");return}}).receive("error",m=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,i={}){return await this.send({type:"presence",event:"track",payload:e},i.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,i,n){return this._on(e,i,n)}async send(e,i={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:l,payload:c}=e,r={method:"POST",headers:{apikey:(n=this.socket.accessToken)!==null&&n!==void 0?n:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,r,(s=i.timeout)!==null&&s!==void 0?s:this.timeout)).ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,r,f;const m=this._push(e.type,e,i.timeout||this.timeout);e.type==="broadcast"&&!(!((f=(r=(c=this.params)===null||c===void 0?void 0:c.config)===null||r===void 0?void 0:r.broadcast)===null||f===void 0)&&f.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=za.leaving;const i=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ao.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const s=new g_(this,Ao.leave,{},e);s.receive("ok",()=>{i(),n("ok")}).receive("timeout",()=>{i(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,i,n){const s=new AbortController,l=setTimeout(()=>s.abort(),n),c=await this.socket.fetch(e,Object.assign(Object.assign({},i),{signal:s.signal}));return clearTimeout(l),c}_push(e,i,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new g_(this,e,i,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,i,n){return i}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,i,n){var s,l;const c=e.toLocaleLowerCase(),{close:r,error:f,leave:m,join:y}=Ao;if(n&&[r,f,m,y].indexOf(c)>=0&&n!==this._joinRef())return;let E=this._onMessage(c,i,n);if(i&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(S=>{var D,R,z;return((D=S.filter)===null||D===void 0?void 0:D.event)==="*"||((z=(R=S.filter)===null||R===void 0?void 0:R.event)===null||z===void 0?void 0:z.toLocaleLowerCase())===c}).map(S=>S.callback(E,n)):(l=this.bindings[c])===null||l===void 0||l.filter(S=>{var D,R,z,H,K,W;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in S){const se=S.id,Y=(D=S.filter)===null||D===void 0?void 0:D.event;return se&&((R=i.ids)===null||R===void 0?void 0:R.includes(se))&&(Y==="*"||(Y==null?void 0:Y.toLocaleLowerCase())===((z=i.data)===null||z===void 0?void 0:z.type.toLocaleLowerCase()))}else{const se=(K=(H=S==null?void 0:S.filter)===null||H===void 0?void 0:H.event)===null||K===void 0?void 0:K.toLocaleLowerCase();return se==="*"||se===((W=i==null?void 0:i.event)===null||W===void 0?void 0:W.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===c}).map(S=>{if(typeof E=="object"&&"ids"in E){const D=E.data,{schema:R,table:z,commit_timestamp:H,type:K,errors:W}=D;E=Object.assign(Object.assign({},{schema:R,table:z,commit_timestamp:H,eventType:K,new:{},old:{},errors:W}),this._getPayloadRecords(D))}S.callback(E,n)})}_isClosed(){return this.state===za.closed}_isJoined(){return this.state===za.joined}_isJoining(){return this.state===za.joining}_isLeaving(){return this.state===za.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,i,n){const s=e.toLocaleLowerCase(),l={type:s,filter:i,callback:n};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(e,i){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&Ny.isEqual(s.filter,i))}),this}static isEqual(e,i){if(Object.keys(e).length!==Object.keys(i).length)return!1;for(const n in e)if(e[n]!==i[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ao.close,{},e)}_onError(e){this._on(Ao.error,{},i=>e(i))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=za.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const i={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(i.new=sA(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(i.old=sA(e.columns,e.old_record)),i}}const uq=()=>{},hq=typeof WebSocket<"u";class dq{constructor(e,i){var n;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=eq,this.params={},this.timeout=sI,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=uq,this.conn=null,this.sendBuffer=[],this.serializer=new nq,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=l=>{let c;return l?c=l:typeof fetch>"u"?c=(...r)=>ru(()=>Promise.resolve().then(()=>wf),void 0).then(({default:f})=>f(...r)):c=fetch,(...r)=>c(...r)},this.endPoint=`${e}/${E0.websocket}`,i!=null&&i.transport?this.transport=i.transport:this.transport=null,i!=null&&i.params&&(this.params=i.params),i!=null&&i.headers&&(this.headers=Object.assign(Object.assign({},this.headers),i.headers)),i!=null&&i.timeout&&(this.timeout=i.timeout),i!=null&&i.logger&&(this.logger=i.logger),i!=null&&i.heartbeatIntervalMs&&(this.heartbeatIntervalMs=i.heartbeatIntervalMs);const s=(n=i==null?void 0:i.params)===null||n===void 0?void 0:n.apikey;s&&(this.accessToken=s),this.reconnectAfterMs=i!=null&&i.reconnectAfterMs?i.reconnectAfterMs:l=>[1e3,2e3,5e3,1e4][l-1]||1e4,this.encode=i!=null&&i.encode?i.encode:(l,c)=>c(JSON.stringify(l)),this.decode=i!=null&&i.decode?i.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new aI(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(i==null?void 0:i.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(hq){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new fq(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),ru(()=>import("./browser-un22x9LA.js").then(e=>e.b),__vite__mapDeps([])).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,i){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,i??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const i=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),i}async removeAllChannels(){const e=await Promise.all(this.channels.map(i=>i.unsubscribe()));return this.disconnect(),e}log(e,i,n){this.logger(e,i,n)}connectionState(){switch(this.conn&&this.conn.readyState){case _h.connecting:return Xc.Connecting;case _h.open:return Xc.Open;case _h.closing:return Xc.Closing;default:return Xc.Closed}}isConnected(){return this.connectionState()===Xc.Open}channel(e,i={config:{}}){const n=new Ny(`realtime:${e}`,i,this);return this.channels.push(n),n}push(e){const{topic:i,event:n,payload:s,ref:l}=e,c=()=>{this.encode(e,r=>{var f;(f=this.conn)===null||f===void 0||f.send(r)})};this.log("push",`${i} ${n} (${l})`,s),this.isConnected()?c():this.sendBuffer.push(c)}setAuth(e){this.accessToken=e,this.channels.forEach(i=>{e&&i.updateJoinPayload({access_token:e}),i.joinedOnce&&i._isJoined()&&i._push(Ao.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let i=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));i&&(this.log("transport",`leaving duplicate topic "${e}"`),i.unsubscribe())}_remove(e){this.channels=this.channels.filter(i=>i._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:tq}))}_onConnMessage(e){this.decode(e.data,i=>{let{topic:n,event:s,payload:l,ref:c}=i;(c&&c===this.pendingHeartbeatRef||s===(l==null?void 0:l.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${l.status||""} ${n} ${s} ${c&&"("+c+")"||""}`,l),this.channels.filter(r=>r._isMember(n)).forEach(r=>r._trigger(s,l,c)),this.stateChangeCallbacks.message.forEach(r=>r(i))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(i=>i(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(i=>i(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ao.error))}_appendParams(e,i){if(Object.keys(i).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(i);return`${e}${n}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(iq,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class fq{constructor(e,i,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=_h.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class zy extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Hs(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class mq extends zy{constructor(e,i){super(e),this.name="StorageApiError",this.status=i}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class cA extends zy{constructor(e,i){super(e),this.name="StorageUnknownError",this.originalError=i}}var pq=function(t,e,i,n){function s(l){return l instanceof i?l:new i(function(c){c(l)})}return new(i||(i=Promise))(function(l,c){function r(y){try{m(n.next(y))}catch(b){c(b)}}function f(y){try{m(n.throw(y))}catch(b){c(b)}}function m(y){y.done?l(y.value):s(y.value).then(r,f)}m((n=n.apply(t,e||[])).next())})};const lI=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...i)=>ru(()=>Promise.resolve().then(()=>wf),void 0).then(({default:n})=>n(...i)):e=fetch,(...i)=>e(...i)},gq=()=>pq(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ru(()=>Promise.resolve().then(()=>wf),void 0)).Response:Response});var Nh=function(t,e,i,n){function s(l){return l instanceof i?l:new i(function(c){c(l)})}return new(i||(i=Promise))(function(l,c){function r(y){try{m(n.next(y))}catch(b){c(b)}}function f(y){try{m(n.throw(y))}catch(b){c(b)}}function m(y){y.done?l(y.value):s(y.value).then(r,f)}m((n=n.apply(t,e||[])).next())})};const __=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),_q=(t,e)=>Nh(void 0,void 0,void 0,function*(){const i=yield gq();t instanceof i?t.json().then(n=>{e(new mq(__(n),t.status||500))}).catch(n=>{e(new cA(__(n),n))}):e(new cA(__(t),t))}),yq=(t,e,i,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),i))};function Bp(t,e,i,n,s,l){return Nh(this,void 0,void 0,function*(){return new Promise((c,r)=>{t(i,yq(e,n,s,l)).then(f=>{if(!f.ok)throw f;return n!=null&&n.noResolveJson?f:f.json()}).then(f=>c(f)).catch(f=>_q(f,r))})})}function S0(t,e,i,n){return Nh(this,void 0,void 0,function*(){return Bp(t,"GET",e,i,n)})}function xc(t,e,i,n,s){return Nh(this,void 0,void 0,function*(){return Bp(t,"POST",e,n,s,i)})}function vq(t,e,i,n,s){return Nh(this,void 0,void 0,function*(){return Bp(t,"PUT",e,n,s,i)})}function cI(t,e,i,n,s){return Nh(this,void 0,void 0,function*(){return Bp(t,"DELETE",e,n,s,i)})}var no=function(t,e,i,n){function s(l){return l instanceof i?l:new i(function(c){c(l)})}return new(i||(i=Promise))(function(l,c){function r(y){try{m(n.next(y))}catch(b){c(b)}}function f(y){try{m(n.throw(y))}catch(b){c(b)}}function m(y){y.done?l(y.value):s(y.value).then(r,f)}m((n=n.apply(t,e||[])).next())})};const bq={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},uA={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xq{constructor(e,i={},n,s){this.url=e,this.headers=i,this.bucketId=n,this.fetch=lI(s)}uploadOrUpdate(e,i,n,s){return no(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},uA),s),r=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,r["cache-control"]=`max-age=${c.cacheControl}`,r["content-type"]=c.contentType);const f=this._removeEmptyFolders(i),m=this._getFinalPath(f),y=yield this.fetch(`${this.url}/object/${m}`,Object.assign({method:e,body:l,headers:r},c!=null&&c.duplex?{duplex:c.duplex}:{})),b=yield y.json();return y.ok?{data:{path:f,id:b.Id,fullPath:b.Key},error:null}:{data:null,error:b}}catch(l){if(Hs(l))return{data:null,error:l};throw l}})}upload(e,i,n){return no(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,i,n)})}uploadToSignedUrl(e,i,n,s){return no(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),r=new URL(this.url+`/object/upload/sign/${c}`);r.searchParams.set("token",i);try{let f;const m=Object.assign({upsert:uA.upsert},s),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&n instanceof Blob?(f=new FormData,f.append("cacheControl",m.cacheControl),f.append("",n)):typeof FormData<"u"&&n instanceof FormData?(f=n,f.append("cacheControl",m.cacheControl)):(f=n,y["cache-control"]=`max-age=${m.cacheControl}`,y["content-type"]=m.contentType);const b=yield this.fetch(r.toString(),{method:"PUT",body:f,headers:y}),E=yield b.json();return b.ok?{data:{path:l,fullPath:E.Key},error:null}:{data:null,error:E}}catch(f){if(Hs(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(e){return no(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e);const n=yield xc(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:this.headers}),s=new URL(this.url+n.url),l=s.searchParams.get("token");if(!l)throw new zy("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:l},error:null}}catch(i){if(Hs(i))return{data:null,error:i};throw i}})}update(e,i,n){return no(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,i,n)})}move(e,i){return no(this,void 0,void 0,function*(){try{return{data:yield xc(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:i},{headers:this.headers}),error:null}}catch(n){if(Hs(n))return{data:null,error:n};throw n}})}copy(e,i){return no(this,void 0,void 0,function*(){try{return{data:{path:(yield xc(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:i},{headers:this.headers})).Key},error:null}}catch(n){if(Hs(n))return{data:null,error:n};throw n}})}createSignedUrl(e,i,n){return no(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),l=yield xc(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:i},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(s){if(Hs(s))return{data:null,error:s};throw s}})}createSignedUrls(e,i,n){return no(this,void 0,void 0,function*(){try{const s=yield xc(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:i,paths:e},{headers:this.headers}),l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(s){if(Hs(s))return{data:null,error:s};throw s}})}download(e,i){return no(this,void 0,void 0,function*(){const s=typeof(i==null?void 0:i.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((i==null?void 0:i.transform)||{}),c=l?`?${l}`:"";try{const r=this._getFinalPath(e);return{data:yield(yield S0(this.fetch,`${this.url}/${s}/${r}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(r){if(Hs(r))return{data:null,error:r};throw r}})}getPublicUrl(e,i){const n=this._getFinalPath(e),s=[],l=i!=null&&i.download?`download=${i.download===!0?"":i.download}`:"";l!==""&&s.push(l);const r=typeof(i==null?void 0:i.transform)<"u"?"render/image":"object",f=this.transformOptsToQueryString((i==null?void 0:i.transform)||{});f!==""&&s.push(f);let m=s.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${r}/public/${n}${m}`)}}}remove(e){return no(this,void 0,void 0,function*(){try{return{data:yield cI(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(i){if(Hs(i))return{data:null,error:i};throw i}})}list(e,i,n){return no(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},bq),i),{prefix:e||""});return{data:yield xc(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Hs(s))return{data:null,error:s};throw s}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const i=[];return e.width&&i.push(`width=${e.width}`),e.height&&i.push(`height=${e.height}`),e.resize&&i.push(`resize=${e.resize}`),e.format&&i.push(`format=${e.format}`),e.quality&&i.push(`quality=${e.quality}`),i.join("&")}}const wq="2.5.5",Aq={"X-Client-Info":`storage-js/${wq}`};var Ju=function(t,e,i,n){function s(l){return l instanceof i?l:new i(function(c){c(l)})}return new(i||(i=Promise))(function(l,c){function r(y){try{m(n.next(y))}catch(b){c(b)}}function f(y){try{m(n.throw(y))}catch(b){c(b)}}function m(y){y.done?l(y.value):s(y.value).then(r,f)}m((n=n.apply(t,e||[])).next())})};class Eq{constructor(e,i={},n){this.url=e,this.headers=Object.assign(Object.assign({},Aq),i),this.fetch=lI(n)}listBuckets(){return Ju(this,void 0,void 0,function*(){try{return{data:yield S0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Hs(e))return{data:null,error:e};throw e}})}getBucket(e){return Ju(this,void 0,void 0,function*(){try{return{data:yield S0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(i){if(Hs(i))return{data:null,error:i};throw i}})}createBucket(e,i={public:!1}){return Ju(this,void 0,void 0,function*(){try{return{data:yield xc(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Hs(n))return{data:null,error:n};throw n}})}updateBucket(e,i){return Ju(this,void 0,void 0,function*(){try{return{data:yield vq(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Hs(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Ju(this,void 0,void 0,function*(){try{return{data:yield xc(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(i){if(Hs(i))return{data:null,error:i};throw i}})}deleteBucket(e){return Ju(this,void 0,void 0,function*(){try{return{data:yield cI(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(i){if(Hs(i))return{data:null,error:i};throw i}})}}class Tq extends Eq{constructor(e,i={},n){super(e,i,n)}from(e){return new xq(this.url,this.headers,e,this.fetch)}}const Sq="2.39.2";let zd="";typeof Deno<"u"?zd="deno":typeof document<"u"?zd="web":typeof navigator<"u"&&navigator.product==="ReactNative"?zd="react-native":zd="node";const Iq={"X-Client-Info":`supabase-js-${zd}/${Sq}`};var kq=function(t,e,i,n){function s(l){return l instanceof i?l:new i(function(c){c(l)})}return new(i||(i=Promise))(function(l,c){function r(y){try{m(n.next(y))}catch(b){c(b)}}function f(y){try{m(n.throw(y))}catch(b){c(b)}}function m(y){y.done?l(y.value):s(y.value).then(r,f)}m((n=n.apply(t,e||[])).next())})};const Oq=t=>{let e;return t?e=t:typeof fetch>"u"?e=Ly:e=fetch,(...i)=>e(...i)},Cq=()=>typeof Headers>"u"?rI:Headers,Mq=(t,e,i)=>{const n=Oq(i),s=Cq();return(l,c)=>kq(void 0,void 0,void 0,function*(){var r;const f=(r=yield e())!==null&&r!==void 0?r:t;let m=new s(c==null?void 0:c.headers);return m.has("apikey")||m.set("apikey",t),m.has("Authorization")||m.set("Authorization",`Bearer ${f}`),n(l,Object.assign(Object.assign({},c),{headers:m}))})};function Dq(t){return t.replace(/\/$/,"")}function Rq(t,e){const{db:i,auth:n,realtime:s,global:l}=t,{db:c,auth:r,realtime:f,global:m}=e;return{db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},r),n),realtime:Object.assign(Object.assign({},f),s),global:Object.assign(Object.assign({},m),l)}}function Lq(t){return Math.round(Date.now()/1e3)+t}function Pq(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const wo=()=>typeof document<"u",Hc={tested:!1,writable:!1},Kd=()=>{if(!wo())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Hc.tested)return Hc.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Hc.tested=!0,Hc.writable=!0}catch{Hc.tested=!0,Hc.writable=!1}return Hc.writable};function y_(t){const e={},i=new URL(t);if(i.hash&&i.hash[0]==="#")try{new URLSearchParams(i.hash.substring(1)).forEach((s,l)=>{e[l]=s})}catch{}return i.searchParams.forEach((n,s)=>{e[s]=n}),e}const uI=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...i)=>ru(()=>Promise.resolve().then(()=>wf),void 0).then(({default:n})=>n(...i)):e=fetch,(...i)=>e(...i)},Nq=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Kc=async(t,e,i)=>{await t.setItem(e,JSON.stringify(i))},fm=async(t,e)=>{const i=await t.getItem(e);if(!i)return null;try{return JSON.parse(i)}catch{return i}},v_=async(t,e)=>{await t.removeItem(e)};function zq(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let i="",n,s,l,c,r,f,m,y=0;for(t=t.replace("-","+").replace("_","/");y<t.length;)c=e.indexOf(t.charAt(y++)),r=e.indexOf(t.charAt(y++)),f=e.indexOf(t.charAt(y++)),m=e.indexOf(t.charAt(y++)),n=c<<2|r>>4,s=(r&15)<<4|f>>2,l=(f&3)<<6|m,i=i+String.fromCharCode(n),f!=64&&s!=0&&(i=i+String.fromCharCode(s)),m!=64&&l!=0&&(i=i+String.fromCharCode(l));return i}class Vp{constructor(){this.promise=new Vp.promiseConstructor((e,i)=>{this.resolve=e,this.reject=i})}}Vp.promiseConstructor=Promise;function hA(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,i=t.split(".");if(i.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(i[1]))throw new Error("JWT is not valid: payload is not in base64url format");const n=i[1];return JSON.parse(zq(n))}async function Bq(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Vq(t,e){return new Promise((n,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await t(l);if(!e(l,null,c)){n(c);return}}catch(c){if(!e(l,c)){s(c);return}}})()})}function Fq(t){return("0"+t.toString(16)).substr(-2)}function Xu(){const e=new Uint32Array(56);if(typeof crypto>"u"){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=i.length;let s="";for(let l=0;l<56;l++)s+=i.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Fq).join("")}async function Uq(t){const i=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",i),s=new Uint8Array(n);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}function jq(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Qu(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const i=await Uq(t);return jq(i)}class By extends Error{constructor(e,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=i}}function bn(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Gq extends By{constructor(e,i){super(e,i),this.name="AuthApiError",this.status=i}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Hq(t){return bn(t)&&t.name==="AuthApiError"}class hI extends By{constructor(e,i){super(e),this.name="AuthUnknownError",this.originalError=i}}class bu extends By{constructor(e,i,n){super(e),this.name=i,this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class $u extends bu{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class b_ extends bu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class mm extends bu{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class pm extends bu{constructor(e,i=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=i}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class dA extends bu{constructor(e,i=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=i}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class I0 extends bu{constructor(e,i){super(e,"AuthRetryableFetchError",i)}}function x_(t){return bn(t)&&t.name==="AuthRetryableFetchError"}class Kq extends bu{constructor(e,i,n){super(e,"AuthWeakPasswordError",i),this.reasons=n}}var qq=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(i[n[s]]=t[n[s]]);return i};const nh=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Zq=[502,503,504];async function fA(t){if(!Nq(t))throw new I0(nh(t),0);if(Zq.includes(t.status))throw new I0(nh(t),t.status);let e;try{e=await t.json()}catch(i){throw new hI(nh(i),i)}throw typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((i,n)=>i&&typeof n=="string",!0)?new Kq(nh(e),t.status,e.weak_password.reasons):new Gq(nh(e),t.status||500)}const Wq=(t,e,i,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),i))};async function kn(t,e,i,n){var s;const l=Object.assign({},n==null?void 0:n.headers);n!=null&&n.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(c.redirect_to=n.redirectTo);const r=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",f=await Yq(t,e,i+r,{headers:l,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(f):{data:Object.assign({},f),error:null}}async function Yq(t,e,i,n,s,l){const c=Wq(e,n,s,l);let r;try{r=await t(i,c)}catch(f){throw console.error(f),new I0(nh(f),0)}if(r.ok||await fA(r),n!=null&&n.noResolveJson)return r;try{return await r.json()}catch(f){await fA(f)}}function Yc(t){var e;let i=null;$q(t)&&(i=Object.assign({},t),t.expires_at||(i.expires_at=Lq(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:i,user:n},error:null}}function mA(t){const e=Yc(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((i,n)=>i&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function wc(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Jq(t){return{data:t,error:null}}function Xq(t){const{action_link:e,email_otp:i,hashed_token:n,redirect_to:s,verification_type:l}=t,c=qq(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),r={action_link:e,email_otp:i,hashed_token:n,redirect_to:s,verification_type:l},f=Object.assign({},c);return{data:{properties:r,user:f},error:null}}function Qq(t){return t}function $q(t){return t.access_token&&t.refresh_token&&t.expires_in}var eZ=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(i[n[s]]=t[n[s]]);return i};class tZ{constructor({url:e="",headers:i={},fetch:n}){this.url=e,this.headers=i,this.fetch=uI(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,i="global"){try{return await kn(this.fetch,"POST",`${this.url}/logout?scope=${i}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(bn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,i={}){try{return await kn(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:i.data},headers:this.headers,redirectTo:i.redirectTo,xform:wc})}catch(n){if(bn(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:i}=e,n=eZ(e,["options"]),s=Object.assign(Object.assign({},n),i);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await kn(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Xq,redirectTo:i==null?void 0:i.redirectTo})}catch(i){if(bn(i))return{data:{properties:null,user:null},error:i};throw i}}async createUser(e){try{return await kn(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:wc})}catch(i){if(bn(i))return{data:{user:null},error:i};throw i}}async listUsers(e){var i,n,s,l,c,r,f;try{const m={nextPage:null,lastPage:0,total:0},y=await kn(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(i=e==null?void 0:e.page)===null||i===void 0?void 0:i.toString())!==null&&n!==void 0?n:"",per_page:(l=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:Qq});if(y.error)throw y.error;const b=await y.json(),E=(c=y.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(f=(r=y.headers.get("link"))===null||r===void 0?void 0:r.split(","))!==null&&f!==void 0?f:[];return S.length>0&&(S.forEach(D=>{const R=parseInt(D.split(";")[0].split("=")[1].substring(0,1)),z=JSON.parse(D.split(";")[1].split("=")[1]);m[`${z}Page`]=R}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},b),m),error:null}}catch(m){if(bn(m))return{data:{users:[]},error:m};throw m}}async getUserById(e){try{return await kn(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:wc})}catch(i){if(bn(i))return{data:{user:null},error:i};throw i}}async updateUserById(e,i){try{return await kn(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:i,headers:this.headers,xform:wc})}catch(n){if(bn(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,i=!1){try{return await kn(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:i},xform:wc})}catch(n){if(bn(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:i,error:n}=await kn(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:i,error:n}}catch(i){if(bn(i))return{data:null,error:i};throw i}}async _deleteFactor(e){try{return{data:await kn(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(i){if(bn(i))return{data:null,error:i};throw i}}}const dI="2.62.0",iZ="http://localhost:9999",nZ="supabase.auth.token",rZ={"X-Client-Info":`gotrue-js/${dI}`},pA=10,sZ={getItem:t=>Kd()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Kd()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Kd()&&globalThis.localStorage.removeItem(t)}};function gA(t={}){return{getItem:e=>t[e]||null,setItem:(e,i)=>{t[e]=i},removeItem:e=>{delete t[e]}}}function aZ(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const eh={debug:!!(globalThis&&Kd()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class fI extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class oZ extends fI{}async function lZ(t,e,i){eh.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),eh.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){eh.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await i()}finally{eh.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw eh.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new oZ(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(eh.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await i()}})}aZ();const cZ={url:iZ,storageKey:nZ,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:rZ,flowType:"implicit",debug:!1},Md=30*1e3,_A=3;async function yA(t,e,i){return await i()}class cf{constructor(e){var i,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=cf.nextInstanceID,cf.nextInstanceID+=1,this.instanceID>0&&wo()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},cZ),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new tZ({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=uI(s.fetch),this.lock=s.lock||yA,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,s.lock?this.lock=s.lock:wo()&&(!((i=globalThis==null?void 0:globalThis.navigator)===null||i===void 0)&&i.locks)?this.lock=lZ:this.lock=yA,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Kd()?this.storage=sZ:(this.memoryStorage={},this.storage=gA(this.memoryStorage)):(this.memoryStorage={},this.storage=gA(this.memoryStorage)),wo()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${dI}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=wo()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:i,error:n}=await this._getSessionFromURL(e);if(n)return this._debug("#_initialize()","error detecting session from URL",n),(n==null?void 0:n.message)==="Identity is already linked"||(n==null?void 0:n.message)==="Identity is already linked to another user"?{error:n}:(await this._removeSession(),{error:n});const{session:s,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",s,"redirect type",l),await this._saveSession(s),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return bn(e)?{error:e}:{error:new hI("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var i,n,s;try{await this._removeSession();let l;if("email"in e){const{email:y,password:b,options:E}=e;let S=null,D=null;if(this.flowType==="pkce"){const R=Xu();await Kc(this.storage,`${this.storageKey}-code-verifier`,R),S=await Qu(R),D=R===S?"plain":"s256"}l=await kn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:y,password:b,data:(i=E==null?void 0:E.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:S,code_challenge_method:D},xform:Yc})}else if("phone"in e){const{phone:y,password:b,options:E}=e;l=await kn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:b,data:(n=E==null?void 0:E.data)!==null&&n!==void 0?n:{},channel:(s=E==null?void 0:E.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:Yc})}else throw new mm("You must provide either an email or phone number and a password");const{data:c,error:r}=l;if(r||!c)return{data:{user:null,session:null},error:r};const f=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(l){if(bn(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(e){try{await this._removeSession();let i;if("email"in e){const{email:l,password:c,options:r}=e;i=await kn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:mA})}else if("phone"in e){const{phone:l,password:c,options:r}=e;i=await kn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:mA})}else throw new mm("You must provide either an email or phone number and a password");const{data:n,error:s}=i;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new b_}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(i){if(bn(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithOAuth(e){var i,n,s,l;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const i=await fm(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(i??"").split("/"),{data:l,error:c}=await kn(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Yc});return await v_(this.storage,`${this.storageKey}-code-verifier`),c?{data:{user:null,session:null,redirectType:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new b_}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:c})}async signInWithIdToken(e){await this._removeSession();try{const{options:i,provider:n,token:s,access_token:l,nonce:c}=e,r=await kn(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Yc}),{data:f,error:m}=r;return m?{data:{user:null,session:null},error:m}:!f||!f.session||!f.user?{data:{user:null,session:null},error:new b_}:(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),{data:f,error:m})}catch(i){if(bn(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithOtp(e){var i,n,s,l,c;try{if(await this._removeSession(),"email"in e){const{email:r,options:f}=e;let m=null,y=null;if(this.flowType==="pkce"){const E=Xu();await Kc(this.storage,`${this.storageKey}-code-verifier`,E),m=await Qu(E),y=E===m?"plain":"s256"}const{error:b}=await kn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:(i=f==null?void 0:f.data)!==null&&i!==void 0?i:{},create_user:(n=f==null?void 0:f.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:m,code_challenge_method:y},redirectTo:f==null?void 0:f.emailRedirectTo});return{data:{user:null,session:null},error:b}}if("phone"in e){const{phone:r,options:f}=e,{data:m,error:y}=await kn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:r,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},create_user:(l=f==null?void 0:f.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},channel:(c=f==null?void 0:f.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:y}}throw new mm("You must provide either an email or phone number.")}catch(r){if(bn(r))return{data:{user:null,session:null},error:r};throw r}}async verifyOtp(e){var i,n;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let s,l;"options"in e&&(s=(i=e.options)===null||i===void 0?void 0:i.redirectTo,l=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:r}=await kn(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:Yc});if(r)throw r;if(!c)throw new Error("An error occurred on token verification.");const f=c.session,m=c.user;return f!=null&&f.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(s){if(bn(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var i,n,s;try{await this._removeSession();let l=null,c=null;if(this.flowType==="pkce"){const r=Xu();await Kc(this.storage,`${this.storageKey}-code-verifier`,r),l=await Qu(r),c=r===l?"plain":"s256"}return await kn(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(i=e.options)===null||i===void 0?void 0:i.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:Jq})}catch(l){if(bn(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:i},error:n}=e;if(n)throw n;if(!i)throw new $u;const{error:s}=await kn(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:i.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(bn(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const i=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:l}=e,{error:c}=await kn(this.fetch,"POST",i,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:n,type:s,options:l}=e,{data:c,error:r}=await kn(this.fetch,"POST",i,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:r}}throw new mm("You must provide either an email or phone number and a type")}catch(i){if(bn(i))return{data:{user:null,session:null},error:i};throw i}}async getSession(){return await this.initializePromise,this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,i){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await i()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=i();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const i=await this.__loadSession();return await e(i)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const i=await fm(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",i),i!==null&&(this._isValidSession(i)?e=i:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n)return{data:{session:e},error:null};const{session:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{session:null},error:l}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await kn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:wc}):await this._useSession(async i=>{var n,s;const{data:l,error:c}=i;if(c)throw c;return await kn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0,xform:wc})})}catch(i){if(bn(i))return{data:{user:null},error:i};throw i}}async updateUser(e,i={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,i))}async _updateUser(e,i={}){try{return await this._useSession(async n=>{const{data:s,error:l}=n;if(l)throw l;if(!s.session)throw new $u;const c=s.session;let r=null,f=null;if(this.flowType==="pkce"&&e.email!=null){const b=Xu();await Kc(this.storage,`${this.storageKey}-code-verifier`,b),r=await Qu(b),f=b===r?"plain":"s256"}const{data:m,error:y}=await kn(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:i==null?void 0:i.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:r,code_challenge_method:f}),jwt:c.access_token,xform:wc});if(y)throw y;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(bn(n))return{data:{user:null},error:n};throw n}}_decodeJWT(e){return hA(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new $u;const i=Date.now()/1e3;let n=i,s=!0,l=null;const c=hA(e.access_token);if(c.exp&&(n=c.exp,s=n<=i),s){const{session:r,error:f}=await this._callRefreshToken(e.refresh_token);if(f)return{data:{user:null,session:null},error:f};if(!r)return{data:{user:null,session:null},error:null};l=r}else{const{data:r,error:f}=await this._getUser(e.access_token);if(f)throw f;l={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:n-i,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(i){if(bn(i))return{data:{session:null,user:null},error:i};throw i}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async i=>{var n;if(!e){const{data:c,error:r}=i;if(r)throw r;e=(n=c.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new $u;const{session:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{user:null,session:null},error:l}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(i){if(bn(i))return{data:{user:null,session:null},error:i};throw i}}async _getSessionFromURL(e){try{if(!wo())throw new pm("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new pm("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new dA("Not a valid PKCE flow url.");const i=y_(window.location.href);if(e){if(!i.code)throw new dA("No code detected.");const{data:K,error:W}=await this._exchangeCodeForSession(i.code);if(W)throw W;const se=new URL(window.location.href);return se.searchParams.delete("code"),window.history.replaceState(window.history.state,"",se.toString()),{data:{session:K.session,redirectType:null},error:null}}if(i.error||i.error_description||i.error_code)throw new pm(i.error_description||"Error in URL with unspecified error_description",{error:i.error||"unspecified_error",code:i.error_code||"unspecified_code"});const{provider_token:n,provider_refresh_token:s,access_token:l,refresh_token:c,expires_in:r,expires_at:f,token_type:m}=i;if(!l||!r||!c||!m)throw new pm("No session defined in URL");const y=Math.round(Date.now()/1e3),b=parseInt(r);let E=y+b;f&&(E=parseInt(f));const S=E-y;S*1e3<=Md&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${b}s`);const D=E-b;y-D>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",D,E,y):y-D<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",D,E,y);const{data:R,error:z}=await this._getUser(l);if(z)throw z;const H={provider_token:n,provider_refresh_token:s,access_token:l,expires_in:b,expires_at:E,refresh_token:c,token_type:m,user:R.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:H,redirectType:i.type},error:null}}catch(i){if(bn(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantFlow(){const e=y_(window.location.href);return!!(wo()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=y_(window.location.href),i=await fm(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&i)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async i=>{var n;const{data:s,error:l}=i;if(l)return{error:l};const c=(n=s.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:r}=await this.admin.signOut(c,e);if(r&&!(Hq(r)&&(r.status===404||r.status===401)))return{error:r}}return e!=="others"&&(await this._removeSession(),await v_(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const i=Pq(),n={id:i,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",i),this.stateChangeEmitters.delete(i)}};return this._debug("#onAuthStateChange()","registered callback with id",i),this.stateChangeEmitters.set(i,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(i)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async i=>{var n,s;try{const{data:{session:l},error:c}=i;if(c)throw c;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,i={}){let n=null,s=null;if(this.flowType==="pkce"){const l=Xu();await Kc(this.storage,`${this.storageKey}-code-verifier`,`${l}/PASSWORD_RECOVERY`),n=await Qu(l),s=l===n?"plain":"s256"}try{return await kn(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:i.captchaToken}},headers:this.headers,redirectTo:i.redirectTo})}catch(l){if(bn(l))return{data:null,error:l};throw l}}async getUserIdentities(){var e;try{const{data:i,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=i.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(i){if(bn(i))return{data:null,error:i};throw i}}async linkIdentity(e){var i;try{const{data:n,error:s}=await this._useSession(async l=>{var c,r,f,m,y;const{data:b,error:E}=l;if(E)throw E;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await kn(this.fetch,"GET",S,{headers:this.headers,jwt:(y=(m=b.session)===null||m===void 0?void 0:m.access_token)!==null&&y!==void 0?y:void 0})});if(s)throw s;return wo()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(bn(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async i=>{var n,s;const{data:l,error:c}=i;if(c)throw c;return await kn(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(i){if(bn(i))return{data:null,error:i};throw i}}async _refreshAccessToken(e){const i=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{const n=Date.now();return await Vq(async s=>(await Bq(s*200),this._debug(i,"refreshing attempt",s),await kn(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Yc})),(s,l,c)=>c&&c.error&&x_(c.error)&&Date.now()+(s+1)*200-n<Md)}catch(n){if(this._debug(i,"error",n),bn(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(i,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,i){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:i.redirectTo,scopes:i.scopes,queryParams:i.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",i,"url",n),wo()&&!i.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const n=await fm(this.storage,this.storageKey);if(this._debug(i,"session from storage",n),!this._isValidSession(n)){this._debug(i,"session is not valid"),n!==null&&await this._removeSession();return}const s=Math.round(Date.now()/1e3),l=((e=n.expires_at)!==null&&e!==void 0?e:1/0)<s+pA;if(this._debug(i,`session has${l?"":" not"} expired with margin of ${pA}s`),l){if(this.autoRefreshToken&&n.refresh_token){const{error:c}=await this._callRefreshToken(n.refresh_token);c&&(console.error(c),x_(c)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(i,"error",n),console.error(n);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var i,n;if(!e)throw new $u;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Vp;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new $u;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const r={session:l.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(l){if(this._debug(s,"error",l),bn(l)){const c={session:null,error:l};return x_(l)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(i=this.refreshingDeferred)===null||i===void 0||i.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,i,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",i,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:i});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,i)}catch(f){l.push(f)}});if(await Promise.all(c),l.length>0){for(let r=0;r<l.length;r+=1)console.error(l[r]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await Kc(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await v_(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&wo()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(i){console.error("removing visibilitychange callback failed",i)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Md);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async i=>{const{data:{session:n}}=i;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/Md);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Md}ms, refresh threshold is ${_A} ticks`),s<=_A&&await this._callRefreshToken(n.refresh_token)})}catch(i){console.error("Auto refresh tick failed with error. This is likely a transient error.",i)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof fI)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!wo()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const i=`#_onVisibilityChanged(${e})`;this._debug(i,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(i,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,i,n){const s=[`provider=${encodeURIComponent(i)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const l=Xu();await Kc(this.storage,`${this.storageKey}-code-verifier`,l);const c=await Qu(l),r=l===c?"plain":"s256";this._debug("PKCE","code verifier",`${l.substring(0,5)}...`,"code challenge",c,"method",r);const f=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(r)}`});s.push(f.toString())}if(n!=null&&n.queryParams){const l=new URLSearchParams(n.queryParams);s.push(l.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async i=>{var n;const{data:s,error:l}=i;return l?{data:null,error:l}:await kn(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(i){if(bn(i))return{data:null,error:i};throw i}}async _enroll(e){try{return await this._useSession(async i=>{var n,s;const{data:l,error:c}=i;if(c)return{data:null,error:c};const{data:r,error:f}=await kn(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(n=l==null?void 0:l.session)===null||n===void 0?void 0:n.access_token});return f?{data:null,error:f}:(!((s=r==null?void 0:r.totp)===null||s===void 0)&&s.qr_code&&(r.totp.qr_code=`data:image/svg+xml;utf-8,${r.totp.qr_code}`),{data:r,error:null})})}catch(i){if(bn(i))return{data:null,error:i};throw i}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async i=>{var n;const{data:s,error:l}=i;if(l)return{data:null,error:l};const{data:c,error:r}=await kn(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return r?{data:null,error:r}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:r})})}catch(i){if(bn(i))return{data:null,error:i};throw i}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async i=>{var n;const{data:s,error:l}=i;return l?{data:null,error:l}:await kn(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(i){if(bn(i))return{data:null,error:i};throw i}})}async _challengeAndVerify(e){const{data:i,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:i.id,code:e.code})}async _listFactors(){const{data:{user:e},error:i}=await this.getUser();if(i)return{data:null,error:i};const n=(e==null?void 0:e.factors)||[],s=n.filter(l=>l.factor_type==="totp"&&l.status==="verified");return{data:{all:n,totp:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var i,n;const{data:{session:s},error:l}=e;if(l)return{data:null,error:l};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const c=this._decodeJWT(s.access_token);let r=null;c.aal&&(r=c.aal);let f=r;((n=(i=s.user.factors)===null||i===void 0?void 0:i.filter(b=>b.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(f="aal2");const y=c.amr||[];return{data:{currentLevel:r,nextLevel:f,currentAuthenticationMethods:y},error:null}}))}}cf.nextInstanceID=0;class uZ extends cf{constructor(e){super(e)}}var hZ=function(t,e,i,n){function s(l){return l instanceof i?l:new i(function(c){c(l)})}return new(i||(i=Promise))(function(l,c){function r(y){try{m(n.next(y))}catch(b){c(b)}}function f(y){try{m(n.throw(y))}catch(b){c(b)}}function m(y){y.done?l(y.value):s(y.value).then(r,f)}m((n=n.apply(t,e||[])).next())})};const dZ={headers:Iq},fZ={schema:"public"},mZ={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},pZ={};class gZ{constructor(e,i,n){var s,l,c,r,f,m,y,b;if(this.supabaseUrl=e,this.supabaseKey=i,this.from=z=>this.rest.from(z),this.schema=z=>this.rest.schema(z),this.rpc=(z,H={},K)=>this.rest.rpc(z,H,K),!e)throw new Error("supabaseUrl is required.");if(!i)throw new Error("supabaseKey is required.");const E=Dq(e);this.realtimeUrl=`${E}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${E}/auth/v1`,this.storageUrl=`${E}/storage/v1`,this.functionsUrl=`${E}/functions/v1`;const S=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,D={db:fZ,realtime:pZ,auth:Object.assign(Object.assign({},mZ),{storageKey:S}),global:dZ},R=Rq(n??{},D);this.storageKey=(l=(s=R.auth)===null||s===void 0?void 0:s.storageKey)!==null&&l!==void 0?l:"",this.headers=(r=(c=R.global)===null||c===void 0?void 0:c.headers)!==null&&r!==void 0?r:{},this.auth=this._initSupabaseAuthClient((f=R.auth)!==null&&f!==void 0?f:{},this.headers,(m=R.global)===null||m===void 0?void 0:m.fetch),this.fetch=Mq(i,this._getAccessToken.bind(this),(y=R.global)===null||y===void 0?void 0:y.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},R.realtime)),this.rest=new Py(`${E}/rest/v1`,{headers:this.headers,schema:(b=R.db)===null||b===void 0?void 0:b.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new GK(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Tq(this.storageUrl,this.headers,this.fetch)}channel(e,i={config:{}}){return this.realtime.channel(e,i)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,i;return hZ(this,void 0,void 0,function*(){const{data:n}=yield this.auth.getSession();return(i=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&i!==void 0?i:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:i,detectSessionInUrl:n,storage:s,storageKey:l,flowType:c,debug:r},f,m){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new uZ({url:this.authUrl,headers:Object.assign(Object.assign({},y),f),storageKey:l,autoRefreshToken:e,persistSession:i,detectSessionInUrl:n,storage:s,flowType:c,debug:r,fetch:m})}_initRealtimeClient(e){return new dq(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((i,n)=>{this._handleTokenChanged(i,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,i,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.realtime.setAuth(n??null),this.changedAccessToken=n):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),i=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const _Z=(t,e,i)=>new gZ(t,e,i);var mI={exports:{}};(function(t,e){(function(i,n){t.exports=n()})(Jc,function(){var i,n,s;function l(r,f){if(!i)i=f;else if(!n)n=f;else{var m="var sharedChunk = {}; ("+i+")(sharedChunk); ("+n+")(sharedChunk);",y={};i(y),s=f(y),typeof window<"u"&&(s.workerUrl=window.URL.createObjectURL(new Blob([m],{type:"text/javascript"})))}}l(["exports"],function(r){function f(u,a,h,p){return new(h||(h=Promise))(function(_,w){function T(P){try{M(p.next(P))}catch(F){w(F)}}function k(P){try{M(p.throw(P))}catch(F){w(F)}}function M(P){var F;P.done?_(P.value):(F=P.value,F instanceof h?F:new h(function(G){G(F)})).then(T,k)}M((p=p.apply(u,a||[])).next())})}function m(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}typeof SuppressedError=="function"&&SuppressedError;var y=b;function b(u,a){this.x=u,this.y=a}b.prototype={clone:function(){return new b(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,a){return this.clone()._rotateAround(u,a)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var a=u.x-this.x,h=u.y-this.y;return a*a+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,a){return Math.atan2(this.x*a-this.y*u,this.x*u+this.y*a)},_matMult:function(u){var a=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=a,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var a=Math.cos(u),h=Math.sin(u),p=h*this.x+a*this.y;return this.x=a*this.x-h*this.y,this.y=p,this},_rotateAround:function(u,a){var h=Math.cos(u),p=Math.sin(u),_=a.y+p*(this.x-a.x)+h*(this.y-a.y);return this.x=a.x+h*(this.x-a.x)-p*(this.y-a.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},b.convert=function(u){return u instanceof b?u:Array.isArray(u)?new b(u[0],u[1]):u};var E=m(y),S=D;function D(u,a,h,p){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=a,this.p2x=h,this.p2y=p}D.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,a){if(a===void 0&&(a=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,p=0;p<8;p++){var _=this.sampleCurveX(h)-u;if(Math.abs(_)<a)return h;var w=this.sampleCurveDerivativeX(h);if(Math.abs(w)<1e-6)break;h-=_/w}var T=0,k=1;for(h=u,p=0;p<20&&(_=this.sampleCurveX(h),!(Math.abs(_-u)<a));p++)u>_?T=h:k=h,h=.5*(k-T)+T;return h},solve:function(u,a){return this.sampleCurveY(this.solveCurveX(u,a))}};var R=m(S);let z,H;function K(){return z==null&&(z=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),z}function W(){if(H==null&&(H=!1,K())){const a=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(a){for(let p=0;p<5*5;p++){const _=4*p;a.fillStyle=`rgb(${_},${_+1},${_+2})`,a.fillRect(p%5,Math.floor(p/5),1,1)}const h=a.getImageData(0,0,5,5).data;for(let p=0;p<5*5*4;p++)if(p%4!=3&&h[p]!==p){H=!0;break}}}return H||!1}function se(u,a,h,p){const _=new R(u,a,h,p);return function(w){return _.solve(w)}}const Y=se(.25,.1,.25,1);function ne(u,a,h){return Math.min(h,Math.max(a,u))}function ue(u,a,h){const p=h-a,_=((u-a)%p+p)%p+a;return _===a?h:_}function ve(u,...a){for(const h of a)for(const p in h)u[p]=h[p];return u}let _e=1;function oe(u,a,h){const p={};for(const _ in u)p[_]=a.call(h||this,u[_],_,u);return p}function Be(u,a,h){const p={};for(const _ in u)a.call(h||this,u[_],_,u)&&(p[_]=u[_]);return p}function mt(u){return Array.isArray(u)?u.map(mt):typeof u=="object"&&u?oe(u,mt):u}const Le={};function rt(u){Le[u]||(typeof console<"u"&&console.warn(u),Le[u]=!0)}function tt(u,a,h){return(h.y-u.y)*(a.x-u.x)>(a.y-u.y)*(h.x-u.x)}function We(u){let a=0;for(let h,p,_=0,w=u.length,T=w-1;_<w;T=_++)h=u[_],p=u[T],a+=(p.x-h.x)*(h.y+p.y);return a}function Ve(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let St=null;function zt(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const mi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function vt(u,a,h,p,_){return f(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const w=new VideoFrame(u,{timestamp:0});try{const T=w==null?void 0:w.format;if(!T||!T.startsWith("BGR")&&!T.startsWith("RGB"))throw new Error(`Unrecognized format ${T}`);const k=T.startsWith("BGR"),M=new Uint8ClampedArray(p*_*4);if(yield w.copyTo(M,function(P,F,G,X,ie){const re=4*Math.max(-F,0),de=(Math.max(0,G)-G)*X*4+re,we=4*X,Ie=Math.max(0,F),Ue=Math.max(0,G);return{rect:{x:Ie,y:Ue,width:Math.min(P.width,F+X)-Ie,height:Math.min(P.height,G+ie)-Ue},layout:[{offset:de,stride:we}]}}(u,a,h,p,_)),k)for(let P=0;P<M.length;P+=4){const F=M[P];M[P]=M[P+2],M[P+2]=F}return M}finally{w.close()}})}let pt,Pt,qe,Ht;const lt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(u){const a=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(a)}},getImageData(u,a=0){return this.getImageCanvasContext(u).getImageData(-a,-a,u.width+2*a,u.height+2*a)},getImageCanvasContext(u){const a=window.document.createElement("canvas"),h=a.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return a.width=u.width,a.height=u.height,h.drawImage(u,0,0,u.width,u.height),h},resolveURL:u=>(qe||(qe=document.createElement("a")),qe.href=u,qe.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ht==null&&(Ht=matchMedia("(prefers-reduced-motion: reduce)")),Ht.matches)}},Gt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Mi extends Error{constructor(a,h,p,_){super(`AJAXError: ${h} (${a}): ${p}`),this.status=a,this.statusText=h,this.url=p,this.body=_}}const bt=Ve()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,ze=u=>Gt.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))];function $t(u,a){const h=new AbortController,p=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:bt(),signal:h.signal});let _=!1,w=!1;return u.type==="json"&&p.headers.set("Accept","application/json"),w||fetch(p).then(T=>T.ok?(k=>{(u.type==="arrayBuffer"||u.type==="image"?k.arrayBuffer():u.type==="json"?k.json():k.text()).then(M=>{w||(_=!0,a(null,M,k.headers.get("Cache-Control"),k.headers.get("Expires")))}).catch(M=>{w||a(new Error(M.message))})})(T):T.blob().then(k=>a(new Mi(T.status,T.statusText,u.url,k)))).catch(T=>{T.code!==20&&a(new Error(T.message))}),{cancel:()=>{w=!0,_||h.abort()}}}const dt=function(u,a){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){if(Ve()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,a);if(!Ve())return(ze(u.url)||$t)(u,a)}if(!(/^file:/.test(h=u.url)||/^file:/.test(bt())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return $t(u,a);if(Ve()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,a,void 0,!0)}var h;return function(p,_){const w=new XMLHttpRequest;w.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(w.responseType="arraybuffer");for(const T in p.headers)w.setRequestHeader(T,p.headers[T]);return p.type==="json"&&(w.responseType="text",w.setRequestHeader("Accept","application/json")),w.withCredentials=p.credentials==="include",w.onerror=()=>{_(new Error(w.statusText))},w.onload=()=>{if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let T=w.response;if(p.type==="json")try{T=JSON.parse(w.response)}catch(k){return _(k)}_(null,T,w.getResponseHeader("Cache-Control"),w.getResponseHeader("Expires"))}else{const T=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});_(new Mi(w.status,w.statusText,p.url,T))}},w.send(p.body),{cancel:()=>w.abort()}}(u,a)},_t=function(u,a){return dt(ve(u,{type:"arrayBuffer"}),a)};function ni(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;const a=new URL(u),h=window.location;return a.protocol===h.protocol&&a.host===h.host}function Wi(u,a,h){h[u]&&h[u].indexOf(a)!==-1||(h[u]=h[u]||[],h[u].push(a))}function ct(u,a,h){if(h&&h[u]){const p=h[u].indexOf(a);p!==-1&&h[u].splice(p,1)}}class et{constructor(a,h={}){ve(this,h),this.type=a}}class zi extends et{constructor(a,h={}){super("error",ve({error:a},h))}}class zn{on(a,h){return this._listeners=this._listeners||{},Wi(a,h,this._listeners),this}off(a,h){return ct(a,h,this._listeners),ct(a,h,this._oneTimeListeners),this}once(a,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Wi(a,h,this._oneTimeListeners),this):new Promise(p=>this.once(a,p))}fire(a,h){typeof a=="string"&&(a=new et(a,h||{}));const p=a.type;if(this.listens(p)){a.target=this;const _=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const k of _)k.call(this,a);const w=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const k of w)ct(p,k,this._oneTimeListeners),k.call(this,a);const T=this._eventedParent;T&&(ve(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(a))}else a instanceof zi&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,h){return this._eventedParent=a,this._eventedParentData=h,this}}var Xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const On=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Rt(u,a){const h={};for(const p in u)p!=="ref"&&(h[p]=u[p]);return On.forEach(p=>{p in a&&(h[p]=a[p])}),h}function Xi(u,a){if(Array.isArray(u)){if(!Array.isArray(a)||u.length!==a.length)return!1;for(let h=0;h<u.length;h++)if(!Xi(u[h],a[h]))return!1;return!0}if(typeof u=="object"&&u!==null&&a!==null){if(typeof a!="object"||Object.keys(u).length!==Object.keys(a).length)return!1;for(const h in u)if(!Xi(u[h],a[h]))return!1;return!0}return u===a}const Ui={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Gn(u,a,h){h.push({command:Ui.addSource,args:[u,a[u]]})}function mr(u,a,h){a.push({command:Ui.removeSource,args:[u]}),h[u]=!0}function vr(u,a,h,p){mr(u,h,p),Gn(u,a,h)}function jr(u,a,h){let p;for(p in u[h])if(Object.prototype.hasOwnProperty.call(u[h],p)&&p!=="data"&&!Xi(u[h][p],a[h][p]))return!1;for(p in a[h])if(Object.prototype.hasOwnProperty.call(a[h],p)&&p!=="data"&&!Xi(u[h][p],a[h][p]))return!1;return!0}function Cr(u,a,h,p,_,w){let T;for(T in a=a||{},u=u||{})Object.prototype.hasOwnProperty.call(u,T)&&(Xi(u[T],a[T])||h.push({command:w,args:[p,T,a[T],_]}));for(T in a)Object.prototype.hasOwnProperty.call(a,T)&&!Object.prototype.hasOwnProperty.call(u,T)&&(Xi(u[T],a[T])||h.push({command:w,args:[p,T,a[T],_]}))}function lr(u){return u.id}function Hn(u,a){return u[a.id]=a,u}class Nt{constructor(a,h,p,_){this.message=(a?`${a}: `:"")+p,_&&(this.identifier=_),h!=null&&h.__line__&&(this.line=h.__line__)}}function Qi(u,...a){for(const h of a)for(const p in h)u[p]=h[p];return u}class Qe extends Error{constructor(a,h){super(h),this.message=h,this.key=a}}class Ki{constructor(a,h=[]){this.parent=a,this.bindings={};for(const[p,_]of h)this.bindings[p]=_}concat(a){return new Ki(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}const Gi={kind:"null"},Lt={kind:"number"},Bi={kind:"string"},ii={kind:"boolean"},Bn={kind:"color"},st={kind:"object"},Q={kind:"value"},ge={kind:"collator"},Z={kind:"formatted"},V={kind:"padding"},q={kind:"resolvedImage"},J={kind:"variableAnchorOffsetCollection"};function le(u,a){return{kind:"array",itemType:u,N:a}}function ce(u){if(u.kind==="array"){const a=ce(u.itemType);return typeof u.N=="number"?`array<${a}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${a}>`}return u.kind}const Oe=[Gi,Lt,Bi,ii,Bn,Z,st,le(Q),V,q,J];function Ae(u,a){if(a.kind==="error")return null;if(u.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!Ae(u.itemType,a.itemType))&&(typeof u.N!="number"||u.N===a.N))return null}else{if(u.kind===a.kind)return null;if(u.kind==="value"){for(const h of Oe)if(!Ae(h,a))return null}}return`Expected ${ce(u)} but found ${ce(a)} instead.`}function ye(u,a){return a.some(h=>h.kind===u.kind)}function Ce(u,a){return a.some(h=>h==="null"?u===null:h==="array"?Array.isArray(u):h==="object"?u&&!Array.isArray(u)&&typeof u=="object":h===typeof u)}function ot(u,a){return u.kind==="array"&&a.kind==="array"?u.itemType.kind===a.itemType.kind&&typeof u.N=="number":u.kind===a.kind}const gt=.96422,ht=.82521,di=4/29,Oi=6/29,ai=3*Oi*Oi,_i=Oi*Oi*Oi,ji=Math.PI/180,ke=180/Math.PI;function Dt(u){return(u%=360)<0&&(u+=360),u}function It([u,a,h,p]){let _,w;const T=gn((.2225045*(u=yi(u))+.7168786*(a=yi(a))+.0606169*(h=yi(h)))/1);u===a&&a===h?_=w=T:(_=gn((.4360747*u+.3850649*a+.1430804*h)/gt),w=gn((.0139322*u+.0971045*a+.7141733*h)/ht));const k=116*T-16;return[k<0?0:k,500*(_-T),200*(T-w),p]}function yi(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function gn(u){return u>_i?Math.pow(u,1/3):u/ai+di}function Zi([u,a,h,p]){let _=(u+16)/116,w=isNaN(a)?_:_+a/500,T=isNaN(h)?_:_-h/200;return _=1*Cn(_),w=gt*Cn(w),T=ht*Cn(T),[In(3.1338561*w-1.6168667*_-.4906146*T),In(-.9787684*w+1.9161415*_+.033454*T),In(.0719453*w-.2289914*_+1.4052427*T),p]}function In(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function Cn(u){return u>Oi?u*u*u:ai*(u-di)}function cr(u){return parseInt(u.padEnd(2,u),16)/255}function Er(u,a){return Ws(a?u/100:u,0,1)}function Ws(u,a,h){return Math.min(Math.max(a,u),h)}function la(u){return!u.some(Number.isNaN)}const Mr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class xn{constructor(a,h,p,_=1,w=!0){this.r=a,this.g=h,this.b=p,this.a=_,w||(this.r*=_,this.g*=_,this.b*=_,_||this.overwriteGetter("rgb",[a,h,p,_]))}static parse(a){if(a instanceof xn)return a;if(typeof a!="string")return;const h=function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const _=Mr[p];if(_){const[T,k,M]=_;return[T/255,k/255,M/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const T=p.length<6?1:2;let k=1;return[cr(p.slice(k,k+=T)),cr(p.slice(k,k+=T)),cr(p.slice(k,k+=T)),cr(p.slice(k,k+T)||"ff")]}if(p.startsWith("rgb")){const T=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[k,M,P,F,G,X,ie,re,de,we,Ie,Ue]=T,Me=[F||" ",ie||" ",we].join("");if(Me==="  "||Me==="  /"||Me===",,"||Me===",,,"){const He=[P,X,de].join(""),$e=He==="%%%"?100:He===""?255:0;if($e){const wt=[Ws(+M/$e,0,1),Ws(+G/$e,0,1),Ws(+re/$e,0,1),Ie?Er(+Ie,Ue):1];if(la(wt))return wt}}return}}const w=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[T,k,M,P,F,G,X,ie,re]=w,de=[M||" ",F||" ",X].join("");if(de==="  "||de==="  /"||de===",,"||de===",,,"){const we=[+k,Ws(+P,0,100),Ws(+G,0,100),ie?Er(+ie,re):1];if(la(we))return function([Ie,Ue,Me,He]){function $e(wt){const ci=(wt+Ie/30)%12,bi=Ue*Math.min(Me,1-Me);return Me-bi*Math.max(-1,Math.min(ci-3,9-ci,1))}return Ie=Dt(Ie),Ue/=100,Me/=100,[$e(0),$e(8),$e(4),He]}(we)}}}(a);return h?new xn(...h,!1):void 0}get rgb(){const{r:a,g:h,b:p,a:_}=this,w=_||1/0;return this.overwriteGetter("rgb",[a/w,h/w,p/w,_])}get hcl(){return this.overwriteGetter("hcl",function(a){const[h,p,_,w]=It(a),T=Math.sqrt(p*p+_*_);return[Math.round(1e4*T)?Dt(Math.atan2(_,p)*ke):NaN,T,h,w]}(this.rgb))}get lab(){return this.overwriteGetter("lab",It(this.rgb))}overwriteGetter(a,h){return Object.defineProperty(this,a,{value:h}),h}toString(){const[a,h,p,_]=this.rgb;return`rgba(${[a,h,p].map(w=>Math.round(255*w)).join(",")},${_})`}}xn.black=new xn(0,0,0,1),xn.white=new xn(1,1,1,1),xn.transparent=new xn(0,0,0,0),xn.red=new xn(1,0,0,1);class Vl{constructor(a,h,p){this.sensitivity=a?h?"variant":"case":h?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,h){return this.collator.compare(a,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ys{constructor(a,h,p,_,w){this.text=a,this.image=h,this.scale=p,this.fontStack=_,this.textColor=w}}class Jn{constructor(a){this.sections=a}static fromString(a){return new Jn([new Ys(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof Jn?a:Jn.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class $r{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof $r)return a;if(typeof a=="number")return new $r([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(const h of a)if(typeof h!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new $r(a)}}toString(){return JSON.stringify(this.values)}}const uo=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class zr{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof zr)return a;if(Array.isArray(a)&&!(a.length<1)&&a.length%2==0){for(let h=0;h<a.length;h+=2){const p=a[h],_=a[h+1];if(typeof p!="string"||!uo.has(p)||!Array.isArray(_)||_.length!==2||typeof _[0]!="number"||typeof _[1]!="number")return}return new zr(a)}}toString(){return JSON.stringify(this.values)}}class Br{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Br({name:a,available:!1}):null}}function Fl(u,a,h,p){return typeof u=="number"&&u>=0&&u<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof h=="number"&&h>=0&&h<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[u,a,h,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[u,a,h,p]:[u,a,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Lo(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof xn||u instanceof Vl||u instanceof Jn||u instanceof $r||u instanceof zr||u instanceof Br)return!0;if(Array.isArray(u)){for(const a of u)if(!Lo(a))return!1;return!0}if(typeof u=="object"){for(const a in u)if(!Lo(u[a]))return!1;return!0}return!1}function $n(u){if(u===null)return Gi;if(typeof u=="string")return Bi;if(typeof u=="boolean")return ii;if(typeof u=="number")return Lt;if(u instanceof xn)return Bn;if(u instanceof Vl)return ge;if(u instanceof Jn)return Z;if(u instanceof $r)return V;if(u instanceof zr)return J;if(u instanceof Br)return q;if(Array.isArray(u)){const a=u.length;let h;for(const p of u){const _=$n(p);if(h){if(h===_)continue;h=Q;break}h=_}return le(h||Q,a)}return st}function _n(u){const a=typeof u;return u===null?"":a==="string"||a==="number"||a==="boolean"?String(u):u instanceof xn||u instanceof Jn||u instanceof $r||u instanceof zr||u instanceof Br?u.toString():JSON.stringify(u)}class Aa{constructor(a,h){this.type=a,this.value=h}static parse(a,h){if(a.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Lo(a[1]))return h.error("invalid value");const p=a[1];let _=$n(p);const w=h.expectedType;return _.kind!=="array"||_.N!==0||!w||w.kind!=="array"||typeof w.N=="number"&&w.N!==0||(_=w),new Aa(_,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class er{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}}const el={string:Bi,number:Lt,boolean:ii,object:st};class Ms{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let p,_=1;const w=a[0];if(w==="array"){let k,M;if(a.length>2){const P=a[1];if(typeof P!="string"||!(P in el)||P==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);k=el[P],_++}else k=Q;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return h.error('The length argument to "array" must be a positive integer literal',2);M=a[2],_++}p=le(k,M)}else{if(!el[w])throw new Error(`Types doesn't contain name = ${w}`);p=el[w]}const T=[];for(;_<a.length;_++){const k=h.parse(a[_],_,Q);if(!k)return null;T.push(k)}return new Ms(p,T)}evaluate(a){for(let h=0;h<this.args.length;h++){const p=this.args[h].evaluate(a);if(!Ae(this.type,$n(p)))return p;if(h===this.args.length-1)throw new er(`Expected value to be of type ${ce(this.type)}, but found ${ce($n(p))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Sc={"to-boolean":ii,"to-color":Bn,"to-number":Lt,"to-string":Bi};class ja{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const p=a[0];if(!Sc[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&a.length!==2)return h.error("Expected one argument.");const _=Sc[p],w=[];for(let T=1;T<a.length;T++){const k=h.parse(a[T],T,Q);if(!k)return null;w.push(k)}return new ja(_,w)}evaluate(a){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(a);case"color":{let h,p;for(const _ of this.args){if(h=_.evaluate(a),p=null,h instanceof xn)return h;if(typeof h=="string"){const w=a.parseColor(h);if(w)return w}else if(Array.isArray(h)&&(p=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Fl(h[0],h[1],h[2],h[3]),!p))return new xn(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new er(p||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const p of this.args){h=p.evaluate(a);const _=$r.parse(h);if(_)return _}throw new er(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const p of this.args){h=p.evaluate(a);const _=zr.parse(h);if(_)return _}throw new er(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const p of this.args){if(h=p.evaluate(a),h===null)return 0;const _=Number(h);if(!isNaN(_))return _}throw new er(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return Jn.fromString(_n(this.args[0].evaluate(a)));case"resolvedImage":return Br.fromString(_n(this.args[0].evaluate(a)));default:return _n(this.args[0].evaluate(a))}}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const tl=["Unknown","Point","LineString","Polygon"];class I{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?tl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let h=this._parseColorCache[a];return h||(h=this._parseColorCache[a]=xn.parse(a)),h}}class N{constructor(a,h,p=[],_,w=new Ki,T=[]){this.registry=a,this.path=p,this.key=p.map(k=>`[${k}]`).join(""),this.scope=w,this.errors=T,this.expectedType=_,this._isConstant=h}parse(a,h,p,_,w={}){return h?this.concat(h,p,_)._parse(a,w):this._parse(a,w)}_parse(a,h){function p(_,w,T){return T==="assert"?new Ms(w,[_]):T==="coerce"?new ja(w,[_]):_}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=a[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const w=this.registry[_];if(w){let T=w.parse(a,this);if(!T)return null;if(this.expectedType){const k=this.expectedType,M=T.type;if(k.kind!=="string"&&k.kind!=="number"&&k.kind!=="boolean"&&k.kind!=="object"&&k.kind!=="array"||M.kind!=="value")if(k.kind!=="color"&&k.kind!=="formatted"&&k.kind!=="resolvedImage"||M.kind!=="value"&&M.kind!=="string")if(k.kind!=="padding"||M.kind!=="value"&&M.kind!=="number"&&M.kind!=="array")if(k.kind!=="variableAnchorOffsetCollection"||M.kind!=="value"&&M.kind!=="array"){if(this.checkSubtype(k,M))return null}else T=p(T,k,h.typeAnnotation||"coerce");else T=p(T,k,h.typeAnnotation||"coerce");else T=p(T,k,h.typeAnnotation||"coerce");else T=p(T,k,h.typeAnnotation||"assert")}if(!(T instanceof Aa)&&T.type.kind!=="resolvedImage"&&this._isConstant(T)){const k=new I;try{T=new Aa(T.type,T.evaluate(k))}catch(M){return this.error(M.message),null}}return T}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,h,p){const _=typeof a=="number"?this.path.concat(a):this.path,w=p?this.scope.concat(p):this.scope;return new N(this.registry,this._isConstant,_,h||null,w,this.errors)}error(a,...h){const p=`${this.key}${h.map(_=>`[${_}]`).join("")}`;this.errors.push(new Qe(p,a))}checkSubtype(a,h){const p=Ae(a,h);return p&&this.error(p),p}}class te{constructor(a,h,p){this.type=ge,this.locale=p,this.caseSensitive=a,this.diacriticSensitive=h}static parse(a,h){if(a.length!==2)return h.error("Expected one argument.");const p=a[1];if(typeof p!="object"||Array.isArray(p))return h.error("Collator options argument must be an object.");const _=h.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,ii);if(!_)return null;const w=h.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,ii);if(!w)return null;let T=null;return p.locale&&(T=h.parse(p.locale,1,Bi),!T)?null:new te(_,w,T)}evaluate(a){return new Vl(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}const xe=8192;function De(u,a){u[0]=Math.min(u[0],a[0]),u[1]=Math.min(u[1],a[1]),u[2]=Math.max(u[2],a[0]),u[3]=Math.max(u[3],a[1])}function Re(u,a){return!(u[0]<=a[0]||u[2]>=a[2]||u[1]<=a[1]||u[3]>=a[3])}function Ke(u,a){const h=(180+u[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,_=Math.pow(2,a.z);return[Math.round(h*_*xe),Math.round(p*_*xe)]}function Bt(u,a,h){const p=u[0]-a[0],_=u[1]-a[1],w=u[0]-h[0],T=u[1]-h[1];return p*T-w*_==0&&p*w<=0&&_*T<=0}function Kt(u,a){let h=!1;for(let T=0,k=a.length;T<k;T++){const M=a[T];for(let P=0,F=M.length;P<F-1;P++){if(Bt(u,M[P],M[P+1]))return!1;(_=M[P])[1]>(p=u)[1]!=(w=M[P+1])[1]>p[1]&&p[0]<(w[0]-_[0])*(p[1]-_[1])/(w[1]-_[1])+_[0]&&(h=!h)}}var p,_,w;return h}function si(u,a){for(let h=0;h<a.length;h++)if(Kt(u,a[h]))return!0;return!1}function oi(u,a,h,p){const _=p[0]-h[0],w=p[1]-h[1],T=(u[0]-h[0])*w-_*(u[1]-h[1]),k=(a[0]-h[0])*w-_*(a[1]-h[1]);return T>0&&k<0||T<0&&k>0}function Xt(u,a,h){for(const P of h)for(let F=0;F<P.length-1;++F)if((k=[(T=P[F+1])[0]-(w=P[F])[0],T[1]-w[1]])[0]*(M=[(_=a)[0]-(p=u)[0],_[1]-p[1]])[1]-k[1]*M[0]!=0&&oi(p,_,w,T)&&oi(w,T,p,_))return!0;var p,_,w,T,k,M;return!1}function qi(u,a){for(let h=0;h<u.length;++h)if(!Kt(u[h],a))return!1;for(let h=0;h<u.length-1;++h)if(Xt(u[h],u[h+1],a))return!1;return!0}function tr(u,a){for(let h=0;h<a.length;h++)if(qi(u,a[h]))return!0;return!1}function Yi(u,a,h){const p=[];for(let _=0;_<u.length;_++){const w=[];for(let T=0;T<u[_].length;T++){const k=Ke(u[_][T],h);De(a,k),w.push(k)}p.push(w)}return p}function br(u,a,h){const p=[];for(let _=0;_<u.length;_++){const w=Yi(u[_],a,h);p.push(w)}return p}function Tt(u,a,h,p){if(u[0]<h[0]||u[0]>h[2]){const _=.5*p;let w=u[0]-h[0]>_?-p:h[0]-u[0]>_?p:0;w===0&&(w=u[0]-h[2]>_?-p:h[2]-u[0]>_?p:0),u[0]+=w}De(a,u)}function xi(u,a,h,p){const _=Math.pow(2,p.z)*xe,w=[p.x*xe,p.y*xe],T=[];for(const k of u)for(const M of k){const P=[M.x+w[0],M.y+w[1]];Tt(P,a,h,_),T.push(P)}return T}function wn(u,a,h,p){const _=Math.pow(2,p.z)*xe,w=[p.x*xe,p.y*xe],T=[];for(const M of u){const P=[];for(const F of M){const G=[F.x+w[0],F.y+w[1]];De(a,G),P.push(G)}T.push(P)}if(a[2]-a[0]<=_/2){(k=a)[0]=k[1]=1/0,k[2]=k[3]=-1/0;for(const M of T)for(const P of M)Tt(P,a,h,_)}var k;return T}class ir{constructor(a,h){this.type=ii,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Lo(a[1])){const p=a[1];if(p.type==="FeatureCollection")for(let _=0;_<p.features.length;++_){const w=p.features[_].geometry.type;if(w==="Polygon"||w==="MultiPolygon")return new ir(p,p.features[_].geometry)}else if(p.type==="Feature"){const _=p.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new ir(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new ir(p,p)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(h,p){const _=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],T=h.canonicalID();if(p.type==="Polygon"){const k=Yi(p.coordinates,w,T),M=xi(h.geometry(),_,w,T);if(!Re(_,w))return!1;for(const P of M)if(!Kt(P,k))return!1}if(p.type==="MultiPolygon"){const k=br(p.coordinates,w,T),M=xi(h.geometry(),_,w,T);if(!Re(_,w))return!1;for(const P of M)if(!si(P,k))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(h,p){const _=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],T=h.canonicalID();if(p.type==="Polygon"){const k=Yi(p.coordinates,w,T),M=wn(h.geometry(),_,w,T);if(!Re(_,w))return!1;for(const P of M)if(!qi(P,k))return!1}if(p.type==="MultiPolygon"){const k=br(p.coordinates,w,T),M=wn(h.geometry(),_,w,T);if(!Re(_,w))return!1;for(const P of M)if(!tr(P,k))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class ur{constructor(a,h){this.type=h.type,this.name=a,this.boundExpression=h}static parse(a,h){if(a.length!==2||typeof a[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const p=a[1];return h.scope.has(p)?new ur(p,h.scope.get(p)):h.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class cs{constructor(a,h,p,_){this.name=a,this.type=h,this._evaluate=p,this.args=_}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,h){const p=a[0],_=cs.definitions[p];if(!_)return h.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const w=Array.isArray(_)?_[0]:_.type,T=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,k=T.filter(([P])=>!Array.isArray(P)||P.length===a.length-1);let M=null;for(const[P,F]of k){M=new N(h.registry,Ul,h.path,null,h.scope);const G=[];let X=!1;for(let ie=1;ie<a.length;ie++){const re=a[ie],de=Array.isArray(P)?P[ie-1]:P.type,we=M.parse(re,1+G.length,de);if(!we){X=!0;break}G.push(we)}if(!X)if(Array.isArray(P)&&P.length!==G.length)M.error(`Expected ${P.length} arguments, but found ${G.length} instead.`);else{for(let ie=0;ie<G.length;ie++){const re=Array.isArray(P)?P[ie]:P.type,de=G[ie];M.concat(ie+1).checkSubtype(re,de.type)}if(M.errors.length===0)return new cs(p,w,F,G)}}if(k.length===1)h.errors.push(...M.errors);else{const P=(k.length?k:T).map(([G])=>{return X=G,Array.isArray(X)?`(${X.map(ce).join(", ")})`:`(${ce(X.type)}...)`;var X}).join(" | "),F=[];for(let G=1;G<a.length;G++){const X=h.parse(a[G],1+F.length);if(!X)return null;F.push(ce(X.type))}h.error(`Expected arguments of type ${P}, but found (${F.join(", ")}) instead.`)}return null}static register(a,h){cs.definitions=h;for(const p in h)a[p]=cs}}function Ul(u){if(u instanceof ur)return Ul(u.boundExpression);if(u instanceof cs&&u.name==="error"||u instanceof te||u instanceof ir)return!1;const a=u instanceof ja||u instanceof Ms;let h=!0;return u.eachChild(p=>{h=a?h&&Ul(p):h&&p instanceof Aa}),!!h&&Dn(u)&&jl(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Dn(u){if(u instanceof cs&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof ir)return!1;let a=!0;return u.eachChild(h=>{a&&!Dn(h)&&(a=!1)}),a}function Po(u){if(u instanceof cs&&u.name==="feature-state")return!1;let a=!0;return u.eachChild(h=>{a&&!Po(h)&&(a=!1)}),a}function jl(u,a){if(u instanceof cs&&a.indexOf(u.name)>=0)return!1;let h=!0;return u.eachChild(p=>{h&&!jl(p,a)&&(h=!1)}),h}function us(u,a){const h=u.length-1;let p,_,w=0,T=h,k=0;for(;w<=T;)if(k=Math.floor((w+T)/2),p=u[k],_=u[k+1],p<=a){if(k===h||a<_)return k;w=k+1}else{if(!(p>a))throw new er("Input is not a number.");T=k-1}return 0}class Ea{constructor(a,h,p){this.type=a,this.input=h,this.labels=[],this.outputs=[];for(const[_,w]of p)this.labels.push(_),this.outputs.push(w)}static parse(a,h){if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");const p=h.parse(a[1],1,Lt);if(!p)return null;const _=[];let w=null;h.expectedType&&h.expectedType.kind!=="value"&&(w=h.expectedType);for(let T=1;T<a.length;T+=2){const k=T===1?-1/0:a[T],M=a[T+1],P=T,F=T+1;if(typeof k!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(_.length&&_[_.length-1][0]>=k)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const G=h.parse(M,F,w);if(!G)return null;w=w||G.type,_.push([k,G])}return new Ea(w,p,_)}evaluate(a){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(a);const _=this.input.evaluate(a);if(_<=h[0])return p[0].evaluate(a);const w=h.length;return _>=h[w-1]?p[w-1].evaluate(a):p[us(h,_)].evaluate(a)}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function on(u,a,h){return u+h*(a-u)}function il(u,a,h){return u.map((p,_)=>on(p,a[_],h))}const is={number:on,color:function(u,a,h,p="rgb"){switch(p){case"rgb":{const[_,w,T,k]=il(u.rgb,a.rgb,h);return new xn(_,w,T,k,!1)}case"hcl":{const[_,w,T,k]=u.hcl,[M,P,F,G]=a.hcl;let X,ie;if(isNaN(_)||isNaN(M))isNaN(_)?isNaN(M)?X=NaN:(X=M,T!==1&&T!==0||(ie=P)):(X=_,F!==1&&F!==0||(ie=w));else{let Ue=M-_;M>_&&Ue>180?Ue-=360:M<_&&_-M>180&&(Ue+=360),X=_+h*Ue}const[re,de,we,Ie]=function([Ue,Me,He,$e]){return Ue=isNaN(Ue)?0:Ue*ji,Zi([He,Math.cos(Ue)*Me,Math.sin(Ue)*Me,$e])}([X,ie??on(w,P,h),on(T,F,h),on(k,G,h)]);return new xn(re,de,we,Ie,!1)}case"lab":{const[_,w,T,k]=Zi(il(u.lab,a.lab,h));return new xn(_,w,T,k,!1)}}},array:il,padding:function(u,a,h){return new $r(il(u.values,a.values,h))},variableAnchorOffsetCollection:function(u,a,h){const p=u.values,_=a.values;if(p.length!==_.length)throw new er(`Cannot interpolate values of different length. from: ${u.toString()}, to: ${a.toString()}`);const w=[];for(let T=0;T<p.length;T+=2){if(p[T]!==_[T])throw new er(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${p[T]}, to[${T}]: ${_[T]}`);w.push(p[T]);const[k,M]=p[T+1],[P,F]=_[T+1];w.push([on(k,P,h),on(M,F,h)])}return new zr(w)}};class hs{constructor(a,h,p,_,w){this.type=a,this.operator=h,this.interpolation=p,this.input=_,this.labels=[],this.outputs=[];for(const[T,k]of w)this.labels.push(T),this.outputs.push(k)}static interpolationFactor(a,h,p,_){let w=0;if(a.name==="exponential")w=Gl(h,a.base,p,_);else if(a.name==="linear")w=Gl(h,1,p,_);else if(a.name==="cubic-bezier"){const T=a.controlPoints;w=new R(T[0],T[1],T[2],T[3]).solve(Gl(h,1,p,_))}return w}static parse(a,h){let[p,_,w,...T]=a;if(!Array.isArray(_)||_.length===0)return h.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const P=_[1];if(typeof P!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:P}}else{if(_[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const P=_.slice(1);if(P.length!==4||P.some(F=>typeof F!="number"||F<0||F>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:P}}}if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(w=h.parse(w,2,Lt),!w)return null;const k=[];let M=null;p==="interpolate-hcl"||p==="interpolate-lab"?M=Bn:h.expectedType&&h.expectedType.kind!=="value"&&(M=h.expectedType);for(let P=0;P<T.length;P+=2){const F=T[P],G=T[P+1],X=P+3,ie=P+4;if(typeof F!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',X);if(k.length&&k[k.length-1][0]>=F)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',X);const re=h.parse(G,ie,M);if(!re)return null;M=M||re.type,k.push([F,re])}return ot(M,Lt)||ot(M,Bn)||ot(M,V)||ot(M,J)||ot(M,le(Lt))?new hs(M,p,_,w,k):h.error(`Type ${ce(M)} is not interpolatable.`)}evaluate(a){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(a);const _=this.input.evaluate(a);if(_<=h[0])return p[0].evaluate(a);const w=h.length;if(_>=h[w-1])return p[w-1].evaluate(a);const T=us(h,_),k=hs.interpolationFactor(this.interpolation,_,h[T],h[T+1]),M=p[T].evaluate(a),P=p[T+1].evaluate(a);switch(this.operator){case"interpolate":return is[this.type.kind](M,P,k);case"interpolate-hcl":return is.color(M,P,k,"hcl");case"interpolate-lab":return is.color(M,P,k,"lab")}}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function Gl(u,a,h,p){const _=p-h,w=u-h;return _===0?0:a===1?w/_:(Math.pow(a,w)-1)/(Math.pow(a,_)-1)}class Hl{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expectected at least one argument.");let p=null;const _=h.expectedType;_&&_.kind!=="value"&&(p=_);const w=[];for(const k of a.slice(1)){const M=h.parse(k,1+w.length,p,void 0,{typeAnnotation:"omit"});if(!M)return null;p=p||M.type,w.push(M)}if(!p)throw new Error("No output type");const T=_&&w.some(k=>Ae(_,k.type));return new Hl(T?Q:p,w)}evaluate(a){let h,p=null,_=0;for(const w of this.args)if(_++,p=w.evaluate(a),p&&p instanceof Br&&!p.available&&(h||(h=p.name),p=null,_===this.args.length&&(p=h)),p!==null)break;return p}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}class Kl{constructor(a,h){this.type=h.type,this.bindings=[].concat(a),this.result=h}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const h of this.bindings)a(h[1]);a(this.result)}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const p=[];for(let w=1;w<a.length-1;w+=2){const T=a[w];if(typeof T!="string")return h.error(`Expected string, but found ${typeof T} instead.`,w);if(/[^a-zA-Z0-9_]/.test(T))return h.error("Variable names must contain only alphanumeric characters or '_'.",w);const k=h.parse(a[w+1],w+1);if(!k)return null;p.push([T,k])}const _=h.parse(a[a.length-1],a.length-1,h.expectedType,p);return _?new Kl(p,_):null}outputDefined(){return this.result.outputDefined()}}class Ic{constructor(a,h,p){this.type=a,this.index=h,this.input=p}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const p=h.parse(a[1],1,Lt),_=h.parse(a[2],2,le(h.expectedType||Q));return p&&_?new Ic(_.type.itemType,p,_):null}evaluate(a){const h=this.index.evaluate(a),p=this.input.evaluate(a);if(h<0)throw new er(`Array index out of bounds: ${h} < 0.`);if(h>=p.length)throw new er(`Array index out of bounds: ${h} > ${p.length-1}.`);if(h!==Math.floor(h))throw new er(`Array index must be an integer, but found ${h} instead.`);return p[h]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class ql{constructor(a,h){this.type=ii,this.needle=a,this.haystack=h}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const p=h.parse(a[1],1,Q),_=h.parse(a[2],2,Q);return p&&_?ye(p.type,[ii,Bi,Lt,Gi,Q])?new ql(p,_):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${ce(p.type)} instead`):null}evaluate(a){const h=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(!p)return!1;if(!Ce(h,["boolean","string","number","null"]))throw new er(`Expected first argument to be of type boolean, string, number or null, but found ${ce($n(h))} instead.`);if(!Ce(p,["string","array"]))throw new er(`Expected second argument to be of type array or string, but found ${ce($n(p))} instead.`);return p.indexOf(h)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class nl{constructor(a,h,p){this.type=Lt,this.needle=a,this.haystack=h,this.fromIndex=p}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const p=h.parse(a[1],1,Q),_=h.parse(a[2],2,Q);if(!p||!_)return null;if(!ye(p.type,[ii,Bi,Lt,Gi,Q]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${ce(p.type)} instead`);if(a.length===4){const w=h.parse(a[3],3,Lt);return w?new nl(p,_,w):null}return new nl(p,_)}evaluate(a){const h=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(!Ce(h,["boolean","string","number","null"]))throw new er(`Expected first argument to be of type boolean, string, number or null, but found ${ce($n(h))} instead.`);if(!Ce(p,["string","array"]))throw new er(`Expected second argument to be of type array or string, but found ${ce($n(p))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(a);return p.indexOf(h,_)}return p.indexOf(h)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class Zl{constructor(a,h,p,_,w,T){this.inputType=a,this.type=h,this.input=p,this.cases=_,this.outputs=w,this.otherwise=T}static parse(a,h){if(a.length<5)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return h.error("Expected an even number of arguments.");let p,_;h.expectedType&&h.expectedType.kind!=="value"&&(_=h.expectedType);const w={},T=[];for(let P=2;P<a.length-1;P+=2){let F=a[P];const G=a[P+1];Array.isArray(F)||(F=[F]);const X=h.concat(P);if(F.length===0)return X.error("Expected at least one branch label.");for(const re of F){if(typeof re!="number"&&typeof re!="string")return X.error("Branch labels must be numbers or strings.");if(typeof re=="number"&&Math.abs(re)>Number.MAX_SAFE_INTEGER)return X.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof re=="number"&&Math.floor(re)!==re)return X.error("Numeric branch labels must be integer values.");if(p){if(X.checkSubtype(p,$n(re)))return null}else p=$n(re);if(w[String(re)]!==void 0)return X.error("Branch labels must be unique.");w[String(re)]=T.length}const ie=h.parse(G,P,_);if(!ie)return null;_=_||ie.type,T.push(ie)}const k=h.parse(a[1],1,Q);if(!k)return null;const M=h.parse(a[a.length-1],a.length-1,_);return M?k.type.kind!=="value"&&h.concat(1).checkSubtype(p,k.type)?null:new Zl(p,_,k,w,T,M):null}evaluate(a){const h=this.input.evaluate(a);return($n(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class kc{constructor(a,h,p){this.type=a,this.branches=h,this.otherwise=p}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return h.error("Expected an odd number of arguments.");let p;h.expectedType&&h.expectedType.kind!=="value"&&(p=h.expectedType);const _=[];for(let T=1;T<a.length-1;T+=2){const k=h.parse(a[T],T,ii);if(!k)return null;const M=h.parse(a[T+1],T+1,p);if(!M)return null;_.push([k,M]),p=p||M.type}const w=h.parse(a[a.length-1],a.length-1,p);if(!w)return null;if(!p)throw new Error("Can't infer output type");return new kc(p,_,w)}evaluate(a){for(const[h,p]of this.branches)if(h.evaluate(a))return p.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[h,p]of this.branches)a(h),a(p);a(this.otherwise)}outputDefined(){return this.branches.every(([a,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class Wl{constructor(a,h,p,_){this.type=a,this.input=h,this.beginIndex=p,this.endIndex=_}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const p=h.parse(a[1],1,Q),_=h.parse(a[2],2,Lt);if(!p||!_)return null;if(!ye(p.type,[le(Q),Bi,Q]))return h.error(`Expected first argument to be of type array or string, but found ${ce(p.type)} instead`);if(a.length===4){const w=h.parse(a[3],3,Lt);return w?new Wl(p.type,p,_,w):null}return new Wl(p.type,p,_)}evaluate(a){const h=this.input.evaluate(a),p=this.beginIndex.evaluate(a);if(!Ce(h,["string","array"]))throw new er(`Expected first argument to be of type array or string, but found ${ce($n(h))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(a);return h.slice(p,_)}return h.slice(p)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function rl(u,a){return u==="=="||u==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function Yl(u,a,h,p){return p.compare(a,h)===0}function ho(u,a,h){const p=u!=="=="&&u!=="!=";return class pI{constructor(w,T,k){this.type=ii,this.lhs=w,this.rhs=T,this.collator=k,this.hasUntypedArgument=w.type.kind==="value"||T.type.kind==="value"}static parse(w,T){if(w.length!==3&&w.length!==4)return T.error("Expected two or three arguments.");const k=w[0];let M=T.parse(w[1],1,Q);if(!M)return null;if(!rl(k,M.type))return T.concat(1).error(`"${k}" comparisons are not supported for type '${ce(M.type)}'.`);let P=T.parse(w[2],2,Q);if(!P)return null;if(!rl(k,P.type))return T.concat(2).error(`"${k}" comparisons are not supported for type '${ce(P.type)}'.`);if(M.type.kind!==P.type.kind&&M.type.kind!=="value"&&P.type.kind!=="value")return T.error(`Cannot compare types '${ce(M.type)}' and '${ce(P.type)}'.`);p&&(M.type.kind==="value"&&P.type.kind!=="value"?M=new Ms(P.type,[M]):M.type.kind!=="value"&&P.type.kind==="value"&&(P=new Ms(M.type,[P])));let F=null;if(w.length===4){if(M.type.kind!=="string"&&P.type.kind!=="string"&&M.type.kind!=="value"&&P.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(F=T.parse(w[3],3,ge),!F)return null}return new pI(M,P,F)}evaluate(w){const T=this.lhs.evaluate(w),k=this.rhs.evaluate(w);if(p&&this.hasUntypedArgument){const M=$n(T),P=$n(k);if(M.kind!==P.kind||M.kind!=="string"&&M.kind!=="number")throw new er(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${M.kind}, ${P.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const M=$n(T),P=$n(k);if(M.kind!=="string"||P.kind!=="string")return a(w,T,k)}return this.collator?h(w,T,k,this.collator.evaluate(w)):a(w,T,k)}eachChild(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)}outputDefined(){return!0}}}const ca=ho("==",function(u,a,h){return a===h},Yl),xu=ho("!=",function(u,a,h){return a!==h},function(u,a,h,p){return!Yl(0,a,h,p)}),wu=ho("<",function(u,a,h){return a<h},function(u,a,h,p){return p.compare(a,h)<0}),zh=ho(">",function(u,a,h){return a>h},function(u,a,h,p){return p.compare(a,h)>0}),Au=ho("<=",function(u,a,h){return a<=h},function(u,a,h,p){return p.compare(a,h)<=0}),Jl=ho(">=",function(u,a,h){return a>=h},function(u,a,h,p){return p.compare(a,h)>=0});class Xl{constructor(a,h,p,_,w){this.type=Bi,this.number=a,this.locale=h,this.currency=p,this.minFractionDigits=_,this.maxFractionDigits=w}static parse(a,h){if(a.length!==3)return h.error("Expected two arguments.");const p=h.parse(a[1],1,Lt);if(!p)return null;const _=a[2];if(typeof _!="object"||Array.isArray(_))return h.error("NumberFormat options argument must be an object.");let w=null;if(_.locale&&(w=h.parse(_.locale,1,Bi),!w))return null;let T=null;if(_.currency&&(T=h.parse(_.currency,1,Bi),!T))return null;let k=null;if(_["min-fraction-digits"]&&(k=h.parse(_["min-fraction-digits"],1,Lt),!k))return null;let M=null;return _["max-fraction-digits"]&&(M=h.parse(_["max-fraction-digits"],1,Lt),!M)?null:new Xl(p,w,T,k,M)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class sl{constructor(a){this.type=Z,this.sections=a}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const p=a[1];if(!Array.isArray(p)&&typeof p=="object")return h.error("First argument must be an image or text section.");const _=[];let w=!1;for(let T=1;T<=a.length-1;++T){const k=a[T];if(w&&typeof k=="object"&&!Array.isArray(k)){w=!1;let M=null;if(k["font-scale"]&&(M=h.parse(k["font-scale"],1,Lt),!M))return null;let P=null;if(k["text-font"]&&(P=h.parse(k["text-font"],1,le(Bi)),!P))return null;let F=null;if(k["text-color"]&&(F=h.parse(k["text-color"],1,Bn),!F))return null;const G=_[_.length-1];G.scale=M,G.font=P,G.textColor=F}else{const M=h.parse(a[T],1,Q);if(!M)return null;const P=M.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");w=!0,_.push({content:M,scale:null,font:null,textColor:null})}}return new sl(_)}evaluate(a){return new Jn(this.sections.map(h=>{const p=h.content.evaluate(a);return $n(p)===q?new Ys("",p,null,null,null):new Ys(_n(p),null,h.scale?h.scale.evaluate(a):null,h.font?h.font.evaluate(a).join(","):null,h.textColor?h.textColor.evaluate(a):null)}))}eachChild(a){for(const h of this.sections)a(h.content),h.scale&&a(h.scale),h.font&&a(h.font),h.textColor&&a(h.textColor)}outputDefined(){return!1}}class Oc{constructor(a){this.type=q,this.input=a}static parse(a,h){if(a.length!==2)return h.error("Expected two arguments.");const p=h.parse(a[1],1,Bi);return p?new Oc(p):h.error("No image name provided.")}evaluate(a){const h=this.input.evaluate(a),p=Br.fromString(h);return p&&a.availableImages&&(p.available=a.availableImages.indexOf(h)>-1),p}eachChild(a){a(this.input)}outputDefined(){return!1}}class Ta{constructor(a){this.type=Lt,this.input=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);const p=h.parse(a[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${ce(p.type)} instead.`):new Ta(p):null}evaluate(a){const h=this.input.evaluate(a);if(typeof h=="string"||Array.isArray(h))return h.length;throw new er(`Expected value to be of type string or array, but found ${ce($n(h))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}const fo={"==":ca,"!=":xu,">":zh,"<":wu,">=":Jl,"<=":Au,array:Ms,at:Ic,boolean:Ms,case:kc,coalesce:Hl,collator:te,format:sl,image:Oc,in:ql,"index-of":nl,interpolate:hs,"interpolate-hcl":hs,"interpolate-lab":hs,length:Ta,let:Kl,literal:Aa,match:Zl,number:Ms,"number-format":Xl,object:Ms,slice:Wl,step:Ea,string:Ms,"to-boolean":ja,"to-color":ja,"to-number":ja,"to-string":ja,var:ur,within:ir};function Eu(u,[a,h,p,_]){a=a.evaluate(u),h=h.evaluate(u),p=p.evaluate(u);const w=_?_.evaluate(u):1,T=Fl(a,h,p,w);if(T)throw new er(T);return new xn(a/255,h/255,p/255,w,!1)}function Tu(u,a){return u in a}function al(u,a){const h=a[u];return h===void 0?null:h}function Js(u){return{type:u}}function Ql(u){return{result:"success",value:u}}function ua(u){return{result:"error",value:u}}function Ga(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function No(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function Cc(u){return!!u.expression&&u.expression.interpolated}function yn(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function nr(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function Bh(u){return u}function cn(u,a){const h=a.type==="color",p=u.stops&&typeof u.stops[0][0]=="object",_=p||!(p||u.property!==void 0),w=u.type||(Cc(a)?"exponential":"interval");if(h||a.type==="padding"){const F=h?xn.parse:$r.parse;(u=Qi({},u)).stops&&(u.stops=u.stops.map(G=>[G[0],F(G[1])])),u.default=F(u.default?u.default:a.default)}if(u.colorSpace&&(T=u.colorSpace)!=="rgb"&&T!=="hcl"&&T!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var T;let k,M,P;if(w==="exponential")k=bs;else if(w==="interval")k=An;else if(w==="categorical"){k=Kn,M=Object.create(null);for(const F of u.stops)M[F[0]]=F[1];P=typeof u.stops[0][0]}else{if(w!=="identity")throw new Error(`Unknown function type "${w}"`);k=Ka}if(p){const F={},G=[];for(let re=0;re<u.stops.length;re++){const de=u.stops[re],we=de[0].zoom;F[we]===void 0&&(F[we]={zoom:we,type:u.type,property:u.property,default:u.default,stops:[]},G.push(we)),F[we].stops.push([de[0].value,de[1]])}const X=[];for(const re of G)X.push([F[re].zoom,cn(F[re],a)]);const ie={name:"linear"};return{kind:"composite",interpolationType:ie,interpolationFactor:hs.interpolationFactor.bind(void 0,ie),zoomStops:X.map(re=>re[0]),evaluate:({zoom:re},de)=>bs({stops:X,base:u.base},a,re).evaluate(re,de)}}if(_){const F=w==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:hs.interpolationFactor.bind(void 0,F),zoomStops:u.stops.map(G=>G[0]),evaluate:({zoom:G})=>k(u,a,G,M,P)}}return{kind:"source",evaluate(F,G){const X=G&&G.properties?G.properties[u.property]:void 0;return X===void 0?Ha(u.default,a.default):k(u,a,X,M,P)}}}function Ha(u,a,h){return u!==void 0?u:a!==void 0?a:h!==void 0?h:void 0}function Kn(u,a,h,p,_){return Ha(typeof h===_?p[h]:void 0,u.default,a.default)}function An(u,a,h){if(yn(h)!=="number")return Ha(u.default,a.default);const p=u.stops.length;if(p===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[p-1][0])return u.stops[p-1][1];const _=us(u.stops.map(w=>w[0]),h);return u.stops[_][1]}function bs(u,a,h){const p=u.base!==void 0?u.base:1;if(yn(h)!=="number")return Ha(u.default,a.default);const _=u.stops.length;if(_===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[_-1][0])return u.stops[_-1][1];const w=us(u.stops.map(F=>F[0]),h),T=function(F,G,X,ie){const re=ie-X,de=F-X;return re===0?0:G===1?de/re:(Math.pow(G,de)-1)/(Math.pow(G,re)-1)}(h,p,u.stops[w][0],u.stops[w+1][0]),k=u.stops[w][1],M=u.stops[w+1][1],P=is[a.type]||Bh;return typeof k.evaluate=="function"?{evaluate(...F){const G=k.evaluate.apply(void 0,F),X=M.evaluate.apply(void 0,F);if(G!==void 0&&X!==void 0)return P(G,X,T,u.colorSpace)}}:P(k,M,T,u.colorSpace)}function Ka(u,a,h){switch(a.type){case"color":h=xn.parse(h);break;case"formatted":h=Jn.fromString(h.toString());break;case"resolvedImage":h=Br.fromString(h.toString());break;case"padding":h=$r.parse(h);break;default:yn(h)===a.type||a.type==="enum"&&a.values[h]||(h=void 0)}return Ha(h,u.default,a.default)}cs.register(fo,{error:[{kind:"error"},[Bi],(u,[a])=>{throw new er(a.evaluate(u))}],typeof:[Bi,[Q],(u,[a])=>ce($n(a.evaluate(u)))],"to-rgba":[le(Lt,4),[Bn],(u,[a])=>{const[h,p,_,w]=a.evaluate(u).rgb;return[255*h,255*p,255*_,w]}],rgb:[Bn,[Lt,Lt,Lt],Eu],rgba:[Bn,[Lt,Lt,Lt,Lt],Eu],has:{type:ii,overloads:[[[Bi],(u,[a])=>Tu(a.evaluate(u),u.properties())],[[Bi,st],(u,[a,h])=>Tu(a.evaluate(u),h.evaluate(u))]]},get:{type:Q,overloads:[[[Bi],(u,[a])=>al(a.evaluate(u),u.properties())],[[Bi,st],(u,[a,h])=>al(a.evaluate(u),h.evaluate(u))]]},"feature-state":[Q,[Bi],(u,[a])=>al(a.evaluate(u),u.featureState||{})],properties:[st,[],u=>u.properties()],"geometry-type":[Bi,[],u=>u.geometryType()],id:[Q,[],u=>u.id()],zoom:[Lt,[],u=>u.globals.zoom],"heatmap-density":[Lt,[],u=>u.globals.heatmapDensity||0],"line-progress":[Lt,[],u=>u.globals.lineProgress||0],accumulated:[Q,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Lt,Js(Lt),(u,a)=>{let h=0;for(const p of a)h+=p.evaluate(u);return h}],"*":[Lt,Js(Lt),(u,a)=>{let h=1;for(const p of a)h*=p.evaluate(u);return h}],"-":{type:Lt,overloads:[[[Lt,Lt],(u,[a,h])=>a.evaluate(u)-h.evaluate(u)],[[Lt],(u,[a])=>-a.evaluate(u)]]},"/":[Lt,[Lt,Lt],(u,[a,h])=>a.evaluate(u)/h.evaluate(u)],"%":[Lt,[Lt,Lt],(u,[a,h])=>a.evaluate(u)%h.evaluate(u)],ln2:[Lt,[],()=>Math.LN2],pi:[Lt,[],()=>Math.PI],e:[Lt,[],()=>Math.E],"^":[Lt,[Lt,Lt],(u,[a,h])=>Math.pow(a.evaluate(u),h.evaluate(u))],sqrt:[Lt,[Lt],(u,[a])=>Math.sqrt(a.evaluate(u))],log10:[Lt,[Lt],(u,[a])=>Math.log(a.evaluate(u))/Math.LN10],ln:[Lt,[Lt],(u,[a])=>Math.log(a.evaluate(u))],log2:[Lt,[Lt],(u,[a])=>Math.log(a.evaluate(u))/Math.LN2],sin:[Lt,[Lt],(u,[a])=>Math.sin(a.evaluate(u))],cos:[Lt,[Lt],(u,[a])=>Math.cos(a.evaluate(u))],tan:[Lt,[Lt],(u,[a])=>Math.tan(a.evaluate(u))],asin:[Lt,[Lt],(u,[a])=>Math.asin(a.evaluate(u))],acos:[Lt,[Lt],(u,[a])=>Math.acos(a.evaluate(u))],atan:[Lt,[Lt],(u,[a])=>Math.atan(a.evaluate(u))],min:[Lt,Js(Lt),(u,a)=>Math.min(...a.map(h=>h.evaluate(u)))],max:[Lt,Js(Lt),(u,a)=>Math.max(...a.map(h=>h.evaluate(u)))],abs:[Lt,[Lt],(u,[a])=>Math.abs(a.evaluate(u))],round:[Lt,[Lt],(u,[a])=>{const h=a.evaluate(u);return h<0?-Math.round(-h):Math.round(h)}],floor:[Lt,[Lt],(u,[a])=>Math.floor(a.evaluate(u))],ceil:[Lt,[Lt],(u,[a])=>Math.ceil(a.evaluate(u))],"filter-==":[ii,[Bi,Q],(u,[a,h])=>u.properties()[a.value]===h.value],"filter-id-==":[ii,[Q],(u,[a])=>u.id()===a.value],"filter-type-==":[ii,[Bi],(u,[a])=>u.geometryType()===a.value],"filter-<":[ii,[Bi,Q],(u,[a,h])=>{const p=u.properties()[a.value],_=h.value;return typeof p==typeof _&&p<_}],"filter-id-<":[ii,[Q],(u,[a])=>{const h=u.id(),p=a.value;return typeof h==typeof p&&h<p}],"filter->":[ii,[Bi,Q],(u,[a,h])=>{const p=u.properties()[a.value],_=h.value;return typeof p==typeof _&&p>_}],"filter-id->":[ii,[Q],(u,[a])=>{const h=u.id(),p=a.value;return typeof h==typeof p&&h>p}],"filter-<=":[ii,[Bi,Q],(u,[a,h])=>{const p=u.properties()[a.value],_=h.value;return typeof p==typeof _&&p<=_}],"filter-id-<=":[ii,[Q],(u,[a])=>{const h=u.id(),p=a.value;return typeof h==typeof p&&h<=p}],"filter->=":[ii,[Bi,Q],(u,[a,h])=>{const p=u.properties()[a.value],_=h.value;return typeof p==typeof _&&p>=_}],"filter-id->=":[ii,[Q],(u,[a])=>{const h=u.id(),p=a.value;return typeof h==typeof p&&h>=p}],"filter-has":[ii,[Q],(u,[a])=>a.value in u.properties()],"filter-has-id":[ii,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[ii,[le(Bi)],(u,[a])=>a.value.indexOf(u.geometryType())>=0],"filter-id-in":[ii,[le(Q)],(u,[a])=>a.value.indexOf(u.id())>=0],"filter-in-small":[ii,[Bi,le(Q)],(u,[a,h])=>h.value.indexOf(u.properties()[a.value])>=0],"filter-in-large":[ii,[Bi,le(Q)],(u,[a,h])=>function(p,_,w,T){for(;w<=T;){const k=w+T>>1;if(_[k]===p)return!0;_[k]>p?T=k-1:w=k+1}return!1}(u.properties()[a.value],h.value,0,h.value.length-1)],all:{type:ii,overloads:[[[ii,ii],(u,[a,h])=>a.evaluate(u)&&h.evaluate(u)],[Js(ii),(u,a)=>{for(const h of a)if(!h.evaluate(u))return!1;return!0}]]},any:{type:ii,overloads:[[[ii,ii],(u,[a,h])=>a.evaluate(u)||h.evaluate(u)],[Js(ii),(u,a)=>{for(const h of a)if(h.evaluate(u))return!0;return!1}]]},"!":[ii,[ii],(u,[a])=>!a.evaluate(u)],"is-supported-script":[ii,[Bi],(u,[a])=>{const h=u.globals&&u.globals.isSupportedScript;return!h||h(a.evaluate(u))}],upcase:[Bi,[Bi],(u,[a])=>a.evaluate(u).toUpperCase()],downcase:[Bi,[Bi],(u,[a])=>a.evaluate(u).toLowerCase()],concat:[Bi,Js(Q),(u,a)=>a.map(h=>_n(h.evaluate(u))).join("")],"resolved-locale":[Bi,[ge],(u,[a])=>a.evaluate(u).resolvedLocale()]});class zo{constructor(a,h){var p;this.expression=a,this._warningHistory={},this._evaluator=new I,this._defaultValue=h?(p=h).type==="color"&&nr(p.default)?new xn(0,0,0,0):p.type==="color"?xn.parse(p.default)||null:p.type==="padding"?$r.parse(p.default)||null:p.type==="variableAnchorOffsetCollection"?zr.parse(p.default)||null:p.default===void 0?null:p.default:null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(a,h,p,_,w,T){return this._evaluator.globals=a,this._evaluator.feature=h,this._evaluator.featureState=p,this._evaluator.canonical=_,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=T,this.expression.evaluate(this._evaluator)}evaluate(a,h,p,_,w,T){this._evaluator.globals=a,this._evaluator.feature=h||null,this._evaluator.featureState=p||null,this._evaluator.canonical=_,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=T||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new er(`Expected value to be one of ${Object.keys(this._enumValues).map(M=>JSON.stringify(M)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function Xs(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in fo}function $l(u,a){const h=new N(fo,Ul,[],a?function(_){const w={color:Bn,string:Bi,number:Lt,enum:Bi,boolean:ii,formatted:Z,padding:V,resolvedImage:q,variableAnchorOffsetCollection:J};return _.type==="array"?le(w[_.value]||Q,_.length):w[_.type]}(a):void 0),p=h.parse(u,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Ql(new zo(p,a)):ua(h.errors)}class Bo{constructor(a,h){this.kind=a,this._styleExpression=h,this.isStateDependent=a!=="constant"&&!Po(h.expression)}evaluateWithoutErrorHandling(a,h,p,_,w,T){return this._styleExpression.evaluateWithoutErrorHandling(a,h,p,_,w,T)}evaluate(a,h,p,_,w,T){return this._styleExpression.evaluate(a,h,p,_,w,T)}}class qa{constructor(a,h,p,_){this.kind=a,this.zoomStops=p,this._styleExpression=h,this.isStateDependent=a!=="camera"&&!Po(h.expression),this.interpolationType=_}evaluateWithoutErrorHandling(a,h,p,_,w,T){return this._styleExpression.evaluateWithoutErrorHandling(a,h,p,_,w,T)}evaluate(a,h,p,_,w,T){return this._styleExpression.evaluate(a,h,p,_,w,T)}interpolationFactor(a,h,p){return this.interpolationType?hs.interpolationFactor(this.interpolationType,a,h,p):0}}function ec(u,a){const h=$l(u,a);if(h.result==="error")return h;const p=h.value.expression,_=Dn(p);if(!_&&!Ga(a))return ua([new Qe("","data expressions not supported")]);const w=jl(p,["zoom"]);if(!w&&!No(a))return ua([new Qe("","zoom expressions not supported")]);const T=ol(p);return T||w?T instanceof Qe?ua([T]):T instanceof hs&&!Cc(a)?ua([new Qe("",'"interpolate" expressions cannot be used with this property')]):Ql(T?new qa(_?"camera":"composite",h.value,T.labels,T instanceof hs?T.interpolation:void 0):new Bo(_?"constant":"source",h.value)):ua([new Qe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Vo{constructor(a,h){this._parameters=a,this._specification=h,Qi(this,cn(this._parameters,this._specification))}static deserialize(a){return new Vo(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function ol(u){let a=null;if(u instanceof Kl)a=ol(u.result);else if(u instanceof Hl){for(const h of u.args)if(a=ol(h),a)break}else(u instanceof Ea||u instanceof hs)&&u.input instanceof cs&&u.input.name==="zoom"&&(a=u);return a instanceof Qe||u.eachChild(h=>{const p=ol(h);p instanceof Qe?a=p:!a&&p?a=new Qe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&p&&a!==p&&(a=new Qe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function ll(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const a of u.slice(1))if(!ll(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}const Su={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function tc(u){if(u==null)return{filter:()=>!0,needGeometry:!1};ll(u)||(u=nc(u));const a=$l(u,Su);if(a.result==="error")throw new Error(a.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,p,_)=>a.value.evaluate(h,p,{},_),needGeometry:mo(u)}}function ic(u,a){return u<a?-1:u>a?1:0}function mo(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let a=1;a<u.length;a++)if(mo(u[a]))return!0;return!1}function nc(u){if(!u)return!0;const a=u[0];return u.length<=1?a!=="any":a==="=="?ha(u[1],u[2],"=="):a==="!="?Fo(ha(u[1],u[2],"==")):a==="<"||a===">"||a==="<="||a===">="?ha(u[1],u[2],a):a==="any"?(h=u.slice(1),["any"].concat(h.map(nc))):a==="all"?["all"].concat(u.slice(1).map(nc)):a==="none"?["all"].concat(u.slice(1).map(nc).map(Fo)):a==="in"?Iu(u[1],u.slice(2)):a==="!in"?Fo(Iu(u[1],u.slice(2))):a==="has"?Za(u[1]):a==="!has"?Fo(Za(u[1])):a!=="within"||u;var h}function ha(u,a,h){switch(u){case"$type":return[`filter-type-${h}`,a];case"$id":return[`filter-id-${h}`,a];default:return[`filter-${h}`,u,a]}}function Iu(u,a){if(a.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(h=>typeof h!=typeof a[0])?["filter-in-large",u,["literal",a.sort(ic)]]:["filter-in-small",u,["literal",a]]}}function Za(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Fo(u){return["!",u]}function rc(u){const a=typeof u;if(a==="number"||a==="boolean"||a==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let _="[";for(const w of u)_+=`${rc(w)},`;return`${_}]`}const h=Object.keys(u).sort();let p="{";for(let _=0;_<h.length;_++)p+=`${JSON.stringify(h[_])}:${rc(u[h[_]])},`;return`${p}}`}function po(u){let a="";for(const h of On)a+=`/${rc(u[h])}`;return a}function sc(u){const a=u.value;return a?[new Nt(u.key,a,"constants have been deprecated as of v8")]:[]}function rr(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Wa(u){if(Array.isArray(u))return u.map(Wa);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const a={};for(const h in u)a[h]=Wa(u[h]);return a}return rr(u)}function ns(u){const a=u.key,h=u.value,p=u.valueSpec||{},_=u.objectElementValidators||{},w=u.style,T=u.styleSpec,k=u.validateSpec;let M=[];const P=yn(h);if(P!=="object")return[new Nt(a,h,`object expected, ${P} found`)];for(const F in h){const G=F.split(".")[0],X=p[G]||p["*"];let ie;if(_[G])ie=_[G];else if(p[G])ie=k;else if(_["*"])ie=_["*"];else{if(!p["*"]){M.push(new Nt(a,h[F],`unknown property "${F}"`));continue}ie=k}M=M.concat(ie({key:(a&&`${a}.`)+F,value:h[F],valueSpec:X,style:w,styleSpec:T,object:h,objectKey:F,validateSpec:k},h))}for(const F in p)_[F]||p[F].required&&p[F].default===void 0&&h[F]===void 0&&M.push(new Nt(a,h,`missing required property "${F}"`));return M}function da(u){const a=u.value,h=u.valueSpec,p=u.style,_=u.styleSpec,w=u.key,T=u.arrayElementValidator||u.validateSpec;if(yn(a)!=="array")return[new Nt(w,a,`array expected, ${yn(a)} found`)];if(h.length&&a.length!==h.length)return[new Nt(w,a,`array length ${h.length} expected, length ${a.length} found`)];if(h["min-length"]&&a.length<h["min-length"])return[new Nt(w,a,`array length at least ${h["min-length"]} expected, length ${a.length} found`)];let k={type:h.value,values:h.values};_.$version<7&&(k.function=h.function),yn(h.value)==="object"&&(k=h.value);let M=[];for(let P=0;P<a.length;P++)M=M.concat(T({array:a,arrayIndex:P,value:a[P],valueSpec:k,validateSpec:u.validateSpec,style:p,styleSpec:_,key:`${w}[${P}]`}));return M}function Uo(u){const a=u.key,h=u.value,p=u.valueSpec;let _=yn(h);return _==="number"&&h!=h&&(_="NaN"),_!=="number"?[new Nt(a,h,`number expected, ${_} found`)]:"minimum"in p&&h<p.minimum?[new Nt(a,h,`${h} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&h>p.maximum?[new Nt(a,h,`${h} is greater than the maximum value ${p.maximum}`)]:[]}function ac(u){const a=u.valueSpec,h=rr(u.value.type);let p,_,w,T={};const k=h!=="categorical"&&u.value.property===void 0,M=!k,P=yn(u.value.stops)==="array"&&yn(u.value.stops[0])==="array"&&yn(u.value.stops[0][0])==="object",F=ns({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(ie){if(h==="identity")return[new Nt(ie.key,ie.value,'identity function may not have a "stops" property')];let re=[];const de=ie.value;return re=re.concat(da({key:ie.key,value:de,valueSpec:ie.valueSpec,validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec,arrayElementValidator:G})),yn(de)==="array"&&de.length===0&&re.push(new Nt(ie.key,de,"array must have at least one stop")),re},default:function(ie){return ie.validateSpec({key:ie.key,value:ie.value,valueSpec:a,validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec})}}});return h==="identity"&&k&&F.push(new Nt(u.key,u.value,'missing required property "property"')),h==="identity"||u.value.stops||F.push(new Nt(u.key,u.value,'missing required property "stops"')),h==="exponential"&&u.valueSpec.expression&&!Cc(u.valueSpec)&&F.push(new Nt(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(M&&!Ga(u.valueSpec)?F.push(new Nt(u.key,u.value,"property functions not supported")):k&&!No(u.valueSpec)&&F.push(new Nt(u.key,u.value,"zoom functions not supported"))),h!=="categorical"&&!P||u.value.property!==void 0||F.push(new Nt(u.key,u.value,'"property" property is required')),F;function G(ie){let re=[];const de=ie.value,we=ie.key;if(yn(de)!=="array")return[new Nt(we,de,`array expected, ${yn(de)} found`)];if(de.length!==2)return[new Nt(we,de,`array length 2 expected, length ${de.length} found`)];if(P){if(yn(de[0])!=="object")return[new Nt(we,de,`object expected, ${yn(de[0])} found`)];if(de[0].zoom===void 0)return[new Nt(we,de,"object stop key must have zoom")];if(de[0].value===void 0)return[new Nt(we,de,"object stop key must have value")];if(w&&w>rr(de[0].zoom))return[new Nt(we,de[0].zoom,"stop zoom values must appear in ascending order")];rr(de[0].zoom)!==w&&(w=rr(de[0].zoom),_=void 0,T={}),re=re.concat(ns({key:`${we}[0]`,value:de[0],valueSpec:{zoom:{}},validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec,objectElementValidators:{zoom:Uo,value:X}}))}else re=re.concat(X({key:`${we}[0]`,value:de[0],valueSpec:{},validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec},de));return Xs(Wa(de[1]))?re.concat([new Nt(`${we}[1]`,de[1],"expressions are not allowed in function stops.")]):re.concat(ie.validateSpec({key:`${we}[1]`,value:de[1],valueSpec:a,validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec}))}function X(ie,re){const de=yn(ie.value),we=rr(ie.value),Ie=ie.value!==null?ie.value:re;if(p){if(de!==p)return[new Nt(ie.key,Ie,`${de} stop domain type must match previous stop domain type ${p}`)]}else p=de;if(de!=="number"&&de!=="string"&&de!=="boolean")return[new Nt(ie.key,Ie,"stop domain value must be a number, string, or boolean")];if(de!=="number"&&h!=="categorical"){let Ue=`number expected, ${de} found`;return Ga(a)&&h===void 0&&(Ue+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Nt(ie.key,Ie,Ue)]}return h!=="categorical"||de!=="number"||isFinite(we)&&Math.floor(we)===we?h!=="categorical"&&de==="number"&&_!==void 0&&we<_?[new Nt(ie.key,Ie,"stop domain values must appear in ascending order")]:(_=we,h==="categorical"&&we in T?[new Nt(ie.key,Ie,"stop domain values must be unique")]:(T[we]=!0,[])):[new Nt(ie.key,Ie,`integer expected, found ${we}`)]}}function Ge(u){const a=(u.expressionContext==="property"?ec:$l)(Wa(u.value),u.valueSpec);if(a.result==="error")return a.value.map(p=>new Nt(`${u.key}${p.key}`,u.value,p.message));const h=a.value.expression||a.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!h.outputDefined())return[new Nt(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!Po(h))return[new Nt(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!Po(h))return[new Nt(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!jl(h,["zoom","feature-state"]))return[new Nt(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!Dn(h))return[new Nt(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ft(u){const a=u.key,h=u.value,p=u.valueSpec,_=[];return Array.isArray(p.values)?p.values.indexOf(rr(h))===-1&&_.push(new Nt(a,h,`expected one of [${p.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(p.values).indexOf(rr(h))===-1&&_.push(new Nt(a,h,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(h)} found`)),_}function Qt(u){return ll(Wa(u.value))?Ge(Qi({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Pi(u)}function Pi(u){const a=u.value,h=u.key;if(yn(a)!=="array")return[new Nt(h,a,`array expected, ${yn(a)} found`)];const p=u.styleSpec;let _,w=[];if(a.length<1)return[new Nt(h,a,"filter array must have at least 1 element")];switch(w=w.concat(ft({key:`${h}[0]`,value:a[0],valueSpec:p.filter_operator,style:u.style,styleSpec:u.styleSpec})),rr(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&rr(a[1])==="$type"&&w.push(new Nt(h,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&w.push(new Nt(h,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(_=yn(a[1]),_!=="string"&&w.push(new Nt(`${h}[1]`,a[1],`string expected, ${_} found`)));for(let T=2;T<a.length;T++)_=yn(a[T]),rr(a[1])==="$type"?w=w.concat(ft({key:`${h}[${T}]`,value:a[T],valueSpec:p.geometry_type,style:u.style,styleSpec:u.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&w.push(new Nt(`${h}[${T}]`,a[T],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let T=1;T<a.length;T++)w=w.concat(Pi({key:`${h}[${T}]`,value:a[T],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":_=yn(a[1]),a.length!==2?w.push(new Nt(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):_!=="string"&&w.push(new Nt(`${h}[1]`,a[1],`string expected, ${_} found`));break;case"within":_=yn(a[1]),a.length!==2?w.push(new Nt(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):_!=="object"&&w.push(new Nt(`${h}[1]`,a[1],`object expected, ${_} found`))}return w}function qn(u,a){const h=u.key,p=u.validateSpec,_=u.style,w=u.styleSpec,T=u.value,k=u.objectKey,M=w[`${a}_${u.layerType}`];if(!M)return[];const P=k.match(/^(.*)-transition$/);if(a==="paint"&&P&&M[P[1]]&&M[P[1]].transition)return p({key:h,value:T,valueSpec:w.transition,style:_,styleSpec:w});const F=u.valueSpec||M[k];if(!F)return[new Nt(h,T,`unknown property "${k}"`)];let G;if(yn(T)==="string"&&Ga(F)&&!F.tokens&&(G=/^{([^}]+)}$/.exec(T)))return[new Nt(h,T,`"${k}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(G[1])} }\`.`)];const X=[];return u.layerType==="symbol"&&(k==="text-field"&&_&&!_.glyphs&&X.push(new Nt(h,T,'use of "text-field" requires a style "glyphs" property')),k==="text-font"&&nr(Wa(T))&&rr(T.type)==="identity"&&X.push(new Nt(h,T,'"text-font" does not support identity functions'))),X.concat(p({key:u.key,value:T,valueSpec:F,style:_,styleSpec:w,expressionContext:"property",propertyType:a,propertyKey:k}))}function dn(u){return qn(u,"paint")}function hr(u){return qn(u,"layout")}function xr(u){let a=[];const h=u.value,p=u.key,_=u.style,w=u.styleSpec;h.type||h.ref||a.push(new Nt(p,h,'either "type" or "ref" is required'));let T=rr(h.type);const k=rr(h.ref);if(h.id){const M=rr(h.id);for(let P=0;P<u.arrayIndex;P++){const F=_.layers[P];rr(F.id)===M&&a.push(new Nt(p,h.id,`duplicate layer id "${h.id}", previously used at line ${F.id.__line__}`))}}if("ref"in h){let M;["type","source","source-layer","filter","layout"].forEach(P=>{P in h&&a.push(new Nt(p,h[P],`"${P}" is prohibited for ref layers`))}),_.layers.forEach(P=>{rr(P.id)===k&&(M=P)}),M?M.ref?a.push(new Nt(p,h.ref,"ref cannot reference another ref layer")):T=rr(M.type):a.push(new Nt(p,h.ref,`ref layer "${k}" not found`))}else if(T!=="background")if(h.source){const M=_.sources&&_.sources[h.source],P=M&&rr(M.type);M?P==="vector"&&T==="raster"?a.push(new Nt(p,h.source,`layer "${h.id}" requires a raster source`)):P!=="raster-dem"&&T==="hillshade"?a.push(new Nt(p,h.source,`layer "${h.id}" requires a raster-dem source`)):P==="raster"&&T!=="raster"?a.push(new Nt(p,h.source,`layer "${h.id}" requires a vector source`)):P!=="vector"||h["source-layer"]?P==="raster-dem"&&T!=="hillshade"?a.push(new Nt(p,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!h.paint||!h.paint["line-gradient"]||P==="geojson"&&M.lineMetrics||a.push(new Nt(p,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new Nt(p,h,`layer "${h.id}" must specify a "source-layer"`)):a.push(new Nt(p,h.source,`source "${h.source}" not found`))}else a.push(new Nt(p,h,'missing required property "source"'));return a=a.concat(ns({key:p,value:h,valueSpec:w.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${p}.type`,value:h.type,valueSpec:w.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:h,objectKey:"type"}),filter:Qt,layout:M=>ns({layer:h,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,validateSpec:M.validateSpec,objectElementValidators:{"*":P=>hr(Qi({layerType:T},P))}}),paint:M=>ns({layer:h,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,validateSpec:M.validateSpec,objectElementValidators:{"*":P=>dn(Qi({layerType:T},P))}})}})),a}function Tr(u){const a=u.value,h=u.key,p=yn(a);return p!=="string"?[new Nt(h,a,`string expected, ${p} found`)]:[]}const dr={promoteId:function({key:u,value:a}){if(yn(a)==="string")return Tr({key:u,value:a});{const h=[];for(const p in a)h.push(...Tr({key:`${u}.${p}`,value:a[p]}));return h}}};function En(u){const a=u.value,h=u.key,p=u.styleSpec,_=u.style,w=u.validateSpec;if(!a.type)return[new Nt(h,a,'"type" is required')];const T=rr(a.type);let k;switch(T){case"vector":case"raster":return k=ns({key:h,value:a,valueSpec:p[`source_${T.replace("-","_")}`],style:u.style,styleSpec:p,objectElementValidators:dr,validateSpec:w}),k;case"raster-dem":return k=function(M){var P;const F=(P=M.sourceName)!==null&&P!==void 0?P:"",G=M.value,X=M.styleSpec,ie=X.source_raster_dem,re=M.style;let de=[];const we=yn(G);if(G===void 0)return de;if(we!=="object")return de.push(new Nt("source_raster_dem",G,`object expected, ${we} found`)),de;const Ie=rr(G.encoding)==="custom",Ue=["redFactor","greenFactor","blueFactor","baseShift"],Me=M.value.encoding?`"${M.value.encoding}"`:"Default";for(const He in G)!Ie&&Ue.includes(He)?de.push(new Nt(He,G[He],`In "${F}": "${He}" is only valid when "encoding" is set to "custom". ${Me} encoding found`)):ie[He]?de=de.concat(M.validateSpec({key:He,value:G[He],valueSpec:ie[He],validateSpec:M.validateSpec,style:re,styleSpec:X})):de.push(new Nt(He,G[He],`unknown property "${He}"`));return de}({sourceName:h,value:a,style:u.style,styleSpec:p,validateSpec:w}),k;case"geojson":if(k=ns({key:h,value:a,valueSpec:p.source_geojson,style:_,styleSpec:p,validateSpec:w,objectElementValidators:dr}),a.cluster)for(const M in a.clusterProperties){const[P,F]=a.clusterProperties[M],G=typeof P=="string"?[P,["accumulated"],["get",M]]:P;k.push(...Ge({key:`${h}.${M}.map`,value:F,validateSpec:w,expressionContext:"cluster-map"})),k.push(...Ge({key:`${h}.${M}.reduce`,value:G,validateSpec:w,expressionContext:"cluster-reduce"}))}return k;case"video":return ns({key:h,value:a,valueSpec:p.source_video,style:_,validateSpec:w,styleSpec:p});case"image":return ns({key:h,value:a,valueSpec:p.source_image,style:_,validateSpec:w,styleSpec:p});case"canvas":return[new Nt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ft({key:`${h}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:_,validateSpec:w,styleSpec:p})}}function ds(u){const a=u.value,h=u.styleSpec,p=h.light,_=u.style;let w=[];const T=yn(a);if(a===void 0)return w;if(T!=="object")return w=w.concat([new Nt("light",a,`object expected, ${T} found`)]),w;for(const k in a){const M=k.match(/^(.*)-transition$/);w=w.concat(M&&p[M[1]]&&p[M[1]].transition?u.validateSpec({key:k,value:a[k],valueSpec:h.transition,validateSpec:u.validateSpec,style:_,styleSpec:h}):p[k]?u.validateSpec({key:k,value:a[k],valueSpec:p[k],validateSpec:u.validateSpec,style:_,styleSpec:h}):[new Nt(k,a[k],`unknown property "${k}"`)])}return w}function fa(u){const a=u.value,h=u.styleSpec,p=h.terrain,_=u.style;let w=[];const T=yn(a);if(a===void 0)return w;if(T!=="object")return w=w.concat([new Nt("terrain",a,`object expected, ${T} found`)]),w;for(const k in a)w=w.concat(p[k]?u.validateSpec({key:k,value:a[k],valueSpec:p[k],validateSpec:u.validateSpec,style:_,styleSpec:h}):[new Nt(k,a[k],`unknown property "${k}"`)]);return w}function es(u){let a=[];const h=u.value,p=u.key;if(Array.isArray(h)){const _=[],w=[];for(const T in h)h[T].id&&_.includes(h[T].id)&&a.push(new Nt(p,h,`all the sprites' ids must be unique, but ${h[T].id} is duplicated`)),_.push(h[T].id),h[T].url&&w.includes(h[T].url)&&a.push(new Nt(p,h,`all the sprites' URLs must be unique, but ${h[T].url} is duplicated`)),w.push(h[T].url),a=a.concat(ns({key:`${p}[${T}]`,value:h[T],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return a}return Tr({key:p,value:h})}const ma={"*":()=>[],array:da,boolean:function(u){const a=u.value,h=u.key,p=yn(a);return p!=="boolean"?[new Nt(h,a,`boolean expected, ${p} found`)]:[]},number:Uo,color:function(u){const a=u.key,h=u.value,p=yn(h);return p!=="string"?[new Nt(a,h,`color expected, ${p} found`)]:xn.parse(String(h))?[]:[new Nt(a,h,`color expected, "${h}" found`)]},constants:sc,enum:ft,filter:Qt,function:ac,layer:xr,object:ns,source:En,light:ds,terrain:fa,string:Tr,formatted:function(u){return Tr(u).length===0?[]:Ge(u)},resolvedImage:function(u){return Tr(u).length===0?[]:Ge(u)},padding:function(u){const a=u.key,h=u.value;if(yn(h)==="array"){if(h.length<1||h.length>4)return[new Nt(a,h,`padding requires 1 to 4 values; ${h.length} values found`)];const p={type:"number"};let _=[];for(let w=0;w<h.length;w++)_=_.concat(u.validateSpec({key:`${a}[${w}]`,value:h[w],validateSpec:u.validateSpec,valueSpec:p}));return _}return Uo({key:a,value:h,valueSpec:{}})},variableAnchorOffsetCollection:function(u){const a=u.key,h=u.value,p=yn(h),_=u.styleSpec;if(p!=="array"||h.length<1||h.length%2!=0)return[new Nt(a,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let w=[];for(let T=0;T<h.length;T+=2)w=w.concat(ft({key:`${a}[${T}]`,value:h[T],valueSpec:_.layout_symbol["text-anchor"]})),w=w.concat(da({key:`${a}[${T+1}]`,value:h[T+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:_}));return w},sprite:es};function fs(u){const a=u.value,h=u.valueSpec,p=u.styleSpec;return u.validateSpec=fs,h.expression&&nr(rr(a))?ac(u):h.expression&&Xs(Wa(a))?Ge(u):h.type&&ma[h.type]?ma[h.type](u):ns(Qi({},u,{valueSpec:h.type?p[h.type]:h}))}function cl(u){const a=u.value,h=u.key,p=Tr(u);return p.length||(a.indexOf("{fontstack}")===-1&&p.push(new Nt(h,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&p.push(new Nt(h,a,'"glyphs" url must include a "{range}" token'))),p}function Gr(u,a=Xe){let h=[];return h=h.concat(fs({key:"",value:u,valueSpec:a.$root,styleSpec:a,style:u,validateSpec:fs,objectElementValidators:{glyphs:cl,"*":()=>[]}})),u.constants&&(h=h.concat(sc({key:"constants",value:u.constants,style:u,styleSpec:a,validateSpec:fs}))),ul(h)}function xs(u){return function(a){return u({...a,validateSpec:fs})}}function ul(u){return[].concat(u).sort((a,h)=>a.line-h.line)}function Sa(u){return function(...a){return ul(u.apply(this,a))}}Gr.source=Sa(xs(En)),Gr.sprite=Sa(xs(es)),Gr.glyphs=Sa(xs(cl)),Gr.light=Sa(xs(ds)),Gr.terrain=Sa(xs(fa)),Gr.layer=Sa(xs(xr)),Gr.filter=Sa(xs(Qt)),Gr.paintProperty=Sa(xs(dn)),Gr.layoutProperty=Sa(xs(hr));const Ia=Gr,Vn=Ia.light,Tn=Ia.paintProperty,hl=Ia.layoutProperty;function Qs(u,a){let h=!1;if(a&&a.length)for(const p of a)u.fire(new zi(new Error(p.message))),h=!0;return h}class Ya{constructor(a,h,p){const _=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;const T=new Int32Array(this.arrayBuffer);a=T[0],this.d=(h=T[1])+2*(p=T[2]);for(let M=0;M<this.d*this.d;M++){const P=T[3+M],F=T[3+M+1];_.push(P===F?null:T.subarray(P,F))}const k=T[3+_.length+1];this.keys=T.subarray(T[3+_.length],k),this.bboxes=T.subarray(k),this.insert=this._insertReadonly}else{this.d=h+2*p;for(let T=0;T<this.d*this.d;T++)_.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=a,this.padding=p,this.scale=h/a,this.uid=0;const w=p/h*a;this.min=-w,this.max=a+w}insert(a,h,p,_,w){this._forEachCell(h,p,_,w,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(w)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(a,h,p,_,w,T){this.cells[w].push(T)}query(a,h,p,_,w){const T=this.min,k=this.max;if(a<=T&&h<=T&&k<=p&&k<=_&&!w)return Array.prototype.slice.call(this.keys);{const M=[];return this._forEachCell(a,h,p,_,this._queryCell,M,{},w),M}}_queryCell(a,h,p,_,w,T,k,M){const P=this.cells[w];if(P!==null){const F=this.keys,G=this.bboxes;for(let X=0;X<P.length;X++){const ie=P[X];if(k[ie]===void 0){const re=4*ie;(M?M(G[re+0],G[re+1],G[re+2],G[re+3]):a<=G[re+2]&&h<=G[re+3]&&p>=G[re+0]&&_>=G[re+1])?(k[ie]=!0,T.push(F[ie])):k[ie]=!1}}}}_forEachCell(a,h,p,_,w,T,k,M){const P=this._convertToCellCoord(a),F=this._convertToCellCoord(h),G=this._convertToCellCoord(p),X=this._convertToCellCoord(_);for(let ie=P;ie<=G;ie++)for(let re=F;re<=X;re++){const de=this.d*re+ie;if((!M||M(this._convertFromCellCoord(ie),this._convertFromCellCoord(re),this._convertFromCellCoord(ie+1),this._convertFromCellCoord(re+1)))&&w.call(this,a,h,p,_,de,T,k,M))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const a=this.cells,h=3+this.cells.length+1+1;let p=0;for(let T=0;T<this.cells.length;T++)p+=this.cells[T].length;const _=new Int32Array(h+p+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let w=h;for(let T=0;T<a.length;T++){const k=a[T];_[3+T]=w,_.set(k,w),w+=k.length}return _[3+a.length]=w,_.set(this.keys,w),w+=this.keys.length,_[3+a.length+1]=w,_.set(this.bboxes,w),w+=this.bboxes.length,_.buffer}static serialize(a,h){const p=a.toArrayBuffer();return h&&h.push(p),{buffer:p}}static deserialize(a){return new Ya(a.buffer)}}const Sr={};function ri(u,a,h={}){if(Sr[u])throw new Error(`${u} is already registered.`);Object.defineProperty(a,"_classRegistryKey",{value:u,writeable:!1}),Sr[u]={klass:a,omit:h.omit||[],shallow:h.shallow||[]}}ri("Object",Object),ri("TransferableGridIndex",Ya),ri("Color",xn),ri("Error",Error),ri("AJAXError",Mi),ri("ResolvedImage",Br),ri("StylePropertyFunction",Vo),ri("StyleExpression",zo,{omit:["_evaluator"]}),ri("ZoomDependentExpression",qa),ri("ZoomConstantExpression",Bo),ri("CompoundExpression",cs,{omit:["_evaluate"]});for(const u in fo)fo[u]._classRegistryKey||ri(`Expression_${u}`,fo[u]);function $s(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function Ds(u,a){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob)return u;if($s(u)||zt(u))return a&&a.push(u),u;if(ArrayBuffer.isView(u)){const h=u;return a&&a.push(h.buffer),h}if(u instanceof ImageData)return a&&a.push(u.data.buffer),u;if(Array.isArray(u)){const h=[];for(const p of u)h.push(Ds(p,a));return h}if(typeof u=="object"){const h=u.constructor,p=h._classRegistryKey;if(!p)throw new Error("can't serialize object of unregistered class");if(!Sr[p])throw new Error(`${p} is not registered.`);const _=h.serialize?h.serialize(u,a):{};if(h.serialize){if(a&&_===a[a.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const w in u){if(!u.hasOwnProperty(w)||Sr[p].omit.indexOf(w)>=0)continue;const T=u[w];_[w]=Sr[p].shallow.indexOf(w)>=0?T:Ds(T,a)}u instanceof Error&&(_.message=u.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(_.$name=p),_}throw new Error("can't serialize object of type "+typeof u)}function ka(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||$s(u)||zt(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(ka);if(typeof u=="object"){const a=u.$name||"Object";if(!Sr[a])throw new Error(`can't deserialize unregistered class ${a}`);const{klass:h}=Sr[a];if(!h)throw new Error(`can't deserialize unregistered class ${a}`);if(h.deserialize)return h.deserialize(u);const p=Object.create(h.prototype);for(const _ of Object.keys(u)){if(_==="$name")continue;const w=u[_];p[_]=Sr[a].shallow.indexOf(_)>=0?w:ka(w)}return p}throw new Error("can't deserialize object of type "+typeof u)}class go{constructor(){this.first=!0}update(a,h){const p=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=h),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=p,!0))}}const Wt={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function oc(u){for(const a of u)if(Go(a.charCodeAt(0)))return!0;return!1}function jo(u){for(const a of u)if(!Mc(a.charCodeAt(0)))return!1;return!0}function Mc(u){return!(Wt.Arabic(u)||Wt["Arabic Supplement"](u)||Wt["Arabic Extended-A"](u)||Wt["Arabic Presentation Forms-A"](u)||Wt["Arabic Presentation Forms-B"](u))}function Go(u){return!(u!==746&&u!==747&&(u<4352||!(Wt["Bopomofo Extended"](u)||Wt.Bopomofo(u)||Wt["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||Wt["CJK Compatibility Ideographs"](u)||Wt["CJK Compatibility"](u)||Wt["CJK Radicals Supplement"](u)||Wt["CJK Strokes"](u)||!(!Wt["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||Wt["CJK Unified Ideographs Extension A"](u)||Wt["CJK Unified Ideographs"](u)||Wt["Enclosed CJK Letters and Months"](u)||Wt["Hangul Compatibility Jamo"](u)||Wt["Hangul Jamo Extended-A"](u)||Wt["Hangul Jamo Extended-B"](u)||Wt["Hangul Jamo"](u)||Wt["Hangul Syllables"](u)||Wt.Hiragana(u)||Wt["Ideographic Description Characters"](u)||Wt.Kanbun(u)||Wt["Kangxi Radicals"](u)||Wt["Katakana Phonetic Extensions"](u)||Wt.Katakana(u)&&u!==12540||!(!Wt["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!Wt["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||Wt["Unified Canadian Aboriginal Syllabics"](u)||Wt["Unified Canadian Aboriginal Syllabics Extended"](u)||Wt["Vertical Forms"](u)||Wt["Yijing Hexagram Symbols"](u)||Wt["Yi Syllables"](u)||Wt["Yi Radicals"](u))))}function dl(u){return!(Go(u)||function(a){return!!(Wt["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||Wt["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||Wt["Letterlike Symbols"](a)||Wt["Number Forms"](a)||Wt["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||Wt["Control Pictures"](a)&&a!==9251||Wt["Optical Character Recognition"](a)||Wt["Enclosed Alphanumerics"](a)||Wt["Geometric Shapes"](a)||Wt["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||Wt["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Wt["CJK Symbols and Punctuation"](a)||Wt.Katakana(a)||Wt["Private Use Area"](a)||Wt["CJK Compatibility Forms"](a)||Wt["Small Form Variants"](a)||Wt["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(u))}function Dc(u){return u>=1424&&u<=2303||Wt["Arabic Presentation Forms-A"](u)||Wt["Arabic Presentation Forms-B"](u)}function fl(u,a){return!(!a&&Dc(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||Wt.Khmer(u))}function lc(u){for(const a of u)if(Dc(a.charCodeAt(0)))return!0;return!1}const Vh="deferred",Fh="loading",Uh="loaded";let jh=null,Rs="unavailable",Ho=null;const Rc=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(Rs="error"),jh&&jh(u)};function Gh(){Lc.fire(new et("pluginStateChange",{pluginStatus:Rs,pluginURL:Ho}))}const Lc=new zn,Hh=function(){return Rs},Af=function(){if(Rs!==Vh||!Ho)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Rs=Fh,Gh(),Ho&&_t({url:Ho},u=>{u?Rc(u):(Rs=Uh,Gh())})},ea={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Rs===Uh||ea.applyArabicShaping!=null,isLoading:()=>Rs===Fh,setState(u){if(!Ve())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Rs=u.pluginStatus,Ho=u.pluginURL},isParsed(){if(!Ve())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ea.applyArabicShaping!=null&&ea.processBidirectionalText!=null&&ea.processStyledBidirectionalText!=null},getPluginURL(){if(!Ve())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Ho}};class sr{constructor(a,h){this.zoom=a,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new go,this.transition={})}isSupportedScript(a){return function(h,p){for(const _ of h)if(!fl(_.charCodeAt(0),p))return!1;return!0}(a,ea.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const a=this.zoom,h=a-Math.floor(a),p=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*h}}}class ku{constructor(a,h){this.property=a,this.value=h,this.expression=function(p,_){if(nr(p))return new Vo(p,_);if(Xs(p)){const w=ec(p,_);if(w.result==="error")throw new Error(w.value.map(T=>`${T.key}: ${T.message}`).join(", "));return w.value}{let w=p;return _.type==="color"&&typeof p=="string"?w=xn.parse(p):_.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?_.type==="variableAnchorOffsetCollection"&&Array.isArray(p)&&(w=zr.parse(p)):w=$r.parse(p),{kind:"constant",evaluate:()=>w}}}(h===void 0?a.specification.default:h,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,h,p){return this.property.possiblyEvaluate(this,a,h,p)}}class Kh{constructor(a){this.property=a,this.value=new ku(a,void 0)}transitioned(a,h){return new Tf(this.property,this.value,h,ve({},a.transition,this.transition),a.now)}untransitioned(){return new Tf(this.property,this.value,null,{},0)}}class Ef{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return mt(this._values[a].value.value)}setValue(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new Kh(this._values[a].property)),this._values[a].value=new ku(this._values[a].property,h===null?void 0:mt(h))}getTransition(a){return mt(this._values[a].transition)}setTransition(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new Kh(this._values[a].property)),this._values[a].transition=mt(h)||void 0}serialize(){const a={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(a[h]=p);const _=this.getTransition(h);_!==void 0&&(a[`${h}-transition`]=_)}return a}transitioned(a,h){const p=new Sf(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].transitioned(a,h._values[_]);return p}untransitioned(){const a=new Sf(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].untransitioned();return a}}class Tf{constructor(a,h,p,_,w){this.property=a,this.value=h,this.begin=w+_.delay||0,this.end=this.begin+_.duration||0,a.specification.transition&&(_.delay||_.duration)&&(this.prior=p)}possiblyEvaluate(a,h,p){const _=a.now||0,w=this.value.possiblyEvaluate(a,h,p),T=this.prior;if(T){if(_>this.end)return this.prior=null,w;if(this.value.isDataDriven())return this.prior=null,w;if(_<this.begin)return T.possiblyEvaluate(a,h,p);{const k=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(a,h,p),w,function(M){if(M<=0)return 0;if(M>=1)return 1;const P=M*M,F=P*M;return 4*(M<.5?F:3*(M-P)+F-.75)}(k))}}return w}}class Sf{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,h,p){const _=new Ou(this._properties);for(const w of Object.keys(this._values))_._values[w]=this._values[w].possiblyEvaluate(a,h,p);return _}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class Fp{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}hasValue(a){return this._values[a].value!==void 0}getValue(a){return mt(this._values[a].value)}setValue(a,h){this._values[a]=new ku(this._values[a].property,h===null?void 0:mt(h))}serialize(){const a={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(a[h]=p)}return a}possiblyEvaluate(a,h,p){const _=new Ou(this._properties);for(const w of Object.keys(this._values))_._values[w]=this._values[w].possiblyEvaluate(a,h,p);return _}}class ws{constructor(a,h,p){this.property=a,this.value=h,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,h,p,_){return this.property.evaluate(this.value,this.parameters,a,h,p,_)}}class Ou{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class Ii{constructor(a){this.specification=a}possiblyEvaluate(a,h){if(a.isDataDriven())throw new Error("Value should not be data driven");return a.expression.evaluate(h)}interpolate(a,h,p){const _=is[this.specification.type];return _?_(a,h,p):a}}class Vi{constructor(a,h){this.specification=a,this.overrides=h}possiblyEvaluate(a,h,p,_){return new ws(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(h,null,{},p,_)}:a.expression,h)}interpolate(a,h,p){if(a.value.kind!=="constant"||h.value.kind!=="constant")return a;if(a.value.value===void 0||h.value.value===void 0)return new ws(this,{kind:"constant",value:void 0},a.parameters);const _=is[this.specification.type];if(_){const w=_(a.value.value,h.value.value,p);return new ws(this,{kind:"constant",value:w},a.parameters)}return a}evaluate(a,h,p,_,w,T){return a.kind==="constant"?a.value:a.evaluate(h,p,_,w,T)}}class Pc extends Vi{possiblyEvaluate(a,h,p,_){if(a.value===void 0)return new ws(this,{kind:"constant",value:void 0},h);if(a.expression.kind==="constant"){const w=a.expression.evaluate(h,null,{},p,_),T=a.property.specification.type==="resolvedImage"&&typeof w!="string"?w.name:w,k=this._calculate(T,T,T,h);return new ws(this,{kind:"constant",value:k},h)}if(a.expression.kind==="camera"){const w=this._calculate(a.expression.evaluate({zoom:h.zoom-1}),a.expression.evaluate({zoom:h.zoom}),a.expression.evaluate({zoom:h.zoom+1}),h);return new ws(this,{kind:"constant",value:w},h)}return new ws(this,a.expression,h)}evaluate(a,h,p,_,w,T){if(a.kind==="source"){const k=a.evaluate(h,p,_,w,T);return this._calculate(k,k,k,h)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(h.zoom)-1},p,_),a.evaluate({zoom:Math.floor(h.zoom)},p,_),a.evaluate({zoom:Math.floor(h.zoom)+1},p,_),h):a.value}_calculate(a,h,p,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:p,to:h}}interpolate(a){return a}}class qh{constructor(a){this.specification=a}possiblyEvaluate(a,h,p,_){if(a.value!==void 0){if(a.expression.kind==="constant"){const w=a.expression.evaluate(h,null,{},p,_);return this._calculate(w,w,w,h)}return this._calculate(a.expression.evaluate(new sr(Math.floor(h.zoom-1),h)),a.expression.evaluate(new sr(Math.floor(h.zoom),h)),a.expression.evaluate(new sr(Math.floor(h.zoom+1),h)),h)}}_calculate(a,h,p,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:p,to:h}}interpolate(a){return a}}class Zh{constructor(a){this.specification=a}possiblyEvaluate(a,h,p,_){return!!a.expression.evaluate(h,null,{},p,_)}interpolate(){return!1}}class Dr{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in a){const p=a[h];p.specification.overridable&&this.overridableProperties.push(h);const _=this.defaultPropertyValues[h]=new ku(p,void 0),w=this.defaultTransitionablePropertyValues[h]=new Kh(p);this.defaultTransitioningPropertyValues[h]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=_.possiblyEvaluate({})}}}ri("DataDrivenProperty",Vi),ri("DataConstantProperty",Ii),ri("CrossFadedDataDrivenProperty",Pc),ri("CrossFadedProperty",qh),ri("ColorRampProperty",Zh);const Wh="-transition";class pa extends zn{constructor(a,h){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1},a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),h.layout&&(this._unevaluatedLayout=new Fp(h.layout)),h.paint)){this._transitionablePaint=new Ef(h.paint);for(const p in a.paint)this.setPaintProperty(p,a.paint[p],{validate:!1});for(const p in a.layout)this.setLayoutProperty(p,a.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ou(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,h,p={}){h!=null&&this._validate(hl,`layers.${this.id}.layout.${a}`,a,h,p)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,h):this.visibility=h)}getPaintProperty(a){return a.endsWith(Wh)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,h,p={}){if(h!=null&&this._validate(Tn,`layers.${this.id}.paint.${a}`,a,h,p))return!1;if(a.endsWith(Wh))return this._transitionablePaint.setTransition(a.slice(0,-11),h||void 0),!1;{const _=this._transitionablePaint._values[a],w=_.property.specification["property-type"]==="cross-faded-data-driven",T=_.value.isDataDriven(),k=_.value;this._transitionablePaint.setValue(a,h),this._handleSpecialPaintPropertyUpdate(a);const M=this._transitionablePaint._values[a].value;return M.isDataDriven()||T||w||this._handleOverridablePaintPropertyUpdate(a,k,M)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,h,p){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,h){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,h)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),Be(a,(h,p)=>!(h===void 0||p==="layout"&&!Object.keys(h).length||p==="paint"&&!Object.keys(h).length))}_validate(a,h,p,_,w={}){return(!w||w.validate!==!1)&&Qs(this,a.call(Ia,{key:h,layerType:this.type,objectKey:p,value:_,styleSpec:Xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const h=this.paint.get(a);if(h instanceof ws&&Ga(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const If={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ml{constructor(a,h){this._structArray=a,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class wr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,h){return a._trim(),h&&(a.isTransferred=!0,h.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const h=Object.create(this.prototype);return h.arrayBuffer=a.arrayBuffer,h.length=a.length,h.capacity=a.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function pr(u,a=1){let h=0,p=0;return{members:u.map(_=>{const w=If[_.type].BYTES_PER_ELEMENT,T=h=cc(h,Math.max(a,w)),k=_.components||1;return p=Math.max(p,w),h+=w*k,{name:_.name,type:_.type,components:k,offset:T}}),size:cc(h,Math.max(p,a)),alignment:a}}function cc(u,a){return Math.ceil(u/a)*a}class Nc extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h){const p=this.length;return this.resize(p+1),this.emplace(p,a,h)}emplace(a,h,p){const _=2*a;return this.int16[_+0]=h,this.int16[_+1]=p,a}}Nc.prototype.bytesPerElement=4,ri("StructArrayLayout2i4",Nc);class zc extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,h,p)}emplace(a,h,p,_){const w=3*a;return this.int16[w+0]=h,this.int16[w+1]=p,this.int16[w+2]=_,a}}zc.prototype.bytesPerElement=6,ri("StructArrayLayout3i6",zc);class pl extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,_){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,p,_)}emplace(a,h,p,_,w){const T=4*a;return this.int16[T+0]=h,this.int16[T+1]=p,this.int16[T+2]=_,this.int16[T+3]=w,a}}pl.prototype.bytesPerElement=8,ri("StructArrayLayout4i8",pl);class Yh extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,_,w,T){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,p,_,w,T)}emplace(a,h,p,_,w,T,k){const M=6*a;return this.int16[M+0]=h,this.int16[M+1]=p,this.int16[M+2]=_,this.int16[M+3]=w,this.int16[M+4]=T,this.int16[M+5]=k,a}}Yh.prototype.bytesPerElement=12,ri("StructArrayLayout2i4i12",Yh);class Jh extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,_,w,T){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,p,_,w,T)}emplace(a,h,p,_,w,T,k){const M=4*a,P=8*a;return this.int16[M+0]=h,this.int16[M+1]=p,this.uint8[P+4]=_,this.uint8[P+5]=w,this.uint8[P+6]=T,this.uint8[P+7]=k,a}}Jh.prototype.bytesPerElement=8,ri("StructArrayLayout2i4ub8",Jh);class uc extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h){const p=this.length;return this.resize(p+1),this.emplace(p,a,h)}emplace(a,h,p){const _=2*a;return this.float32[_+0]=h,this.float32[_+1]=p,a}}uc.prototype.bytesPerElement=8,ri("StructArrayLayout2f8",uc);class Xh extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,p,_,w,T,k,M,P,F){const G=this.length;return this.resize(G+1),this.emplace(G,a,h,p,_,w,T,k,M,P,F)}emplace(a,h,p,_,w,T,k,M,P,F,G){const X=10*a;return this.uint16[X+0]=h,this.uint16[X+1]=p,this.uint16[X+2]=_,this.uint16[X+3]=w,this.uint16[X+4]=T,this.uint16[X+5]=k,this.uint16[X+6]=M,this.uint16[X+7]=P,this.uint16[X+8]=F,this.uint16[X+9]=G,a}}Xh.prototype.bytesPerElement=20,ri("StructArrayLayout10ui20",Xh);class Qh extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,p,_,w,T,k,M,P,F,G,X){const ie=this.length;return this.resize(ie+1),this.emplace(ie,a,h,p,_,w,T,k,M,P,F,G,X)}emplace(a,h,p,_,w,T,k,M,P,F,G,X,ie){const re=12*a;return this.int16[re+0]=h,this.int16[re+1]=p,this.int16[re+2]=_,this.int16[re+3]=w,this.uint16[re+4]=T,this.uint16[re+5]=k,this.uint16[re+6]=M,this.uint16[re+7]=P,this.int16[re+8]=F,this.int16[re+9]=G,this.int16[re+10]=X,this.int16[re+11]=ie,a}}Qh.prototype.bytesPerElement=24,ri("StructArrayLayout4i4ui4i24",Qh);class Sn extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,h,p)}emplace(a,h,p,_){const w=3*a;return this.float32[w+0]=h,this.float32[w+1]=p,this.float32[w+2]=_,a}}Sn.prototype.bytesPerElement=12,ri("StructArrayLayout3f12",Sn);class x extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint32[1*a+0]=h,a}}x.prototype.bytesPerElement=4,ri("StructArrayLayout1ul4",x);class o extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,p,_,w,T,k,M,P){const F=this.length;return this.resize(F+1),this.emplace(F,a,h,p,_,w,T,k,M,P)}emplace(a,h,p,_,w,T,k,M,P,F){const G=10*a,X=5*a;return this.int16[G+0]=h,this.int16[G+1]=p,this.int16[G+2]=_,this.int16[G+3]=w,this.int16[G+4]=T,this.int16[G+5]=k,this.uint32[X+3]=M,this.uint16[G+8]=P,this.uint16[G+9]=F,a}}o.prototype.bytesPerElement=20,ri("StructArrayLayout6i1ul2ui20",o);class d extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,_,w,T){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,p,_,w,T)}emplace(a,h,p,_,w,T,k){const M=6*a;return this.int16[M+0]=h,this.int16[M+1]=p,this.int16[M+2]=_,this.int16[M+3]=w,this.int16[M+4]=T,this.int16[M+5]=k,a}}d.prototype.bytesPerElement=12,ri("StructArrayLayout2i2i2i12",d);class g extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,_,w){const T=this.length;return this.resize(T+1),this.emplace(T,a,h,p,_,w)}emplace(a,h,p,_,w,T){const k=4*a,M=8*a;return this.float32[k+0]=h,this.float32[k+1]=p,this.float32[k+2]=_,this.int16[M+6]=w,this.int16[M+7]=T,a}}g.prototype.bytesPerElement=16,ri("StructArrayLayout2f1f2i16",g);class v extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p,_){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,p,_)}emplace(a,h,p,_,w){const T=12*a,k=3*a;return this.uint8[T+0]=h,this.uint8[T+1]=p,this.float32[k+1]=_,this.float32[k+2]=w,a}}v.prototype.bytesPerElement=12,ri("StructArrayLayout2ub2f12",v);class A extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,h,p)}emplace(a,h,p,_){const w=3*a;return this.uint16[w+0]=h,this.uint16[w+1]=p,this.uint16[w+2]=_,a}}A.prototype.bytesPerElement=6,ri("StructArrayLayout3ui6",A);class O extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p,_,w,T,k,M,P,F,G,X,ie,re,de,we,Ie){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,a,h,p,_,w,T,k,M,P,F,G,X,ie,re,de,we,Ie)}emplace(a,h,p,_,w,T,k,M,P,F,G,X,ie,re,de,we,Ie,Ue){const Me=24*a,He=12*a,$e=48*a;return this.int16[Me+0]=h,this.int16[Me+1]=p,this.uint16[Me+2]=_,this.uint16[Me+3]=w,this.uint32[He+2]=T,this.uint32[He+3]=k,this.uint32[He+4]=M,this.uint16[Me+10]=P,this.uint16[Me+11]=F,this.uint16[Me+12]=G,this.float32[He+7]=X,this.float32[He+8]=ie,this.uint8[$e+36]=re,this.uint8[$e+37]=de,this.uint8[$e+38]=we,this.uint32[He+10]=Ie,this.int16[Me+22]=Ue,a}}O.prototype.bytesPerElement=48,ri("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",O);class C extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p,_,w,T,k,M,P,F,G,X,ie,re,de,we,Ie,Ue,Me,He,$e,wt,ci,bi,li,ti,Zt,pi){const Yt=this.length;return this.resize(Yt+1),this.emplace(Yt,a,h,p,_,w,T,k,M,P,F,G,X,ie,re,de,we,Ie,Ue,Me,He,$e,wt,ci,bi,li,ti,Zt,pi)}emplace(a,h,p,_,w,T,k,M,P,F,G,X,ie,re,de,we,Ie,Ue,Me,He,$e,wt,ci,bi,li,ti,Zt,pi,Yt){const jt=32*a,Li=16*a;return this.int16[jt+0]=h,this.int16[jt+1]=p,this.int16[jt+2]=_,this.int16[jt+3]=w,this.int16[jt+4]=T,this.int16[jt+5]=k,this.int16[jt+6]=M,this.int16[jt+7]=P,this.uint16[jt+8]=F,this.uint16[jt+9]=G,this.uint16[jt+10]=X,this.uint16[jt+11]=ie,this.uint16[jt+12]=re,this.uint16[jt+13]=de,this.uint16[jt+14]=we,this.uint16[jt+15]=Ie,this.uint16[jt+16]=Ue,this.uint16[jt+17]=Me,this.uint16[jt+18]=He,this.uint16[jt+19]=$e,this.uint16[jt+20]=wt,this.uint16[jt+21]=ci,this.uint16[jt+22]=bi,this.uint32[Li+12]=li,this.float32[Li+13]=ti,this.float32[Li+14]=Zt,this.uint16[jt+30]=pi,this.uint16[jt+31]=Yt,a}}C.prototype.bytesPerElement=64,ri("StructArrayLayout8i15ui1ul2f2ui64",C);class L extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.float32[1*a+0]=h,a}}L.prototype.bytesPerElement=4,ri("StructArrayLayout1f4",L);class B extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,h,p)}emplace(a,h,p,_){const w=3*a;return this.uint16[6*a+0]=h,this.float32[w+1]=p,this.float32[w+2]=_,a}}B.prototype.bytesPerElement=12,ri("StructArrayLayout1ui2f12",B);class U extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,h,p)}emplace(a,h,p,_){const w=4*a;return this.uint32[2*a+0]=h,this.uint16[w+2]=p,this.uint16[w+3]=_,a}}U.prototype.bytesPerElement=8,ri("StructArrayLayout1ul2ui8",U);class j extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h){const p=this.length;return this.resize(p+1),this.emplace(p,a,h)}emplace(a,h,p){const _=2*a;return this.uint16[_+0]=h,this.uint16[_+1]=p,a}}j.prototype.bytesPerElement=4,ri("StructArrayLayout2ui4",j);class ee extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint16[1*a+0]=h,a}}ee.prototype.bytesPerElement=2,ri("StructArrayLayout1ui2",ee);class me extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p,_){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,p,_)}emplace(a,h,p,_,w){const T=4*a;return this.float32[T+0]=h,this.float32[T+1]=p,this.float32[T+2]=_,this.float32[T+3]=w,a}}me.prototype.bytesPerElement=16,ri("StructArrayLayout4f16",me);class fe extends ml{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new E(this.anchorPointX,this.anchorPointY)}}fe.prototype.size=20;class be extends o{get(a){return new fe(this,a)}}ri("CollisionBoxArray",be);class he extends ml{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}he.prototype.size=48;class Pe extends O{get(a){return new he(this,a)}}ri("PlacedSymbolArray",Pe);class Je extends ml{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Je.prototype.size=64;class Ee extends C{get(a){return new Je(this,a)}}ri("SymbolInstanceArray",Ee);class Fe extends L{getoffsetX(a){return this.float32[1*a+0]}}ri("GlyphOffsetArray",Fe);class it extends zc{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}ri("SymbolLineVertexArray",it);class at extends ml{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}at.prototype.size=12;class xt extends B{get(a){return new at(this,a)}}ri("TextAnchorOffsetArray",xt);class Vt extends ml{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Vt.prototype.size=8;class kt extends U{get(a){return new Vt(this,a)}}ri("FeatureIndexArray",kt);class qt extends Nc{}class vi extends Nc{}class un extends Nc{}class ei extends Yh{}class Fi extends Jh{}class wi extends uc{}class Rn extends Xh{}class ln extends Qh{}class rn extends Sn{}class hn extends x{}class Ir extends d{}class Xn extends v{}class rs extends A{}class Hr extends j{}const Rr=pr([{name:"a_pos",components:2,type:"Int16"}],4),{members:ta}=Rr;class ar{constructor(a=[]){this.segments=a}prepareSegment(a,h,p,_){let w=this.segments[this.segments.length-1];return a>ar.MAX_VERTEX_ARRAY_LENGTH&&rt(`Max vertices per segment is ${ar.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!w||w.vertexLength+a>ar.MAX_VERTEX_ARRAY_LENGTH||w.sortKey!==_)&&(w={vertexOffset:h.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},_!==void 0&&(w.sortKey=_),this.segments.push(w)),w}get(){return this.segments}destroy(){for(const a of this.segments)for(const h in a.vaos)a.vaos[h].destroy()}static simpleSegment(a,h,p,_){return new ar([{vertexOffset:a,primitiveOffset:h,vertexLength:p,primitiveLength:_,vaos:{},sortKey:0}])}}function Ja(u,a){return 256*(u=ne(Math.floor(u),0,255))+ne(Math.floor(a),0,255)}ar.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ri("SegmentVector",ar);const Xa=pr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ko={exports:{}},gl={exports:{}};gl.exports=function(u,a){var h,p,_,w,T,k,M,P;for(p=u.length-(h=3&u.length),_=a,T=3432918353,k=461845907,P=0;P<p;)M=255&u.charCodeAt(P)|(255&u.charCodeAt(++P))<<8|(255&u.charCodeAt(++P))<<16|(255&u.charCodeAt(++P))<<24,++P,_=27492+(65535&(w=5*(65535&(_=(_^=M=(65535&(M=(M=(65535&M)*T+(((M>>>16)*T&65535)<<16)&4294967295)<<15|M>>>17))*k+(((M>>>16)*k&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(M=0,h){case 3:M^=(255&u.charCodeAt(P+2))<<16;case 2:M^=(255&u.charCodeAt(P+1))<<8;case 1:_^=M=(65535&(M=(M=(65535&(M^=255&u.charCodeAt(P)))*T+(((M>>>16)*T&65535)<<16)&4294967295)<<15|M>>>17))*k+(((M>>>16)*k&65535)<<16)&4294967295}return _^=u.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0};var hc=gl.exports,ms={exports:{}};ms.exports=function(u,a){for(var h,p=u.length,_=a^p,w=0;p>=4;)h=1540483477*(65535&(h=255&u.charCodeAt(w)|(255&u.charCodeAt(++w))<<8|(255&u.charCodeAt(++w))<<16|(255&u.charCodeAt(++w))<<24))+((1540483477*(h>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),p-=4,++w;switch(p){case 3:_^=(255&u.charCodeAt(w+2))<<16;case 2:_^=(255&u.charCodeAt(w+1))<<8;case 1:_=1540483477*(65535&(_^=255&u.charCodeAt(w)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0};var ss=hc,As=ms.exports;Ko.exports=ss,Ko.exports.murmur3=ss,Ko.exports.murmur2=As;var _l=m(Ko.exports);class kr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,h,p,_){this.ids.push(Kr(a)),this.positions.push(h,p,_)}getPositions(a){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=Kr(a);let p=0,_=this.ids.length-1;for(;p<_;){const T=p+_>>1;this.ids[T]>=h?_=T:p=T+1}const w=[];for(;this.ids[p]===h;)w.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return w}static serialize(a,h){const p=new Float64Array(a.ids),_=new Uint32Array(a.positions);return Ls(p,_,0,p.length-1),h&&h.push(p.buffer,_.buffer),{ids:p,positions:_}}static deserialize(a){const h=new kr;return h.ids=a.ids,h.positions=a.positions,h.indexed=!0,h}}function Kr(u){const a=+u;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:_l(String(u))}function Ls(u,a,h,p){for(;h<p;){const _=u[h+p>>1];let w=h-1,T=p+1;for(;;){do w++;while(u[w]<_);do T--;while(u[T]>_);if(w>=T)break;Or(u,w,T),Or(a,3*w,3*T),Or(a,3*w+1,3*T+1),Or(a,3*w+2,3*T+2)}T-h<p-T?(Ls(u,a,h,T),h=T+1):(Ls(u,a,T+1,p),p=T)}}function Or(u,a,h){const p=u[a];u[a]=u[h],u[h]=p}ri("FeaturePositionMap",kr);class yl{constructor(a,h){this.gl=a.gl,this.location=h}}class Cu extends yl{constructor(a,h){super(a,h),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class kf extends yl{constructor(a,h){super(a,h),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class Of extends yl{constructor(a,h){super(a,h),this.current=xn.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}const Up=new Float32Array(16);function $h(u){return[Ja(255*u.r,255*u.g),Ja(255*u.b,255*u.a)]}class Qa{constructor(a,h,p){this.value=a,this.uniformNames=h.map(_=>`u_${_}`),this.type=p}setUniform(a,h,p){a.set(p.constantOr(this.value))}getBinding(a,h,p){return this.type==="color"?new Of(a,h):new Cu(a,h)}}class vl{constructor(a,h){this.uniformNames=h.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=a.tlbr}setUniform(a,h,p,_){const w=_==="u_pattern_to"?this.patternTo:_==="u_pattern_from"?this.patternFrom:_==="u_pixel_ratio_to"?this.pixelRatioTo:_==="u_pixel_ratio_from"?this.pixelRatioFrom:null;w&&a.set(w)}getBinding(a,h,p){return p.substr(0,9)==="u_pattern"?new kf(a,h):new Cu(a,h)}}class $a{constructor(a,h,p,_){this.expression=a,this.type=p,this.maxValue=0,this.paintVertexAttributes=h.map(w=>({name:`a_${w}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(a,h,p,_,w){const T=this.paintVertexArray.length,k=this.expression.evaluate(new sr(0),h,{},_,[],w);this.paintVertexArray.resize(a),this._setPaintValue(T,a,k)}updatePaintArray(a,h,p,_){const w=this.expression.evaluate({zoom:0},p,_);this._setPaintValue(a,h,w)}_setPaintValue(a,h,p){if(this.type==="color"){const _=$h(p);for(let w=a;w<h;w++)this.paintVertexArray.emplace(w,_[0],_[1])}else{for(let _=a;_<h;_++)this.paintVertexArray.emplace(_,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ga{constructor(a,h,p,_,w,T){this.expression=a,this.uniformNames=h.map(k=>`u_${k}_t`),this.type=p,this.useIntegerZoom=_,this.zoom=w,this.maxValue=0,this.paintVertexAttributes=h.map(k=>({name:`a_${k}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(a,h,p,_,w){const T=this.expression.evaluate(new sr(this.zoom),h,{},_,[],w),k=this.expression.evaluate(new sr(this.zoom+1),h,{},_,[],w),M=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(M,a,T,k)}updatePaintArray(a,h,p,_){const w=this.expression.evaluate({zoom:this.zoom},p,_),T=this.expression.evaluate({zoom:this.zoom+1},p,_);this._setPaintValue(a,h,w,T)}_setPaintValue(a,h,p,_){if(this.type==="color"){const w=$h(p),T=$h(_);for(let k=a;k<h;k++)this.paintVertexArray.emplace(k,w[0],w[1],T[0],T[1])}else{for(let w=a;w<h;w++)this.paintVertexArray.emplace(w,p,_);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(_))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,h){const p=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,_=ne(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);a.set(_)}getBinding(a,h,p){return new Cu(a,h)}}class eo{constructor(a,h,p,_,w,T){this.expression=a,this.type=h,this.useIntegerZoom=p,this.zoom=_,this.layerId=T,this.zoomInPaintVertexArray=new w,this.zoomOutPaintVertexArray=new w}populatePaintArray(a,h,p){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(_,a,h.patterns&&h.patterns[this.layerId],p)}updatePaintArray(a,h,p,_,w){this._setPaintValues(a,h,p.patterns&&p.patterns[this.layerId],w)}_setPaintValues(a,h,p,_){if(!_||!p)return;const{min:w,mid:T,max:k}=p,M=_[w],P=_[T],F=_[k];if(M&&P&&F)for(let G=a;G<h;G++)this.zoomInPaintVertexArray.emplace(G,P.tl[0],P.tl[1],P.br[0],P.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],P.pixelRatio,M.pixelRatio),this.zoomOutPaintVertexArray.emplace(G,P.tl[0],P.tl[1],P.br[0],P.br[1],F.tl[0],F.tl[1],F.br[0],F.br[1],P.pixelRatio,F.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,Xa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,Xa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ed{constructor(a,h,p){this.binders={},this._buffers=[];const _=[];for(const w in a.paint._values){if(!p(w))continue;const T=a.paint.get(w);if(!(T instanceof ws&&Ga(T.property.specification)))continue;const k=_I(w,a.type),M=T.value,P=T.property.specification.type,F=T.property.useIntegerZoom,G=T.property.specification["property-type"],X=G==="cross-faded"||G==="cross-faded-data-driven";if(M.kind==="constant")this.binders[w]=X?new vl(M.value,k):new Qa(M.value,k,P),_.push(`/u_${w}`);else if(M.kind==="source"||X){const ie=Vy(w,P,"source");this.binders[w]=X?new eo(M,P,F,h,ie,a.id):new $a(M,k,P,ie),_.push(`/a_${w}`)}else{const ie=Vy(w,P,"composite");this.binders[w]=new ga(M,k,P,F,h,ie),_.push(`/z_${w}`)}}this.cacheKey=_.sort().join("")}getMaxValue(a){const h=this.binders[a];return h instanceof $a||h instanceof ga?h.maxValue:0}populatePaintArrays(a,h,p,_,w){for(const T in this.binders){const k=this.binders[T];(k instanceof $a||k instanceof ga||k instanceof eo)&&k.populatePaintArray(a,h,p,_,w)}}setConstantPatternPositions(a,h){for(const p in this.binders){const _=this.binders[p];_ instanceof vl&&_.setConstantPatternPositions(a,h)}}updatePaintArrays(a,h,p,_,w){let T=!1;for(const k in a){const M=h.getPositions(k);for(const P of M){const F=p.feature(P.index);for(const G in this.binders){const X=this.binders[G];if((X instanceof $a||X instanceof ga||X instanceof eo)&&X.expression.isStateDependent===!0){const ie=_.paint.get(G);X.expression=ie.value,X.updatePaintArray(P.start,P.end,F,a[k],w),T=!0}}}}return T}defines(){const a=[];for(const h in this.binders){const p=this.binders[h];(p instanceof Qa||p instanceof vl)&&a.push(...p.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return a}getBinderAttributes(){const a=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof $a||p instanceof ga)for(let _=0;_<p.paintVertexAttributes.length;_++)a.push(p.paintVertexAttributes[_].name);else if(p instanceof eo)for(let _=0;_<Xa.members.length;_++)a.push(Xa.members[_].name)}return a}getBinderUniforms(){const a=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof Qa||p instanceof vl||p instanceof ga)for(const _ of p.uniformNames)a.push(_)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,h){const p=[];for(const _ in this.binders){const w=this.binders[_];if(w instanceof Qa||w instanceof vl||w instanceof ga){for(const T of w.uniformNames)if(h[T]){const k=w.getBinding(a,h[T],T);p.push({name:T,property:_,binding:k})}}}return p}setUniforms(a,h,p,_){for(const{name:w,property:T,binding:k}of h)this.binders[T].setUniform(k,_,p.get(T),w)}updatePaintBuffers(a){this._buffers=[];for(const h in this.binders){const p=this.binders[h];if(a&&p instanceof eo){const _=a.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(p instanceof $a||p instanceof ga)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(a){for(const h in this.binders){const p=this.binders[h];(p instanceof $a||p instanceof ga||p instanceof eo)&&p.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const h=this.binders[a];(h instanceof $a||h instanceof ga||h instanceof eo)&&h.destroy()}}}class _o{constructor(a,h,p=()=>!0){this.programConfigurations={};for(const _ of a)this.programConfigurations[_.id]=new ed(_,h,p);this.needsUpload=!1,this._featureMap=new kr,this._bufferOffset=0}populatePaintArrays(a,h,p,_,w,T){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(a,h,_,w,T);h.id!==void 0&&this._featureMap.add(h.id,p,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,h,p,_){for(const w of p)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(a,this._featureMap,h,w,_)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}function _I(u,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${a}-`,"").replace(/-/g,"_")]}function Vy(u,a,h){const p={color:{source:uc,composite:me},number:{source:L,composite:uc}},_=function(w){return{"line-pattern":{source:Rn,composite:Rn},"fill-pattern":{source:Rn,composite:Rn},"fill-extrusion-pattern":{source:Rn,composite:Rn}}[w]}(u);return _&&_[h]||p[a][h]}ri("ConstantBinder",Qa),ri("CrossFadedConstantBinder",vl),ri("SourceExpressionBinder",$a),ri("CrossFadedCompositeBinder",eo),ri("CompositeExpressionBinder",ga),ri("ProgramConfiguration",ed,{omit:["_buffers"]}),ri("ProgramConfigurationSet",_o);const Vr=8192,jp=Math.pow(2,14)-1,Fy=-jp-1;function Bc(u){const a=Vr/u.extent,h=u.loadGeometry();for(let p=0;p<h.length;p++){const _=h[p];for(let w=0;w<_.length;w++){const T=_[w],k=Math.round(T.x*a),M=Math.round(T.y*a);T.x=ne(k,Fy,jp),T.y=ne(M,Fy,jp),(k<T.x||k>T.x+1||M<T.y||M>T.y+1)&&rt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Vc(u,a){return{type:u.type,id:u.id,properties:u.properties,geometry:a?Bc(u):[]}}function Cf(u,a,h,p,_){u.emplaceBack(2*a+(p+1)/2,2*h+(_+1)/2)}class Gp{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new vi,this.indexArray=new rs,this.segments=new ar,this.programConfigurations=new _o(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,p){const _=this.layers[0],w=[];let T=null,k=!1;_.type==="circle"&&(T=_.layout.get("circle-sort-key"),k=!T.isConstant());for(const{feature:M,id:P,index:F,sourceLayerIndex:G}of a){const X=this.layers[0]._featureFilter.needGeometry,ie=Vc(M,X);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),ie,p))continue;const re=k?T.evaluate(ie,{},p):void 0,de={id:P,properties:M.properties,type:M.type,sourceLayerIndex:G,index:F,geometry:X?ie.geometry:Bc(M),patterns:{},sortKey:re};w.push(de)}k&&w.sort((M,P)=>M.sortKey-P.sortKey);for(const M of w){const{geometry:P,index:F,sourceLayerIndex:G}=M,X=a[F].feature;this.addFeature(M,P,F,p),h.featureIndex.insert(X,P,F,G,this.index)}}update(a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,ta),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,h,p,_){for(const w of h)for(const T of w){const k=T.x,M=T.y;if(k<0||k>=Vr||M<0||M>=Vr)continue;const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),F=P.vertexLength;Cf(this.layoutVertexArray,k,M,-1,-1),Cf(this.layoutVertexArray,k,M,1,-1),Cf(this.layoutVertexArray,k,M,1,1),Cf(this.layoutVertexArray,k,M,-1,1),this.indexArray.emplaceBack(F,F+1,F+2),this.indexArray.emplaceBack(F,F+3,F+2),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,{},_)}}function Uy(u,a){for(let h=0;h<u.length;h++)if(Mu(a,u[h]))return!0;for(let h=0;h<a.length;h++)if(Mu(u,a[h]))return!0;return!!Hp(u,a)}function yI(u,a,h){return!!Mu(u,a)||!!Kp(a,u,h)}function jy(u,a){if(u.length===1)return Hy(a,u[0]);for(let h=0;h<a.length;h++){const p=a[h];for(let _=0;_<p.length;_++)if(Mu(u,p[_]))return!0}for(let h=0;h<u.length;h++)if(Hy(a,u[h]))return!0;for(let h=0;h<a.length;h++)if(Hp(u,a[h]))return!0;return!1}function vI(u,a,h){if(u.length>1){if(Hp(u,a))return!0;for(let p=0;p<a.length;p++)if(Kp(a[p],u,h))return!0}for(let p=0;p<u.length;p++)if(Kp(u[p],a,h))return!0;return!1}function Hp(u,a){if(u.length===0||a.length===0)return!1;for(let h=0;h<u.length-1;h++){const p=u[h],_=u[h+1];for(let w=0;w<a.length-1;w++)if(bI(p,_,a[w],a[w+1]))return!0}return!1}function bI(u,a,h,p){return tt(u,h,p)!==tt(a,h,p)&&tt(u,a,h)!==tt(u,a,p)}function Kp(u,a,h){const p=h*h;if(a.length===1)return u.distSqr(a[0])<p;for(let _=1;_<a.length;_++)if(Gy(u,a[_-1],a[_])<p)return!0;return!1}function Gy(u,a,h){const p=a.distSqr(h);if(p===0)return u.distSqr(a);const _=((u.x-a.x)*(h.x-a.x)+(u.y-a.y)*(h.y-a.y))/p;return u.distSqr(_<0?a:_>1?h:h.sub(a)._mult(_)._add(a))}function Hy(u,a){let h,p,_,w=!1;for(let T=0;T<u.length;T++){h=u[T];for(let k=0,M=h.length-1;k<h.length;M=k++)p=h[k],_=h[M],p.y>a.y!=_.y>a.y&&a.x<(_.x-p.x)*(a.y-p.y)/(_.y-p.y)+p.x&&(w=!w)}return w}function Mu(u,a){let h=!1;for(let p=0,_=u.length-1;p<u.length;_=p++){const w=u[p],T=u[_];w.y>a.y!=T.y>a.y&&a.x<(T.x-w.x)*(a.y-w.y)/(T.y-w.y)+w.x&&(h=!h)}return h}function xI(u,a,h){const p=h[0],_=h[2];if(u.x<p.x&&a.x<p.x||u.x>_.x&&a.x>_.x||u.y<p.y&&a.y<p.y||u.y>_.y&&a.y>_.y)return!1;const w=tt(u,a,h[0]);return w!==tt(u,a,h[1])||w!==tt(u,a,h[2])||w!==tt(u,a,h[3])}function td(u,a,h){const p=a.paint.get(u).value;return p.kind==="constant"?p.value:h.programConfigurations.get(a.id).getMaxValue(u)}function Mf(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function Df(u,a,h,p,_){if(!a[0]&&!a[1])return u;const w=E.convert(a)._mult(_);h==="viewport"&&w._rotate(-p);const T=[];for(let k=0;k<u.length;k++)T.push(u[k].sub(w));return T}let Ky,qy;ri("CircleBucket",Gp,{omit:["layers"]});var wI={get paint(){return qy=qy||new Dr({"circle-radius":new Vi(Xe.paint_circle["circle-radius"]),"circle-color":new Vi(Xe.paint_circle["circle-color"]),"circle-blur":new Vi(Xe.paint_circle["circle-blur"]),"circle-opacity":new Vi(Xe.paint_circle["circle-opacity"]),"circle-translate":new Ii(Xe.paint_circle["circle-translate"]),"circle-translate-anchor":new Ii(Xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ii(Xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ii(Xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Vi(Xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Vi(Xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Vi(Xe.paint_circle["circle-stroke-opacity"])})},get layout(){return Ky=Ky||new Dr({"circle-sort-key":new Vi(Xe.layout_circle["circle-sort-key"])})}},Ps=1e-6,Du=typeof Float32Array<"u"?Float32Array:Array;function qp(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Zy(u,a,h){var p=a[0],_=a[1],w=a[2],T=a[3],k=a[4],M=a[5],P=a[6],F=a[7],G=a[8],X=a[9],ie=a[10],re=a[11],de=a[12],we=a[13],Ie=a[14],Ue=a[15],Me=h[0],He=h[1],$e=h[2],wt=h[3];return u[0]=Me*p+He*k+$e*G+wt*de,u[1]=Me*_+He*M+$e*X+wt*we,u[2]=Me*w+He*P+$e*ie+wt*Ie,u[3]=Me*T+He*F+$e*re+wt*Ue,u[4]=(Me=h[4])*p+(He=h[5])*k+($e=h[6])*G+(wt=h[7])*de,u[5]=Me*_+He*M+$e*X+wt*we,u[6]=Me*w+He*P+$e*ie+wt*Ie,u[7]=Me*T+He*F+$e*re+wt*Ue,u[8]=(Me=h[8])*p+(He=h[9])*k+($e=h[10])*G+(wt=h[11])*de,u[9]=Me*_+He*M+$e*X+wt*we,u[10]=Me*w+He*P+$e*ie+wt*Ie,u[11]=Me*T+He*F+$e*re+wt*Ue,u[12]=(Me=h[12])*p+(He=h[13])*k+($e=h[14])*G+(wt=h[15])*de,u[13]=Me*_+He*M+$e*X+wt*we,u[14]=Me*w+He*P+$e*ie+wt*Ie,u[15]=Me*T+He*F+$e*re+wt*Ue,u}Math.hypot||(Math.hypot=function(){for(var u=0,a=arguments.length;a--;)u+=arguments[a]*arguments[a];return Math.sqrt(u)});var id,AI=Zy;function Rf(u,a,h){var p=a[0],_=a[1],w=a[2],T=a[3];return u[0]=h[0]*p+h[4]*_+h[8]*w+h[12]*T,u[1]=h[1]*p+h[5]*_+h[9]*w+h[13]*T,u[2]=h[2]*p+h[6]*_+h[10]*w+h[14]*T,u[3]=h[3]*p+h[7]*_+h[11]*w+h[15]*T,u}id=new Du(4),Du!=Float32Array&&(id[0]=0,id[1]=0,id[2]=0,id[3]=0);class EI extends pa{constructor(a){super(a,wI)}createBucket(a){return new Gp(a)}queryRadius(a){const h=a;return td("circle-radius",this,h)+td("circle-stroke-width",this,h)+Mf(this.paint.get("circle-translate"))}queryIntersectsFeature(a,h,p,_,w,T,k,M){const P=Df(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),T.angle,k),F=this.paint.get("circle-radius").evaluate(h,p)+this.paint.get("circle-stroke-width").evaluate(h,p),G=this.paint.get("circle-pitch-alignment")==="map",X=G?P:function(re,de){return re.map(we=>Wy(we,de))}(P,M),ie=G?F*k:F;for(const re of _)for(const de of re){const we=G?de:Wy(de,M);let Ie=ie;const Ue=Rf([],[de.x,de.y,0,1],M);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ie*=Ue[3]/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ie*=T.cameraToCenterDistance/Ue[3]),yI(X,we,Ie))return!0}return!1}}function Wy(u,a){const h=Rf([],[u.x,u.y,0,1],a);return new E(h[0]/h[3],h[1]/h[3])}class Yy extends Gp{}let Jy;ri("HeatmapBucket",Yy,{omit:["layers"]});var TI={get paint(){return Jy=Jy||new Dr({"heatmap-radius":new Vi(Xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Vi(Xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ii(Xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Zh(Xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ii(Xe.paint_heatmap["heatmap-opacity"])})}};function Zp(u,{width:a,height:h},p,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==a*h*p)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${a*h*p}`)}else _=new Uint8Array(a*h*p);return u.width=a,u.height=h,u.data=_,u}function Xy(u,{width:a,height:h},p){if(a===u.width&&h===u.height)return;const _=Zp({},{width:a,height:h},p);Wp(u,_,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,a),height:Math.min(u.height,h)},p),u.width=a,u.height=h,u.data=_.data}function Wp(u,a,h,p,_,w){if(_.width===0||_.height===0)return a;if(_.width>u.width||_.height>u.height||h.x>u.width-_.width||h.y>u.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>a.width||_.height>a.height||p.x>a.width-_.width||p.y>a.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const T=u.data,k=a.data;if(T===k)throw new Error("srcData equals dstData, so image is already copied");for(let M=0;M<_.height;M++){const P=((h.y+M)*u.width+h.x)*w,F=((p.y+M)*a.width+p.x)*w;for(let G=0;G<_.width*w;G++)k[F+G]=T[P+G]}return a}class nd{constructor(a,h){Zp(this,a,1,h)}resize(a){Xy(this,a,1)}clone(){return new nd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,p,_,w){Wp(a,h,p,_,w,1)}}class Oa{constructor(a,h){Zp(this,a,4,h)}resize(a){Xy(this,a,4)}replace(a,h){h?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new Oa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,p,_,w){Wp(a,h,p,_,w,4)}}function Qy(u){const a={},h=u.resolution||256,p=u.clips?u.clips.length:1,_=u.image||new Oa({width:h,height:p});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const w=(T,k,M)=>{a[u.evaluationKey]=M;const P=u.expression.evaluate(a);_.data[T+k+0]=Math.floor(255*P.r/P.a),_.data[T+k+1]=Math.floor(255*P.g/P.a),_.data[T+k+2]=Math.floor(255*P.b/P.a),_.data[T+k+3]=Math.floor(255*P.a)};if(u.clips)for(let T=0,k=0;T<p;++T,k+=4*h)for(let M=0,P=0;M<h;M++,P+=4){const F=M/(h-1),{start:G,end:X}=u.clips[T];w(k,P,G*(1-F)+X*F)}else for(let T=0,k=0;T<h;T++,k+=4)w(0,k,T/(h-1));return _}ri("AlphaImage",nd),ri("RGBAImage",Oa);class SI extends pa{createBucket(a){return new Yy(a)}constructor(a){super(a,TI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Qy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let $y;var II={get paint(){return $y=$y||new Dr({"hillshade-illumination-direction":new Ii(Xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ii(Xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ii(Xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ii(Xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ii(Xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ii(Xe.paint_hillshade["hillshade-accent-color"])})}};class kI extends pa{constructor(a){super(a,II)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const OI=pr([{name:"a_pos",components:2,type:"Int16"}],4),{members:CI}=OI;var Yp={exports:{}};function Lf(u,a,h){h=h||2;var p,_,w,T,k,M,P,F=a&&a.length,G=F?a[0]*h:u.length,X=e1(u,0,G,h,!0),ie=[];if(!X||X.next===X.prev)return ie;if(F&&(X=function(de,we,Ie,Ue){var Me,He,$e,wt=[];for(Me=0,He=we.length;Me<He;Me++)($e=e1(de,we[Me]*Ue,Me<He-1?we[Me+1]*Ue:de.length,Ue,!1))===$e.next&&($e.steiner=!0),wt.push(BI($e));for(wt.sort(PI),Me=0;Me<wt.length;Me++)Ie=NI(wt[Me],Ie);return Ie}(u,a,X,h)),u.length>80*h){p=w=u[0],_=T=u[1];for(var re=h;re<G;re+=h)(k=u[re])<p&&(p=k),(M=u[re+1])<_&&(_=M),k>w&&(w=k),M>T&&(T=M);P=(P=Math.max(w-p,T-_))!==0?32767/P:0}return rd(X,ie,h,p,_,P,0),ie}function e1(u,a,h,p,_){var w,T;if(_===Qp(u,a,h,p)>0)for(w=a;w<h;w+=p)T=n1(w,u[w],u[w+1],T);else for(w=h-p;w>=a;w-=p)T=n1(w,u[w],u[w+1],T);return T&&Pf(T,T.next)&&(ad(T),T=T.next),T}function Fc(u,a){if(!u)return u;a||(a=u);var h,p=u;do if(h=!1,p.steiner||!Pf(p,p.next)&&Lr(p.prev,p,p.next)!==0)p=p.next;else{if(ad(p),(p=a=p.prev)===p.next)break;h=!0}while(h||p!==a);return a}function rd(u,a,h,p,_,w,T){if(u){!T&&w&&function(F,G,X,ie){var re=F;do re.z===0&&(re.z=Jp(re.x,re.y,G,X,ie)),re.prevZ=re.prev,re.nextZ=re.next,re=re.next;while(re!==F);re.prevZ.nextZ=null,re.prevZ=null,function(de){var we,Ie,Ue,Me,He,$e,wt,ci,bi=1;do{for(Ie=de,de=null,He=null,$e=0;Ie;){for($e++,Ue=Ie,wt=0,we=0;we<bi&&(wt++,Ue=Ue.nextZ);we++);for(ci=bi;wt>0||ci>0&&Ue;)wt!==0&&(ci===0||!Ue||Ie.z<=Ue.z)?(Me=Ie,Ie=Ie.nextZ,wt--):(Me=Ue,Ue=Ue.nextZ,ci--),He?He.nextZ=Me:de=Me,Me.prevZ=He,He=Me;Ie=Ue}He.nextZ=null,bi*=2}while($e>1)}(re)}(u,p,_,w);for(var k,M,P=u;u.prev!==u.next;)if(k=u.prev,M=u.next,w?DI(u,p,_,w):MI(u))a.push(k.i/h|0),a.push(u.i/h|0),a.push(M.i/h|0),ad(u),u=M.next,P=M.next;else if((u=M)===P){T?T===1?rd(u=RI(Fc(u),a,h),a,h,p,_,w,2):T===2&&LI(u,a,h,p,_,w):rd(Fc(u),a,h,p,_,w,1);break}}}function MI(u){var a=u.prev,h=u,p=u.next;if(Lr(a,h,p)>=0)return!1;for(var _=a.x,w=h.x,T=p.x,k=a.y,M=h.y,P=p.y,F=_<w?_<T?_:T:w<T?w:T,G=k<M?k<P?k:P:M<P?M:P,X=_>w?_>T?_:T:w>T?w:T,ie=k>M?k>P?k:P:M>P?M:P,re=p.next;re!==a;){if(re.x>=F&&re.x<=X&&re.y>=G&&re.y<=ie&&Ru(_,k,w,M,T,P,re.x,re.y)&&Lr(re.prev,re,re.next)>=0)return!1;re=re.next}return!0}function DI(u,a,h,p){var _=u.prev,w=u,T=u.next;if(Lr(_,w,T)>=0)return!1;for(var k=_.x,M=w.x,P=T.x,F=_.y,G=w.y,X=T.y,ie=k<M?k<P?k:P:M<P?M:P,re=F<G?F<X?F:X:G<X?G:X,de=k>M?k>P?k:P:M>P?M:P,we=F>G?F>X?F:X:G>X?G:X,Ie=Jp(ie,re,a,h,p),Ue=Jp(de,we,a,h,p),Me=u.prevZ,He=u.nextZ;Me&&Me.z>=Ie&&He&&He.z<=Ue;){if(Me.x>=ie&&Me.x<=de&&Me.y>=re&&Me.y<=we&&Me!==_&&Me!==T&&Ru(k,F,M,G,P,X,Me.x,Me.y)&&Lr(Me.prev,Me,Me.next)>=0||(Me=Me.prevZ,He.x>=ie&&He.x<=de&&He.y>=re&&He.y<=we&&He!==_&&He!==T&&Ru(k,F,M,G,P,X,He.x,He.y)&&Lr(He.prev,He,He.next)>=0))return!1;He=He.nextZ}for(;Me&&Me.z>=Ie;){if(Me.x>=ie&&Me.x<=de&&Me.y>=re&&Me.y<=we&&Me!==_&&Me!==T&&Ru(k,F,M,G,P,X,Me.x,Me.y)&&Lr(Me.prev,Me,Me.next)>=0)return!1;Me=Me.prevZ}for(;He&&He.z<=Ue;){if(He.x>=ie&&He.x<=de&&He.y>=re&&He.y<=we&&He!==_&&He!==T&&Ru(k,F,M,G,P,X,He.x,He.y)&&Lr(He.prev,He,He.next)>=0)return!1;He=He.nextZ}return!0}function RI(u,a,h){var p=u;do{var _=p.prev,w=p.next.next;!Pf(_,w)&&t1(_,p,p.next,w)&&sd(_,w)&&sd(w,_)&&(a.push(_.i/h|0),a.push(p.i/h|0),a.push(w.i/h|0),ad(p),ad(p.next),p=u=w),p=p.next}while(p!==u);return Fc(p)}function LI(u,a,h,p,_,w){var T=u;do{for(var k=T.next.next;k!==T.prev;){if(T.i!==k.i&&VI(T,k)){var M=i1(T,k);return T=Fc(T,T.next),M=Fc(M,M.next),rd(T,a,h,p,_,w,0),void rd(M,a,h,p,_,w,0)}k=k.next}T=T.next}while(T!==u)}function PI(u,a){return u.x-a.x}function NI(u,a){var h=function(_,w){var T,k=w,M=_.x,P=_.y,F=-1/0;do{if(P<=k.y&&P>=k.next.y&&k.next.y!==k.y){var G=k.x+(P-k.y)*(k.next.x-k.x)/(k.next.y-k.y);if(G<=M&&G>F&&(F=G,T=k.x<k.next.x?k:k.next,G===M))return T}k=k.next}while(k!==w);if(!T)return null;var X,ie=T,re=T.x,de=T.y,we=1/0;k=T;do M>=k.x&&k.x>=re&&M!==k.x&&Ru(P<de?M:F,P,re,de,P<de?F:M,P,k.x,k.y)&&(X=Math.abs(P-k.y)/(M-k.x),sd(k,_)&&(X<we||X===we&&(k.x>T.x||k.x===T.x&&zI(T,k)))&&(T=k,we=X)),k=k.next;while(k!==ie);return T}(u,a);if(!h)return a;var p=i1(h,u);return Fc(p,p.next),Fc(h,h.next)}function zI(u,a){return Lr(u.prev,u,a.prev)<0&&Lr(a.next,u,u.next)<0}function Jp(u,a,h,p,_){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-h)*_|0)|u<<8))|u<<4))|u<<2))|u<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-p)*_|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function BI(u){var a=u,h=u;do(a.x<h.x||a.x===h.x&&a.y<h.y)&&(h=a),a=a.next;while(a!==u);return h}function Ru(u,a,h,p,_,w,T,k){return(_-T)*(a-k)>=(u-T)*(w-k)&&(u-T)*(p-k)>=(h-T)*(a-k)&&(h-T)*(w-k)>=(_-T)*(p-k)}function VI(u,a){return u.next.i!==a.i&&u.prev.i!==a.i&&!function(h,p){var _=h;do{if(_.i!==h.i&&_.next.i!==h.i&&_.i!==p.i&&_.next.i!==p.i&&t1(_,_.next,h,p))return!0;_=_.next}while(_!==h);return!1}(u,a)&&(sd(u,a)&&sd(a,u)&&function(h,p){var _=h,w=!1,T=(h.x+p.x)/2,k=(h.y+p.y)/2;do _.y>k!=_.next.y>k&&_.next.y!==_.y&&T<(_.next.x-_.x)*(k-_.y)/(_.next.y-_.y)+_.x&&(w=!w),_=_.next;while(_!==h);return w}(u,a)&&(Lr(u.prev,u,a.prev)||Lr(u,a.prev,a))||Pf(u,a)&&Lr(u.prev,u,u.next)>0&&Lr(a.prev,a,a.next)>0)}function Lr(u,a,h){return(a.y-u.y)*(h.x-a.x)-(a.x-u.x)*(h.y-a.y)}function Pf(u,a){return u.x===a.x&&u.y===a.y}function t1(u,a,h,p){var _=zf(Lr(u,a,h)),w=zf(Lr(u,a,p)),T=zf(Lr(h,p,u)),k=zf(Lr(h,p,a));return _!==w&&T!==k||!(_!==0||!Nf(u,h,a))||!(w!==0||!Nf(u,p,a))||!(T!==0||!Nf(h,u,p))||!(k!==0||!Nf(h,a,p))}function Nf(u,a,h){return a.x<=Math.max(u.x,h.x)&&a.x>=Math.min(u.x,h.x)&&a.y<=Math.max(u.y,h.y)&&a.y>=Math.min(u.y,h.y)}function zf(u){return u>0?1:u<0?-1:0}function sd(u,a){return Lr(u.prev,u,u.next)<0?Lr(u,a,u.next)>=0&&Lr(u,u.prev,a)>=0:Lr(u,a,u.prev)<0||Lr(u,u.next,a)<0}function i1(u,a){var h=new Xp(u.i,u.x,u.y),p=new Xp(a.i,a.x,a.y),_=u.next,w=a.prev;return u.next=a,a.prev=u,h.next=_,_.prev=h,p.next=h,h.prev=p,w.next=p,p.prev=w,p}function n1(u,a,h,p){var _=new Xp(u,a,h);return p?(_.next=p.next,_.prev=p,p.next.prev=_,p.next=_):(_.prev=_,_.next=_),_}function ad(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function Xp(u,a,h){this.i=u,this.x=a,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qp(u,a,h,p){for(var _=0,w=a,T=h-p;w<h;w+=p)_+=(u[T]-u[w])*(u[w+1]+u[T+1]),T=w;return _}Yp.exports=Lf,Yp.exports.default=Lf,Lf.deviation=function(u,a,h,p){var _=a&&a.length,w=Math.abs(Qp(u,0,_?a[0]*h:u.length,h));if(_)for(var T=0,k=a.length;T<k;T++)w-=Math.abs(Qp(u,a[T]*h,T<k-1?a[T+1]*h:u.length,h));var M=0;for(T=0;T<p.length;T+=3){var P=p[T]*h,F=p[T+1]*h,G=p[T+2]*h;M+=Math.abs((u[P]-u[G])*(u[F+1]-u[P+1])-(u[P]-u[F])*(u[G+1]-u[P+1]))}return w===0&&M===0?0:Math.abs((M-w)/w)},Lf.flatten=function(u){for(var a=u[0][0].length,h={vertices:[],holes:[],dimensions:a},p=0,_=0;_<u.length;_++){for(var w=0;w<u[_].length;w++)for(var T=0;T<a;T++)h.vertices.push(u[_][w][T]);_>0&&h.holes.push(p+=u[_-1].length)}return h};var r1=m(Yp.exports);function FI(u,a,h,p,_){s1(u,a,h||0,p||u.length-1,_||UI)}function s1(u,a,h,p,_){for(;p>h;){if(p-h>600){var w=p-h+1,T=a-h+1,k=Math.log(w),M=.5*Math.exp(2*k/3),P=.5*Math.sqrt(k*M*(w-M)/w)*(T-w/2<0?-1:1);s1(u,a,Math.max(h,Math.floor(a-T*M/w+P)),Math.min(p,Math.floor(a+(w-T)*M/w+P)),_)}var F=u[a],G=h,X=p;for(od(u,h,a),_(u[p],F)>0&&od(u,h,p);G<X;){for(od(u,G,X),G++,X--;_(u[G],F)<0;)G++;for(;_(u[X],F)>0;)X--}_(u[h],F)===0?od(u,h,X):od(u,++X,p),X<=a&&(h=X+1),a<=X&&(p=X-1)}}function od(u,a,h){var p=u[a];u[a]=u[h],u[h]=p}function UI(u,a){return u<a?-1:u>a?1:0}function $p(u,a){const h=u.length;if(h<=1)return[u];const p=[];let _,w;for(let T=0;T<h;T++){const k=We(u[T]);k!==0&&(u[T].area=Math.abs(k),w===void 0&&(w=k<0),w===k<0?(_&&p.push(_),_=[u[T]]):_.push(u[T]))}if(_&&p.push(_),a>1)for(let T=0;T<p.length;T++)p[T].length<=a||(FI(p[T],a,1,p[T].length-1,jI),p[T]=p[T].slice(0,a));return p}function jI(u,a){return a.area-u.area}function eg(u,a,h){const p=h.patternDependencies;let _=!1;for(const w of a){const T=w.paint.get(`${u}-pattern`);T.isConstant()||(_=!0);const k=T.constantOr(null);k&&(_=!0,p[k.to]=!0,p[k.from]=!0)}return _}function tg(u,a,h,p,_){const w=_.patternDependencies;for(const T of a){const k=T.paint.get(`${u}-pattern`).value;if(k.kind!=="constant"){let M=k.evaluate({zoom:p-1},h,{},_.availableImages),P=k.evaluate({zoom:p},h,{},_.availableImages),F=k.evaluate({zoom:p+1},h,{},_.availableImages);M=M&&M.name?M.name:M,P=P&&P.name?P.name:P,F=F&&F.name?F.name:F,w[M]=!0,w[P]=!0,w[F]=!0,h.patterns[T.id]={min:M,mid:P,max:F}}}return h}class ig{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new un,this.indexArray=new rs,this.indexArray2=new Hr,this.programConfigurations=new _o(a.layers,a.zoom),this.segments=new ar,this.segments2=new ar,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,p){this.hasPattern=eg("fill",this.layers,h);const _=this.layers[0].layout.get("fill-sort-key"),w=!_.isConstant(),T=[];for(const{feature:k,id:M,index:P,sourceLayerIndex:F}of a){const G=this.layers[0]._featureFilter.needGeometry,X=Vc(k,G);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),X,p))continue;const ie=w?_.evaluate(X,{},p,h.availableImages):void 0,re={id:M,properties:k.properties,type:k.type,sourceLayerIndex:F,index:P,geometry:G?X.geometry:Bc(k),patterns:{},sortKey:ie};T.push(re)}w&&T.sort((k,M)=>k.sortKey-M.sortKey);for(const k of T){const{geometry:M,index:P,sourceLayerIndex:F}=k;if(this.hasPattern){const G=tg("fill",this.layers,k,this.zoom,h);this.patternFeatures.push(G)}else this.addFeature(k,M,P,p,{});h.featureIndex.insert(a[P].feature,M,P,F,this.index)}}update(a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,p)}addFeatures(a,h,p){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,CI),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,h,p,_,w){for(const T of $p(h,500)){let k=0;for(const ie of T)k+=ie.length;const M=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),P=M.vertexLength,F=[],G=[];for(const ie of T){if(ie.length===0)continue;ie!==T[0]&&G.push(F.length/2);const re=this.segments2.prepareSegment(ie.length,this.layoutVertexArray,this.indexArray2),de=re.vertexLength;this.layoutVertexArray.emplaceBack(ie[0].x,ie[0].y),this.indexArray2.emplaceBack(de+ie.length-1,de),F.push(ie[0].x),F.push(ie[0].y);for(let we=1;we<ie.length;we++)this.layoutVertexArray.emplaceBack(ie[we].x,ie[we].y),this.indexArray2.emplaceBack(de+we-1,de+we),F.push(ie[we].x),F.push(ie[we].y);re.vertexLength+=ie.length,re.primitiveLength+=ie.length}const X=r1(F,G);for(let ie=0;ie<X.length;ie+=3)this.indexArray.emplaceBack(P+X[ie],P+X[ie+1],P+X[ie+2]);M.vertexLength+=k,M.primitiveLength+=X.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,w,_)}}let a1,o1;ri("FillBucket",ig,{omit:["layers","patternFeatures"]});var GI={get paint(){return o1=o1||new Dr({"fill-antialias":new Ii(Xe.paint_fill["fill-antialias"]),"fill-opacity":new Vi(Xe.paint_fill["fill-opacity"]),"fill-color":new Vi(Xe.paint_fill["fill-color"]),"fill-outline-color":new Vi(Xe.paint_fill["fill-outline-color"]),"fill-translate":new Ii(Xe.paint_fill["fill-translate"]),"fill-translate-anchor":new Ii(Xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Pc(Xe.paint_fill["fill-pattern"])})},get layout(){return a1=a1||new Dr({"fill-sort-key":new Vi(Xe.layout_fill["fill-sort-key"])})}};class HI extends pa{constructor(a){super(a,GI)}recalculate(a,h){super.recalculate(a,h);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new ig(a)}queryRadius(){return Mf(this.paint.get("fill-translate"))}queryIntersectsFeature(a,h,p,_,w,T,k){return jy(Df(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),T.angle,k),_)}isTileClipped(){return!0}}const KI=pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),qI=pr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ZI}=KI;var dc={},WI=y,l1=Lu;function Lu(u,a,h,p,_){this.properties={},this.extent=h,this.type=0,this._pbf=u,this._geometry=-1,this._keys=p,this._values=_,u.readFields(YI,this,a)}function YI(u,a,h){u==1?a.id=h.readVarint():u==2?function(p,_){for(var w=p.readVarint()+p.pos;p.pos<w;){var T=_._keys[p.readVarint()],k=_._values[p.readVarint()];_.properties[T]=k}}(h,a):u==3?a.type=h.readVarint():u==4&&(a._geometry=h.pos)}function JI(u){for(var a,h,p=0,_=0,w=u.length,T=w-1;_<w;T=_++)p+=((h=u[T]).x-(a=u[_]).x)*(a.y+h.y);return p}Lu.types=["Unknown","Point","LineString","Polygon"],Lu.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var a,h=u.readVarint()+u.pos,p=1,_=0,w=0,T=0,k=[];u.pos<h;){if(_<=0){var M=u.readVarint();p=7&M,_=M>>3}if(_--,p===1||p===2)w+=u.readSVarint(),T+=u.readSVarint(),p===1&&(a&&k.push(a),a=[]),a.push(new WI(w,T));else{if(p!==7)throw new Error("unknown command "+p);a&&a.push(a[0].clone())}}return a&&k.push(a),k},Lu.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var a=u.readVarint()+u.pos,h=1,p=0,_=0,w=0,T=1/0,k=-1/0,M=1/0,P=-1/0;u.pos<a;){if(p<=0){var F=u.readVarint();h=7&F,p=F>>3}if(p--,h===1||h===2)(_+=u.readSVarint())<T&&(T=_),_>k&&(k=_),(w+=u.readSVarint())<M&&(M=w),w>P&&(P=w);else if(h!==7)throw new Error("unknown command "+h)}return[T,M,k,P]},Lu.prototype.toGeoJSON=function(u,a,h){var p,_,w=this.extent*Math.pow(2,h),T=this.extent*u,k=this.extent*a,M=this.loadGeometry(),P=Lu.types[this.type];function F(ie){for(var re=0;re<ie.length;re++){var de=ie[re];ie[re]=[360*(de.x+T)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(de.y+k)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(p=0;p<M.length;p++)G[p]=M[p][0];F(M=G);break;case 2:for(p=0;p<M.length;p++)F(M[p]);break;case 3:for(M=function(ie){var re=ie.length;if(re<=1)return[ie];for(var de,we,Ie=[],Ue=0;Ue<re;Ue++){var Me=JI(ie[Ue]);Me!==0&&(we===void 0&&(we=Me<0),we===Me<0?(de&&Ie.push(de),de=[ie[Ue]]):de.push(ie[Ue]))}return de&&Ie.push(de),Ie}(M),p=0;p<M.length;p++)for(_=0;_<M[p].length;_++)F(M[p][_])}M.length===1?M=M[0]:P="Multi"+P;var X={type:"Feature",geometry:{type:P,coordinates:M},properties:this.properties};return"id"in this&&(X.id=this.id),X};var XI=l1,c1=u1;function u1(u,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(QI,this,a),this.length=this._features.length}function QI(u,a,h){u===15?a.version=h.readVarint():u===1?a.name=h.readString():u===5?a.extent=h.readVarint():u===2?a._features.push(h.pos):u===3?a._keys.push(h.readString()):u===4&&a._values.push(function(p){for(var _=null,w=p.readVarint()+p.pos;p.pos<w;){var T=p.readVarint()>>3;_=T===1?p.readString():T===2?p.readFloat():T===3?p.readDouble():T===4?p.readVarint64():T===5?p.readVarint():T===6?p.readSVarint():T===7?p.readBoolean():null}return _}(h))}u1.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var a=this._pbf.readVarint()+this._pbf.pos;return new XI(this._pbf,a,this.extent,this._keys,this._values)};var $I=c1;function ek(u,a,h){if(u===3){var p=new $I(h,h.readVarint()+h.pos);p.length&&(a[p.name]=p)}}dc.VectorTile=function(u,a){this.layers=u.readFields(ek,{},a)},dc.VectorTileFeature=l1,dc.VectorTileLayer=c1;const tk=dc.VectorTileFeature.types,ng=Math.pow(2,13);function ld(u,a,h,p,_,w,T,k){u.emplaceBack(a,h,2*Math.floor(p*ng)+T,_*ng*2,w*ng*2,Math.round(k))}class rg{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new ei,this.centroidVertexArray=new qt,this.indexArray=new rs,this.programConfigurations=new _o(a.layers,a.zoom),this.segments=new ar,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,p){this.features=[],this.hasPattern=eg("fill-extrusion",this.layers,h);for(const{feature:_,id:w,index:T,sourceLayerIndex:k}of a){const M=this.layers[0]._featureFilter.needGeometry,P=Vc(_,M);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),P,p))continue;const F={id:w,sourceLayerIndex:k,index:T,geometry:M?P.geometry:Bc(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(tg("fill-extrusion",this.layers,F,this.zoom,h)):this.addFeature(F,F.geometry,T,p,{}),h.featureIndex.insert(_,F.geometry,T,k,this.index,!0)}}addFeatures(a,h,p){for(const _ of this.features){const{geometry:w}=_;this.addFeature(_,w,_.index,h,p)}}update(a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,ZI),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,qI.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,h,p,_,w){const T={x:0,y:0,vertexCount:0};for(const k of $p(h,500)){let M=0;for(const re of k)M+=re.length;let P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const re of k){if(re.length===0||nk(re))continue;let de=0;for(let we=0;we<re.length;we++){const Ie=re[we];if(we>=1){const Ue=re[we-1];if(!ik(Ie,Ue)){P.vertexLength+4>ar.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Me=Ie.sub(Ue)._perp()._unit(),He=Ue.dist(Ie);de+He>32768&&(de=0),ld(this.layoutVertexArray,Ie.x,Ie.y,Me.x,Me.y,0,0,de),ld(this.layoutVertexArray,Ie.x,Ie.y,Me.x,Me.y,0,1,de),T.x+=2*Ie.x,T.y+=2*Ie.y,T.vertexCount+=2,de+=He,ld(this.layoutVertexArray,Ue.x,Ue.y,Me.x,Me.y,0,0,de),ld(this.layoutVertexArray,Ue.x,Ue.y,Me.x,Me.y,0,1,de),T.x+=2*Ue.x,T.y+=2*Ue.y,T.vertexCount+=2;const $e=P.vertexLength;this.indexArray.emplaceBack($e,$e+2,$e+1),this.indexArray.emplaceBack($e+1,$e+2,$e+3),P.vertexLength+=4,P.primitiveLength+=2}}}}if(P.vertexLength+M>ar.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(M,this.layoutVertexArray,this.indexArray)),tk[a.type]!=="Polygon")continue;const F=[],G=[],X=P.vertexLength;for(const re of k)if(re.length!==0){re!==k[0]&&G.push(F.length/2);for(let de=0;de<re.length;de++){const we=re[de];ld(this.layoutVertexArray,we.x,we.y,0,0,1,1,0),T.x+=we.x,T.y+=we.y,T.vertexCount+=1,F.push(we.x),F.push(we.y)}}const ie=r1(F,G);for(let re=0;re<ie.length;re+=3)this.indexArray.emplaceBack(X+ie[re],X+ie[re+2],X+ie[re+1]);P.primitiveLength+=ie.length/3,P.vertexLength+=M}for(let k=0;k<T.vertexCount;k++)this.centroidVertexArray.emplaceBack(Math.floor(T.x/T.vertexCount),Math.floor(T.y/T.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,w,_)}}function ik(u,a){return u.x===a.x&&(u.x<0||u.x>Vr)||u.y===a.y&&(u.y<0||u.y>Vr)}function nk(u){return u.every(a=>a.x<0)||u.every(a=>a.x>Vr)||u.every(a=>a.y<0)||u.every(a=>a.y>Vr)}let h1;ri("FillExtrusionBucket",rg,{omit:["layers","features"]});var rk={get paint(){return h1=h1||new Dr({"fill-extrusion-opacity":new Ii(Xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Vi(Xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ii(Xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ii(Xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Pc(Xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Vi(Xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Vi(Xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ii(Xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class sk extends pa{constructor(a){super(a,rk)}createBucket(a){return new rg(a)}queryRadius(){return Mf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(a,h,p,_,w,T,k,M){const P=Df(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),T.angle,k),F=this.paint.get("fill-extrusion-height").evaluate(h,p),G=this.paint.get("fill-extrusion-base").evaluate(h,p),X=function(re,de,we,Ie){const Ue=[];for(const Me of re){const He=[Me.x,Me.y,0,1];Rf(He,He,de),Ue.push(new E(He[0]/He[3],He[1]/He[3]))}return Ue}(P,M),ie=function(re,de,we,Ie){const Ue=[],Me=[],He=Ie[8]*de,$e=Ie[9]*de,wt=Ie[10]*de,ci=Ie[11]*de,bi=Ie[8]*we,li=Ie[9]*we,ti=Ie[10]*we,Zt=Ie[11]*we;for(const pi of re){const Yt=[],jt=[];for(const Li of pi){const Ti=Li.x,an=Li.y,or=Ie[0]*Ti+Ie[4]*an+Ie[12],fr=Ie[1]*Ti+Ie[5]*an+Ie[13],Zr=Ie[2]*Ti+Ie[6]*an+Ie[14],_a=Ie[3]*Ti+Ie[7]*an+Ie[15],Ns=Zr+wt,Fr=_a+ci,as=or+bi,gs=fr+li,zs=Zr+ti,Bs=_a+Zt,Wr=new E((or+He)/Fr,(fr+$e)/Fr);Wr.z=Ns/Fr,Yt.push(Wr);const Yr=new E(as/Bs,gs/Bs);Yr.z=zs/Bs,jt.push(Yr)}Ue.push(Yt),Me.push(jt)}return[Ue,Me]}(_,G,F,M);return function(re,de,we){let Ie=1/0;jy(we,de)&&(Ie=d1(we,de[0]));for(let Ue=0;Ue<de.length;Ue++){const Me=de[Ue],He=re[Ue];for(let $e=0;$e<Me.length-1;$e++){const wt=Me[$e],ci=[wt,Me[$e+1],He[$e+1],He[$e],wt];Uy(we,ci)&&(Ie=Math.min(Ie,d1(we,ci)))}}return Ie!==1/0&&Ie}(ie[0],ie[1],X)}}function cd(u,a){return u.x*a.x+u.y*a.y}function d1(u,a){if(u.length===1){let h=0;const p=a[h++];let _;for(;!_||p.equals(_);)if(_=a[h++],!_)return 1/0;for(;h<a.length;h++){const w=a[h],T=u[0],k=_.sub(p),M=w.sub(p),P=T.sub(p),F=cd(k,k),G=cd(k,M),X=cd(M,M),ie=cd(P,k),re=cd(P,M),de=F*X-G*G,we=(X*ie-G*re)/de,Ie=(F*re-G*ie)/de,Ue=p.z*(1-we-Ie)+_.z*we+w.z*Ie;if(isFinite(Ue))return Ue}return 1/0}{let h=1/0;for(const p of a)h=Math.min(h,p.z);return h}}const ak=pr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:ok}=ak,lk=pr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:ck}=lk,uk=dc.VectorTileFeature.types,hk=Math.cos(Math.PI/180*37.5),f1=Math.pow(2,14)/.5;class sg{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new Fi,this.layoutVertexArray2=new wi,this.indexArray=new rs,this.programConfigurations=new _o(a.layers,a.zoom),this.segments=new ar,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,p){this.hasPattern=eg("line",this.layers,h);const _=this.layers[0].layout.get("line-sort-key"),w=!_.isConstant(),T=[];for(const{feature:k,id:M,index:P,sourceLayerIndex:F}of a){const G=this.layers[0]._featureFilter.needGeometry,X=Vc(k,G);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),X,p))continue;const ie=w?_.evaluate(X,{},p):void 0,re={id:M,properties:k.properties,type:k.type,sourceLayerIndex:F,index:P,geometry:G?X.geometry:Bc(k),patterns:{},sortKey:ie};T.push(re)}w&&T.sort((k,M)=>k.sortKey-M.sortKey);for(const k of T){const{geometry:M,index:P,sourceLayerIndex:F}=k;if(this.hasPattern){const G=tg("line",this.layers,k,this.zoom,h);this.patternFeatures.push(G)}else this.addFeature(k,M,P,p,{});h.featureIndex.insert(a[P].feature,M,P,F,this.index)}}update(a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,p)}addFeatures(a,h,p){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,ck)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,ok),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,h,p,_,w){const T=this.layers[0].layout,k=T.get("line-join").evaluate(a,{}),M=T.get("line-cap"),P=T.get("line-miter-limit"),F=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const G of h)this.addLine(G,a,k,M,P,F);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,w,_)}addLine(a,h,p,_,w,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ie=0;Ie<a.length-1;Ie++)this.totalDistance+=a[Ie].dist(a[Ie+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const k=uk[h.type]==="Polygon";let M=a.length;for(;M>=2&&a[M-1].equals(a[M-2]);)M--;let P=0;for(;P<M-1&&a[P].equals(a[P+1]);)P++;if(M<(k?3:2))return;p==="bevel"&&(w=1.05);const F=this.overscaling<=16?15*Vr/(512*this.overscaling):0,G=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let X,ie,re,de,we;this.e1=this.e2=-1,k&&(X=a[M-2],we=a[P].sub(X)._unit()._perp());for(let Ie=P;Ie<M;Ie++){if(re=Ie===M-1?k?a[P+1]:void 0:a[Ie+1],re&&a[Ie].equals(re))continue;we&&(de=we),X&&(ie=X),X=a[Ie],we=re?re.sub(X)._unit()._perp():de,de=de||we;let Ue=de.add(we);Ue.x===0&&Ue.y===0||Ue._unit();const Me=de.x*we.x+de.y*we.y,He=Ue.x*we.x+Ue.y*we.y,$e=He!==0?1/He:1/0,wt=2*Math.sqrt(2-2*He),ci=He<hk&&ie&&re,bi=de.x*we.y-de.y*we.x>0;if(ci&&Ie>P){const Zt=X.dist(ie);if(Zt>2*F){const pi=X.sub(X.sub(ie)._mult(F/Zt)._round());this.updateDistance(ie,pi),this.addCurrentVertex(pi,de,0,0,G),ie=pi}}const li=ie&&re;let ti=li?p:k?"butt":_;if(li&&ti==="round"&&($e<T?ti="miter":$e<=2&&(ti="fakeround")),ti==="miter"&&$e>w&&(ti="bevel"),ti==="bevel"&&($e>2&&(ti="flipbevel"),$e<w&&(ti="miter")),ie&&this.updateDistance(ie,X),ti==="miter")Ue._mult($e),this.addCurrentVertex(X,Ue,0,0,G);else if(ti==="flipbevel"){if($e>100)Ue=we.mult(-1);else{const Zt=$e*de.add(we).mag()/de.sub(we).mag();Ue._perp()._mult(Zt*(bi?-1:1))}this.addCurrentVertex(X,Ue,0,0,G),this.addCurrentVertex(X,Ue.mult(-1),0,0,G)}else if(ti==="bevel"||ti==="fakeround"){const Zt=-Math.sqrt($e*$e-1),pi=bi?Zt:0,Yt=bi?0:Zt;if(ie&&this.addCurrentVertex(X,de,pi,Yt,G),ti==="fakeround"){const jt=Math.round(180*wt/Math.PI/20);for(let Li=1;Li<jt;Li++){let Ti=Li/jt;if(Ti!==.5){const or=Ti-.5;Ti+=Ti*or*(Ti-1)*((1.0904+Me*(Me*(3.55645-1.43519*Me)-3.2452))*or*or+(.848013+Me*(.215638*Me-1.06021)))}const an=we.sub(de)._mult(Ti)._add(de)._unit()._mult(bi?-1:1);this.addHalfVertex(X,an.x,an.y,!1,bi,0,G)}}re&&this.addCurrentVertex(X,we,-pi,-Yt,G)}else if(ti==="butt")this.addCurrentVertex(X,Ue,0,0,G);else if(ti==="square"){const Zt=ie?1:-1;this.addCurrentVertex(X,Ue,Zt,Zt,G)}else ti==="round"&&(ie&&(this.addCurrentVertex(X,de,0,0,G),this.addCurrentVertex(X,de,1,1,G,!0)),re&&(this.addCurrentVertex(X,we,-1,-1,G,!0),this.addCurrentVertex(X,we,0,0,G)));if(ci&&Ie<M-1){const Zt=X.dist(re);if(Zt>2*F){const pi=X.add(re.sub(X)._mult(F/Zt)._round());this.updateDistance(X,pi),this.addCurrentVertex(pi,we,0,0,G),X=pi}}}}addCurrentVertex(a,h,p,_,w,T=!1){const k=h.y*_-h.x,M=-h.y-h.x*_;this.addHalfVertex(a,h.x+h.y*p,h.y-h.x*p,T,!1,p,w),this.addHalfVertex(a,k,M,T,!0,-_,w),this.distance>f1/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(a,h,p,_,w,T))}addHalfVertex({x:a,y:h},p,_,w,T,k,M){const P=.5*(this.lineClips?this.scaledDistance*(f1-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(w?1:0),(h<<1)+(T?1:0),Math.round(63*p)+128,Math.round(63*_)+128,1+(k===0?0:k<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const F=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,F),M.primitiveLength++),T?this.e2=F:this.e1=F}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,h){this.distance+=a.dist(h),this.updateScaledDistance()}}let m1,p1;ri("LineBucket",sg,{omit:["layers","patternFeatures"]});var g1={get paint(){return p1=p1||new Dr({"line-opacity":new Vi(Xe.paint_line["line-opacity"]),"line-color":new Vi(Xe.paint_line["line-color"]),"line-translate":new Ii(Xe.paint_line["line-translate"]),"line-translate-anchor":new Ii(Xe.paint_line["line-translate-anchor"]),"line-width":new Vi(Xe.paint_line["line-width"]),"line-gap-width":new Vi(Xe.paint_line["line-gap-width"]),"line-offset":new Vi(Xe.paint_line["line-offset"]),"line-blur":new Vi(Xe.paint_line["line-blur"]),"line-dasharray":new qh(Xe.paint_line["line-dasharray"]),"line-pattern":new Pc(Xe.paint_line["line-pattern"]),"line-gradient":new Zh(Xe.paint_line["line-gradient"])})},get layout(){return m1=m1||new Dr({"line-cap":new Ii(Xe.layout_line["line-cap"]),"line-join":new Vi(Xe.layout_line["line-join"]),"line-miter-limit":new Ii(Xe.layout_line["line-miter-limit"]),"line-round-limit":new Ii(Xe.layout_line["line-round-limit"]),"line-sort-key":new Vi(Xe.layout_line["line-sort-key"])})}};class dk extends Vi{possiblyEvaluate(a,h){return h=new sr(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(a,h)}evaluate(a,h,p,_){return h=ve({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(a,h,p,_)}}let Bf;class fk extends pa{constructor(a){super(a,g1),this.gradientVersion=0,Bf||(Bf=new dk(g1.paint.properties["line-width"].specification),Bf.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(p){return p._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof Ea,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,h){super.recalculate(a,h),this.paint._values["line-floorwidth"]=Bf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new sg(a)}queryRadius(a){const h=a,p=_1(td("line-width",this,h),td("line-gap-width",this,h)),_=td("line-offset",this,h);return p/2+Math.abs(_)+Mf(this.paint.get("line-translate"))}queryIntersectsFeature(a,h,p,_,w,T,k){const M=Df(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),T.angle,k),P=k/2*_1(this.paint.get("line-width").evaluate(h,p),this.paint.get("line-gap-width").evaluate(h,p)),F=this.paint.get("line-offset").evaluate(h,p);return F&&(_=function(G,X){const ie=[];for(let re=0;re<G.length;re++){const de=G[re],we=[];for(let Ie=0;Ie<de.length;Ie++){const Ue=de[Ie-1],Me=de[Ie],He=de[Ie+1],$e=Ie===0?new E(0,0):Me.sub(Ue)._unit()._perp(),wt=Ie===de.length-1?new E(0,0):He.sub(Me)._unit()._perp(),ci=$e._add(wt)._unit(),bi=ci.x*wt.x+ci.y*wt.y;bi!==0&&ci._mult(1/bi),we.push(ci._mult(X)._add(Me))}ie.push(we)}return ie}(_,F*k)),function(G,X,ie){for(let re=0;re<X.length;re++){const de=X[re];if(G.length>=3){for(let we=0;we<de.length;we++)if(Mu(G,de[we]))return!0}if(vI(G,de,ie))return!0}return!1}(M,_,P)}isTileClipped(){return!0}}function _1(u,a){return a>0?a+2*u:u}const mk=pr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),pk=pr([{name:"a_projected_pos",components:3,type:"Float32"}],4);pr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const gk=pr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);pr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const y1=pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),_k=pr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function yk(u,a,h){return u.sections.forEach(p=>{p.text=function(_,w,T){const k=w.layout.get("text-transform").evaluate(T,{});return k==="uppercase"?_=_.toLocaleUpperCase():k==="lowercase"&&(_=_.toLocaleLowerCase()),ea.applyArabicShaping&&(_=ea.applyArabicShaping(_)),_}(p.text,a,h)}),u}pr([{name:"triangle",components:3,type:"Uint16"}]),pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),pr([{type:"Float32",name:"offsetX"}]),pr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),pr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const ud={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var qr=24,v1=Fn,b1=function(u,a,h,p,_){var w,T,k=8*_-p-1,M=(1<<k)-1,P=M>>1,F=-7,G=h?_-1:0,X=h?-1:1,ie=u[a+G];for(G+=X,w=ie&(1<<-F)-1,ie>>=-F,F+=k;F>0;w=256*w+u[a+G],G+=X,F-=8);for(T=w&(1<<-F)-1,w>>=-F,F+=p;F>0;T=256*T+u[a+G],G+=X,F-=8);if(w===0)w=1-P;else{if(w===M)return T?NaN:1/0*(ie?-1:1);T+=Math.pow(2,p),w-=P}return(ie?-1:1)*T*Math.pow(2,w-p)},x1=function(u,a,h,p,_,w){var T,k,M,P=8*w-_-1,F=(1<<P)-1,G=F>>1,X=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,ie=p?0:w-1,re=p?1:-1,de=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(k=isNaN(a)?1:0,T=F):(T=Math.floor(Math.log(a)/Math.LN2),a*(M=Math.pow(2,-T))<1&&(T--,M*=2),(a+=T+G>=1?X/M:X*Math.pow(2,1-G))*M>=2&&(T++,M/=2),T+G>=F?(k=0,T=F):T+G>=1?(k=(a*M-1)*Math.pow(2,_),T+=G):(k=a*Math.pow(2,G-1)*Math.pow(2,_),T=0));_>=8;u[h+ie]=255&k,ie+=re,k/=256,_-=8);for(T=T<<_|k,P+=_;P>0;u[h+ie]=255&T,ie+=re,T/=256,P-=8);u[h+ie-re]|=128*de};function Fn(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Fn.Varint=0,Fn.Fixed64=1,Fn.Bytes=2,Fn.Fixed32=5;var ag=4294967296,w1=1/ag,A1=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function bl(u){return u.type===Fn.Bytes?u.readVarint()+u.pos:u.pos+1}function Pu(u,a,h){return h?4294967296*a+(u>>>0):4294967296*(a>>>0)+(u>>>0)}function E1(u,a,h){var p=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));h.realloc(p);for(var _=h.pos-1;_>=u;_--)h.buf[_+p]=h.buf[_]}function vk(u,a){for(var h=0;h<u.length;h++)a.writeVarint(u[h])}function bk(u,a){for(var h=0;h<u.length;h++)a.writeSVarint(u[h])}function xk(u,a){for(var h=0;h<u.length;h++)a.writeFloat(u[h])}function wk(u,a){for(var h=0;h<u.length;h++)a.writeDouble(u[h])}function Ak(u,a){for(var h=0;h<u.length;h++)a.writeBoolean(u[h])}function Ek(u,a){for(var h=0;h<u.length;h++)a.writeFixed32(u[h])}function Tk(u,a){for(var h=0;h<u.length;h++)a.writeSFixed32(u[h])}function Sk(u,a){for(var h=0;h<u.length;h++)a.writeFixed64(u[h])}function Ik(u,a){for(var h=0;h<u.length;h++)a.writeSFixed64(u[h])}function Vf(u,a){return(u[a]|u[a+1]<<8|u[a+2]<<16)+16777216*u[a+3]}function Nu(u,a,h){u[h]=a,u[h+1]=a>>>8,u[h+2]=a>>>16,u[h+3]=a>>>24}function T1(u,a){return(u[a]|u[a+1]<<8|u[a+2]<<16)+(u[a+3]<<24)}Fn.prototype={destroy:function(){this.buf=null},readFields:function(u,a,h){for(h=h||this.length;this.pos<h;){var p=this.readVarint(),_=p>>3,w=this.pos;this.type=7&p,u(_,a,this),this.pos===w&&this.skip(p)}return a},readMessage:function(u,a){return this.readFields(u,a,this.readVarint()+this.pos)},readFixed32:function(){var u=Vf(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=T1(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=Vf(this.buf,this.pos)+Vf(this.buf,this.pos+4)*ag;return this.pos+=8,u},readSFixed64:function(){var u=Vf(this.buf,this.pos)+T1(this.buf,this.pos+4)*ag;return this.pos+=8,u},readFloat:function(){var u=b1(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=b1(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var a,h,p=this.buf;return a=127&(h=p[this.pos++]),h<128?a:(a|=(127&(h=p[this.pos++]))<<7,h<128?a:(a|=(127&(h=p[this.pos++]))<<14,h<128?a:(a|=(127&(h=p[this.pos++]))<<21,h<128?a:function(_,w,T){var k,M,P=T.buf;if(k=(112&(M=P[T.pos++]))>>4,M<128||(k|=(127&(M=P[T.pos++]))<<3,M<128)||(k|=(127&(M=P[T.pos++]))<<10,M<128)||(k|=(127&(M=P[T.pos++]))<<17,M<128)||(k|=(127&(M=P[T.pos++]))<<24,M<128)||(k|=(1&(M=P[T.pos++]))<<31,M<128))return Pu(_,k,w);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(h=p[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,a=this.pos;return this.pos=u,u-a>=12&&A1?function(h,p,_){return A1.decode(h.subarray(p,_))}(this.buf,a,u):function(h,p,_){for(var w="",T=p;T<_;){var k,M,P,F=h[T],G=null,X=F>239?4:F>223?3:F>191?2:1;if(T+X>_)break;X===1?F<128&&(G=F):X===2?(192&(k=h[T+1]))==128&&(G=(31&F)<<6|63&k)<=127&&(G=null):X===3?(M=h[T+2],(192&(k=h[T+1]))==128&&(192&M)==128&&((G=(15&F)<<12|(63&k)<<6|63&M)<=2047||G>=55296&&G<=57343)&&(G=null)):X===4&&(M=h[T+2],P=h[T+3],(192&(k=h[T+1]))==128&&(192&M)==128&&(192&P)==128&&((G=(15&F)<<18|(63&k)<<12|(63&M)<<6|63&P)<=65535||G>=1114112)&&(G=null)),G===null?(G=65533,X=1):G>65535&&(G-=65536,w+=String.fromCharCode(G>>>10&1023|55296),G=56320|1023&G),w+=String.fromCharCode(G),T+=X}return w}(this.buf,a,u)},readBytes:function(){var u=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,u);return this.pos=u,a},readPackedVarint:function(u,a){if(this.type!==Fn.Bytes)return u.push(this.readVarint(a));var h=bl(this);for(u=u||[];this.pos<h;)u.push(this.readVarint(a));return u},readPackedSVarint:function(u){if(this.type!==Fn.Bytes)return u.push(this.readSVarint());var a=bl(this);for(u=u||[];this.pos<a;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Fn.Bytes)return u.push(this.readBoolean());var a=bl(this);for(u=u||[];this.pos<a;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Fn.Bytes)return u.push(this.readFloat());var a=bl(this);for(u=u||[];this.pos<a;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Fn.Bytes)return u.push(this.readDouble());var a=bl(this);for(u=u||[];this.pos<a;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Fn.Bytes)return u.push(this.readFixed32());var a=bl(this);for(u=u||[];this.pos<a;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Fn.Bytes)return u.push(this.readSFixed32());var a=bl(this);for(u=u||[];this.pos<a;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Fn.Bytes)return u.push(this.readFixed64());var a=bl(this);for(u=u||[];this.pos<a;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Fn.Bytes)return u.push(this.readSFixed64());var a=bl(this);for(u=u||[];this.pos<a;)u.push(this.readSFixed64());return u},skip:function(u){var a=7&u;if(a===Fn.Varint)for(;this.buf[this.pos++]>127;);else if(a===Fn.Bytes)this.pos=this.readVarint()+this.pos;else if(a===Fn.Fixed32)this.pos+=4;else{if(a!==Fn.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(u,a){this.writeVarint(u<<3|a)},realloc:function(u){for(var a=this.length||16;a<this.pos+u;)a*=2;if(a!==this.length){var h=new Uint8Array(a);h.set(this.buf),this.buf=h,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),Nu(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),Nu(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),Nu(this.buf,-1&u,this.pos),Nu(this.buf,Math.floor(u*w1),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),Nu(this.buf,-1&u,this.pos),Nu(this.buf,Math.floor(u*w1),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(a,h){var p,_;if(a>=0?(p=a%4294967296|0,_=a/4294967296|0):(_=~(-a/4294967296),4294967295^(p=~(-a%4294967296))?p=p+1|0:(p=0,_=_+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(w,T,k){k.buf[k.pos++]=127&w|128,w>>>=7,k.buf[k.pos++]=127&w|128,w>>>=7,k.buf[k.pos++]=127&w|128,w>>>=7,k.buf[k.pos++]=127&w|128,k.buf[k.pos]=127&(w>>>=7)}(p,0,h),function(w,T){var k=(7&w)<<4;T.buf[T.pos++]|=k|((w>>>=3)?128:0),w&&(T.buf[T.pos++]=127&w|((w>>>=7)?128:0),w&&(T.buf[T.pos++]=127&w|((w>>>=7)?128:0),w&&(T.buf[T.pos++]=127&w|((w>>>=7)?128:0),w&&(T.buf[T.pos++]=127&w|((w>>>=7)?128:0),w&&(T.buf[T.pos++]=127&w)))))}(_,h)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var a=this.pos;this.pos=function(p,_,w){for(var T,k,M=0;M<_.length;M++){if((T=_.charCodeAt(M))>55295&&T<57344){if(!k){T>56319||M+1===_.length?(p[w++]=239,p[w++]=191,p[w++]=189):k=T;continue}if(T<56320){p[w++]=239,p[w++]=191,p[w++]=189,k=T;continue}T=k-55296<<10|T-56320|65536,k=null}else k&&(p[w++]=239,p[w++]=191,p[w++]=189,k=null);T<128?p[w++]=T:(T<2048?p[w++]=T>>6|192:(T<65536?p[w++]=T>>12|224:(p[w++]=T>>18|240,p[w++]=T>>12&63|128),p[w++]=T>>6&63|128),p[w++]=63&T|128)}return w}(this.buf,u,this.pos);var h=this.pos-a;h>=128&&E1(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeFloat:function(u){this.realloc(4),x1(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),x1(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var a=u.length;this.writeVarint(a),this.realloc(a);for(var h=0;h<a;h++)this.buf[this.pos++]=u[h]},writeRawMessage:function(u,a){this.pos++;var h=this.pos;u(a,this);var p=this.pos-h;p>=128&&E1(h,p,this),this.pos=h-1,this.writeVarint(p),this.pos+=p},writeMessage:function(u,a,h){this.writeTag(u,Fn.Bytes),this.writeRawMessage(a,h)},writePackedVarint:function(u,a){a.length&&this.writeMessage(u,vk,a)},writePackedSVarint:function(u,a){a.length&&this.writeMessage(u,bk,a)},writePackedBoolean:function(u,a){a.length&&this.writeMessage(u,Ak,a)},writePackedFloat:function(u,a){a.length&&this.writeMessage(u,xk,a)},writePackedDouble:function(u,a){a.length&&this.writeMessage(u,wk,a)},writePackedFixed32:function(u,a){a.length&&this.writeMessage(u,Ek,a)},writePackedSFixed32:function(u,a){a.length&&this.writeMessage(u,Tk,a)},writePackedFixed64:function(u,a){a.length&&this.writeMessage(u,Sk,a)},writePackedSFixed64:function(u,a){a.length&&this.writeMessage(u,Ik,a)},writeBytesField:function(u,a){this.writeTag(u,Fn.Bytes),this.writeBytes(a)},writeFixed32Field:function(u,a){this.writeTag(u,Fn.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(u,a){this.writeTag(u,Fn.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(u,a){this.writeTag(u,Fn.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(u,a){this.writeTag(u,Fn.Fixed64),this.writeSFixed64(a)},writeVarintField:function(u,a){this.writeTag(u,Fn.Varint),this.writeVarint(a)},writeSVarintField:function(u,a){this.writeTag(u,Fn.Varint),this.writeSVarint(a)},writeStringField:function(u,a){this.writeTag(u,Fn.Bytes),this.writeString(a)},writeFloatField:function(u,a){this.writeTag(u,Fn.Fixed32),this.writeFloat(a)},writeDoubleField:function(u,a){this.writeTag(u,Fn.Fixed64),this.writeDouble(a)},writeBooleanField:function(u,a){this.writeVarintField(u,!!a)}};var og=m(v1);const lg=3;function kk(u,a,h){u===1&&h.readMessage(Ok,a)}function Ok(u,a,h){if(u===3){const{id:p,bitmap:_,width:w,height:T,left:k,top:M,advance:P}=h.readMessage(Ck,{});a.push({id:p,bitmap:new nd({width:w+2*lg,height:T+2*lg},_),metrics:{width:w,height:T,left:k,top:M,advance:P}})}}function Ck(u,a,h){u===1?a.id=h.readVarint():u===2?a.bitmap=h.readBytes():u===3?a.width=h.readVarint():u===4?a.height=h.readVarint():u===5?a.left=h.readSVarint():u===6?a.top=h.readSVarint():u===7&&(a.advance=h.readVarint())}const S1=lg;function I1(u){let a=0,h=0;for(const T of u)a+=T.w*T.h,h=Math.max(h,T.w);u.sort((T,k)=>k.h-T.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),h),h:1/0}];let _=0,w=0;for(const T of u)for(let k=p.length-1;k>=0;k--){const M=p[k];if(!(T.w>M.w||T.h>M.h)){if(T.x=M.x,T.y=M.y,w=Math.max(w,T.y+T.h),_=Math.max(_,T.x+T.w),T.w===M.w&&T.h===M.h){const P=p.pop();k<p.length&&(p[k]=P)}else T.h===M.h?(M.x+=T.w,M.w-=T.w):T.w===M.w?(M.y+=T.h,M.h-=T.h):(p.push({x:M.x+T.w,y:M.y,w:M.w-T.w,h:T.h}),M.y+=T.h,M.h-=T.h);break}}return{w:_,h:w,fill:a/(_*w)||0}}const ia=1;class cg{constructor(a,{pixelRatio:h,version:p,stretchX:_,stretchY:w,content:T}){this.paddedRect=a,this.pixelRatio=h,this.stretchX=_,this.stretchY=w,this.content=T,this.version=p}get tl(){return[this.paddedRect.x+ia,this.paddedRect.y+ia]}get br(){return[this.paddedRect.x+this.paddedRect.w-ia,this.paddedRect.y+this.paddedRect.h-ia]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ia)/this.pixelRatio,(this.paddedRect.h-2*ia)/this.pixelRatio]}}class k1{constructor(a,h){const p={},_={};this.haveRenderCallbacks=[];const w=[];this.addImages(a,p,w),this.addImages(h,_,w);const{w:T,h:k}=I1(w),M=new Oa({width:T||1,height:k||1});for(const P in a){const F=a[P],G=p[P].paddedRect;Oa.copy(F.data,M,{x:0,y:0},{x:G.x+ia,y:G.y+ia},F.data)}for(const P in h){const F=h[P],G=_[P].paddedRect,X=G.x+ia,ie=G.y+ia,re=F.data.width,de=F.data.height;Oa.copy(F.data,M,{x:0,y:0},{x:X,y:ie},F.data),Oa.copy(F.data,M,{x:0,y:de-1},{x:X,y:ie-1},{width:re,height:1}),Oa.copy(F.data,M,{x:0,y:0},{x:X,y:ie+de},{width:re,height:1}),Oa.copy(F.data,M,{x:re-1,y:0},{x:X-1,y:ie},{width:1,height:de}),Oa.copy(F.data,M,{x:0,y:0},{x:X+re,y:ie},{width:1,height:de})}this.image=M,this.iconPositions=p,this.patternPositions=_}addImages(a,h,p){for(const _ in a){const w=a[_],T={x:0,y:0,w:w.data.width+2*ia,h:w.data.height+2*ia};p.push(T),h[_]=new cg(T,w),w.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(a,h){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in a.updatedImages)this.patchUpdatedImage(this.iconPositions[p],a.getImage(p),h),this.patchUpdatedImage(this.patternPositions[p],a.getImage(p),h)}patchUpdatedImage(a,h,p){if(!a||!h||a.version===h.version)return;a.version=h.version;const[_,w]=a.tl;p.update(h.data,void 0,{x:_,y:w})}}var fc;ri("ImagePosition",cg),ri("ImageAtlas",k1),r.ai=void 0,(fc=r.ai||(r.ai={}))[fc.none=0]="none",fc[fc.horizontal=1]="horizontal",fc[fc.vertical=2]="vertical",fc[fc.horizontalOnly=3]="horizontalOnly";const hd=-17;class dd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,h){const p=new dd;return p.scale=a||1,p.fontStack=h,p}static forImage(a){const h=new dd;return h.imageName=a,h}}class zu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,h){const p=new zu;for(let _=0;_<a.sections.length;_++){const w=a.sections[_];w.image?p.addImageSection(w):p.addTextSection(w,h)}return p}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(){this.text=function(a){let h="";for(let p=0;p<a.length;p++){const _=a.charCodeAt(p+1)||null,w=a.charCodeAt(p-1)||null;h+=_&&dl(_)&&!ud[a[p+1]]||w&&dl(w)&&!ud[a[p-1]]||!ud[a[p]]?a[p]:ud[a[p]]}return h}(this.text)}trim(){let a=0;for(let p=0;p<this.text.length&&Uf[this.text.charCodeAt(p)];p++)a++;let h=this.text.length;for(let p=this.text.length-1;p>=0&&p>=a&&Uf[this.text.charCodeAt(p)];p--)h--;this.text=this.text.substring(a,h),this.sectionIndex=this.sectionIndex.slice(a,h)}substring(a,h){const p=new zu;return p.text=this.text.substring(a,h),p.sectionIndex=this.sectionIndex.slice(a,h),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,h)=>Math.max(a,this.sections[h].scale),0)}addTextSection(a,h){this.text+=a.text,this.sections.push(dd.forText(a.scale,a.fontStack||h));const p=this.sections.length-1;for(let _=0;_<a.text.length;++_)this.sectionIndex.push(p)}addImageSection(a){const h=a.image?a.image.name:"";if(h.length===0)return void rt("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(dd.forImage(h)),this.sectionIndex.push(this.sections.length-1)):rt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ff(u,a,h,p,_,w,T,k,M,P,F,G,X,ie,re,de){const we=zu.fromFeature(u,_);let Ie;G===r.ai.vertical&&we.verticalizePunctuation();const{processBidirectionalText:Ue,processStyledBidirectionalText:Me}=ea;if(Ue&&we.sections.length===1){Ie=[];const wt=Ue(we.toString(),ug(we,P,w,a,p,ie,re));for(const ci of wt){const bi=new zu;bi.text=ci,bi.sections=we.sections;for(let li=0;li<ci.length;li++)bi.sectionIndex.push(0);Ie.push(bi)}}else if(Me){Ie=[];const wt=Me(we.text,we.sectionIndex,ug(we,P,w,a,p,ie,re));for(const ci of wt){const bi=new zu;bi.text=ci[0],bi.sectionIndex=ci[1],bi.sections=we.sections,Ie.push(bi)}}else Ie=function(wt,ci){const bi=[],li=wt.text;let ti=0;for(const Zt of ci)bi.push(wt.substring(ti,Zt)),ti=Zt;return ti<li.length&&bi.push(wt.substring(ti,li.length)),bi}(we,ug(we,P,w,a,p,ie,re));const He=[],$e={positionedLines:He,text:we.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:G,iconsInText:!1,verticalizable:!1};return function(wt,ci,bi,li,ti,Zt,pi,Yt,jt,Li,Ti,an){let or=0,fr=hd,Zr=0,_a=0;const Ns=Yt==="right"?1:Yt==="left"?0:.5;let Fr=0;for(const Wr of ti){Wr.trim();const Yr=Wr.getMaxScale(),Es=(Yr-1)*qr,Vs={positionedGlyphs:[],lineOffset:0};wt.positionedLines[Fr]=Vs;const Ts=Vs.positionedGlyphs;let na=0;if(!Wr.length()){fr+=Zt,++Fr;continue}for(let Jr=0;Jr<Wr.length();Jr++){const fn=Wr.getSection(Jr),Ss=Wr.getSectionIndex(Jr),_s=Wr.getCharCode(Jr);let Xr=0,to=null,yo=null,vo=null,xl=qr;const io=!(jt===r.ai.horizontal||!Ti&&!Go(_s)||Ti&&(Uf[_s]||(as=_s,Wt.Arabic(as)||Wt["Arabic Supplement"](as)||Wt["Arabic Extended-A"](as)||Wt["Arabic Presentation Forms-A"](as)||Wt["Arabic Presentation Forms-B"](as))));if(fn.imageName){const Ma=li[fn.imageName];if(!Ma)continue;vo=fn.imageName,wt.iconsInText=wt.iconsInText||!0,yo=Ma.paddedRect;const sa=Ma.displaySize;fn.scale=fn.scale*qr/an,to={width:sa[0],height:sa[1],left:ia,top:-S1,advance:io?sa[1]:sa[0]},Xr=Es+(qr-sa[1]*fn.scale),xl=to.advance;const wl=io?sa[0]*fn.scale-qr*Yr:sa[1]*fn.scale-qr*Yr;wl>0&&wl>na&&(na=wl)}else{const Ma=bi[fn.fontStack],sa=Ma&&Ma[_s];if(sa&&sa.rect)yo=sa.rect,to=sa.metrics;else{const wl=ci[fn.fontStack],_d=wl&&wl[_s];if(!_d)continue;to=_d.metrics}Xr=(Yr-fn.scale)*qr}io?(wt.verticalizable=!0,Ts.push({glyph:_s,imageName:vo,x:or,y:fr+Xr,vertical:io,scale:fn.scale,fontStack:fn.fontStack,sectionIndex:Ss,metrics:to,rect:yo}),or+=xl*fn.scale+Li):(Ts.push({glyph:_s,imageName:vo,x:or,y:fr+Xr,vertical:io,scale:fn.scale,fontStack:fn.fontStack,sectionIndex:Ss,metrics:to,rect:yo}),or+=to.advance*fn.scale+Li)}Ts.length!==0&&(Zr=Math.max(or-Li,Zr),Rk(Ts,0,Ts.length-1,Ns,na)),or=0;const ra=Zt*Yr+na;Vs.lineOffset=Math.max(na,Es),fr+=ra,_a=Math.max(ra,_a),++Fr}var as;const gs=fr-hd,{horizontalAlign:zs,verticalAlign:Bs}=hg(pi);(function(Wr,Yr,Es,Vs,Ts,na,ra,Jr,fn){const Ss=(Yr-Es)*Ts;let _s=0;_s=na!==ra?-Jr*Vs-hd:(-Vs*fn+.5)*ra;for(const Xr of Wr)for(const to of Xr.positionedGlyphs)to.x+=Ss,to.y+=_s})(wt.positionedLines,Ns,zs,Bs,Zr,_a,Zt,gs,ti.length),wt.top+=-Bs*gs,wt.bottom=wt.top+gs,wt.left+=-zs*Zr,wt.right=wt.left+Zr}($e,a,h,p,Ie,T,k,M,G,P,X,de),!function(wt){for(const ci of wt)if(ci.positionedGlyphs.length!==0)return!1;return!0}(He)&&$e}const Uf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Mk={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function O1(u,a,h,p,_,w){if(a.imageName){const T=p[a.imageName];return T?T.displaySize[0]*a.scale*qr/w+_:0}{const T=h[a.fontStack],k=T&&T[u];return k?k.metrics.advance*a.scale+_:0}}function C1(u,a,h,p){const _=Math.pow(u-a,2);return p?u<a?_/2:2*_:_+Math.abs(h)*h}function Dk(u,a,h){let p=0;return u===10&&(p-=1e4),h&&(p+=150),u!==40&&u!==65288||(p+=50),a!==41&&a!==65289||(p+=50),p}function M1(u,a,h,p,_,w){let T=null,k=C1(a,h,_,w);for(const M of p){const P=C1(a-M.x,h,_,w)+M.badness;P<=k&&(T=M,k=P)}return{index:u,x:a,priorBreak:T,badness:k}}function D1(u){return u?D1(u.priorBreak).concat(u.index):[]}function ug(u,a,h,p,_,w,T){if(w!=="point")return[];if(!u)return[];const k=[],M=function(X,ie,re,de,we,Ie){let Ue=0;for(let Me=0;Me<X.length();Me++){const He=X.getSection(Me);Ue+=O1(X.getCharCode(Me),He,de,we,ie,Ie)}return Ue/Math.max(1,Math.ceil(Ue/re))}(u,a,h,p,_,T),P=u.text.indexOf("")>=0;let F=0;for(let X=0;X<u.length();X++){const ie=u.getSection(X),re=u.getCharCode(X);if(Uf[re]||(F+=O1(re,ie,p,_,a,T)),X<u.length()-1){const de=!((G=re)<11904||!(Wt["Bopomofo Extended"](G)||Wt.Bopomofo(G)||Wt["CJK Compatibility Forms"](G)||Wt["CJK Compatibility Ideographs"](G)||Wt["CJK Compatibility"](G)||Wt["CJK Radicals Supplement"](G)||Wt["CJK Strokes"](G)||Wt["CJK Symbols and Punctuation"](G)||Wt["CJK Unified Ideographs Extension A"](G)||Wt["CJK Unified Ideographs"](G)||Wt["Enclosed CJK Letters and Months"](G)||Wt["Halfwidth and Fullwidth Forms"](G)||Wt.Hiragana(G)||Wt["Ideographic Description Characters"](G)||Wt["Kangxi Radicals"](G)||Wt["Katakana Phonetic Extensions"](G)||Wt.Katakana(G)||Wt["Vertical Forms"](G)||Wt["Yi Radicals"](G)||Wt["Yi Syllables"](G)));(Mk[re]||de||ie.imageName)&&k.push(M1(X+1,F,M,k,Dk(re,u.getCharCode(X+1),de&&P),!1))}}var G;return D1(M1(u.length(),F,M,k,0,!0))}function hg(u){let a=.5,h=.5;switch(u){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:a,verticalAlign:h}}function Rk(u,a,h,p,_){if(!p&&!_)return;const w=u[h],T=(u[h].x+w.metrics.advance*w.scale)*p;for(let k=a;k<=h;k++)u[k].x-=T,u[k].y+=_}function Lk(u,a,h){const{horizontalAlign:p,verticalAlign:_}=hg(h),w=a[0]-u.displaySize[0]*p,T=a[1]-u.displaySize[1]*_;return{image:u,top:T,bottom:T+u.displaySize[1],left:w,right:w+u.displaySize[0]}}function R1(u,a,h,p,_,w){const T=u.image;let k;if(T.content){const we=T.content,Ie=T.pixelRatio||1;k=[we[0]/Ie,we[1]/Ie,T.displaySize[0]-we[2]/Ie,T.displaySize[1]-we[3]/Ie]}const M=a.left*w,P=a.right*w;let F,G,X,ie;h==="width"||h==="both"?(ie=_[0]+M-p[3],G=_[0]+P+p[1]):(ie=_[0]+(M+P-T.displaySize[0])/2,G=ie+T.displaySize[0]);const re=a.top*w,de=a.bottom*w;return h==="height"||h==="both"?(F=_[1]+re-p[0],X=_[1]+de+p[2]):(F=_[1]+(re+de-T.displaySize[1])/2,X=F+T.displaySize[1]),{image:T,top:F,right:G,bottom:X,left:ie,collisionPadding:k}}const fd=255,qo=128,mc=fd*qo;function L1(u,a){const{expression:h}=a;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new sr(u+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:_}=h;let w=0;for(;w<p.length&&p[w]<=u;)w++;w=Math.max(0,w-1);let T=w;for(;T<p.length&&p[T]<u+1;)T++;T=Math.min(p.length-1,T);const k=p[w],M=p[T];return h.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:M,interpolationType:_}:{kind:"camera",minZoom:k,maxZoom:M,minSize:h.evaluate(new sr(k)),maxSize:h.evaluate(new sr(M)),interpolationType:_}}}function dg(u,a,h){let p="never";const _=u.get(a);return _?p=_:u.get(h)&&(p="always"),p}const Pk=dc.VectorTileFeature.types,Nk=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function jf(u,a,h,p,_,w,T,k,M,P,F,G,X){const ie=k?Math.min(mc,Math.round(k[0])):0,re=k?Math.min(mc,Math.round(k[1])):0;u.emplaceBack(a,h,Math.round(32*p),Math.round(32*_),w,T,(ie<<1)+(M?1:0),re,16*P,16*F,256*G,256*X)}function fg(u,a,h){u.emplaceBack(a.x,a.y,h),u.emplaceBack(a.x,a.y,h),u.emplaceBack(a.x,a.y,h),u.emplaceBack(a.x,a.y,h)}function zk(u){for(const a of u.sections)if(lc(a.text))return!0;return!1}class mg{constructor(a){this.layoutVertexArray=new ln,this.indexArray=new rs,this.programConfigurations=a,this.segments=new ar,this.dynamicLayoutVertexArray=new rn,this.opacityVertexArray=new hn,this.hasVisibleVertices=!1,this.placedSymbolArray=new Pe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,h,p,_){this.isEmpty()||(p&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,mk.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,pk.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,Nk,!0),this.opacityVertexBuffer.itemSize=1),(p||_)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ri("SymbolBuffers",mg);class pg{constructor(a,h,p){this.layoutVertexArray=new a,this.layoutAttributes=h,this.indexArray=new p,this.segments=new ar,this.collisionVertexArray=new Xn}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,gk.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ri("CollisionBuffers",pg);class Bu{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(T=>T.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=qp([]),this.placementViewportMatrix=qp([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=L1(this.zoom,h["text-size"]),this.iconSizeData=L1(this.zoom,h["icon-size"]);const p=this.layers[0].layout,_=p.get("symbol-sort-key"),w=p.get("symbol-z-order");this.canOverlap=dg(p,"text-overlap","text-allow-overlap")!=="never"||dg(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=w!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(w==="viewport-y"||w==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(T=>r.ai[T])),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=a.sourceID}createArrays(){this.text=new mg(new _o(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new mg(new _o(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new Fe,this.lineVertexArray=new it,this.symbolInstances=new Ee,this.textAnchorOffsets=new xt}calculateGlyphDependencies(a,h,p,_,w){for(let T=0;T<a.length;T++)if(h[a.charCodeAt(T)]=!0,(p||_)&&w){const k=ud[a.charAt(T)];k&&(h[k.charCodeAt(0)]=!0)}}populate(a,h,p){const _=this.layers[0],w=_.layout,T=w.get("text-font"),k=w.get("text-field"),M=w.get("icon-image"),P=(k.value.kind!=="constant"||k.value.value instanceof Jn&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),F=M.value.kind!=="constant"||!!M.value.value||Object.keys(M.parameters).length>0,G=w.get("symbol-sort-key");if(this.features=[],!P&&!F)return;const X=h.iconDependencies,ie=h.glyphDependencies,re=h.availableImages,de=new sr(this.zoom);for(const{feature:we,id:Ie,index:Ue,sourceLayerIndex:Me}of a){const He=_._featureFilter.needGeometry,$e=Vc(we,He);if(!_._featureFilter.filter(de,$e,p))continue;let wt,ci;if(He||($e.geometry=Bc(we)),P){const li=_.getValueAndResolveTokens("text-field",$e,p,re),ti=Jn.factory(li);zk(ti)&&(this.hasRTLText=!0),(!this.hasRTLText||Hh()==="unavailable"||this.hasRTLText&&ea.isParsed())&&(wt=yk(ti,_,$e))}if(F){const li=_.getValueAndResolveTokens("icon-image",$e,p,re);ci=li instanceof Br?li:Br.fromString(li)}if(!wt&&!ci)continue;const bi=this.sortFeaturesByKey?G.evaluate($e,{},p):void 0;if(this.features.push({id:Ie,text:wt,icon:ci,index:Ue,sourceLayerIndex:Me,geometry:$e.geometry,properties:we.properties,type:Pk[we.type],sortKey:bi}),ci&&(X[ci.name]=!0),wt){const li=T.evaluate($e,{},p).join(","),ti=w.get("text-rotation-alignment")!=="viewport"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(r.ai.vertical)>=0;for(const Zt of wt.sections)if(Zt.image)X[Zt.image.name]=!0;else{const pi=oc(wt.toString()),Yt=Zt.fontStack||li,jt=ie[Yt]=ie[Yt]||{};this.calculateGlyphDependencies(Zt.text,jt,ti,this.allowVerticalPlacement,pi)}}}w.get("symbol-placement")==="line"&&(this.features=function(we){const Ie={},Ue={},Me=[];let He=0;function $e(li){Me.push(we[li]),He++}function wt(li,ti,Zt){const pi=Ue[li];return delete Ue[li],Ue[ti]=pi,Me[pi].geometry[0].pop(),Me[pi].geometry[0]=Me[pi].geometry[0].concat(Zt[0]),pi}function ci(li,ti,Zt){const pi=Ie[ti];return delete Ie[ti],Ie[li]=pi,Me[pi].geometry[0].shift(),Me[pi].geometry[0]=Zt[0].concat(Me[pi].geometry[0]),pi}function bi(li,ti,Zt){const pi=Zt?ti[0][ti[0].length-1]:ti[0][0];return`${li}:${pi.x}:${pi.y}`}for(let li=0;li<we.length;li++){const ti=we[li],Zt=ti.geometry,pi=ti.text?ti.text.toString():null;if(!pi){$e(li);continue}const Yt=bi(pi,Zt),jt=bi(pi,Zt,!0);if(Yt in Ue&&jt in Ie&&Ue[Yt]!==Ie[jt]){const Li=ci(Yt,jt,Zt),Ti=wt(Yt,jt,Me[Li].geometry);delete Ie[Yt],delete Ue[jt],Ue[bi(pi,Me[Ti].geometry,!0)]=Ti,Me[Li].geometry=null}else Yt in Ue?wt(Yt,jt,Zt):jt in Ie?ci(Yt,jt,Zt):($e(li),Ie[Yt]=He-1,Ue[jt]=He-1)}return Me.filter(li=>li.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((we,Ie)=>we.sortKey-Ie.sortKey)}update(a,h,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,h,this.layers,p),this.icon.programConfigurations.updatePaintArrays(a,h,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,h){const p=this.lineVertexArray.length;if(a.segment!==void 0){let _=a.dist(h[a.segment+1]),w=a.dist(h[a.segment]);const T={};for(let k=a.segment+1;k<h.length;k++)T[k]={x:h[k].x,y:h[k].y,tileUnitDistanceFromAnchor:_},k<h.length-1&&(_+=h[k+1].dist(h[k]));for(let k=a.segment||0;k>=0;k--)T[k]={x:h[k].x,y:h[k].y,tileUnitDistanceFromAnchor:w},k>0&&(w+=h[k-1].dist(h[k]));for(let k=0;k<h.length;k++){const M=T[k];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(a,h,p,_,w,T,k,M,P,F,G,X){const ie=a.indexArray,re=a.layoutVertexArray,de=a.segments.prepareSegment(4*h.length,re,ie,this.canOverlap?T.sortKey:void 0),we=this.glyphOffsetArray.length,Ie=de.vertexLength,Ue=this.allowVerticalPlacement&&k===r.ai.vertical?Math.PI/2:0,Me=T.text&&T.text.sections;for(let He=0;He<h.length;He++){const{tl:$e,tr:wt,bl:ci,br:bi,tex:li,pixelOffsetTL:ti,pixelOffsetBR:Zt,minFontScaleX:pi,minFontScaleY:Yt,glyphOffset:jt,isSDF:Li,sectionIndex:Ti}=h[He],an=de.vertexLength,or=jt[1];jf(re,M.x,M.y,$e.x,or+$e.y,li.x,li.y,p,Li,ti.x,ti.y,pi,Yt),jf(re,M.x,M.y,wt.x,or+wt.y,li.x+li.w,li.y,p,Li,Zt.x,ti.y,pi,Yt),jf(re,M.x,M.y,ci.x,or+ci.y,li.x,li.y+li.h,p,Li,ti.x,Zt.y,pi,Yt),jf(re,M.x,M.y,bi.x,or+bi.y,li.x+li.w,li.y+li.h,p,Li,Zt.x,Zt.y,pi,Yt),fg(a.dynamicLayoutVertexArray,M,Ue),ie.emplaceBack(an,an+1,an+2),ie.emplaceBack(an+1,an+2,an+3),de.vertexLength+=4,de.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(jt[0]),He!==h.length-1&&Ti===h[He+1].sectionIndex||a.programConfigurations.populatePaintArrays(re.length,T,T.index,{},X,Me&&Me[Ti])}a.placedSymbolArray.emplaceBack(M.x,M.y,we,this.glyphOffsetArray.length-we,Ie,P,F,M.segment,p?p[0]:0,p?p[1]:0,_[0],_[1],k,0,!1,0,G)}_addCollisionDebugVertex(a,h,p,_,w,T){return h.emplaceBack(0,0),a.emplaceBack(p.x,p.y,_,w,Math.round(T.x),Math.round(T.y))}addCollisionDebugVertices(a,h,p,_,w,T,k){const M=w.segments.prepareSegment(4,w.layoutVertexArray,w.indexArray),P=M.vertexLength,F=w.layoutVertexArray,G=w.collisionVertexArray,X=k.anchorX,ie=k.anchorY;this._addCollisionDebugVertex(F,G,T,X,ie,new E(a,h)),this._addCollisionDebugVertex(F,G,T,X,ie,new E(p,h)),this._addCollisionDebugVertex(F,G,T,X,ie,new E(p,_)),this._addCollisionDebugVertex(F,G,T,X,ie,new E(a,_)),M.vertexLength+=4;const re=w.indexArray;re.emplaceBack(P,P+1),re.emplaceBack(P+1,P+2),re.emplaceBack(P+2,P+3),re.emplaceBack(P+3,P),M.primitiveLength+=4}addDebugCollisionBoxes(a,h,p,_){for(let w=a;w<h;w++){const T=this.collisionBoxArray.get(w);this.addCollisionDebugVertices(T.x1,T.y1,T.x2,T.y2,_?this.textCollisionBox:this.iconCollisionBox,T.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pg(Ir,y1.members,Hr),this.iconCollisionBox=new pg(Ir,y1.members,Hr);for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(a,h,p,_,w,T,k,M,P){const F={};for(let G=h;G<p;G++){const X=a.get(G);F.textBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},F.textFeatureIndex=X.featureIndex;break}for(let G=_;G<w;G++){const X=a.get(G);F.verticalTextBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},F.verticalTextFeatureIndex=X.featureIndex;break}for(let G=T;G<k;G++){const X=a.get(G);F.iconBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},F.iconFeatureIndex=X.featureIndex;break}for(let G=M;G<P;G++){const X=a.get(G);F.verticalIconBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},F.verticalIconFeatureIndex=X.featureIndex;break}return F}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,h){const p=a.placedSymbolArray.get(h),_=p.vertexStartIndex+4*p.numGlyphs;for(let w=p.vertexStartIndex;w<_;w+=4)a.indexArray.emplaceBack(w,w+1,w+2),a.indexArray.emplaceBack(w+1,w+2,w+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(a),p=Math.cos(a),_=[],w=[],T=[];for(let k=0;k<this.symbolInstances.length;++k){T.push(k);const M=this.symbolInstances.get(k);_.push(0|Math.round(h*M.anchorX+p*M.anchorY)),w.push(M.featureIndex)}return T.sort((k,M)=>_[k]-_[M]||w[M]-w[k]),T}addToSortKeyRanges(a,h){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===h?p.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const p=this.symbolInstances.get(h);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((_,w,T)=>{_>=0&&T.indexOf(_)===w&&this.addIndicesForPlacedSymbol(this.text,_)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let P1,N1;ri("SymbolBucket",Bu,{omit:["layers","collisionBoxArray","features","compareText"]}),Bu.MAX_GLYPHS=65535,Bu.addDynamicAttributes=fg;var gg={get paint(){return N1=N1||new Dr({"icon-opacity":new Vi(Xe.paint_symbol["icon-opacity"]),"icon-color":new Vi(Xe.paint_symbol["icon-color"]),"icon-halo-color":new Vi(Xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Vi(Xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Vi(Xe.paint_symbol["icon-halo-blur"]),"icon-translate":new Ii(Xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ii(Xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Vi(Xe.paint_symbol["text-opacity"]),"text-color":new Vi(Xe.paint_symbol["text-color"],{runtimeType:Bn,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Vi(Xe.paint_symbol["text-halo-color"]),"text-halo-width":new Vi(Xe.paint_symbol["text-halo-width"]),"text-halo-blur":new Vi(Xe.paint_symbol["text-halo-blur"]),"text-translate":new Ii(Xe.paint_symbol["text-translate"]),"text-translate-anchor":new Ii(Xe.paint_symbol["text-translate-anchor"])})},get layout(){return P1=P1||new Dr({"symbol-placement":new Ii(Xe.layout_symbol["symbol-placement"]),"symbol-spacing":new Ii(Xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ii(Xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Vi(Xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ii(Xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ii(Xe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ii(Xe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ii(Xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ii(Xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ii(Xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Vi(Xe.layout_symbol["icon-size"]),"icon-text-fit":new Ii(Xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ii(Xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Vi(Xe.layout_symbol["icon-image"]),"icon-rotate":new Vi(Xe.layout_symbol["icon-rotate"]),"icon-padding":new Vi(Xe.layout_symbol["icon-padding"]),"icon-keep-upright":new Ii(Xe.layout_symbol["icon-keep-upright"]),"icon-offset":new Vi(Xe.layout_symbol["icon-offset"]),"icon-anchor":new Vi(Xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ii(Xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ii(Xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ii(Xe.layout_symbol["text-rotation-alignment"]),"text-field":new Vi(Xe.layout_symbol["text-field"]),"text-font":new Vi(Xe.layout_symbol["text-font"]),"text-size":new Vi(Xe.layout_symbol["text-size"]),"text-max-width":new Vi(Xe.layout_symbol["text-max-width"]),"text-line-height":new Ii(Xe.layout_symbol["text-line-height"]),"text-letter-spacing":new Vi(Xe.layout_symbol["text-letter-spacing"]),"text-justify":new Vi(Xe.layout_symbol["text-justify"]),"text-radial-offset":new Vi(Xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ii(Xe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Vi(Xe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Vi(Xe.layout_symbol["text-anchor"]),"text-max-angle":new Ii(Xe.layout_symbol["text-max-angle"]),"text-writing-mode":new Ii(Xe.layout_symbol["text-writing-mode"]),"text-rotate":new Vi(Xe.layout_symbol["text-rotate"]),"text-padding":new Ii(Xe.layout_symbol["text-padding"]),"text-keep-upright":new Ii(Xe.layout_symbol["text-keep-upright"]),"text-transform":new Vi(Xe.layout_symbol["text-transform"]),"text-offset":new Vi(Xe.layout_symbol["text-offset"]),"text-allow-overlap":new Ii(Xe.layout_symbol["text-allow-overlap"]),"text-overlap":new Ii(Xe.layout_symbol["text-overlap"]),"text-ignore-placement":new Ii(Xe.layout_symbol["text-ignore-placement"]),"text-optional":new Ii(Xe.layout_symbol["text-optional"])})}};class z1{constructor(a){if(a.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=a.property.overrides?a.property.overrides.runtimeType:Gi,this.defaultValue=a}evaluate(a){if(a.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(a.formattedSection))return h.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ri("FormatSectionOverride",z1,{omit:["defaultValue"]});class Gf extends pa{constructor(a){super(a,gg)}recalculate(a,h){if(super.recalculate(a,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const _=[];for(const w of p)_.indexOf(w)<0&&_.push(w);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(a,h,p,_){const w=this.layout.get(a).evaluate(h,{},p,_),T=this._unevaluatedLayout._values[a];return T.isDataDriven()||Xs(T.value)||!w?w:function(k,M){return M.replace(/{([^{}]+)}/g,(P,F)=>k&&F in k?String(k[F]):"")}(h.properties,w)}createBucket(a){return new Bu(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const a of gg.paint.overridableProperties){if(!Gf.hasPaintOverride(this.layout,a))continue;const h=this.paint.get(a),p=new z1(h),_=new zo(p,h.property.specification);let w=null;w=h.value.kind==="constant"||h.value.kind==="source"?new Bo("source",_):new qa("composite",_,h.value.zoomStops),this.paint._values[a]=new ws(h.property,w,h.parameters)}}_handleOverridablePaintPropertyUpdate(a,h,p){return!(!this.layout||h.isDataDriven()||p.isDataDriven())&&Gf.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,h){const p=a.get("text-field"),_=gg.paint.properties[h];let w=!1;const T=k=>{for(const M of k)if(_.overrides&&_.overrides.hasOverride(M))return void(w=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Jn)T(p.value.value.sections);else if(p.value.kind==="source"){const k=P=>{w||(P instanceof Aa&&$n(P.value)===Z?T(P.value.sections):P instanceof sl?T(P.sections):P.eachChild(k))},M=p.value;M._styleExpression&&k(M._styleExpression.expression)}return w}}let B1;var Bk={get paint(){return B1=B1||new Dr({"background-color":new Ii(Xe.paint_background["background-color"]),"background-pattern":new qh(Xe.paint_background["background-pattern"]),"background-opacity":new Ii(Xe.paint_background["background-opacity"])})}};class Vk extends pa{constructor(a){super(a,Bk)}}let V1;var Fk={get paint(){return V1=V1||new Dr({"raster-opacity":new Ii(Xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ii(Xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ii(Xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ii(Xe.paint_raster["raster-brightness-max"]),"raster-saturation":new Ii(Xe.paint_raster["raster-saturation"]),"raster-contrast":new Ii(Xe.paint_raster["raster-contrast"]),"raster-resampling":new Ii(Xe.paint_raster["raster-resampling"]),"raster-fade-duration":new Ii(Xe.paint_raster["raster-fade-duration"])})}};class Uk extends pa{constructor(a){super(a,Fk)}}class jk extends pa{constructor(a){super(a,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Gk{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const _g=63710088e-1;class pc{constructor(a,h){if(isNaN(a)||isNaN(h))throw new Error(`Invalid LngLat object: (${a}, ${h})`);if(this.lng=+a,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new pc(ue(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const h=Math.PI/180,p=this.lat*h,_=a.lat*h,w=Math.sin(p)*Math.sin(_)+Math.cos(p)*Math.cos(_)*Math.cos((a.lng-this.lng)*h);return _g*Math.acos(Math.min(w,1))}static convert(a){if(a instanceof pc)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new pc(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new pc(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const F1=2*Math.PI*_g;function U1(u){return F1*Math.cos(u*Math.PI/180)}function j1(u){return(180+u)/360}function G1(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function H1(u,a){return u/U1(a)}function K1(u){return 360*u-180}function yg(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class Hf{constructor(a,h,p=0){this.x=+a,this.y=+h,this.z=+p}static fromLngLat(a,h=0){const p=pc.convert(a);return new Hf(j1(p.lng),G1(p.lat),H1(h,p.lat))}toLngLat(){return new pc(K1(this.x),yg(this.y))}toAltitude(){return this.z*U1(yg(this.y))}meterInMercatorCoordinateUnits(){return 1/F1*(a=yg(this.y),1/Math.cos(a*Math.PI/180));var a}}function q1(u,a,h){var p=2*Math.PI*6378137/256/Math.pow(2,h);return[u*p-2*Math.PI*6378137/2,a*p-2*Math.PI*6378137/2]}class vg{constructor(a,h,p){if(a<0||a>25||p<0||p>=Math.pow(2,a)||h<0||h>=Math.pow(2,a))throw new Error(`x=${h}, y=${p}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=h,this.y=p,this.key=md(0,a,a,h,p)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,h,p){const _=(T=this.y,k=this.z,M=q1(256*(w=this.x),256*(T=Math.pow(2,k)-T-1),k),P=q1(256*(w+1),256*(T+1),k),M[0]+","+M[1]+","+P[0]+","+P[1]);var w,T,k,M,P;const F=function(G,X,ie){let re,de="";for(let we=G;we>0;we--)re=1<<we-1,de+=(X&re?1:0)+(ie&re?2:0);return de}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,F).replace(/{bbox-epsg-3857}/g,_)}isChildOf(a){const h=this.z-a.z;return h>0&&a.x===this.x>>h&&a.y===this.y>>h}getTilePoint(a){const h=Math.pow(2,this.z);return new E((a.x*h-this.x)*Vr,(a.y*h-this.y)*Vr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Z1{constructor(a,h){this.wrap=a,this.canonical=h,this.key=md(a,h.z,h.z,h.x,h.y)}}class Ca{constructor(a,h,p,_,w){if(a<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${p}`);this.overscaledZ=a,this.wrap=h,this.canonical=new vg(p,+_,+w),this.key=md(h,a,p,_,w)}clone(){return new Ca(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-a;return a>this.canonical.z?new Ca(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ca(a,this.wrap,a,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(a,h){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-a;return a>this.canonical.z?md(this.wrap*+h,a,this.canonical.z,this.canonical.x,this.canonical.y):md(this.wrap*+h,a,a,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(a){if(a.wrap!==this.wrap)return!1;const h=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>h&&a.canonical.y===this.canonical.y>>h}children(a){if(this.overscaledZ>=a)return[new Ca(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,p=2*this.canonical.x,_=2*this.canonical.y;return[new Ca(h,this.wrap,h,p,_),new Ca(h,this.wrap,h,p+1,_),new Ca(h,this.wrap,h,p,_+1),new Ca(h,this.wrap,h,p+1,_+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new Ca(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new Ca(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Z1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new Hf(a.x-this.wrap,a.y))}}function md(u,a,h,p,_){(u*=2)<0&&(u=-1*u-1);const w=1<<h;return(w*w*u+w*_+p).toString(36)+h.toString(36)+a.toString(36)}ri("CanonicalTileID",vg),ri("OverscaledTileID",Ca,{omit:["posMatrix"]});class W1{constructor(a,h,p,_=1,w=1,T=1,k=0){if(this.uid=a,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void rt(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const M=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=_,this.greenFactor=w,this.blueFactor=T,this.baseShift=k;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<M;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(M,P)]=this.data[this._idx(M-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,M)]=this.data[this._idx(P,M-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(M,-1)]=this.data[this._idx(M-1,0)],this.data[this._idx(-1,M)]=this.data[this._idx(0,M-1)],this.data[this._idx(M,M)]=this.data[this._idx(M-1,M-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<M;P++)for(let F=0;F<M;F++){const G=this.get(P,F);G>this.max&&(this.max=G),G<this.min&&(this.min=G)}}get(a,h){const p=new Uint8Array(this.data.buffer),_=4*this._idx(a,h);return this.unpack(p[_],p[_+1],p[_+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(a,h){if(a<-1||a>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(a+1)}unpack(a,h,p){return a*this.redFactor+h*this.greenFactor+p*this.blueFactor-this.baseShift}getPixels(){return new Oa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,h,p){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let _=h*this.dim,w=h*this.dim+this.dim,T=p*this.dim,k=p*this.dim+this.dim;switch(h){case-1:_=w-1;break;case 1:w=_+1}switch(p){case-1:T=k-1;break;case 1:k=T+1}const M=-h*this.dim,P=-p*this.dim;for(let F=T;F<k;F++)for(let G=_;G<w;G++)this.data[this._idx(G,F)]=a.data[this._idx(G+M,F+P)]}}ri("DEMData",W1);class Y1{constructor(a){this._stringToNumber={},this._numberToString=[];for(let h=0;h<a.length;h++){const p=a[h];this._stringToNumber[p]=h,this._numberToString[h]=p}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class J1{constructor(a,h,p,_,w){this.type="Feature",this._vectorTileFeature=a,a._z=h,a._x=p,a._y=_,this.properties=a.properties,this.id=w}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(a[h]=this[h]);return a}}class X1{constructor(a,h){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Ya(Vr,16,0),this.grid3D=new Ya(Vr,16,0),this.featureIndexArray=new kt,this.promoteId=h}insert(a,h,p,_,w,T){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,_,w);const M=T?this.grid3D:this.grid;for(let P=0;P<h.length;P++){const F=h[P],G=[1/0,1/0,-1/0,-1/0];for(let X=0;X<F.length;X++){const ie=F[X];G[0]=Math.min(G[0],ie.x),G[1]=Math.min(G[1],ie.y),G[2]=Math.max(G[2],ie.x),G[3]=Math.max(G[3],ie.y)}G[0]<Vr&&G[1]<Vr&&G[2]>=0&&G[3]>=0&&M.insert(k,G[0],G[1],G[2],G[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new dc.VectorTile(new og(this.rawTileData)).layers,this.sourceLayerCoder=new Y1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,h,p,_){this.loadVTLayers();const w=a.params||{},T=Vr/a.tileSize/a.scale,k=tc(w.filter),M=a.queryGeometry,P=a.queryPadding*T,F=$1(M),G=this.grid.query(F.minX-P,F.minY-P,F.maxX+P,F.maxY+P),X=$1(a.cameraQueryGeometry),ie=this.grid3D.query(X.minX-P,X.minY-P,X.maxX+P,X.maxY+P,(we,Ie,Ue,Me)=>function(He,$e,wt,ci,bi){for(const ti of He)if($e<=ti.x&&wt<=ti.y&&ci>=ti.x&&bi>=ti.y)return!0;const li=[new E($e,wt),new E($e,bi),new E(ci,bi),new E(ci,wt)];if(He.length>2){for(const ti of li)if(Mu(He,ti))return!0}for(let ti=0;ti<He.length-1;ti++)if(xI(He[ti],He[ti+1],li))return!0;return!1}(a.cameraQueryGeometry,we-P,Ie-P,Ue+P,Me+P));for(const we of ie)G.push(we);G.sort(Hk);const re={};let de;for(let we=0;we<G.length;we++){const Ie=G[we];if(Ie===de)continue;de=Ie;const Ue=this.featureIndexArray.get(Ie);let Me=null;this.loadMatchingFeature(re,Ue.bucketIndex,Ue.sourceLayerIndex,Ue.featureIndex,k,w.layers,w.availableImages,h,p,_,(He,$e,wt)=>(Me||(Me=Bc(He)),$e.queryIntersectsFeature(M,He,wt,Me,this.z,a.transform,T,a.pixelPosMatrix)))}return re}loadMatchingFeature(a,h,p,_,w,T,k,M,P,F,G){const X=this.bucketLayerIDs[h];if(T&&!function(we,Ie){for(let Ue=0;Ue<we.length;Ue++)if(Ie.indexOf(we[Ue])>=0)return!0;return!1}(T,X))return;const ie=this.sourceLayerCoder.decode(p),re=this.vtLayers[ie].feature(_);if(w.needGeometry){const we=Vc(re,!0);if(!w.filter(new sr(this.tileID.overscaledZ),we,this.tileID.canonical))return}else if(!w.filter(new sr(this.tileID.overscaledZ),re))return;const de=this.getId(re,ie);for(let we=0;we<X.length;we++){const Ie=X[we];if(T&&T.indexOf(Ie)<0)continue;const Ue=M[Ie];if(!Ue)continue;let Me={};de&&F&&(Me=F.getState(Ue.sourceLayer||"_geojsonTileLayer",de));const He=ve({},P[Ie]);He.paint=Q1(He.paint,Ue.paint,re,Me,k),He.layout=Q1(He.layout,Ue.layout,re,Me,k);const $e=!G||G(re,Ue,Me);if(!$e)continue;const wt=new J1(re,this.z,this.x,this.y,de);wt.layer=He;let ci=a[Ie];ci===void 0&&(ci=a[Ie]=[]),ci.push({featureIndex:_,feature:wt,intersectionZ:$e})}}lookupSymbolFeatures(a,h,p,_,w,T,k,M){const P={};this.loadVTLayers();const F=tc(w);for(const G of a)this.loadMatchingFeature(P,p,_,G,F,T,k,M,h);return P}hasLayer(a){for(const h of this.bucketLayerIDs)for(const p of h)if(a===p)return!0;return!1}getId(a,h){let p=a.id;return this.promoteId&&(p=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof p=="boolean"&&(p=Number(p))),p}}function Q1(u,a,h,p,_){return oe(u,(w,T)=>{const k=a instanceof Ou?a.get(T):null;return k&&k.evaluate?k.evaluate(h,p,_):k})}function $1(u){let a=1/0,h=1/0,p=-1/0,_=-1/0;for(const w of u)a=Math.min(a,w.x),h=Math.min(h,w.y),p=Math.max(p,w.x),_=Math.max(_,w.y);return{minX:a,minY:h,maxX:p,maxY:_}}function Hk(u,a){return a-u}function ev(u,a,h,p,_){const w=[];for(let T=0;T<u.length;T++){const k=u[T];let M;for(let P=0;P<k.length-1;P++){let F=k[P],G=k[P+1];F.x<a&&G.x<a||(F.x<a?F=new E(a,F.y+(a-F.x)/(G.x-F.x)*(G.y-F.y))._round():G.x<a&&(G=new E(a,F.y+(a-F.x)/(G.x-F.x)*(G.y-F.y))._round()),F.y<h&&G.y<h||(F.y<h?F=new E(F.x+(h-F.y)/(G.y-F.y)*(G.x-F.x),h)._round():G.y<h&&(G=new E(F.x+(h-F.y)/(G.y-F.y)*(G.x-F.x),h)._round()),F.x>=p&&G.x>=p||(F.x>=p?F=new E(p,F.y+(p-F.x)/(G.x-F.x)*(G.y-F.y))._round():G.x>=p&&(G=new E(p,F.y+(p-F.x)/(G.x-F.x)*(G.y-F.y))._round()),F.y>=_&&G.y>=_||(F.y>=_?F=new E(F.x+(_-F.y)/(G.y-F.y)*(G.x-F.x),_)._round():G.y>=_&&(G=new E(F.x+(_-F.y)/(G.y-F.y)*(G.x-F.x),_)._round()),M&&F.equals(M[M.length-1])||(M=[F],w.push(M)),M.push(G)))))}}return w}ri("FeatureIndex",X1,{omit:["rawTileData","sourceLayerCoder"]});class gc extends E{constructor(a,h,p,_){super(a,h),this.angle=p,_!==void 0&&(this.segment=_)}clone(){return new gc(this.x,this.y,this.angle,this.segment)}}function tv(u,a,h,p,_){if(a.segment===void 0||h===0)return!0;let w=a,T=a.segment+1,k=0;for(;k>-h/2;){if(T--,T<0)return!1;k-=u[T].dist(w),w=u[T]}k+=u[T].dist(u[T+1]),T++;const M=[];let P=0;for(;k<h/2;){const F=u[T],G=u[T+1];if(!G)return!1;let X=u[T-1].angleTo(F)-F.angleTo(G);for(X=Math.abs((X+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:k,angleDelta:X}),P+=X;k-M[0].distance>p;)P-=M.shift().angleDelta;if(P>_)return!1;T++,k+=F.dist(G)}return!0}function iv(u){let a=0;for(let h=0;h<u.length-1;h++)a+=u[h].dist(u[h+1]);return a}function nv(u,a,h){return u?.6*a*h:0}function rv(u,a){return Math.max(u?u.right-u.left:0,a?a.right-a.left:0)}function Kk(u,a,h,p,_,w){const T=nv(h,_,w),k=rv(h,p)*w;let M=0;const P=iv(u)/2;for(let F=0;F<u.length-1;F++){const G=u[F],X=u[F+1],ie=G.dist(X);if(M+ie>P){const re=(P-M)/ie,de=is.number(G.x,X.x,re),we=is.number(G.y,X.y,re),Ie=new gc(de,we,X.angleTo(G),F);return Ie._round(),!T||tv(u,Ie,k,T,a)?Ie:void 0}M+=ie}}function qk(u,a,h,p,_,w,T,k,M){const P=nv(p,w,T),F=rv(p,_),G=F*T,X=u[0].x===0||u[0].x===M||u[0].y===0||u[0].y===M;return a-G<a/4&&(a=G+a/4),sv(u,X?a/2*k%a:(F/2+2*w)*T*k%a,a,P,h,G,X,!1,M)}function sv(u,a,h,p,_,w,T,k,M){const P=w/2,F=iv(u);let G=0,X=a-h,ie=[];for(let re=0;re<u.length-1;re++){const de=u[re],we=u[re+1],Ie=de.dist(we),Ue=we.angleTo(de);for(;X+h<G+Ie;){X+=h;const Me=(X-G)/Ie,He=is.number(de.x,we.x,Me),$e=is.number(de.y,we.y,Me);if(He>=0&&He<M&&$e>=0&&$e<M&&X-P>=0&&X+P<=F){const wt=new gc(He,$e,Ue,re);wt._round(),p&&!tv(u,wt,w,p,_)||ie.push(wt)}}G+=Ie}return k||ie.length||T||(ie=sv(u,G/2,h,p,_,w,T,!0,M)),ie}ri("Anchor",gc);const Vu=ia;function av(u,a,h,p){const _=[],w=u.image,T=w.pixelRatio,k=w.paddedRect.w-2*Vu,M=w.paddedRect.h-2*Vu,P=u.right-u.left,F=u.bottom-u.top,G=w.stretchX||[[0,k]],X=w.stretchY||[[0,M]],ie=(Zt,pi)=>Zt+pi[1]-pi[0],re=G.reduce(ie,0),de=X.reduce(ie,0),we=k-re,Ie=M-de;let Ue=0,Me=re,He=0,$e=de,wt=0,ci=we,bi=0,li=Ie;if(w.content&&p){const Zt=w.content;Ue=Kf(G,0,Zt[0]),He=Kf(X,0,Zt[1]),Me=Kf(G,Zt[0],Zt[2]),$e=Kf(X,Zt[1],Zt[3]),wt=Zt[0]-Ue,bi=Zt[1]-He,ci=Zt[2]-Zt[0]-Me,li=Zt[3]-Zt[1]-$e}const ti=(Zt,pi,Yt,jt)=>{const Li=qf(Zt.stretch-Ue,Me,P,u.left),Ti=Zf(Zt.fixed-wt,ci,Zt.stretch,re),an=qf(pi.stretch-He,$e,F,u.top),or=Zf(pi.fixed-bi,li,pi.stretch,de),fr=qf(Yt.stretch-Ue,Me,P,u.left),Zr=Zf(Yt.fixed-wt,ci,Yt.stretch,re),_a=qf(jt.stretch-He,$e,F,u.top),Ns=Zf(jt.fixed-bi,li,jt.stretch,de),Fr=new E(Li,an),as=new E(fr,an),gs=new E(fr,_a),zs=new E(Li,_a),Bs=new E(Ti/T,or/T),Wr=new E(Zr/T,Ns/T),Yr=a*Math.PI/180;if(Yr){const Ts=Math.sin(Yr),na=Math.cos(Yr),ra=[na,-Ts,Ts,na];Fr._matMult(ra),as._matMult(ra),zs._matMult(ra),gs._matMult(ra)}const Es=Zt.stretch+Zt.fixed,Vs=pi.stretch+pi.fixed;return{tl:Fr,tr:as,bl:zs,br:gs,tex:{x:w.paddedRect.x+Vu+Es,y:w.paddedRect.y+Vu+Vs,w:Yt.stretch+Yt.fixed-Es,h:jt.stretch+jt.fixed-Vs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Bs,pixelOffsetBR:Wr,minFontScaleX:ci/T/P,minFontScaleY:li/T/F,isSDF:h}};if(p&&(w.stretchX||w.stretchY)){const Zt=ov(G,we,re),pi=ov(X,Ie,de);for(let Yt=0;Yt<Zt.length-1;Yt++){const jt=Zt[Yt],Li=Zt[Yt+1];for(let Ti=0;Ti<pi.length-1;Ti++)_.push(ti(jt,pi[Ti],Li,pi[Ti+1]))}}else _.push(ti({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:M+1}));return _}function Kf(u,a,h){let p=0;for(const _ of u)p+=Math.max(a,Math.min(h,_[1]))-Math.max(a,Math.min(h,_[0]));return p}function ov(u,a,h){const p=[{fixed:-Vu,stretch:0}];for(const[_,w]of u){const T=p[p.length-1];p.push({fixed:_-T.stretch,stretch:T.stretch}),p.push({fixed:_-T.stretch,stretch:T.stretch+(w-_)})}return p.push({fixed:a+Vu,stretch:h}),p}function qf(u,a,h,p){return u/a*h+p}function Zf(u,a,h,p){return u-a*h/p}class Wf{constructor(a,h,p,_,w,T,k,M,P,F){if(this.boxStartIndex=a.length,P){let G=T.top,X=T.bottom;const ie=T.collisionPadding;ie&&(G-=ie[1],X+=ie[3]);let re=X-G;re>0&&(re=Math.max(10,re),this.circleDiameter=re)}else{let G=T.top*k-M[0],X=T.bottom*k+M[2],ie=T.left*k-M[3],re=T.right*k+M[1];const de=T.collisionPadding;if(de&&(ie-=de[0]*k,G-=de[1]*k,re+=de[2]*k,X+=de[3]*k),F){const we=new E(ie,G),Ie=new E(re,G),Ue=new E(ie,X),Me=new E(re,X),He=F*Math.PI/180;we._rotate(He),Ie._rotate(He),Ue._rotate(He),Me._rotate(He),ie=Math.min(we.x,Ie.x,Ue.x,Me.x),re=Math.max(we.x,Ie.x,Ue.x,Me.x),G=Math.min(we.y,Ie.y,Ue.y,Me.y),X=Math.max(we.y,Ie.y,Ue.y,Me.y)}a.emplaceBack(h.x,h.y,ie,G,re,X,p,_,w)}this.boxEndIndex=a.length}}class Zk{constructor(a=[],h=Wk){if(this.data=a,this.length=this.data.length,this.compare=h,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const a=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:h,compare:p}=this,_=h[a];for(;a>0;){const w=a-1>>1,T=h[w];if(p(_,T)>=0)break;h[a]=T,a=w}h[a]=_}_down(a){const{data:h,compare:p}=this,_=this.length>>1,w=h[a];for(;a<_;){let T=1+(a<<1),k=h[T];const M=T+1;if(M<this.length&&p(h[M],k)<0&&(T=M,k=h[M]),p(k,w)>=0)break;h[a]=k,a=T}h[a]=w}}function Wk(u,a){return u<a?-1:u>a?1:0}function Yk(u,a=1,h=!1){let p=1/0,_=1/0,w=-1/0,T=-1/0;const k=u[0];for(let ie=0;ie<k.length;ie++){const re=k[ie];(!ie||re.x<p)&&(p=re.x),(!ie||re.y<_)&&(_=re.y),(!ie||re.x>w)&&(w=re.x),(!ie||re.y>T)&&(T=re.y)}const M=Math.min(w-p,T-_);let P=M/2;const F=new Zk([],Jk);if(M===0)return new E(p,_);for(let ie=p;ie<w;ie+=M)for(let re=_;re<T;re+=M)F.push(new Fu(ie+P,re+P,P,u));let G=function(ie){let re=0,de=0,we=0;const Ie=ie[0];for(let Ue=0,Me=Ie.length,He=Me-1;Ue<Me;He=Ue++){const $e=Ie[Ue],wt=Ie[He],ci=$e.x*wt.y-wt.x*$e.y;de+=($e.x+wt.x)*ci,we+=($e.y+wt.y)*ci,re+=3*ci}return new Fu(de/re,we/re,0,ie)}(u),X=F.length;for(;F.length;){const ie=F.pop();(ie.d>G.d||!G.d)&&(G=ie,h&&console.log("found best %d after %d probes",Math.round(1e4*ie.d)/1e4,X)),ie.max-G.d<=a||(P=ie.h/2,F.push(new Fu(ie.p.x-P,ie.p.y-P,P,u)),F.push(new Fu(ie.p.x+P,ie.p.y-P,P,u)),F.push(new Fu(ie.p.x-P,ie.p.y+P,P,u)),F.push(new Fu(ie.p.x+P,ie.p.y+P,P,u)),X+=4)}return h&&(console.log(`num probes: ${X}`),console.log(`best distance: ${G.d}`)),G.p}function Jk(u,a){return a.max-u.max}function Fu(u,a,h,p){this.p=new E(u,a),this.h=h,this.d=function(_,w){let T=!1,k=1/0;for(let M=0;M<w.length;M++){const P=w[M];for(let F=0,G=P.length,X=G-1;F<G;X=F++){const ie=P[F],re=P[X];ie.y>_.y!=re.y>_.y&&_.x<(re.x-ie.x)*(_.y-ie.y)/(re.y-ie.y)+ie.x&&(T=!T),k=Math.min(k,Gy(_,ie,re))}}return(T?1:-1)*Math.sqrt(k)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}var ps;r.aq=void 0,(ps=r.aq||(r.aq={}))[ps.center=1]="center",ps[ps.left=2]="left",ps[ps.right=3]="right",ps[ps.top=4]="top",ps[ps.bottom=5]="bottom",ps[ps["top-left"]=6]="top-left",ps[ps["top-right"]=7]="top-right",ps[ps["bottom-left"]=8]="bottom-left",ps[ps["bottom-right"]=9]="bottom-right";const _c=7,bg=Number.POSITIVE_INFINITY;function lv(u,a){return a[1]!==bg?function(h,p,_){let w=0,T=0;switch(p=Math.abs(p),_=Math.abs(_),h){case"top-right":case"top-left":case"top":T=_-_c;break;case"bottom-right":case"bottom-left":case"bottom":T=-_+_c}switch(h){case"top-right":case"bottom-right":case"right":w=-p;break;case"top-left":case"bottom-left":case"left":w=p}return[w,T]}(u,a[0],a[1]):function(h,p){let _=0,w=0;p<0&&(p=0);const T=p/Math.SQRT2;switch(h){case"top-right":case"top-left":w=T-_c;break;case"bottom-right":case"bottom-left":w=-T+_c;break;case"bottom":w=-p+_c;break;case"top":w=p-_c}switch(h){case"top-right":case"bottom-right":_=-T;break;case"top-left":case"bottom-left":_=T;break;case"left":_=p;break;case"right":_=-p}return[_,w]}(u,a[0])}function cv(u,a,h){var p;const _=u.layout,w=(p=_.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(a,{},h);if(w){const k=w.values,M=[];for(let P=0;P<k.length;P+=2){const F=M[P]=k[P],G=k[P+1].map(X=>X*qr);F.startsWith("top")?G[1]-=_c:F.startsWith("bottom")&&(G[1]+=_c),M[P+1]=G}return new zr(M)}const T=_.get("text-variable-anchor");if(T){let k;k=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[_.get("text-radial-offset").evaluate(a,{},h)*qr,bg]:_.get("text-offset").evaluate(a,{},h).map(P=>P*qr);const M=[];for(const P of T)M.push(P,lv(P,k));return new zr(M)}return null}function xg(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Xk(u,a,h,p,_,w,T,k,M,P,F){let G=w.textMaxSize.evaluate(a,{});G===void 0&&(G=T);const X=u.layers[0].layout,ie=X.get("icon-offset").evaluate(a,{},F),re=hv(h.horizontal),de=T/24,we=u.tilePixelRatio*de,Ie=u.tilePixelRatio*G/24,Ue=u.tilePixelRatio*k,Me=u.tilePixelRatio*X.get("symbol-spacing"),He=X.get("text-padding")*u.tilePixelRatio,$e=function(jt,Li,Ti,an=1){const or=jt.get("icon-padding").evaluate(Li,{},Ti),fr=or&&or.values;return[fr[0]*an,fr[1]*an,fr[2]*an,fr[3]*an]}(X,a,F,u.tilePixelRatio),wt=X.get("text-max-angle")/180*Math.PI,ci=X.get("text-rotation-alignment")!=="viewport"&&X.get("symbol-placement")!=="point",bi=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",li=X.get("symbol-placement"),ti=Me/2,Zt=X.get("icon-text-fit");let pi;p&&Zt!=="none"&&(u.allowVerticalPlacement&&h.vertical&&(pi=R1(p,h.vertical,Zt,X.get("icon-text-fit-padding"),ie,de)),re&&(p=R1(p,re,Zt,X.get("icon-text-fit-padding"),ie,de)));const Yt=(jt,Li)=>{Li.x<0||Li.x>=Vr||Li.y<0||Li.y>=Vr||function(Ti,an,or,fr,Zr,_a,Ns,Fr,as,gs,zs,Bs,Wr,Yr,Es,Vs,Ts,na,ra,Jr,fn,Ss,_s,Xr,to){const yo=Ti.addToLineVertexArray(an,or);let vo,xl,io,Ma,sa=0,wl=0,_d=0,pv=0,Og=-1,Cg=-1;const Al={};let gv=_l("");if(Ti.allowVerticalPlacement&&fr.vertical){const Is=Fr.layout.get("text-rotate").evaluate(fn,{},Xr)+90;io=new Wf(as,an,gs,zs,Bs,fr.vertical,Wr,Yr,Es,Is),Ns&&(Ma=new Wf(as,an,gs,zs,Bs,Ns,Ts,na,Es,Is))}if(Zr){const Is=Fr.layout.get("icon-rotate").evaluate(fn,{}),Da=Fr.layout.get("icon-text-fit")!=="none",Uc=av(Zr,Is,_s,Da),xo=Ns?av(Ns,Is,_s,Da):void 0;xl=new Wf(as,an,gs,zs,Bs,Zr,Ts,na,!1,Is),sa=4*Uc.length;const jc=Ti.iconSizeData;let Zo=null;jc.kind==="source"?(Zo=[qo*Fr.layout.get("icon-size").evaluate(fn,{})],Zo[0]>mc&&rt(`${Ti.layerIds[0]}: Value for "icon-size" is >= ${fd}. Reduce your "icon-size".`)):jc.kind==="composite"&&(Zo=[qo*Ss.compositeIconSizes[0].evaluate(fn,{},Xr),qo*Ss.compositeIconSizes[1].evaluate(fn,{},Xr)],(Zo[0]>mc||Zo[1]>mc)&&rt(`${Ti.layerIds[0]}: Value for "icon-size" is >= ${fd}. Reduce your "icon-size".`)),Ti.addSymbols(Ti.icon,Uc,Zo,Jr,ra,fn,r.ai.none,an,yo.lineStartIndex,yo.lineLength,-1,Xr),Og=Ti.icon.placedSymbolArray.length-1,xo&&(wl=4*xo.length,Ti.addSymbols(Ti.icon,xo,Zo,Jr,ra,fn,r.ai.vertical,an,yo.lineStartIndex,yo.lineLength,-1,Xr),Cg=Ti.icon.placedSymbolArray.length-1)}const _v=Object.keys(fr.horizontal);for(const Is of _v){const Da=fr.horizontal[Is];if(!vo){gv=_l(Da.text);const xo=Fr.layout.get("text-rotate").evaluate(fn,{},Xr);vo=new Wf(as,an,gs,zs,Bs,Da,Wr,Yr,Es,xo)}const Uc=Da.positionedLines.length===1;if(_d+=uv(Ti,an,Da,_a,Fr,Es,fn,Vs,yo,fr.vertical?r.ai.horizontal:r.ai.horizontalOnly,Uc?_v:[Is],Al,Og,Ss,Xr),Uc)break}fr.vertical&&(pv+=uv(Ti,an,fr.vertical,_a,Fr,Es,fn,Vs,yo,r.ai.vertical,["vertical"],Al,Cg,Ss,Xr));const eO=vo?vo.boxStartIndex:Ti.collisionBoxArray.length,tO=vo?vo.boxEndIndex:Ti.collisionBoxArray.length,iO=io?io.boxStartIndex:Ti.collisionBoxArray.length,nO=io?io.boxEndIndex:Ti.collisionBoxArray.length,rO=xl?xl.boxStartIndex:Ti.collisionBoxArray.length,sO=xl?xl.boxEndIndex:Ti.collisionBoxArray.length,aO=Ma?Ma.boxStartIndex:Ti.collisionBoxArray.length,oO=Ma?Ma.boxEndIndex:Ti.collisionBoxArray.length;let bo=-1;const Jf=(Is,Da)=>Is&&Is.circleDiameter?Math.max(Is.circleDiameter,Da):Da;bo=Jf(vo,bo),bo=Jf(io,bo),bo=Jf(xl,bo),bo=Jf(Ma,bo);const yv=bo>-1?1:0;yv&&(bo*=to/qr),Ti.glyphOffsetArray.length>=Bu.MAX_GLYPHS&&rt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),fn.sortKey!==void 0&&Ti.addToSortKeyRanges(Ti.symbolInstances.length,fn.sortKey);const lO=cv(Fr,fn,Xr),[cO,uO]=function(Is,Da){const Uc=Is.length,xo=Da==null?void 0:Da.values;if((xo==null?void 0:xo.length)>0)for(let jc=0;jc<xo.length;jc+=2){const Zo=xo[jc+1];Is.emplaceBack(r.aq[xo[jc]],Zo[0],Zo[1])}return[Uc,Is.length]}(Ti.textAnchorOffsets,lO);Ti.symbolInstances.emplaceBack(an.x,an.y,Al.right>=0?Al.right:-1,Al.center>=0?Al.center:-1,Al.left>=0?Al.left:-1,Al.vertical||-1,Og,Cg,gv,eO,tO,iO,nO,rO,sO,aO,oO,gs,_d,pv,sa,wl,yv,0,Wr,bo,cO,uO)}(u,Li,jt,h,p,_,pi,u.layers[0],u.collisionBoxArray,a.index,a.sourceLayerIndex,u.index,we,[He,He,He,He],ci,M,Ue,$e,bi,ie,a,w,P,F,T)};if(li==="line")for(const jt of ev(a.geometry,0,0,Vr,Vr)){const Li=qk(jt,Me,wt,h.vertical||re,p,24,Ie,u.overscaling,Vr);for(const Ti of Li)re&&Qk(u,re.text,ti,Ti)||Yt(jt,Ti)}else if(li==="line-center"){for(const jt of a.geometry)if(jt.length>1){const Li=Kk(jt,wt,h.vertical||re,p,24,Ie);Li&&Yt(jt,Li)}}else if(a.type==="Polygon")for(const jt of $p(a.geometry,0)){const Li=Yk(jt,16);Yt(jt[0],new gc(Li.x,Li.y,0))}else if(a.type==="LineString")for(const jt of a.geometry)Yt(jt,new gc(jt[0].x,jt[0].y,0));else if(a.type==="Point")for(const jt of a.geometry)for(const Li of jt)Yt([Li],new gc(Li.x,Li.y,0))}function uv(u,a,h,p,_,w,T,k,M,P,F,G,X,ie,re){const de=function(Ue,Me,He,$e,wt,ci,bi,li){const ti=$e.layout.get("text-rotate").evaluate(ci,{})*Math.PI/180,Zt=[];for(const pi of Me.positionedLines)for(const Yt of pi.positionedGlyphs){if(!Yt.rect)continue;const jt=Yt.rect||{};let Li=S1+1,Ti=!0,an=1,or=0;const fr=(wt||li)&&Yt.vertical,Zr=Yt.metrics.advance*Yt.scale/2;if(li&&Me.verticalizable&&(or=pi.lineOffset/2-(Yt.imageName?-(qr-Yt.metrics.width*Yt.scale)/2:(Yt.scale-1)*qr)),Yt.imageName){const Jr=bi[Yt.imageName];Ti=Jr.sdf,an=Jr.pixelRatio,Li=ia/an}const _a=wt?[Yt.x+Zr,Yt.y]:[0,0];let Ns=wt?[0,0]:[Yt.x+Zr+He[0],Yt.y+He[1]-or],Fr=[0,0];fr&&(Fr=Ns,Ns=[0,0]);const as=Yt.metrics.isDoubleResolution?2:1,gs=(Yt.metrics.left-Li)*Yt.scale-Zr+Ns[0],zs=(-Yt.metrics.top-Li)*Yt.scale+Ns[1],Bs=gs+jt.w/as*Yt.scale/an,Wr=zs+jt.h/as*Yt.scale/an,Yr=new E(gs,zs),Es=new E(Bs,zs),Vs=new E(gs,Wr),Ts=new E(Bs,Wr);if(fr){const Jr=new E(-Zr,Zr-hd),fn=-Math.PI/2,Ss=qr/2-Zr,_s=new E(5-hd-Ss,-(Yt.imageName?Ss:0)),Xr=new E(...Fr);Yr._rotateAround(fn,Jr)._add(_s)._add(Xr),Es._rotateAround(fn,Jr)._add(_s)._add(Xr),Vs._rotateAround(fn,Jr)._add(_s)._add(Xr),Ts._rotateAround(fn,Jr)._add(_s)._add(Xr)}if(ti){const Jr=Math.sin(ti),fn=Math.cos(ti),Ss=[fn,-Jr,Jr,fn];Yr._matMult(Ss),Es._matMult(Ss),Vs._matMult(Ss),Ts._matMult(Ss)}const na=new E(0,0),ra=new E(0,0);Zt.push({tl:Yr,tr:Es,bl:Vs,br:Ts,tex:jt,writingMode:Me.writingMode,glyphOffset:_a,sectionIndex:Yt.sectionIndex,isSDF:Ti,pixelOffsetTL:na,pixelOffsetBR:ra,minFontScaleX:0,minFontScaleY:0})}return Zt}(0,h,k,_,w,T,p,u.allowVerticalPlacement),we=u.textSizeData;let Ie=null;we.kind==="source"?(Ie=[qo*_.layout.get("text-size").evaluate(T,{})],Ie[0]>mc&&rt(`${u.layerIds[0]}: Value for "text-size" is >= ${fd}. Reduce your "text-size".`)):we.kind==="composite"&&(Ie=[qo*ie.compositeTextSizes[0].evaluate(T,{},re),qo*ie.compositeTextSizes[1].evaluate(T,{},re)],(Ie[0]>mc||Ie[1]>mc)&&rt(`${u.layerIds[0]}: Value for "text-size" is >= ${fd}. Reduce your "text-size".`)),u.addSymbols(u.text,de,Ie,k,w,T,P,a,M.lineStartIndex,M.lineLength,X,re);for(const Ue of F)G[Ue]=u.text.placedSymbolArray.length-1;return 4*de.length}function hv(u){for(const a in u)return u[a];return null}function Qk(u,a,h,p){const _=u.compareText;if(a in _){const w=_[a];for(let T=w.length-1;T>=0;T--)if(p.dist(w[T])<h)return!0}else _[a]=[];return _[a].push(p),!1}const dv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class wg{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,p]=new Uint8Array(a,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=p>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const w=dv[15&p];if(!w)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(a,2,1),[k]=new Uint32Array(a,4,1);return new wg(k,T,w,a)}constructor(a,h=64,p=Float64Array,_){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=p,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const w=dv.indexOf(this.ArrayType),T=2*a*this.ArrayType.BYTES_PER_ELEMENT,k=a*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-k%8)%8;if(w<0)throw new Error(`Unexpected typed array class: ${p}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+k+M,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+T+k+M),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+k+M,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+w]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=a)}add(a,h){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=a,this.coords[this._pos++]=h,p}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return Ag(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,h,p,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:w,coords:T,nodeSize:k}=this,M=[0,w.length-1,0],P=[];for(;M.length;){const F=M.pop()||0,G=M.pop()||0,X=M.pop()||0;if(G-X<=k){for(let we=X;we<=G;we++){const Ie=T[2*we],Ue=T[2*we+1];Ie>=a&&Ie<=p&&Ue>=h&&Ue<=_&&P.push(w[we])}continue}const ie=X+G>>1,re=T[2*ie],de=T[2*ie+1];re>=a&&re<=p&&de>=h&&de<=_&&P.push(w[ie]),(F===0?a<=re:h<=de)&&(M.push(X),M.push(ie-1),M.push(1-F)),(F===0?p>=re:_>=de)&&(M.push(ie+1),M.push(G),M.push(1-F))}return P}within(a,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:w,nodeSize:T}=this,k=[0,_.length-1,0],M=[],P=p*p;for(;k.length;){const F=k.pop()||0,G=k.pop()||0,X=k.pop()||0;if(G-X<=T){for(let we=X;we<=G;we++)mv(w[2*we],w[2*we+1],a,h)<=P&&M.push(_[we]);continue}const ie=X+G>>1,re=w[2*ie],de=w[2*ie+1];mv(re,de,a,h)<=P&&M.push(_[ie]),(F===0?a-p<=re:h-p<=de)&&(k.push(X),k.push(ie-1),k.push(1-F)),(F===0?a+p>=re:h+p>=de)&&(k.push(ie+1),k.push(G),k.push(1-F))}return M}}function Ag(u,a,h,p,_,w){if(_-p<=h)return;const T=p+_>>1;fv(u,a,T,p,_,w),Ag(u,a,h,p,T-1,1-w),Ag(u,a,h,T+1,_,1-w)}function fv(u,a,h,p,_,w){for(;_>p;){if(_-p>600){const P=_-p+1,F=h-p+1,G=Math.log(P),X=.5*Math.exp(2*G/3),ie=.5*Math.sqrt(G*X*(P-X)/P)*(F-P/2<0?-1:1);fv(u,a,h,Math.max(p,Math.floor(h-F*X/P+ie)),Math.min(_,Math.floor(h+(P-F)*X/P+ie)),w)}const T=a[2*h+w];let k=p,M=_;for(pd(u,a,p,h),a[2*_+w]>T&&pd(u,a,p,_);k<M;){for(pd(u,a,k,M),k++,M--;a[2*k+w]<T;)k++;for(;a[2*M+w]>T;)M--}a[2*p+w]===T?pd(u,a,p,M):(M++,pd(u,a,M,_)),M<=h&&(p=M+1),h<=M&&(_=M-1)}}function pd(u,a,h,p){Eg(u,h,p),Eg(a,2*h,2*p),Eg(a,2*h+1,2*p+1)}function Eg(u,a,h){const p=u[a];u[a]=u[h],u[h]=p}function mv(u,a,h,p){const _=u-h,w=a-p;return _*_+w*w}var Tg;r.bh=void 0,(Tg=r.bh||(r.bh={})).create="create",Tg.load="load",Tg.fullLoad="fullLoad";let Yf=null,gd=[];const Sg=1e3/60,Ig="loadTime",kg="fullLoadTime",$k={mark(u){performance.mark(u)},frame(u){const a=u;Yf!=null&&gd.push(a-Yf),Yf=a},clearMetrics(){Yf=null,gd=[],performance.clearMeasures(Ig),performance.clearMeasures(kg);for(const u in r.bh)performance.clearMarks(r.bh[u])},getPerformanceMetrics(){performance.measure(Ig,r.bh.create,r.bh.load),performance.measure(kg,r.bh.create,r.bh.fullLoad);const u=performance.getEntriesByName(Ig)[0].duration,a=performance.getEntriesByName(kg)[0].duration,h=gd.length,p=1/(gd.reduce((w,T)=>w+T,0)/h/1e3),_=gd.filter(w=>w>Sg).reduce((w,T)=>w+(T-Sg)/Sg,0);return{loadTime:u,fullLoadTime:a,fps:p,percentDroppedFrames:_/(h+_)*100,totalFrames:h}}};r.$=function(u,a,h){var p,_,w,T,k,M,P,F,G,X,ie,re,de=h[0],we=h[1],Ie=h[2];return a===u?(u[12]=a[0]*de+a[4]*we+a[8]*Ie+a[12],u[13]=a[1]*de+a[5]*we+a[9]*Ie+a[13],u[14]=a[2]*de+a[6]*we+a[10]*Ie+a[14],u[15]=a[3]*de+a[7]*we+a[11]*Ie+a[15]):(_=a[1],w=a[2],T=a[3],k=a[4],M=a[5],P=a[6],F=a[7],G=a[8],X=a[9],ie=a[10],re=a[11],u[0]=p=a[0],u[1]=_,u[2]=w,u[3]=T,u[4]=k,u[5]=M,u[6]=P,u[7]=F,u[8]=G,u[9]=X,u[10]=ie,u[11]=re,u[12]=p*de+k*we+G*Ie+a[12],u[13]=_*de+M*we+X*Ie+a[13],u[14]=w*de+P*we+ie*Ie+a[14],u[15]=T*de+F*we+re*Ie+a[15]),u},r.A=Du,r.B=is,r.C=class{constructor(u,a,h){this.receive=p=>{const _=p.data,w=_.id;if(w&&(!_.targetMapId||this.mapId===_.targetMapId))if(_.type==="<cancel>"){delete this.tasks[w];const T=this.cancelCallbacks[w];delete this.cancelCallbacks[w],T&&T()}else Ve()||_.mustQueue?(this.tasks[w]=_,this.taskQueue.push(w),this.invoker.trigger()):this.processTask(w,_)},this.process=()=>{if(!this.taskQueue.length)return;const p=this.taskQueue.shift(),_=this.tasks[p];delete this.tasks[p],this.taskQueue.length&&this.invoker.trigger(),_&&this.processTask(p,_)},this.target=u,this.parent=a,this.mapId=h,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new Gk(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ve()?u:window}send(u,a,h,p,_=!1){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(this.callbacks[w]=h);const T=[],k={id:w,type:u,hasCallback:!!h,targetMapId:p,mustQueue:_,sourceMapId:this.mapId,data:Ds(a,T)};return this.target.postMessage(k,{transfer:T}),{cancel:()=>{h&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}processTask(u,a){if(a.type==="<response>"){const h=this.callbacks[u];delete this.callbacks[u],h&&(a.error?h(ka(a.error)):h(null,ka(a.data)))}else{let h=!1;const p=[],_=a.hasCallback?(k,M)=>{h=!0,delete this.cancelCallbacks[u];const P={id:u,type:"<response>",sourceMapId:this.mapId,error:k?Ds(k):null,data:Ds(M,p)};this.target.postMessage(P,{transfer:p})}:k=>{h=!0};let w=null;const T=ka(a.data);if(this.parent[a.type])w=this.parent[a.type](a.sourceMapId,T,_);else if("getWorkerSource"in this.parent){const k=a.type.split(".");w=this.parent.getWorkerSource(a.sourceMapId,k[0],T.source)[k[1]](T,_)}else _(new Error(`Could not find function ${a.type}`));!h&&w&&w.cancel&&(this.cancelCallbacks[u]=w.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},r.D=Ii,r.E=zn,r.F=function(u,a){const h={};for(let p=0;p<a.length;p++){const _=a[p];_ in u&&(h[_]=u[_])}return h},r.G=j1,r.H=G1,r.I=cg,r.J=K,r.K=W,r.L=pc,r.M=vt,r.N=Vr,r.O=Ca,r.P=E,r.Q=pr,r.R=Oa,r.S=ar,r.T=Ef,r.U=Hf,r.V=class extends pl{},r.W=vg,r.X=function(u,a){const h=window.document.createElement("video");h.muted=!0,h.onloadstart=function(){a(null,h)};for(let p=0;p<u.length;p++){const _=window.document.createElement("source");ni(u[p])||(h.crossOrigin="Anonymous"),_.src=u[p],h.appendChild(_)}return{cancel:()=>{}}},r.Y=Nt,r.Z=function(){var u=new Du(16);return Du!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},r._=f,r.a=zt,r.a$=class extends ee{},r.a0=function(u,a,h){var p=h[0],_=h[1],w=h[2];return u[0]=a[0]*p,u[1]=a[1]*p,u[2]=a[2]*p,u[3]=a[3]*p,u[4]=a[4]*_,u[5]=a[5]*_,u[6]=a[6]*_,u[7]=a[7]*_,u[8]=a[8]*w,u[9]=a[9]*w,u[10]=a[10]*w,u[11]=a[11]*w,u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},r.a1=Zy,r.a2=function(){return _e++},r.a3=be,r.a4=Bu,r.a5=function(){ea.isLoading()||ea.isLoaded()||Hh()!=="deferred"||Af()},r.a6=tc,r.a7=Vc,r.a8=sr,r.a9=J1,r.aA=Rc,r.aB=function(u){u=u.slice();const a=Object.create(null);for(let h=0;h<u.length;h++)a[u[h].id]=u[h];for(let h=0;h<u.length;h++)"ref"in u[h]&&(u[h]=Rt(u[h],a[u[h].ref]));return u},r.aC=function(u){if(u.type==="custom")return new jk(u);switch(u.type){case"background":return new Vk(u);case"circle":return new EI(u);case"fill":return new HI(u);case"fill-extrusion":return new sk(u);case"heatmap":return new SI(u);case"hillshade":return new kI(u);case"line":return new fk(u);case"raster":return new Uk(u);case"symbol":return new Gf(u)}},r.aD=mt,r.aE=function(u,a){if(!u)return[{command:Ui.setStyle,args:[a]}];let h=[];try{if(!Xi(u.version,a.version))return[{command:Ui.setStyle,args:[a]}];Xi(u.center,a.center)||h.push({command:Ui.setCenter,args:[a.center]}),Xi(u.zoom,a.zoom)||h.push({command:Ui.setZoom,args:[a.zoom]}),Xi(u.bearing,a.bearing)||h.push({command:Ui.setBearing,args:[a.bearing]}),Xi(u.pitch,a.pitch)||h.push({command:Ui.setPitch,args:[a.pitch]}),Xi(u.sprite,a.sprite)||h.push({command:Ui.setSprite,args:[a.sprite]}),Xi(u.glyphs,a.glyphs)||h.push({command:Ui.setGlyphs,args:[a.glyphs]}),Xi(u.transition,a.transition)||h.push({command:Ui.setTransition,args:[a.transition]}),Xi(u.light,a.light)||h.push({command:Ui.setLight,args:[a.light]});const p={},_=[];(function(T,k,M,P){let F;for(F in k=k||{},T=T||{})Object.prototype.hasOwnProperty.call(T,F)&&(Object.prototype.hasOwnProperty.call(k,F)||mr(F,M,P));for(F in k)Object.prototype.hasOwnProperty.call(k,F)&&(Object.prototype.hasOwnProperty.call(T,F)?Xi(T[F],k[F])||(T[F].type==="geojson"&&k[F].type==="geojson"&&jr(T,k,F)?M.push({command:Ui.setGeoJSONSourceData,args:[F,k[F].data]}):vr(F,k,M,P)):Gn(F,k,M))})(u.sources,a.sources,_,p);const w=[];u.layers&&u.layers.forEach(T=>{p[T.source]?h.push({command:Ui.removeLayer,args:[T.id]}):w.push(T)}),h=h.concat(_),function(T,k,M){k=k||[];const P=(T=T||[]).map(lr),F=k.map(lr),G=T.reduce(Hn,{}),X=k.reduce(Hn,{}),ie=P.slice(),re=Object.create(null);let de,we,Ie,Ue,Me,He,$e;for(de=0,we=0;de<P.length;de++)Ie=P[de],Object.prototype.hasOwnProperty.call(X,Ie)?we++:(M.push({command:Ui.removeLayer,args:[Ie]}),ie.splice(ie.indexOf(Ie,we),1));for(de=0,we=0;de<F.length;de++)Ie=F[F.length-1-de],ie[ie.length-1-de]!==Ie&&(Object.prototype.hasOwnProperty.call(G,Ie)?(M.push({command:Ui.removeLayer,args:[Ie]}),ie.splice(ie.lastIndexOf(Ie,ie.length-we),1)):we++,He=ie[ie.length-de],M.push({command:Ui.addLayer,args:[X[Ie],He]}),ie.splice(ie.length-de,0,Ie),re[Ie]=!0);for(de=0;de<F.length;de++)if(Ie=F[de],Ue=G[Ie],Me=X[Ie],!re[Ie]&&!Xi(Ue,Me))if(Xi(Ue.source,Me.source)&&Xi(Ue["source-layer"],Me["source-layer"])&&Xi(Ue.type,Me.type)){for($e in Cr(Ue.layout,Me.layout,M,Ie,null,Ui.setLayoutProperty),Cr(Ue.paint,Me.paint,M,Ie,null,Ui.setPaintProperty),Xi(Ue.filter,Me.filter)||M.push({command:Ui.setFilter,args:[Ie,Me.filter]}),Xi(Ue.minzoom,Me.minzoom)&&Xi(Ue.maxzoom,Me.maxzoom)||M.push({command:Ui.setLayerZoomRange,args:[Ie,Me.minzoom,Me.maxzoom]}),Ue)Object.prototype.hasOwnProperty.call(Ue,$e)&&$e!=="layout"&&$e!=="paint"&&$e!=="filter"&&$e!=="metadata"&&$e!=="minzoom"&&$e!=="maxzoom"&&($e.indexOf("paint.")===0?Cr(Ue[$e],Me[$e],M,Ie,$e.slice(6),Ui.setPaintProperty):Xi(Ue[$e],Me[$e])||M.push({command:Ui.setLayerProperty,args:[Ie,$e,Me[$e]]}));for($e in Me)Object.prototype.hasOwnProperty.call(Me,$e)&&!Object.prototype.hasOwnProperty.call(Ue,$e)&&$e!=="layout"&&$e!=="paint"&&$e!=="filter"&&$e!=="metadata"&&$e!=="minzoom"&&$e!=="maxzoom"&&($e.indexOf("paint.")===0?Cr(Ue[$e],Me[$e],M,Ie,$e.slice(6),Ui.setPaintProperty):Xi(Ue[$e],Me[$e])||M.push({command:Ui.setLayerProperty,args:[Ie,$e,Me[$e]]}))}else M.push({command:Ui.removeLayer,args:[Ie]}),He=ie[ie.lastIndexOf(Ie)+1],M.push({command:Ui.addLayer,args:[Me,He]})}(w,a.layers,h)}catch(p){console.warn("Unable to compute style diff:",p),h=[{command:Ui.setStyle,args:[a]}]}return h},r.aF=function(u){const a=[],h=u.id;return h===void 0&&a.push({message:`layers.${h}: missing required property "id"`}),u.render===void 0&&a.push({message:`layers.${h}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&a.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),a},r.aG=function u(a,h){if(Array.isArray(a)){if(!Array.isArray(h)||a.length!==h.length)return!1;for(let p=0;p<a.length;p++)if(!u(a[p],h[p]))return!1;return!0}if(typeof a=="object"&&a!==null&&h!==null){if(typeof h!="object"||Object.keys(a).length!==Object.keys(h).length)return!1;for(const p in a)if(!u(a[p],h[p]))return!1;return!0}return a===h},r.aH=oe,r.aI=Be,r.aJ=Lc,r.aK=function(u){return u({pluginStatus:Rs,pluginURL:Ho}),Lc.on("pluginStateChange",u),u},r.aL=class extends yl{constructor(u,a){super(u,a),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},r.aM=Cu,r.aN=class extends yl{constructor(u,a){super(u,a),this.current=Up}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let a=1;a<16;a++)if(u[a]!==this.current[a]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},r.aO=kf,r.aP=class extends yl{constructor(u,a){super(u,a),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},r.aQ=class extends yl{constructor(u,a){super(u,a),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},r.aR=Of,r.aS=function(u,a,h,p,_,w,T){var k=1/(a-h),M=1/(p-_),P=1/(w-T);return u[0]=-2*k,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*M,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*P,u[11]=0,u[12]=(a+h)*k,u[13]=(_+p)*M,u[14]=(T+w)*P,u[15]=1,u},r.aT=xn,r.aU=AI,r.aV=class extends g{},r.aW=_k,r.aX=class extends A{},r.aY=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},r.aZ=Qy,r.a_=qt,r.aa=function(u){const a={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,p,_,w)=>{const T=_||w;return a[p]=!T||T.toLowerCase(),""}),a["max-age"]){const h=parseInt(a["max-age"],10);isNaN(h)?delete a["max-age"]:a["max-age"]=h}return a},r.ab=function(u,a){const h=[];for(const p in u)p in a||h.push(p);return h},r.ac=function(u){if(St==null){const a=u.navigator?u.navigator.userAgent:null;St=!!u.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return St},r.ad=ne,r.ae=function(u,a,h){var p=Math.sin(h),_=Math.cos(h),w=a[0],T=a[1],k=a[2],M=a[3],P=a[4],F=a[5],G=a[6],X=a[7];return a!==u&&(u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[0]=w*_+P*p,u[1]=T*_+F*p,u[2]=k*_+G*p,u[3]=M*_+X*p,u[4]=P*_-w*p,u[5]=F*_-T*p,u[6]=G*_-k*p,u[7]=X*_-M*p,u},r.af=function(u){var a=new Du(16);return a[0]=u[0],a[1]=u[1],a[2]=u[2],a[3]=u[3],a[4]=u[4],a[5]=u[5],a[6]=u[6],a[7]=u[7],a[8]=u[8],a[9]=u[9],a[10]=u[10],a[11]=u[11],a[12]=u[12],a[13]=u[13],a[14]=u[14],a[15]=u[15],a},r.ag=Rf,r.ah=function(u,a){let h=0,p=0;if(u.kind==="constant")p=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:_,minZoom:w,maxZoom:T}=u,k=_?ne(hs.interpolationFactor(_,a,w,T),0,1):0;u.kind==="camera"?p=is.number(u.minSize,u.maxSize,k):h=k}return{uSizeT:h,uSize:p}},r.aj=function(u,{uSize:a,uSizeT:h},{lowerSize:p,upperSize:_}){return u.kind==="source"?p/qo:u.kind==="composite"?is.number(p/qo,_/qo,h):a},r.ak=fg,r.al=function(u,a,h,p){const _=a.y-u.y,w=a.x-u.x,T=p.y-h.y,k=p.x-h.x,M=T*w-k*_;if(M===0)return null;const P=(k*(u.y-h.y)-T*(u.x-h.x))/M;return new E(u.x+P*w,u.y+P*_)},r.am=ev,r.an=Uy,r.ao=qp,r.ap=qr,r.ar=dg,r.as=function(u,a){var h=a[0],p=a[1],_=a[2],w=a[3],T=a[4],k=a[5],M=a[6],P=a[7],F=a[8],G=a[9],X=a[10],ie=a[11],re=a[12],de=a[13],we=a[14],Ie=a[15],Ue=h*k-p*T,Me=h*M-_*T,He=h*P-w*T,$e=p*M-_*k,wt=p*P-w*k,ci=_*P-w*M,bi=F*de-G*re,li=F*we-X*re,ti=F*Ie-ie*re,Zt=G*we-X*de,pi=G*Ie-ie*de,Yt=X*Ie-ie*we,jt=Ue*Yt-Me*pi+He*Zt+$e*ti-wt*li+ci*bi;return jt?(u[0]=(k*Yt-M*pi+P*Zt)*(jt=1/jt),u[1]=(_*pi-p*Yt-w*Zt)*jt,u[2]=(de*ci-we*wt+Ie*$e)*jt,u[3]=(X*wt-G*ci-ie*$e)*jt,u[4]=(M*ti-T*Yt-P*li)*jt,u[5]=(h*Yt-_*ti+w*li)*jt,u[6]=(we*He-re*ci-Ie*Me)*jt,u[7]=(F*ci-X*He+ie*Me)*jt,u[8]=(T*pi-k*ti+P*bi)*jt,u[9]=(p*ti-h*pi-w*bi)*jt,u[10]=(re*wt-de*He+Ie*Ue)*jt,u[11]=(G*He-F*wt-ie*Ue)*jt,u[12]=(k*li-T*Zt-M*bi)*jt,u[13]=(h*Zt-p*li+_*bi)*jt,u[14]=(de*Me-re*$e-we*Ue)*jt,u[15]=(F*$e-G*Me+X*Ue)*jt,u):null},r.at=xg,r.au=hg,r.av=wg,r.aw=function(){const u={},a=Xe.$version;for(const h in Xe.$root){const p=Xe.$root[h];if(p.required){let _=null;_=h==="version"?a:p.type==="array"?[]:{},_!=null&&(u[h]=_)}}return u},r.ax=Ui,r.ay=go,r.az=bt,r.b=function(u,a){const h=new Blob([new Uint8Array(u)],{type:"image/png"});createImageBitmap(h).then(p=>{a(null,p)}).catch(p=>{a(new Error(`Could not load image because of ${p.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},r.b0=rs,r.b1=function(u,a){var h=u[0],p=u[1],_=u[2],w=u[3],T=u[4],k=u[5],M=u[6],P=u[7],F=u[8],G=u[9],X=u[10],ie=u[11],re=u[12],de=u[13],we=u[14],Ie=u[15],Ue=a[0],Me=a[1],He=a[2],$e=a[3],wt=a[4],ci=a[5],bi=a[6],li=a[7],ti=a[8],Zt=a[9],pi=a[10],Yt=a[11],jt=a[12],Li=a[13],Ti=a[14],an=a[15];return Math.abs(h-Ue)<=Ps*Math.max(1,Math.abs(h),Math.abs(Ue))&&Math.abs(p-Me)<=Ps*Math.max(1,Math.abs(p),Math.abs(Me))&&Math.abs(_-He)<=Ps*Math.max(1,Math.abs(_),Math.abs(He))&&Math.abs(w-$e)<=Ps*Math.max(1,Math.abs(w),Math.abs($e))&&Math.abs(T-wt)<=Ps*Math.max(1,Math.abs(T),Math.abs(wt))&&Math.abs(k-ci)<=Ps*Math.max(1,Math.abs(k),Math.abs(ci))&&Math.abs(M-bi)<=Ps*Math.max(1,Math.abs(M),Math.abs(bi))&&Math.abs(P-li)<=Ps*Math.max(1,Math.abs(P),Math.abs(li))&&Math.abs(F-ti)<=Ps*Math.max(1,Math.abs(F),Math.abs(ti))&&Math.abs(G-Zt)<=Ps*Math.max(1,Math.abs(G),Math.abs(Zt))&&Math.abs(X-pi)<=Ps*Math.max(1,Math.abs(X),Math.abs(pi))&&Math.abs(ie-Yt)<=Ps*Math.max(1,Math.abs(ie),Math.abs(Yt))&&Math.abs(re-jt)<=Ps*Math.max(1,Math.abs(re),Math.abs(jt))&&Math.abs(de-Li)<=Ps*Math.max(1,Math.abs(de),Math.abs(Li))&&Math.abs(we-Ti)<=Ps*Math.max(1,Math.abs(we),Math.abs(Ti))&&Math.abs(Ie-an)<=Ps*Math.max(1,Math.abs(Ie),Math.abs(an))},r.b2=function(u,a){return u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[4]=a[4],u[5]=a[5],u[6]=a[6],u[7]=a[7],u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},r.b3=function(u,a,h){return u[0]=a[0]*h[0],u[1]=a[1]*h[1],u[2]=a[2]*h[2],u[3]=a[3]*h[3],u},r.b4=function(u,a){return u[0]*a[0]+u[1]*a[1]+u[2]*a[2]+u[3]*a[3]},r.b5=ue,r.b6=Z1,r.b7=H1,r.b8=function(u,a,h,p,_){var w,T=1/Math.tan(a/2);return u[0]=T/h,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=T,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,_!=null&&_!==1/0?(u[10]=(_+p)*(w=1/(p-_)),u[14]=2*_*p*w):(u[10]=-1,u[14]=-2*p),u},r.b9=function(u,a,h){var p=Math.sin(h),_=Math.cos(h),w=a[4],T=a[5],k=a[6],M=a[7],P=a[8],F=a[9],G=a[10],X=a[11];return a!==u&&(u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[4]=w*_+P*p,u[5]=T*_+F*p,u[6]=k*_+G*p,u[7]=M*_+X*p,u[8]=P*_-w*p,u[9]=F*_-T*p,u[10]=G*_-k*p,u[11]=X*_-M*p,u},r.bA=y,r.bB=v1,r.bC=$l,r.bD=ea,r.ba=se,r.bb=Y,r.bc=function(u,a){return u[0]=a[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=a[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=a[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},r.bd=class extends zc{},r.be=_g,r.bf=K1,r.bg=$k,r.bi=Mi,r.bj=function(u,a,h=!1){if(Rs===Vh||Rs===Fh||Rs===Uh)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ho=lt.resolveURL(u),Rs=Vh,jh=a,Gh(),h||Af()},r.bk=Hh,r.bl=function(u,a){const h={};for(let _=0;_<u.length;_++){const w=a&&a[u[_].id]||po(u[_]);a&&(a[u[_].id]=w);let T=h[w];T||(T=h[w]=[]),T.push(u[_])}const p=[];for(const _ in h)p.push(h[_]);return p},r.bm=ri,r.bn=Y1,r.bo=X1,r.bp=k1,r.bq=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=Vr/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const a=u.bucket.layers[0],h=a.layout,p=a._unevaluatedLayout._values,_={layoutIconSize:p["icon-size"].possiblyEvaluate(new sr(u.bucket.zoom+1),u.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new sr(u.bucket.zoom+1),u.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new sr(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:F}=u.bucket.textSizeData;_.compositeTextSizes=[p["text-size"].possiblyEvaluate(new sr(P),u.canonical),p["text-size"].possiblyEvaluate(new sr(F),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:F}=u.bucket.iconSizeData;_.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new sr(P),u.canonical),p["icon-size"].possiblyEvaluate(new sr(F),u.canonical)]}const w=h.get("text-line-height")*qr,T=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",k=h.get("text-keep-upright"),M=h.get("text-size");for(const P of u.bucket.features){const F=h.get("text-font").evaluate(P,{},u.canonical).join(","),G=M.evaluate(P,{},u.canonical),X=_.layoutTextSize.evaluate(P,{},u.canonical),ie=_.layoutIconSize.evaluate(P,{},u.canonical),re={horizontal:{},vertical:void 0},de=P.text;let we,Ie=[0,0];if(de){const He=de.toString(),$e=h.get("text-letter-spacing").evaluate(P,{},u.canonical)*qr,wt=jo(He)?$e:0,ci=h.get("text-anchor").evaluate(P,{},u.canonical),bi=cv(a,P,u.canonical);if(!bi){const Yt=h.get("text-radial-offset").evaluate(P,{},u.canonical);Ie=Yt?lv(ci,[Yt*qr,bg]):h.get("text-offset").evaluate(P,{},u.canonical).map(jt=>jt*qr)}let li=T?"center":h.get("text-justify").evaluate(P,{},u.canonical);const ti=h.get("symbol-placement"),Zt=ti==="point"?h.get("text-max-width").evaluate(P,{},u.canonical)*qr:0,pi=()=>{u.bucket.allowVerticalPlacement&&oc(He)&&(re.vertical=Ff(de,u.glyphMap,u.glyphPositions,u.imagePositions,F,Zt,w,ci,"left",wt,Ie,r.ai.vertical,!0,ti,X,G))};if(!T&&bi){const Yt=new Set;if(li==="auto")for(let Li=0;Li<bi.values.length;Li+=2)Yt.add(xg(bi.values[Li]));else Yt.add(li);let jt=!1;for(const Li of Yt)if(!re.horizontal[Li])if(jt)re.horizontal[Li]=re.horizontal[0];else{const Ti=Ff(de,u.glyphMap,u.glyphPositions,u.imagePositions,F,Zt,w,"center",Li,wt,Ie,r.ai.horizontal,!1,ti,X,G);Ti&&(re.horizontal[Li]=Ti,jt=Ti.positionedLines.length===1)}pi()}else{li==="auto"&&(li=xg(ci));const Yt=Ff(de,u.glyphMap,u.glyphPositions,u.imagePositions,F,Zt,w,ci,li,wt,Ie,r.ai.horizontal,!1,ti,X,G);Yt&&(re.horizontal[li]=Yt),pi(),oc(He)&&T&&k&&(re.vertical=Ff(de,u.glyphMap,u.glyphPositions,u.imagePositions,F,Zt,w,ci,li,wt,Ie,r.ai.vertical,!1,ti,X,G))}}let Ue=!1;if(P.icon&&P.icon.name){const He=u.imageMap[P.icon.name];He&&(we=Lk(u.imagePositions[P.icon.name],h.get("icon-offset").evaluate(P,{},u.canonical),h.get("icon-anchor").evaluate(P,{},u.canonical)),Ue=!!He.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=Ue:u.bucket.sdfIcons!==Ue&&rt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(He.pixelRatio!==u.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const Me=hv(re.horizontal)||re.vertical;u.bucket.iconsInText=!!Me&&Me.iconsInText,(Me||we)&&Xk(u.bucket,P,re,we,u.imageMap,_,X,ie,Ie,Ue,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},r.br=sg,r.bs=ig,r.bt=rg,r.bu=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},r.bv=og,r.bw=dc,r.bx=function(u,a,h,p,_){return f(this,void 0,void 0,function*(){if(W())try{return yield vt(u,a,h,p,_)}catch{}return function(w,T,k,M,P){const F=w.width,G=w.height;pt&&Pt||(pt=new OffscreenCanvas(F,G),Pt=pt.getContext("2d",{willReadFrequently:!0})),pt.width=F,pt.height=G,Pt.drawImage(w,0,0,F,G);const X=Pt.getImageData(T,k,M,P);return Pt.clearRect(0,0,F,G),X.data}(u,a,h,p,_)})},r.by=W1,r.bz=m,r.c=Gt,r.d=function(u,a){const h=new Image;h.onload=()=>{a(null,h),URL.revokeObjectURL(h.src),h.onload=null,window.requestAnimationFrame(()=>{h.src=mi})},h.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(u)],{type:"image/png"});h.src=u.byteLength?URL.createObjectURL(p):mi},r.e=ve,r.f=function(u,a){return dt(ve(u,{type:"json"}),a)},r.g=ze,r.h=lt,r.i=Ve,r.j=zi,r.k=et,r.l=_t,r.m=dt,r.n=function(u){return new og(u).readFields(kk,[])},r.o=function(u,a,h){if(!u.length)return h(null,[]);let p=u.length;const _=new Array(u.length);let w=null;u.forEach((T,k)=>{a(T,(M,P)=>{M&&(w=M),_[k]=P,--p==0&&h(w,_)})})},r.p=I1,r.q=nd,r.r=Dr,r.s=ni,r.t=Vn,r.u=Wt,r.v=Xe,r.w=rt,r.x=Qs,r.y=Ia,r.z=function([u,a,h]){return a+=90,a*=Math.PI/180,h*=Math.PI/180,{x:u*Math.cos(a)*Math.sin(h),y:u*Math.sin(a)*Math.sin(h),z:u*Math.cos(h)}}}),l(["./shared"],function(r){class f{constructor(V){this.keyCache={},V&&this.replace(V)}replace(V){this._layerConfigs={},this._layers={},this.update(V,[])}update(V,q){for(const le of V){this._layerConfigs[le.id]=le;const ce=this._layers[le.id]=r.aC(le);ce._featureFilter=r.a6(ce.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(const le of q)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};const J=r.bl(Object.values(this._layerConfigs),this.keyCache);for(const le of J){const ce=le.map(gt=>this._layers[gt.id]),Oe=ce[0];if(Oe.visibility==="none")continue;const Ae=Oe.source||"";let ye=this.familiesBySource[Ae];ye||(ye=this.familiesBySource[Ae]={});const Ce=Oe.sourceLayer||"_geojsonTileLayer";let ot=ye[Ce];ot||(ot=ye[Ce]=[]),ot.push(ce)}}}class m{constructor(V){const q={},J=[];for(const Ae in V){const ye=V[Ae],Ce=q[Ae]={};for(const ot in ye){const gt=ye[+ot];if(!gt||gt.bitmap.width===0||gt.bitmap.height===0)continue;const ht={x:0,y:0,w:gt.bitmap.width+2,h:gt.bitmap.height+2};J.push(ht),Ce[ot]={rect:ht,metrics:gt.metrics}}}const{w:le,h:ce}=r.p(J),Oe=new r.q({width:le||1,height:ce||1});for(const Ae in V){const ye=V[Ae];for(const Ce in ye){const ot=ye[+Ce];if(!ot||ot.bitmap.width===0||ot.bitmap.height===0)continue;const gt=q[Ae][Ce].rect;r.q.copy(ot.bitmap,Oe,{x:0,y:0},{x:gt.x+1,y:gt.y+1},ot.bitmap)}}this.image=Oe,this.positions=q}}r.bm("GlyphAtlas",m);class y{constructor(V){this.tileID=new r.O(V.tileID.overscaledZ,V.tileID.wrap,V.tileID.canonical.z,V.tileID.canonical.x,V.tileID.canonical.y),this.uid=V.uid,this.zoom=V.zoom,this.pixelRatio=V.pixelRatio,this.tileSize=V.tileSize,this.source=V.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=V.showCollisionBoxes,this.collectResourceTiming=!!V.collectResourceTiming,this.returnDependencies=!!V.returnDependencies,this.promoteId=V.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(V,q,J,le,ce){this.status="parsing",this.data=V,this.collisionBoxArray=new r.a3;const Oe=new r.bn(Object.keys(V.layers).sort()),Ae=new r.bo(this.tileID,this.promoteId);Ae.bucketLayerIDs=[];const ye={},Ce={featureIndex:Ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:J},ot=q.familiesBySource[this.source];for(const It in ot){const yi=V.layers[It];if(!yi)continue;yi.version===1&&r.w(`Vector tile source "${this.source}" layer "${It}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const gn=Oe.encode(It),Zi=[];for(let In=0;In<yi.length;In++){const Cn=yi.feature(In),cr=Ae.getId(Cn,It);Zi.push({feature:Cn,id:cr,index:In,sourceLayerIndex:gn})}for(const In of ot[It]){const Cn=In[0];Cn.source!==this.source&&r.w(`layer.source = ${Cn.source} does not equal this.source = ${this.source}`),Cn.minzoom&&this.zoom<Math.floor(Cn.minzoom)||Cn.maxzoom&&this.zoom>=Cn.maxzoom||Cn.visibility!=="none"&&(b(In,this.zoom,J),(ye[Cn.id]=Cn.createBucket({index:Ae.bucketLayerIDs.length,layers:In,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:gn,sourceID:this.source})).populate(Zi,Ce,this.tileID.canonical),Ae.bucketLayerIDs.push(In.map(cr=>cr.id)))}}let gt,ht,di,Oi;const ai=r.aH(Ce.glyphDependencies,It=>Object.keys(It).map(Number));this.inFlightDependencies.forEach(It=>It==null?void 0:It.cancel()),this.inFlightDependencies=[];const _i=++this.dependencySentinel;Object.keys(ai).length?this.inFlightDependencies.push(le.send("getGlyphs",{uid:this.uid,stacks:ai,source:this.source,tileID:this.tileID,type:"glyphs"},(It,yi)=>{_i===this.dependencySentinel&&(gt||(gt=It,ht=yi,Dt.call(this)))})):ht={};const ji=Object.keys(Ce.iconDependencies);ji.length?this.inFlightDependencies.push(le.send("getImages",{icons:ji,source:this.source,tileID:this.tileID,type:"icons"},(It,yi)=>{_i===this.dependencySentinel&&(gt||(gt=It,di=yi,Dt.call(this)))})):di={};const ke=Object.keys(Ce.patternDependencies);function Dt(){if(gt)return ce(gt);if(ht&&di&&Oi){const It=new m(ht),yi=new r.bp(di,Oi);for(const gn in ye){const Zi=ye[gn];Zi instanceof r.a4?(b(Zi.layers,this.zoom,J),r.bq({bucket:Zi,glyphMap:ht,glyphPositions:It.positions,imageMap:di,imagePositions:yi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Zi.hasPattern&&(Zi instanceof r.br||Zi instanceof r.bs||Zi instanceof r.bt)&&(b(Zi.layers,this.zoom,J),Zi.addFeatures(Ce,this.tileID.canonical,yi.patternPositions))}this.status="done",ce(null,{buckets:Object.values(ye).filter(gn=>!gn.isEmpty()),featureIndex:Ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:It.image,imageAtlas:yi,glyphMap:this.returnDependencies?ht:null,iconMap:this.returnDependencies?di:null,glyphPositions:this.returnDependencies?It.positions:null})}}ke.length?this.inFlightDependencies.push(le.send("getImages",{icons:ke,source:this.source,tileID:this.tileID,type:"patterns"},(It,yi)=>{_i===this.dependencySentinel&&(gt||(gt=It,Oi=yi,Dt.call(this)))})):Oi={},Dt.call(this)}}function b(Z,V,q){const J=new r.a8(V);for(const le of Z)le.recalculate(J,q)}function E(Z,V){const q=r.l(Z.request,(J,le,ce,Oe)=>{if(J)V(J);else if(le)try{const Ae=new r.bw.VectorTile(new r.bv(le));V(null,{vectorTile:Ae,rawData:le,cacheControl:ce,expires:Oe})}catch(Ae){const ye=new Uint8Array(le);let Ce=`Unable to parse the tile at ${Z.request.url}, `;Ce+=ye[0]===31&&ye[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Ae.messge}`,V(new Error(Ce))}});return()=>{q.cancel(),V()}}class S{constructor(V,q,J,le){this.actor=V,this.layerIndex=q,this.availableImages=J,this.loadVectorData=le||E,this.fetching={},this.loading={},this.loaded={}}loadTile(V,q){const J=V.uid;this.loading||(this.loading={});const le=!!(V&&V.request&&V.request.collectResourceTiming)&&new r.bu(V.request),ce=this.loading[J]=new y(V);ce.abort=this.loadVectorData(V,(Oe,Ae)=>{if(delete this.loading[J],Oe||!Ae)return ce.status="done",this.loaded[J]=ce,q(Oe);const ye=Ae.rawData,Ce={};Ae.expires&&(Ce.expires=Ae.expires),Ae.cacheControl&&(Ce.cacheControl=Ae.cacheControl);const ot={};if(le){const gt=le.finish();gt&&(ot.resourceTiming=JSON.parse(JSON.stringify(gt)))}ce.vectorTile=Ae.vectorTile,ce.parse(Ae.vectorTile,this.layerIndex,this.availableImages,this.actor,(gt,ht)=>{if(delete this.fetching[J],gt||!ht)return q(gt);q(null,r.e({rawTileData:ye.slice(0)},ht,Ce,ot))}),this.loaded=this.loaded||{},this.loaded[J]=ce,this.fetching[J]={rawTileData:ye,cacheControl:Ce,resourceTiming:ot}})}reloadTile(V,q){const J=this.loaded,le=V.uid;if(J&&J[le]){const ce=J[le];ce.showCollisionBoxes=V.showCollisionBoxes,ce.status==="parsing"?ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor,(Oe,Ae)=>{if(Oe||!Ae)return q(Oe,Ae);let ye;if(this.fetching[le]){const{rawTileData:Ce,cacheControl:ot,resourceTiming:gt}=this.fetching[le];delete this.fetching[le],ye=r.e({rawTileData:Ce.slice(0)},Ae,ot,gt)}else ye=Ae;q(null,ye)}):ce.status==="done"&&(ce.vectorTile?ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor,q):q())}}abortTile(V,q){const J=this.loading,le=V.uid;J&&J[le]&&J[le].abort&&(J[le].abort(),delete J[le]),q()}removeTile(V,q){const J=this.loaded,le=V.uid;J&&J[le]&&delete J[le],q()}}class D{constructor(){this.loaded={}}loadTile(V,q){return r._(this,void 0,void 0,function*(){const{uid:J,encoding:le,rawImageData:ce,redFactor:Oe,greenFactor:Ae,blueFactor:ye,baseShift:Ce}=V,ot=ce.width+2,gt=ce.height+2,ht=r.a(ce)?new r.R({width:ot,height:gt},yield r.bx(ce,-1,-1,ot,gt)):ce,di=new r.by(J,ht,le,Oe,Ae,ye,Ce);this.loaded=this.loaded||{},this.loaded[J]=di,q(null,di)})}removeTile(V){const q=this.loaded,J=V.uid;q&&q[J]&&delete q[J]}}function R(Z,V){if(Z.length!==0){z(Z[0],V);for(var q=1;q<Z.length;q++)z(Z[q],!V)}}function z(Z,V){for(var q=0,J=0,le=0,ce=Z.length,Oe=ce-1;le<ce;Oe=le++){var Ae=(Z[le][0]-Z[Oe][0])*(Z[Oe][1]+Z[le][1]),ye=q+Ae;J+=Math.abs(q)>=Math.abs(Ae)?q-ye+Ae:Ae-ye+q,q=ye}q+J>=0!=!!V&&Z.reverse()}var H=r.bz(function Z(V,q){var J,le=V&&V.type;if(le==="FeatureCollection")for(J=0;J<V.features.length;J++)Z(V.features[J],q);else if(le==="GeometryCollection")for(J=0;J<V.geometries.length;J++)Z(V.geometries[J],q);else if(le==="Feature")Z(V.geometry,q);else if(le==="Polygon")R(V.coordinates,q);else if(le==="MultiPolygon")for(J=0;J<V.coordinates.length;J++)R(V.coordinates[J],q);return V});const K=r.bw.VectorTileFeature.prototype.toGeoJSON;var W={exports:{}},se=r.bA,Y=r.bw.VectorTileFeature,ne=ue;function ue(Z,V){this.options=V||{},this.features=Z,this.length=Z.length}function ve(Z,V){this.id=typeof Z.id=="number"?Z.id:void 0,this.type=Z.type,this.rawGeometry=Z.type===1?[Z.geometry]:Z.geometry,this.properties=Z.tags,this.extent=V||4096}ue.prototype.feature=function(Z){return new ve(this.features[Z],this.options.extent)},ve.prototype.loadGeometry=function(){var Z=this.rawGeometry;this.geometry=[];for(var V=0;V<Z.length;V++){for(var q=Z[V],J=[],le=0;le<q.length;le++)J.push(new se(q[le][0],q[le][1]));this.geometry.push(J)}return this.geometry},ve.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Z=this.geometry,V=1/0,q=-1/0,J=1/0,le=-1/0,ce=0;ce<Z.length;ce++)for(var Oe=Z[ce],Ae=0;Ae<Oe.length;Ae++){var ye=Oe[Ae];V=Math.min(V,ye.x),q=Math.max(q,ye.x),J=Math.min(J,ye.y),le=Math.max(le,ye.y)}return[V,J,q,le]},ve.prototype.toGeoJSON=Y.prototype.toGeoJSON;var _e=r.bB,oe=ne;function Be(Z){var V=new _e;return function(q,J){for(var le in q.layers)J.writeMessage(3,mt,q.layers[le])}(Z,V),V.finish()}function mt(Z,V){var q;V.writeVarintField(15,Z.version||1),V.writeStringField(1,Z.name||""),V.writeVarintField(5,Z.extent||4096);var J={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<Z.length;q++)J.feature=Z.feature(q),V.writeMessage(2,Le,J);var le=J.keys;for(q=0;q<le.length;q++)V.writeStringField(3,le[q]);var ce=J.values;for(q=0;q<ce.length;q++)V.writeMessage(4,St,ce[q])}function Le(Z,V){var q=Z.feature;q.id!==void 0&&V.writeVarintField(1,q.id),V.writeMessage(2,rt,Z),V.writeVarintField(3,q.type),V.writeMessage(4,Ve,q)}function rt(Z,V){var q=Z.feature,J=Z.keys,le=Z.values,ce=Z.keycache,Oe=Z.valuecache;for(var Ae in q.properties){var ye=q.properties[Ae],Ce=ce[Ae];if(ye!==null){Ce===void 0&&(J.push(Ae),ce[Ae]=Ce=J.length-1),V.writeVarint(Ce);var ot=typeof ye;ot!=="string"&&ot!=="boolean"&&ot!=="number"&&(ye=JSON.stringify(ye));var gt=ot+":"+ye,ht=Oe[gt];ht===void 0&&(le.push(ye),Oe[gt]=ht=le.length-1),V.writeVarint(ht)}}}function tt(Z,V){return(V<<3)+(7&Z)}function We(Z){return Z<<1^Z>>31}function Ve(Z,V){for(var q=Z.loadGeometry(),J=Z.type,le=0,ce=0,Oe=q.length,Ae=0;Ae<Oe;Ae++){var ye=q[Ae],Ce=1;J===1&&(Ce=ye.length),V.writeVarint(tt(1,Ce));for(var ot=J===3?ye.length-1:ye.length,gt=0;gt<ot;gt++){gt===1&&J!==1&&V.writeVarint(tt(2,ot-1));var ht=ye[gt].x-le,di=ye[gt].y-ce;V.writeVarint(We(ht)),V.writeVarint(We(di)),le+=ht,ce+=di}J===3&&V.writeVarint(tt(7,1))}}function St(Z,V){var q=typeof Z;q==="string"?V.writeStringField(1,Z):q==="boolean"?V.writeBooleanField(7,Z):q==="number"&&(Z%1!=0?V.writeDoubleField(3,Z):Z<0?V.writeSVarintField(6,Z):V.writeVarintField(5,Z))}W.exports=Be,W.exports.fromVectorTileJs=Be,W.exports.fromGeojsonVt=function(Z,V){V=V||{};var q={};for(var J in Z)q[J]=new oe(Z[J].features,V),q[J].name=J,q[J].version=V.version,q[J].extent=V.extent;return Be({layers:q})},W.exports.GeoJSONWrapper=oe;var zt=r.bz(W.exports);const mi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Z=>Z},vt=Math.fround||(pt=new Float32Array(1),Z=>(pt[0]=+Z,pt[0]));var pt;const Pt=3,qe=5,Ht=6;class lt{constructor(V){this.options=Object.assign(Object.create(mi),V),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(V){const{log:q,minZoom:J,maxZoom:le}=this.options;q&&console.time("total time");const ce=`prepare ${V.length} points`;q&&console.time(ce),this.points=V;const Oe=[];for(let ye=0;ye<V.length;ye++){const Ce=V[ye];if(!Ce.geometry)continue;const[ot,gt]=Ce.geometry.coordinates,ht=vt(bt(ot)),di=vt(ze(gt));Oe.push(ht,di,1/0,ye,-1,1),this.options.reduce&&Oe.push(0)}let Ae=this.trees[le+1]=this._createTree(Oe);q&&console.timeEnd(ce);for(let ye=le;ye>=J;ye--){const Ce=+Date.now();Ae=this.trees[ye]=this._createTree(this._cluster(Ae,ye)),q&&console.log("z%d: %d clusters in %dms",ye,Ae.numItems,+Date.now()-Ce)}return q&&console.timeEnd("total time"),this}getClusters(V,q){let J=((V[0]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,V[1]));let ce=V[2]===180?180:((V[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)J=-180,ce=180;else if(J>ce){const gt=this.getClusters([J,le,180,Oe],q),ht=this.getClusters([-180,le,ce,Oe],q);return gt.concat(ht)}const Ae=this.trees[this._limitZoom(q)],ye=Ae.range(bt(J),ze(Oe),bt(ce),ze(le)),Ce=Ae.data,ot=[];for(const gt of ye){const ht=this.stride*gt;ot.push(Ce[ht+qe]>1?Gt(Ce,ht,this.clusterProps):this.points[Ce[ht+Pt]])}return ot}getChildren(V){const q=this._getOriginId(V),J=this._getOriginZoom(V),le="No cluster with the specified id.",ce=this.trees[J];if(!ce)throw new Error(le);const Oe=ce.data;if(q*this.stride>=Oe.length)throw new Error(le);const Ae=this.options.radius/(this.options.extent*Math.pow(2,J-1)),ye=ce.within(Oe[q*this.stride],Oe[q*this.stride+1],Ae),Ce=[];for(const ot of ye){const gt=ot*this.stride;Oe[gt+4]===V&&Ce.push(Oe[gt+qe]>1?Gt(Oe,gt,this.clusterProps):this.points[Oe[gt+Pt]])}if(Ce.length===0)throw new Error(le);return Ce}getLeaves(V,q,J){const le=[];return this._appendLeaves(le,V,q=q||10,J=J||0,0),le}getTile(V,q,J){const le=this.trees[this._limitZoom(V)],ce=Math.pow(2,V),{extent:Oe,radius:Ae}=this.options,ye=Ae/Oe,Ce=(J-ye)/ce,ot=(J+1+ye)/ce,gt={features:[]};return this._addTileFeatures(le.range((q-ye)/ce,Ce,(q+1+ye)/ce,ot),le.data,q,J,ce,gt),q===0&&this._addTileFeatures(le.range(1-ye/ce,Ce,1,ot),le.data,ce,J,ce,gt),q===ce-1&&this._addTileFeatures(le.range(0,Ce,ye/ce,ot),le.data,-1,J,ce,gt),gt.features.length?gt:null}getClusterExpansionZoom(V){let q=this._getOriginZoom(V)-1;for(;q<=this.options.maxZoom;){const J=this.getChildren(V);if(q++,J.length!==1)break;V=J[0].properties.cluster_id}return q}_appendLeaves(V,q,J,le,ce){const Oe=this.getChildren(q);for(const Ae of Oe){const ye=Ae.properties;if(ye&&ye.cluster?ce+ye.point_count<=le?ce+=ye.point_count:ce=this._appendLeaves(V,ye.cluster_id,J,le,ce):ce<le?ce++:V.push(Ae),V.length===J)break}return ce}_createTree(V){const q=new r.av(V.length/this.stride|0,this.options.nodeSize,Float32Array);for(let J=0;J<V.length;J+=this.stride)q.add(V[J],V[J+1]);return q.finish(),q.data=V,q}_addTileFeatures(V,q,J,le,ce,Oe){for(const Ae of V){const ye=Ae*this.stride,Ce=q[ye+qe]>1;let ot,gt,ht;if(Ce)ot=Mi(q,ye,this.clusterProps),gt=q[ye],ht=q[ye+1];else{const ai=this.points[q[ye+Pt]];ot=ai.properties;const[_i,ji]=ai.geometry.coordinates;gt=bt(_i),ht=ze(ji)}const di={type:1,geometry:[[Math.round(this.options.extent*(gt*ce-J)),Math.round(this.options.extent*(ht*ce-le))]],tags:ot};let Oi;Oi=Ce||this.options.generateId?q[ye+Pt]:this.points[q[ye+Pt]].id,Oi!==void 0&&(di.id=Oi),Oe.features.push(di)}}_limitZoom(V){return Math.max(this.options.minZoom,Math.min(Math.floor(+V),this.options.maxZoom+1))}_cluster(V,q){const{radius:J,extent:le,reduce:ce,minPoints:Oe}=this.options,Ae=J/(le*Math.pow(2,q)),ye=V.data,Ce=[],ot=this.stride;for(let gt=0;gt<ye.length;gt+=ot){if(ye[gt+2]<=q)continue;ye[gt+2]=q;const ht=ye[gt],di=ye[gt+1],Oi=V.within(ye[gt],ye[gt+1],Ae),ai=ye[gt+qe];let _i=ai;for(const ji of Oi){const ke=ji*ot;ye[ke+2]>q&&(_i+=ye[ke+qe])}if(_i>ai&&_i>=Oe){let ji,ke=ht*ai,Dt=di*ai,It=-1;const yi=((gt/ot|0)<<5)+(q+1)+this.points.length;for(const gn of Oi){const Zi=gn*ot;if(ye[Zi+2]<=q)continue;ye[Zi+2]=q;const In=ye[Zi+qe];ke+=ye[Zi]*In,Dt+=ye[Zi+1]*In,ye[Zi+4]=yi,ce&&(ji||(ji=this._map(ye,gt,!0),It=this.clusterProps.length,this.clusterProps.push(ji)),ce(ji,this._map(ye,Zi)))}ye[gt+4]=yi,Ce.push(ke/_i,Dt/_i,1/0,yi,-1,_i),ce&&Ce.push(It)}else{for(let ji=0;ji<ot;ji++)Ce.push(ye[gt+ji]);if(_i>1)for(const ji of Oi){const ke=ji*ot;if(!(ye[ke+2]<=q)){ye[ke+2]=q;for(let Dt=0;Dt<ot;Dt++)Ce.push(ye[ke+Dt])}}}}return Ce}_getOriginId(V){return V-this.points.length>>5}_getOriginZoom(V){return(V-this.points.length)%32}_map(V,q,J){if(V[q+qe]>1){const Oe=this.clusterProps[V[q+Ht]];return J?Object.assign({},Oe):Oe}const le=this.points[V[q+Pt]].properties,ce=this.options.map(le);return J&&ce===le?Object.assign({},ce):ce}}function Gt(Z,V,q){return{type:"Feature",id:Z[V+Pt],properties:Mi(Z,V,q),geometry:{type:"Point",coordinates:[(J=Z[V],360*(J-.5)),$t(Z[V+1])]}};var J}function Mi(Z,V,q){const J=Z[V+qe],le=J>=1e4?`${Math.round(J/1e3)}k`:J>=1e3?Math.round(J/100)/10+"k":J,ce=Z[V+Ht],Oe=ce===-1?{}:Object.assign({},q[ce]);return Object.assign(Oe,{cluster:!0,cluster_id:Z[V+Pt],point_count:J,point_count_abbreviated:le})}function bt(Z){return Z/360+.5}function ze(Z){const V=Math.sin(Z*Math.PI/180),q=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return q<0?0:q>1?1:q}function $t(Z){const V=(180-360*Z)*Math.PI/180;return 360*Math.atan(Math.exp(V))/Math.PI-90}function dt(Z,V,q,J){for(var le,ce=J,Oe=q-V>>1,Ae=q-V,ye=Z[V],Ce=Z[V+1],ot=Z[q],gt=Z[q+1],ht=V+3;ht<q;ht+=3){var di=_t(Z[ht],Z[ht+1],ye,Ce,ot,gt);if(di>ce)le=ht,ce=di;else if(di===ce){var Oi=Math.abs(ht-Oe);Oi<Ae&&(le=ht,Ae=Oi)}}ce>J&&(le-V>3&&dt(Z,V,le,J),Z[le+2]=ce,q-le>3&&dt(Z,le,q,J))}function _t(Z,V,q,J,le,ce){var Oe=le-q,Ae=ce-J;if(Oe!==0||Ae!==0){var ye=((Z-q)*Oe+(V-J)*Ae)/(Oe*Oe+Ae*Ae);ye>1?(q=le,J=ce):ye>0&&(q+=Oe*ye,J+=Ae*ye)}return(Oe=Z-q)*Oe+(Ae=V-J)*Ae}function ni(Z,V,q,J){var le={id:Z===void 0?null:Z,type:V,geometry:q,tags:J,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ce){var Oe=ce.geometry,Ae=ce.type;if(Ae==="Point"||Ae==="MultiPoint"||Ae==="LineString")Wi(ce,Oe);else if(Ae==="Polygon"||Ae==="MultiLineString")for(var ye=0;ye<Oe.length;ye++)Wi(ce,Oe[ye]);else if(Ae==="MultiPolygon")for(ye=0;ye<Oe.length;ye++)for(var Ce=0;Ce<Oe[ye].length;Ce++)Wi(ce,Oe[ye][Ce])}(le),le}function Wi(Z,V){for(var q=0;q<V.length;q+=3)Z.minX=Math.min(Z.minX,V[q]),Z.minY=Math.min(Z.minY,V[q+1]),Z.maxX=Math.max(Z.maxX,V[q]),Z.maxY=Math.max(Z.maxY,V[q+1])}function ct(Z,V,q,J){if(V.geometry){var le=V.geometry.coordinates,ce=V.geometry.type,Oe=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),Ae=[],ye=V.id;if(q.promoteId?ye=V.properties[q.promoteId]:q.generateId&&(ye=J||0),ce==="Point")et(le,Ae);else if(ce==="MultiPoint")for(var Ce=0;Ce<le.length;Ce++)et(le[Ce],Ae);else if(ce==="LineString")zi(le,Ae,Oe,!1);else if(ce==="MultiLineString"){if(q.lineMetrics){for(Ce=0;Ce<le.length;Ce++)zi(le[Ce],Ae=[],Oe,!1),Z.push(ni(ye,"LineString",Ae,V.properties));return}zn(le,Ae,Oe,!1)}else if(ce==="Polygon")zn(le,Ae,Oe,!0);else{if(ce!=="MultiPolygon"){if(ce==="GeometryCollection"){for(Ce=0;Ce<V.geometry.geometries.length;Ce++)ct(Z,{id:ye,geometry:V.geometry.geometries[Ce],properties:V.properties},q,J);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ce=0;Ce<le.length;Ce++){var ot=[];zn(le[Ce],ot,Oe,!0),Ae.push(ot)}}Z.push(ni(ye,ce,Ae,V.properties))}}function et(Z,V){V.push(Xe(Z[0])),V.push(On(Z[1])),V.push(0)}function zi(Z,V,q,J){for(var le,ce,Oe=0,Ae=0;Ae<Z.length;Ae++){var ye=Xe(Z[Ae][0]),Ce=On(Z[Ae][1]);V.push(ye),V.push(Ce),V.push(0),Ae>0&&(Oe+=J?(le*Ce-ye*ce)/2:Math.sqrt(Math.pow(ye-le,2)+Math.pow(Ce-ce,2))),le=ye,ce=Ce}var ot=V.length-3;V[2]=1,dt(V,0,ot,q),V[ot+2]=1,V.size=Math.abs(Oe),V.start=0,V.end=V.size}function zn(Z,V,q,J){for(var le=0;le<Z.length;le++){var ce=[];zi(Z[le],ce,q,J),V.push(ce)}}function Xe(Z){return Z/360+.5}function On(Z){var V=Math.sin(Z*Math.PI/180),q=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return q<0?0:q>1?1:q}function Rt(Z,V,q,J,le,ce,Oe,Ae){if(J/=V,ce>=(q/=V)&&Oe<J)return Z;if(Oe<q||ce>=J)return null;for(var ye=[],Ce=0;Ce<Z.length;Ce++){var ot=Z[Ce],gt=ot.geometry,ht=ot.type,di=le===0?ot.minX:ot.minY,Oi=le===0?ot.maxX:ot.maxY;if(di>=q&&Oi<J)ye.push(ot);else if(!(Oi<q||di>=J)){var ai=[];if(ht==="Point"||ht==="MultiPoint")Xi(gt,ai,q,J,le);else if(ht==="LineString")Ui(gt,ai,q,J,le,!1,Ae.lineMetrics);else if(ht==="MultiLineString")mr(gt,ai,q,J,le,!1);else if(ht==="Polygon")mr(gt,ai,q,J,le,!0);else if(ht==="MultiPolygon")for(var _i=0;_i<gt.length;_i++){var ji=[];mr(gt[_i],ji,q,J,le,!0),ji.length&&ai.push(ji)}if(ai.length){if(Ae.lineMetrics&&ht==="LineString"){for(_i=0;_i<ai.length;_i++)ye.push(ni(ot.id,ht,ai[_i],ot.tags));continue}ht!=="LineString"&&ht!=="MultiLineString"||(ai.length===1?(ht="LineString",ai=ai[0]):ht="MultiLineString"),ht!=="Point"&&ht!=="MultiPoint"||(ht=ai.length===3?"Point":"MultiPoint"),ye.push(ni(ot.id,ht,ai,ot.tags))}}}return ye.length?ye:null}function Xi(Z,V,q,J,le){for(var ce=0;ce<Z.length;ce+=3){var Oe=Z[ce+le];Oe>=q&&Oe<=J&&(V.push(Z[ce]),V.push(Z[ce+1]),V.push(Z[ce+2]))}}function Ui(Z,V,q,J,le,ce,Oe){for(var Ae,ye,Ce=Gn(Z),ot=le===0?jr:Cr,gt=Z.start,ht=0;ht<Z.length-3;ht+=3){var di=Z[ht],Oi=Z[ht+1],ai=Z[ht+2],_i=Z[ht+3],ji=Z[ht+4],ke=le===0?di:Oi,Dt=le===0?_i:ji,It=!1;Oe&&(Ae=Math.sqrt(Math.pow(di-_i,2)+Math.pow(Oi-ji,2))),ke<q?Dt>q&&(ye=ot(Ce,di,Oi,_i,ji,q),Oe&&(Ce.start=gt+Ae*ye)):ke>J?Dt<J&&(ye=ot(Ce,di,Oi,_i,ji,J),Oe&&(Ce.start=gt+Ae*ye)):vr(Ce,di,Oi,ai),Dt<q&&ke>=q&&(ye=ot(Ce,di,Oi,_i,ji,q),It=!0),Dt>J&&ke<=J&&(ye=ot(Ce,di,Oi,_i,ji,J),It=!0),!ce&&It&&(Oe&&(Ce.end=gt+Ae*ye),V.push(Ce),Ce=Gn(Z)),Oe&&(gt+=Ae)}var yi=Z.length-3;di=Z[yi],Oi=Z[yi+1],ai=Z[yi+2],(ke=le===0?di:Oi)>=q&&ke<=J&&vr(Ce,di,Oi,ai),yi=Ce.length-3,ce&&yi>=3&&(Ce[yi]!==Ce[0]||Ce[yi+1]!==Ce[1])&&vr(Ce,Ce[0],Ce[1],Ce[2]),Ce.length&&V.push(Ce)}function Gn(Z){var V=[];return V.size=Z.size,V.start=Z.start,V.end=Z.end,V}function mr(Z,V,q,J,le,ce){for(var Oe=0;Oe<Z.length;Oe++)Ui(Z[Oe],V,q,J,le,ce,!1)}function vr(Z,V,q,J){Z.push(V),Z.push(q),Z.push(J)}function jr(Z,V,q,J,le,ce){var Oe=(ce-V)/(J-V);return Z.push(ce),Z.push(q+(le-q)*Oe),Z.push(1),Oe}function Cr(Z,V,q,J,le,ce){var Oe=(ce-q)/(le-q);return Z.push(V+(J-V)*Oe),Z.push(ce),Z.push(1),Oe}function lr(Z,V){for(var q=[],J=0;J<Z.length;J++){var le,ce=Z[J],Oe=ce.type;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")le=Hn(ce.geometry,V);else if(Oe==="MultiLineString"||Oe==="Polygon"){le=[];for(var Ae=0;Ae<ce.geometry.length;Ae++)le.push(Hn(ce.geometry[Ae],V))}else if(Oe==="MultiPolygon")for(le=[],Ae=0;Ae<ce.geometry.length;Ae++){for(var ye=[],Ce=0;Ce<ce.geometry[Ae].length;Ce++)ye.push(Hn(ce.geometry[Ae][Ce],V));le.push(ye)}q.push(ni(ce.id,Oe,le,ce.tags))}return q}function Hn(Z,V){var q=[];q.size=Z.size,Z.start!==void 0&&(q.start=Z.start,q.end=Z.end);for(var J=0;J<Z.length;J+=3)q.push(Z[J]+V,Z[J+1],Z[J+2]);return q}function Nt(Z,V){if(Z.transformed)return Z;var q,J,le,ce=1<<Z.z,Oe=Z.x,Ae=Z.y;for(q=0;q<Z.features.length;q++){var ye=Z.features[q],Ce=ye.geometry,ot=ye.type;if(ye.geometry=[],ot===1)for(J=0;J<Ce.length;J+=2)ye.geometry.push(Qi(Ce[J],Ce[J+1],V,ce,Oe,Ae));else for(J=0;J<Ce.length;J++){var gt=[];for(le=0;le<Ce[J].length;le+=2)gt.push(Qi(Ce[J][le],Ce[J][le+1],V,ce,Oe,Ae));ye.geometry.push(gt)}}return Z.transformed=!0,Z}function Qi(Z,V,q,J,le,ce){return[Math.round(q*(Z*J-le)),Math.round(q*(V*J-ce))]}function Qe(Z,V,q,J,le){for(var ce=V===le.maxZoom?0:le.tolerance/((1<<V)*le.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:J,z:V,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ae=0;Ae<Z.length;Ae++){Oe.numFeatures++,Ki(Oe,Z[Ae],ce,le);var ye=Z[Ae].minX,Ce=Z[Ae].minY,ot=Z[Ae].maxX,gt=Z[Ae].maxY;ye<Oe.minX&&(Oe.minX=ye),Ce<Oe.minY&&(Oe.minY=Ce),ot>Oe.maxX&&(Oe.maxX=ot),gt>Oe.maxY&&(Oe.maxY=gt)}return Oe}function Ki(Z,V,q,J){var le=V.geometry,ce=V.type,Oe=[];if(ce==="Point"||ce==="MultiPoint")for(var Ae=0;Ae<le.length;Ae+=3)Oe.push(le[Ae]),Oe.push(le[Ae+1]),Z.numPoints++,Z.numSimplified++;else if(ce==="LineString")Gi(Oe,le,Z,q,!1,!1);else if(ce==="MultiLineString"||ce==="Polygon")for(Ae=0;Ae<le.length;Ae++)Gi(Oe,le[Ae],Z,q,ce==="Polygon",Ae===0);else if(ce==="MultiPolygon")for(var ye=0;ye<le.length;ye++){var Ce=le[ye];for(Ae=0;Ae<Ce.length;Ae++)Gi(Oe,Ce[Ae],Z,q,!0,Ae===0)}if(Oe.length){var ot=V.tags||null;if(ce==="LineString"&&J.lineMetrics){for(var gt in ot={},V.tags)ot[gt]=V.tags[gt];ot.mapbox_clip_start=le.start/le.size,ot.mapbox_clip_end=le.end/le.size}var ht={geometry:Oe,type:ce==="Polygon"||ce==="MultiPolygon"?3:ce==="LineString"||ce==="MultiLineString"?2:1,tags:ot};V.id!==null&&(ht.id=V.id),Z.features.push(ht)}}function Gi(Z,V,q,J,le,ce){var Oe=J*J;if(J>0&&V.size<(le?Oe:J))q.numPoints+=V.length/3;else{for(var Ae=[],ye=0;ye<V.length;ye+=3)(J===0||V[ye+2]>Oe)&&(q.numSimplified++,Ae.push(V[ye]),Ae.push(V[ye+1])),q.numPoints++;le&&function(Ce,ot){for(var gt=0,ht=0,di=Ce.length,Oi=di-2;ht<di;Oi=ht,ht+=2)gt+=(Ce[ht]-Ce[Oi])*(Ce[ht+1]+Ce[Oi+1]);if(gt>0===ot)for(ht=0,di=Ce.length;ht<di/2;ht+=2){var ai=Ce[ht],_i=Ce[ht+1];Ce[ht]=Ce[di-2-ht],Ce[ht+1]=Ce[di-1-ht],Ce[di-2-ht]=ai,Ce[di-1-ht]=_i}}(Ae,ce),Z.push(Ae)}}function Lt(Z,V){var q=(V=this.options=function(le,ce){for(var Oe in ce)le[Oe]=ce[Oe];return le}(Object.create(this.options),V)).debug;if(q&&console.time("preprocess data"),V.maxZoom<0||V.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(V.promoteId&&V.generateId)throw new Error("promoteId and generateId cannot be used together.");var J=function(le,ce){var Oe=[];if(le.type==="FeatureCollection")for(var Ae=0;Ae<le.features.length;Ae++)ct(Oe,le.features[Ae],ce,Ae);else ct(Oe,le.type==="Feature"?le:{geometry:le},ce);return Oe}(Z,V);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",V.indexMaxZoom,V.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),J=function(le,ce){var Oe=ce.buffer/ce.extent,Ae=le,ye=Rt(le,1,-1-Oe,Oe,0,-1,2,ce),Ce=Rt(le,1,1-Oe,2+Oe,0,-1,2,ce);return(ye||Ce)&&(Ae=Rt(le,1,-Oe,1+Oe,0,-1,2,ce)||[],ye&&(Ae=lr(ye,1).concat(Ae)),Ce&&(Ae=Ae.concat(lr(Ce,-1)))),Ae}(J,V),J.length&&this.splitTile(J,0,0,0),q&&(J.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Bi(Z,V,q){return 32*((1<<Z)*q+V)+Z}function ii(Z,V){return V?Z.properties[V]:Z.id}function Bn(Z,V){if(Z==null)return!0;if(Z.type==="Feature")return ii(Z,V)!=null;if(Z.type==="FeatureCollection"){const q=new Set;for(const J of Z.features){const le=ii(J,V);if(le==null||q.has(le))return!1;q.add(le)}return!0}return!1}function st(Z,V){const q=new Map;if(Z!=null)if(Z.type==="Feature")q.set(ii(Z,V),Z);else for(const J of Z.features)q.set(ii(J,V),J);return q}Lt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Lt.prototype.splitTile=function(Z,V,q,J,le,ce,Oe){for(var Ae=[Z,V,q,J],ye=this.options,Ce=ye.debug;Ae.length;){J=Ae.pop(),q=Ae.pop(),V=Ae.pop(),Z=Ae.pop();var ot=1<<V,gt=Bi(V,q,J),ht=this.tiles[gt];if(!ht&&(Ce>1&&console.time("creation"),ht=this.tiles[gt]=Qe(Z,V,q,J,ye),this.tileCoords.push({z:V,x:q,y:J}),Ce)){Ce>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",V,q,J,ht.numFeatures,ht.numPoints,ht.numSimplified),console.timeEnd("creation"));var di="z"+V;this.stats[di]=(this.stats[di]||0)+1,this.total++}if(ht.source=Z,le){if(V===ye.maxZoom||V===le)continue;var Oi=1<<le-V;if(q!==Math.floor(ce/Oi)||J!==Math.floor(Oe/Oi))continue}else if(V===ye.indexMaxZoom||ht.numPoints<=ye.indexMaxPoints)continue;if(ht.source=null,Z.length!==0){Ce>1&&console.time("clipping");var ai,_i,ji,ke,Dt,It,yi=.5*ye.buffer/ye.extent,gn=.5-yi,Zi=.5+yi,In=1+yi;ai=_i=ji=ke=null,Dt=Rt(Z,ot,q-yi,q+Zi,0,ht.minX,ht.maxX,ye),It=Rt(Z,ot,q+gn,q+In,0,ht.minX,ht.maxX,ye),Z=null,Dt&&(ai=Rt(Dt,ot,J-yi,J+Zi,1,ht.minY,ht.maxY,ye),_i=Rt(Dt,ot,J+gn,J+In,1,ht.minY,ht.maxY,ye),Dt=null),It&&(ji=Rt(It,ot,J-yi,J+Zi,1,ht.minY,ht.maxY,ye),ke=Rt(It,ot,J+gn,J+In,1,ht.minY,ht.maxY,ye),It=null),Ce>1&&console.timeEnd("clipping"),Ae.push(ai||[],V+1,2*q,2*J),Ae.push(_i||[],V+1,2*q,2*J+1),Ae.push(ji||[],V+1,2*q+1,2*J),Ae.push(ke||[],V+1,2*q+1,2*J+1)}}},Lt.prototype.getTile=function(Z,V,q){var J=this.options,le=J.extent,ce=J.debug;if(Z<0||Z>24)return null;var Oe=1<<Z,Ae=Bi(Z,V=(V%Oe+Oe)%Oe,q);if(this.tiles[Ae])return Nt(this.tiles[Ae],le);ce>1&&console.log("drilling down to z%d-%d-%d",Z,V,q);for(var ye,Ce=Z,ot=V,gt=q;!ye&&Ce>0;)Ce--,ot=Math.floor(ot/2),gt=Math.floor(gt/2),ye=this.tiles[Bi(Ce,ot,gt)];return ye&&ye.source?(ce>1&&console.log("found parent tile z%d-%d-%d",Ce,ot,gt),ce>1&&console.time("drilling down"),this.splitTile(ye.source,Ce,ot,gt,Z,V,q),ce>1&&console.timeEnd("drilling down"),this.tiles[Ae]?Nt(this.tiles[Ae],le):null):null};class Q extends S{constructor(V,q,J,le){super(V,q,J),this._dataUpdateable=new Map,this.loadGeoJSON=(ce,Oe)=>{const{promoteId:Ae}=ce;if(ce.request)return r.f(ce.request,(ye,Ce,ot,gt)=>{this._dataUpdateable=Bn(Ce,Ae)?st(Ce,Ae):void 0,Oe(ye,Ce,ot,gt)});if(typeof ce.data=="string")try{const ye=JSON.parse(ce.data);this._dataUpdateable=Bn(ye,Ae)?st(ye,Ae):void 0,Oe(null,ye)}catch{Oe(new Error(`Input data given to '${ce.source}' is not a valid GeoJSON object.`))}else ce.dataDiff?this._dataUpdateable?(function(ye,Ce,ot){var gt,ht,di,Oi;if(Ce.removeAll&&ye.clear(),Ce.remove)for(const ai of Ce.remove)ye.delete(ai);if(Ce.add)for(const ai of Ce.add){const _i=ii(ai,ot);_i!=null&&ye.set(_i,ai)}if(Ce.update)for(const ai of Ce.update){let _i=ye.get(ai.id);if(_i==null)continue;const ji=!ai.removeAllProperties&&(((gt=ai.removeProperties)===null||gt===void 0?void 0:gt.length)>0||((ht=ai.addOrUpdateProperties)===null||ht===void 0?void 0:ht.length)>0);if((ai.newGeometry||ai.removeAllProperties||ji)&&(_i=Object.assign({},_i),ye.set(ai.id,_i),ji&&(_i.properties=Object.assign({},_i.properties))),ai.newGeometry&&(_i.geometry=ai.newGeometry),ai.removeAllProperties)_i.properties={};else if(((di=ai.removeProperties)===null||di===void 0?void 0:di.length)>0)for(const ke of ai.removeProperties)Object.prototype.hasOwnProperty.call(_i.properties,ke)&&delete _i.properties[ke];if(((Oi=ai.addOrUpdateProperties)===null||Oi===void 0?void 0:Oi.length)>0)for(const{key:ke,value:Dt}of ai.addOrUpdateProperties)_i.properties[ke]=Dt}}(this._dataUpdateable,ce.dataDiff,Ae),Oe(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Oe(new Error(`Cannot update existing geojson data in ${ce.source}`)):Oe(new Error(`Input data given to '${ce.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,le&&(this.loadGeoJSON=le)}loadGeoJSONTile(V,q){const J=V.tileID.canonical;if(!this._geoJSONIndex)return q(null,null);const le=this._geoJSONIndex.getTile(J.z,J.x,J.y);if(!le)return q(null,null);const ce=new class{constructor(Ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.N,this.length=Ae.length,this._features=Ae}feature(Ae){return new class{constructor(ye){this._feature=ye,this.extent=r.N,this.type=ye.type,this.properties=ye.tags,"id"in ye&&!isNaN(ye.id)&&(this.id=parseInt(ye.id,10))}loadGeometry(){if(this._feature.type===1){const ye=[];for(const Ce of this._feature.geometry)ye.push([new r.P(Ce[0],Ce[1])]);return ye}{const ye=[];for(const Ce of this._feature.geometry){const ot=[];for(const gt of Ce)ot.push(new r.P(gt[0],gt[1]));ye.push(ot)}return ye}}toGeoJSON(ye,Ce,ot){return K.call(this,ye,Ce,ot)}}(this._features[Ae])}}(le.features);let Oe=zt(ce);Oe.byteOffset===0&&Oe.byteLength===Oe.buffer.byteLength||(Oe=new Uint8Array(Oe)),q(null,{vectorTile:ce,rawData:Oe.buffer})}loadData(V,q){var J;(J=this._pendingRequest)===null||J===void 0||J.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const le=!!(V&&V.request&&V.request.collectResourceTiming)&&new r.bu(V.request);this._pendingCallback=q,this._pendingRequest=this.loadGeoJSON(V,(ce,Oe)=>{if(delete this._pendingCallback,delete this._pendingRequest,ce||!Oe)return q(ce);if(typeof Oe!="object")return q(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`));{H(Oe,!0);try{if(V.filter){const ye=r.bC(V.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(ot=>`${ot.key}: ${ot.message}`).join(", "));Oe={type:"FeatureCollection",features:Oe.features.filter(ot=>ye.value.evaluate({zoom:0},ot))}}this._geoJSONIndex=V.cluster?new lt(function({superclusterOptions:ye,clusterProperties:Ce}){if(!Ce||!ye)return ye;const ot={},gt={},ht={accumulated:null,zoom:0},di={properties:null},Oi=Object.keys(Ce);for(const ai of Oi){const[_i,ji]=Ce[ai],ke=r.bC(ji),Dt=r.bC(typeof _i=="string"?[_i,["accumulated"],["get",ai]]:_i);ot[ai]=ke.value,gt[ai]=Dt.value}return ye.map=ai=>{di.properties=ai;const _i={};for(const ji of Oi)_i[ji]=ot[ji].evaluate(ht,di);return _i},ye.reduce=(ai,_i)=>{di.properties=_i;for(const ji of Oi)ht.accumulated=ai[ji],ai[ji]=gt[ji].evaluate(ht,di)},ye}(V)).load(Oe.features):function(ye,Ce){return new Lt(ye,Ce)}(Oe,V.geojsonVtOptions)}catch(ye){return q(ye)}this.loaded={};const Ae={};if(le){const ye=le.finish();ye&&(Ae.resourceTiming={},Ae.resourceTiming[V.source]=JSON.parse(JSON.stringify(ye)))}q(null,Ae)}})}reloadTile(V,q){const J=this.loaded;return J&&J[V.uid]?super.reloadTile(V,q):this.loadTile(V,q)}removeSource(V,q){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),q()}getClusterExpansionZoom(V,q){try{q(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch(J){q(J)}}getClusterChildren(V,q){try{q(null,this._geoJSONIndex.getChildren(V.clusterId))}catch(J){q(J)}}getClusterLeaves(V,q){try{q(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch(J){q(J)}}}class ge{constructor(V){this.self=V,this.actor=new r.C(V,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:S,geojson:Q},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(q,J)=>{if(this.workerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.workerSourceTypes[q]=J},this.self.registerRTLTextPlugin=q=>{if(r.bD.isParsed())throw new Error("RTL text plugin already registered.");r.bD.applyArabicShaping=q.applyArabicShaping,r.bD.processBidirectionalText=q.processBidirectionalText,r.bD.processStyledBidirectionalText=q.processStyledBidirectionalText}}setReferrer(V,q){this.referrer=q}setImages(V,q,J){this.availableImages[V]=q;for(const le in this.workerSources[V]){const ce=this.workerSources[V][le];for(const Oe in ce)ce[Oe].availableImages=q}J()}setLayers(V,q,J){this.getLayerIndex(V).replace(q),J()}updateLayers(V,q,J){this.getLayerIndex(V).update(q.layers,q.removedIds),J()}loadTile(V,q,J){this.getWorkerSource(V,q.type,q.source).loadTile(q,J)}loadDEMTile(V,q,J){this.getDEMWorkerSource(V,q.source).loadTile(q,J)}reloadTile(V,q,J){this.getWorkerSource(V,q.type,q.source).reloadTile(q,J)}abortTile(V,q,J){this.getWorkerSource(V,q.type,q.source).abortTile(q,J)}removeTile(V,q,J){this.getWorkerSource(V,q.type,q.source).removeTile(q,J)}removeDEMTile(V,q){this.getDEMWorkerSource(V,q.source).removeTile(q)}removeSource(V,q,J){if(!this.workerSources[V]||!this.workerSources[V][q.type]||!this.workerSources[V][q.type][q.source])return;const le=this.workerSources[V][q.type][q.source];delete this.workerSources[V][q.type][q.source],le.removeSource!==void 0?le.removeSource(q,J):J()}loadWorkerSource(V,q,J){try{this.self.importScripts(q.url),J()}catch(le){J(le.toString())}}syncRTLPluginState(V,q,J){try{r.bD.setState(q);const le=r.bD.getPluginURL();if(r.bD.isLoaded()&&!r.bD.isParsed()&&le!=null){this.self.importScripts(le);const ce=r.bD.isParsed();J(ce?void 0:new Error(`RTL Text Plugin failed to import scripts from ${le}`),ce)}}catch(le){J(le.toString())}}getAvailableImages(V){let q=this.availableImages[V];return q||(q=[]),q}getLayerIndex(V){let q=this.layerIndexes[V];return q||(q=this.layerIndexes[V]=new f),q}getWorkerSource(V,q,J){return this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][q]||(this.workerSources[V][q]={}),this.workerSources[V][q][J]||(this.workerSources[V][q][J]=new this.workerSourceTypes[q]({send:(le,ce,Oe)=>{this.actor.send(le,ce,Oe,V)}},this.getLayerIndex(V),this.getAvailableImages(V))),this.workerSources[V][q][J]}getDEMWorkerSource(V,q){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][q]||(this.demWorkerSources[V][q]=new D),this.demWorkerSources[V][q]}}return r.i()&&(self.worker=new ge(self)),ge}),l(["./shared"],function(r){var f="3.6.2";class m{static testProp(o){if(!m.docStyle)return o[0];for(let d=0;d<o.length;d++)if(o[d]in m.docStyle)return o[d];return o[0]}static create(o,d,g){const v=window.document.createElement(o);return d!==void 0&&(v.className=d),g&&g.appendChild(v),v}static createNS(o,d){return window.document.createElementNS(o,d)}static disableDrag(){m.docStyle&&m.selectProp&&(m.userSelect=m.docStyle[m.selectProp],m.docStyle[m.selectProp]="none")}static enableDrag(){m.docStyle&&m.selectProp&&(m.docStyle[m.selectProp]=m.userSelect)}static setTransform(o,d){o.style[m.transformProp]=d}static addEventListener(o,d,g,v={}){o.addEventListener(d,g,"passive"in v?v:v.capture)}static removeEventListener(o,d,g,v={}){o.removeEventListener(d,g,"passive"in v?v:v.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",m.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",m.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",m.suppressClickInternal,!0)},0)}static mousePos(o,d){const g=o.getBoundingClientRect();return new r.P(d.clientX-g.left-o.clientLeft,d.clientY-g.top-o.clientTop)}static touchPos(o,d){const g=o.getBoundingClientRect(),v=[];for(let A=0;A<d.length;A++)v.push(new r.P(d[A].clientX-g.left-o.clientLeft,d[A].clientY-g.top-o.clientTop));return v}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}m.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,m.selectProp=m.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),m.transformProp=m.testProp(["transform","WebkitTransform"]);const y={supported:!1,testSupport:function(x){!S&&E&&(D?R(x):b=x)}};let b,E,S=!1,D=!1;function R(x){const o=x.createTexture();x.bindTexture(x.TEXTURE_2D,o);try{if(x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,E),x.isContextLost())return;y.supported=!0}catch{}x.deleteTexture(o),S=!0}var z,H;typeof document<"u"&&(E=document.createElement("img"),E.onload=function(){b&&R(b),b=null,D=!0},E.onerror=function(){S=!0,b=null},E.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(x){let o,d,g,v;x.resetRequestQueue=()=>{o=[],d=0,g=0,v={}},x.addThrottleControl=B=>{const U=g++;return v[U]=B,U},x.removeThrottleControl=B=>{delete v[B],C()},x.getImage=(B,U,j=!0)=>{y.supported&&(B.headers||(B.headers={}),B.headers.accept="image/webp,*/*");const ee={requestParameters:B,supportImageRefresh:j,callback:U,cancelled:!1,completed:!1,cancel:()=>{ee.completed||ee.cancelled||(ee.cancelled=!0,ee.innerRequest&&(ee.innerRequest.cancel(),d--),C())}};return o.push(ee),C(),ee};const A=B=>{const{requestParameters:U,supportImageRefresh:j,callback:ee}=B;return r.e(U,{type:"image"}),(j!==!1||r.i()||r.g(U.url)||U.headers&&!Object.keys(U.headers).reduce((me,fe)=>me&&fe==="accept",!0)?r.m:L)(U,(me,fe,be,he)=>{O(B,ee,me,fe,be,he)})},O=(B,U,j,ee,me,fe)=>{j?U(j):ee instanceof HTMLImageElement||r.a(ee)?U(null,ee):ee&&((be,he)=>{typeof createImageBitmap=="function"?r.b(be,he):r.d(be,he)})(ee,(be,he)=>{be!=null?U(be):he!=null&&U(null,he,{cacheControl:me,expires:fe})}),B.cancelled||(B.completed=!0,d--,C())},C=()=>{const B=(()=>{const U=Object.keys(v);let j=!1;if(U.length>0){for(const ee of U)if(j=v[ee](),j)break}return j})()?r.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:r.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let U=d;U<B&&o.length>0;U++){const j=o.shift();if(j.cancelled){U--;continue}const ee=A(j);d++,j.innerRequest=ee}},L=(B,U)=>{const j=new Image,ee=B.url;let me=!1;const fe=B.credentials;return fe&&fe==="include"?j.crossOrigin="use-credentials":(fe&&fe==="same-origin"||!r.s(ee))&&(j.crossOrigin="anonymous"),j.fetchPriority="high",j.onload=()=>{U(null,j),j.onerror=j.onload=null},j.onerror=()=>{me||U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),j.onerror=j.onload=null},j.src=ee,{cancel:()=>{me=!0,j.src=""}}}}(z||(z={})),z.resetRequestQueue(),function(x){x.Glyphs="Glyphs",x.Image="Image",x.Source="Source",x.SpriteImage="SpriteImage",x.SpriteJSON="SpriteJSON",x.Style="Style",x.Tile="Tile",x.Unknown="Unknown"}(H||(H={}));class K{constructor(o){this._transformRequestFn=o}transformRequest(o,d){return this._transformRequestFn&&this._transformRequestFn(o,d)||{url:o}}normalizeSpriteURL(o,d,g){const v=function(A){const O=A.match(W);if(!O)throw new Error(`Unable to parse URL "${A}"`);return{protocol:O[1],authority:O[2],path:O[3]||"/",params:O[4]?O[4].split("&"):[]}}(o);return v.path+=`${d}${g}`,function(A){const O=A.params.length?`?${A.params.join("&")}`:"";return`${A.protocol}://${A.authority}${A.path}${O}`}(v)}setTransformRequest(o){this._transformRequestFn=o}}const W=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function se(x){var o=new r.A(3);return o[0]=x[0],o[1]=x[1],o[2]=x[2],o}var Y,ne=function(x,o,d){return x[0]=o[0]-d[0],x[1]=o[1]-d[1],x[2]=o[2]-d[2],x};Y=new r.A(3),r.A!=Float32Array&&(Y[0]=0,Y[1]=0,Y[2]=0);var ue=function(x){var o=x[0],d=x[1];return o*o+d*d};function ve(x){const o=[];if(typeof x=="string")o.push({id:"default",url:x});else if(x&&x.length>0){const d=[];for(const{id:g,url:v}of x){const A=`${g}${v}`;d.indexOf(A)===-1&&(d.push(A),o.push({id:g,url:v}))}}return o}function _e(x,o,d,g,v){if(g)return void x(g);if(v!==Object.values(o).length||v!==Object.values(d).length)return;const A={};for(const O in o){A[O]={};const C=r.h.getImageCanvasContext(d[O]),L=o[O];for(const B in L){const{width:U,height:j,x:ee,y:me,sdf:fe,pixelRatio:be,stretchX:he,stretchY:Pe,content:Je}=L[B];A[O][B]={data:null,pixelRatio:be,sdf:fe,stretchX:he,stretchY:Pe,content:Je,spriteData:{width:U,height:j,x:ee,y:me,context:C}}}}x(null,A)}(function(){var x=new r.A(2);r.A!=Float32Array&&(x[0]=0,x[1]=0)})();class oe{constructor(o,d,g,v){this.context=o,this.format=g,this.texture=o.gl.createTexture(),this.update(d,v)}update(o,d,g){const{width:v,height:A}=o,O=!(this.size&&this.size[0]===v&&this.size[1]===A||g),{context:C}=this,{gl:L}=C;if(this.useMipmap=!!(d&&d.useMipmap),L.bindTexture(L.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===L.RGBA&&(!d||d.premultiply!==!1)),O)this.size=[v,A],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||r.a(o)?L.texImage2D(L.TEXTURE_2D,0,this.format,this.format,L.UNSIGNED_BYTE,o):L.texImage2D(L.TEXTURE_2D,0,this.format,v,A,0,this.format,L.UNSIGNED_BYTE,o.data);else{const{x:B,y:U}=g||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||r.a(o)?L.texSubImage2D(L.TEXTURE_2D,0,B,U,L.RGBA,L.UNSIGNED_BYTE,o):L.texSubImage2D(L.TEXTURE_2D,0,B,U,v,A,L.RGBA,L.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&L.generateMipmap(L.TEXTURE_2D)}bind(o,d,g){const{context:v}=this,{gl:A}=v;A.bindTexture(A.TEXTURE_2D,this.texture),g!==A.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=A.LINEAR),o!==this.filter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,o),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,g||o),this.filter=o),d!==this.wrap&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,d),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function Be(x){const{userImage:o}=x;return!!(o&&o.render&&o.render())&&(x.data.replace(new Uint8Array(o.data.buffer)),!0)}class mt extends r.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new r.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:d,callback:g}of this.requestors)this._notify(d,g);this.requestors=[]}}getImage(o){const d=this.images[o];if(d&&!d.data&&d.spriteData){const g=d.spriteData;d.data=new r.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data),d.spriteData=null}return d}addImage(o,d){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,d)&&(this.images[o]=d)}_validate(o,d){let g=!0;const v=d.data||d.spriteData;return this._validateStretch(d.stretchX,v&&v.width)||(this.fire(new r.j(new Error(`Image "${o}" has invalid "stretchX" value`))),g=!1),this._validateStretch(d.stretchY,v&&v.height)||(this.fire(new r.j(new Error(`Image "${o}" has invalid "stretchY" value`))),g=!1),this._validateContent(d.content,d)||(this.fire(new r.j(new Error(`Image "${o}" has invalid "content" value`))),g=!1),g}_validateStretch(o,d){if(!o)return!0;let g=0;for(const v of o){if(v[0]<g||v[1]<v[0]||d<v[1])return!1;g=v[1]}return!0}_validateContent(o,d){if(!o)return!0;if(o.length!==4)return!1;const g=d.spriteData,v=g&&g.width||d.data.width,A=g&&g.height||d.data.height;return!(o[0]<0||v<o[0]||o[1]<0||A<o[1]||o[2]<0||v<o[2]||o[3]<0||A<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,d,g=!0){const v=this.getImage(o);if(g&&(v.data.width!==d.data.width||v.data.height!==d.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=v.version+1,this.images[o]=d,this.updatedImages[o]=!0}removeImage(o){const d=this.images[o];delete this.images[o],delete this.patterns[o],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,d){let g=!0;if(!this.isLoaded())for(const v of o)this.images[v]||(g=!1);this.isLoaded()||g?this._notify(o,d):this.requestors.push({ids:o,callback:d})}_notify(o,d){const g={};for(const v of o){let A=this.getImage(v);A||(this.fire(new r.k("styleimagemissing",{id:v})),A=this.getImage(v)),A?g[v]={data:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:r.w(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,g)}getPixelSize(){const{width:o,height:d}=this.atlasImage;return{width:o,height:d}}getPattern(o){const d=this.patterns[o],g=this.getImage(o);if(!g)return null;if(d&&d.position.version===g.version)return d.position;if(d)d.position.version=g.version;else{const v={w:g.data.width+2,h:g.data.height+2,x:0,y:0},A=new r.I(v,g);this.patterns[o]={bin:v,position:A}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const d=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new oe(o,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const A in this.patterns)o.push(this.patterns[A].bin);const{w:d,h:g}=r.p(o),v=this.atlasImage;v.resize({width:d||1,height:g||1});for(const A in this.patterns){const{bin:O}=this.patterns[A],C=O.x+1,L=O.y+1,B=this.getImage(A).data,U=B.width,j=B.height;r.R.copy(B,v,{x:0,y:0},{x:C,y:L},{width:U,height:j}),r.R.copy(B,v,{x:0,y:j-1},{x:C,y:L-1},{width:U,height:1}),r.R.copy(B,v,{x:0,y:0},{x:C,y:L+j},{width:U,height:1}),r.R.copy(B,v,{x:U-1,y:0},{x:C-1,y:L},{width:1,height:j}),r.R.copy(B,v,{x:0,y:0},{x:C+U,y:L},{width:1,height:j})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const d of o){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const g=this.getImage(d);g||r.w(`Image with ID: "${d}" was not found`),Be(g)&&this.updateImage(d,g)}}}const Le=1e20;function rt(x,o,d,g,v,A,O,C,L){for(let B=o;B<o+g;B++)tt(x,d*A+B,A,v,O,C,L);for(let B=d;B<d+v;B++)tt(x,B*A+o,1,g,O,C,L)}function tt(x,o,d,g,v,A,O){A[0]=0,O[0]=-Le,O[1]=Le,v[0]=x[o];for(let C=1,L=0,B=0;C<g;C++){v[C]=x[o+C*d];const U=C*C;do{const j=A[L];B=(v[C]-v[j]+U-j*j)/(C-j)/2}while(B<=O[L]&&--L>-1);L++,A[L]=C,O[L]=B,O[L+1]=Le}for(let C=0,L=0;C<g;C++){for(;O[L+1]<C;)L++;const B=A[L],U=C-B;x[o+C*d]=v[B]+U*U}}class We{constructor(o,d){this.requestManager=o,this.localIdeographFontFamily=d,this.entries={}}setURL(o){this.url=o}getGlyphs(o,d){const g=[];for(const v in o)for(const A of o[v])g.push({stack:v,id:A});r.o(g,({stack:v,id:A},O)=>{let C=this.entries[v];C||(C=this.entries[v]={glyphs:{},requests:{},ranges:{}});let L=C.glyphs[A];if(L!==void 0)return void O(null,{stack:v,id:A,glyph:L});if(L=this._tinySDF(C,v,A),L)return C.glyphs[A]=L,void O(null,{stack:v,id:A,glyph:L});const B=Math.floor(A/256);if(256*B>65535)return void O(new Error("glyphs > 65535 not supported"));if(C.ranges[B])return void O(null,{stack:v,id:A,glyph:L});if(!this.url)return void O(new Error("glyphsUrl is not set"));let U=C.requests[B];U||(U=C.requests[B]=[],We.loadGlyphRange(v,B,this.url,this.requestManager,(j,ee)=>{if(ee){for(const me in ee)this._doesCharSupportLocalGlyph(+me)||(C.glyphs[+me]=ee[+me]);C.ranges[B]=!0}for(const me of U)me(j,ee);delete C.requests[B]})),U.push((j,ee)=>{j?O(j):ee&&O(null,{stack:v,id:A,glyph:ee[A]||null})})},(v,A)=>{if(v)d(v);else if(A){const O={};for(const{stack:C,id:L,glyph:B}of A)(O[C]||(O[C]={}))[L]=B&&{id:B.id,bitmap:B.bitmap.clone(),metrics:B.metrics};d(null,O)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(r.u["CJK Unified Ideographs"](o)||r.u["Hangul Syllables"](o)||r.u.Hiragana(o)||r.u.Katakana(o))}_tinySDF(o,d,g){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(g))return;let A=o.tinySDF;if(!A){let C="400";/bold/i.test(d)?C="900":/medium/i.test(d)?C="500":/light/i.test(d)&&(C="200"),A=o.tinySDF=new We.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:v,fontWeight:C})}const O=A.draw(String.fromCharCode(g));return{id:g,bitmap:new r.q({width:O.width||60,height:O.height||60},O.data),metrics:{width:O.glyphWidth/2||24,height:O.glyphHeight/2||24,left:O.glyphLeft/2+.5||0,top:O.glyphTop/2-27.5||-8,advance:O.glyphAdvance/2||24,isDoubleResolution:!0}}}}We.loadGlyphRange=function(x,o,d,g,v){const A=256*o,O=A+255,C=g.transformRequest(d.replace("{fontstack}",x).replace("{range}",`${A}-${O}`),H.Glyphs);r.l(C,(L,B)=>{if(L)v(L);else if(B){const U={};for(const j of r.n(B))U[j.id]=j;v(null,U)}})},We.TinySDF=class{constructor({fontSize:x=24,buffer:o=3,radius:d=8,cutoff:g=.25,fontFamily:v="sans-serif",fontWeight:A="normal",fontStyle:O="normal"}={}){this.buffer=o,this.cutoff=g,this.radius=d;const C=this.size=x+4*o,L=this._createCanvas(C),B=this.ctx=L.getContext("2d",{willReadFrequently:!0});B.font=`${O} ${A} ${x}px ${v}`,B.textBaseline="alphabetic",B.textAlign="left",B.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(x){const o=document.createElement("canvas");return o.width=o.height=x,o}draw(x){const{width:o,actualBoundingBoxAscent:d,actualBoundingBoxDescent:g,actualBoundingBoxLeft:v,actualBoundingBoxRight:A}=this.ctx.measureText(x),O=Math.ceil(d),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(A-v))),L=Math.min(this.size-this.buffer,O+Math.ceil(g)),B=C+2*this.buffer,U=L+2*this.buffer,j=Math.max(B*U,0),ee=new Uint8ClampedArray(j),me={data:ee,width:B,height:U,glyphWidth:C,glyphHeight:L,glyphTop:O,glyphLeft:0,glyphAdvance:o};if(C===0||L===0)return me;const{ctx:fe,buffer:be,gridInner:he,gridOuter:Pe}=this;fe.clearRect(be,be,C,L),fe.fillText(x,be,be+O);const Je=fe.getImageData(be,be,C,L);Pe.fill(Le,0,j),he.fill(0,0,j);for(let Ee=0;Ee<L;Ee++)for(let Fe=0;Fe<C;Fe++){const it=Je.data[4*(Ee*C+Fe)+3]/255;if(it===0)continue;const at=(Ee+be)*B+Fe+be;if(it===1)Pe[at]=0,he[at]=Le;else{const xt=.5-it;Pe[at]=xt>0?xt*xt:0,he[at]=xt<0?xt*xt:0}}rt(Pe,0,0,B,U,B,this.f,this.v,this.z),rt(he,be,be,C,L,B,this.f,this.v,this.z);for(let Ee=0;Ee<j;Ee++){const Fe=Math.sqrt(Pe[Ee])-Math.sqrt(he[Ee]);ee[Ee]=Math.round(255-255*(Fe/this.radius+this.cutoff))}return me}};class Ve{constructor(){this.specification=r.v.light.position}possiblyEvaluate(o,d){return r.z(o.expression.evaluate(d))}interpolate(o,d,g){return{x:r.B.number(o.x,d.x,g),y:r.B.number(o.y,d.y,g),z:r.B.number(o.z,d.z,g)}}}let St;class zt extends r.E{constructor(o){super(),St=St||new r.r({anchor:new r.D(r.v.light.anchor),position:new Ve,color:new r.D(r.v.light.color),intensity:new r.D(r.v.light.intensity)}),this._transitionable=new r.T(St),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d={}){if(!this._validate(r.t,o,d))for(const g in o){const v=o[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),v):this._transitionable.setValue(g,v)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,g){return(!g||g.validate!==!1)&&r.x(this,o.call(r.y,r.e({value:d,style:{glyphs:!0,sprite:!0},styleSpec:r.v})))}}class mi{constructor(o,d){this.width=o,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,d){const g=o.join(",")+String(d);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(o,d)),this.dashEntry[g]}getDashRanges(o,d,g){const v=[];let A=o.length%2==1?-o[o.length-1]*g:0,O=o[0]*g,C=!0;v.push({left:A,right:O,isDash:C,zeroLength:o[0]===0});let L=o[0];for(let B=1;B<o.length;B++){C=!C;const U=o[B];A=L*g,L+=U,O=L*g,v.push({left:A,right:O,isDash:C,zeroLength:U===0})}return v}addRoundDash(o,d,g){const v=d/2;for(let A=-g;A<=g;A++){const O=this.width*(this.nextRow+g+A);let C=0,L=o[C];for(let B=0;B<this.width;B++){B/L.right>1&&(L=o[++C]);const U=Math.abs(B-L.left),j=Math.abs(B-L.right),ee=Math.min(U,j);let me;const fe=A/g*(v+1);if(L.isDash){const be=v-Math.abs(fe);me=Math.sqrt(ee*ee+be*be)}else me=v-Math.sqrt(ee*ee+fe*fe);this.data[O+B]=Math.max(0,Math.min(255,me+128))}}}addRegularDash(o){for(let C=o.length-1;C>=0;--C){const L=o[C],B=o[C+1];L.zeroLength?o.splice(C,1):B&&B.isDash===L.isDash&&(B.left=L.left,o.splice(C,1))}const d=o[0],g=o[o.length-1];d.isDash===g.isDash&&(d.left=g.left-this.width,g.right=d.right+this.width);const v=this.width*this.nextRow;let A=0,O=o[A];for(let C=0;C<this.width;C++){C/O.right>1&&(O=o[++A]);const L=Math.abs(C-O.left),B=Math.abs(C-O.right),U=Math.min(L,B);this.data[v+C]=Math.max(0,Math.min(255,(O.isDash?U:-U)+128))}}addDash(o,d){const g=d?7:0,v=2*g+1;if(this.nextRow+v>this.height)return r.w("LineAtlas out of space"),null;let A=0;for(let C=0;C<o.length;C++)A+=o[C];if(A!==0){const C=this.width/A,L=this.getDashRanges(o,this.width,C);d?this.addRoundDash(L,C,g):this.addRegularDash(L)}const O={y:(this.nextRow+g+.5)/this.height,height:2*g/this.height,width:A};return this.nextRow+=v,this.dirty=!0,O}bind(o){const d=o.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}class vt{constructor(o,d,g){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=g;const v=this.workerPool.acquire(g);for(let A=0;A<v.length;A++){const O=new r.C(v[A],d,g);O.name=`Worker ${A}`,this.actors.push(O)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,d,g){r.o(this.actors,(v,A)=>{v.send(o,d,A)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}}function pt(x,o,d){const g=function(v,A){if(v)return d(v);if(A){const O=r.F(r.e(A,x),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);A.vector_layers&&(O.vectorLayers=A.vector_layers,O.vectorLayerIds=O.vectorLayers.map(C=>C.id)),d(null,O)}};return x.url?r.f(o.transformRequest(x.url,H.Source),g):r.h.frame(()=>g(null,x))}class Pt{constructor(o,d){o&&(d?this.setSouthWest(o).setNorthEast(d):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof r.L?new r.L(o.lng,o.lat):r.L.convert(o),this}setSouthWest(o){return this._sw=o instanceof r.L?new r.L(o.lng,o.lat):r.L.convert(o),this}extend(o){const d=this._sw,g=this._ne;let v,A;if(o instanceof r.L)v=o,A=o;else{if(!(o instanceof Pt))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(Pt.convert(o)):this.extend(r.L.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(r.L.convert(o)):this;if(v=o._sw,A=o._ne,!v||!A)return this}return d||g?(d.lng=Math.min(v.lng,d.lng),d.lat=Math.min(v.lat,d.lat),g.lng=Math.max(A.lng,g.lng),g.lat=Math.max(A.lat,g.lat)):(this._sw=new r.L(v.lng,v.lat),this._ne=new r.L(A.lng,A.lat)),this}getCenter(){return new r.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new r.L(this.getWest(),this.getNorth())}getSouthEast(){return new r.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:d,lat:g}=r.L.convert(o);let v=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&v}static convert(o){return o instanceof Pt?o:o&&new Pt(o)}static fromLngLat(o,d=0){const g=360*d/40075017,v=g/Math.cos(Math.PI/180*o.lat);return new Pt(new r.L(o.lng-v,o.lat-g),new r.L(o.lng+v,o.lat+g))}}class qe{constructor(o,d,g){this.bounds=Pt.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=g||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),g=Math.floor(r.G(this.bounds.getWest())*d),v=Math.floor(r.H(this.bounds.getNorth())*d),A=Math.ceil(r.G(this.bounds.getEast())*d),O=Math.ceil(r.H(this.bounds.getSouth())*d);return o.x>=g&&o.x<A&&o.y>=v&&o.y<O}}class Ht extends r.E{constructor(o,d,g,v){if(super(),this.load=()=>{this._loaded=!1,this.fire(new r.k("dataloading",{dataType:"source"})),this._tileJSONRequest=pt(this._options,this.map._requestManager,(A,O)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),A?this.fire(new r.j(A)):O&&(r.e(this,O),O.bounds&&(this.tileBounds=new qe(O.bounds,this.minzoom,this.maxzoom)),this.fire(new r.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>r.e({},this._options),this.id=o,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.e(this,r.F(d,["url","scheme","tileSize","promoteId"])),this._options=r.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(o,d){const g=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v={request:this.map._requestManager.transformRequest(g,H.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function A(O,C){return delete o.request,o.aborted?d(null):O&&O.status!==404?d(O):(C&&C.resourceTiming&&(o.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&o.setExpiryData(C),o.loadVectorData(C,this.map.painter),d(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}v.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=d:o.request=o.actor.send("reloadTile",v,A.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",v,A.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class lt extends r.E{constructor(o,d,g,v){super(),this.id=o,this.dispatcher=g,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.e({type:"raster"},d),r.e(this,r.F(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new r.k("dataloading",{dataType:"source"})),this._tileJSONRequest=pt(this._options,this.map._requestManager,(o,d)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new r.j(o)):d&&(r.e(this,d),d.bounds&&(this.tileBounds=new qe(d.bounds,this.minzoom,this.maxzoom)),this.fire(new r.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}serialize(){return r.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,d){const g=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=z.getImage(this.map._requestManager.transformRequest(g,H.Tile),(v,A,O)=>{if(delete o.request,o.aborted)o.state="unloaded",d(null);else if(v)o.state="errored",d(v);else if(A){this.map._refreshExpiredTiles&&O&&o.setExpiryData(O);const C=this.map.painter.context,L=C.gl;o.texture=this.map.painter.getTileTexture(A.width),o.texture?o.texture.update(A,{useMipmap:!0}):(o.texture=new oe(C,A,L.RGBA,{useMipmap:!0}),o.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&L.texParameterf(L.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),o.state="loaded",d(null)}},this.map._refreshExpiredTiles)}abortTile(o,d){o.request&&(o.request.cancel(),delete o.request),d()}unloadTile(o,d){o.texture&&this.map.painter.saveTileTexture(o.texture),d()}hasTransition(){return!1}}class Gt extends lt{constructor(o,d,g,v){super(o,d,g,v),this.type="raster-dem",this.maxzoom=22,this._options=r.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(o,d){const g=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v=this.map._requestManager.transformRequest(g,H.Tile);function A(O,C){O&&(o.state="errored",d(O)),C&&(o.dem=C,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded",d(null))}o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.request=z.getImage(v,(O,C,L)=>r._(this,void 0,void 0,function*(){if(delete o.request,o.aborted)o.state="unloaded",d(null);else if(O)o.state="errored",d(O);else if(C){this.map._refreshExpiredTiles&&o.setExpiryData(L);const B=r.a(C)&&r.J()?C:yield function(j){return r._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&r.K()){const ee=j.width+2,me=j.height+2;try{return new r.R({width:ee,height:me},yield r.M(j,-1,-1,ee,me))}catch{}}return r.h.getImageData(j,1)})}(C),U={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:B,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",U,A))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(o){const d=o.canonical,g=Math.pow(2,d.z),v=(d.x-1+g)%g,A=d.x===0?o.wrap-1:o.wrap,O=(d.x+1+g)%g,C=d.x+1===g?o.wrap+1:o.wrap,L={};return L[new r.O(o.overscaledZ,A,d.z,v,d.y).key]={backfilled:!1},L[new r.O(o.overscaledZ,C,d.z,O,d.y).key]={backfilled:!1},d.y>0&&(L[new r.O(o.overscaledZ,A,d.z,v,d.y-1).key]={backfilled:!1},L[new r.O(o.overscaledZ,o.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},L[new r.O(o.overscaledZ,C,d.z,O,d.y-1).key]={backfilled:!1}),d.y+1<g&&(L[new r.O(o.overscaledZ,A,d.z,v,d.y+1).key]={backfilled:!1},L[new r.O(o.overscaledZ,o.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},L[new r.O(o.overscaledZ,C,d.z,O,d.y+1).key]={backfilled:!1}),L}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class Mi extends r.E{constructor(o,d,g,v){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>r.e({},this._options,{type:this.type,data:this._data}),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=g.getActor(),this.setEventedParent(v),this._data=d.data,this._options=r.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const A=r.N/this.tileSize;this.workerOptions=r.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*A,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*A,extent:r.N,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:r.N,radius:(d.clusterRadius||50)*A,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},d),this}getClusterChildren(o,d){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},d),this}getClusterLeaves(o,d,g,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:d,offset:g},v),this}_updateWorkerData(o){const d=r.e({},this.workerOptions);o?d.dataDiff=o:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(r.h.resolveURL(this._data),H.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new r.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,d,(g,v)=>{if(this._pendingLoads--,this._removed||v&&v.abandoned)return void this.fire(new r.k("dataabort",{dataType:"source"}));let A=null;if(v&&v.resourceTiming&&v.resourceTiming[this.id]&&(A=v.resourceTiming[this.id].slice(0)),g)return void this.fire(new r.j(g));const O={dataType:"source"};this._collectResourceTiming&&A&&A.length>0&&r.e(O,{resourceTiming:A}),this.fire(new r.k("data",Object.assign(Object.assign({},O),{sourceDataType:"metadata"}))),this.fire(new r.k("data",Object.assign(Object.assign({},O),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(o,d){const g=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const v={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(g,v,(A,O)=>(delete o.request,o.unloadVectorData(),o.aborted?d(null):A?d(A):(o.loadVectorData(O,this.map.painter,g==="reloadTile"),d(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var bt=r.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ze extends r.E{constructor(o,d,g,v){super(),this.load=(A,O)=>{this._loaded=!1,this.fire(new r.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=z.getImage(this.map._requestManager.transformRequest(this.url,H.Image),(C,L)=>{this._request=null,this._loaded=!0,C?this.fire(new r.j(C)):L&&(this.image=L,A&&(this.coordinates=A),O&&O(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const A=this.map.painter.context,O=A.gl;this.boundsBuffer||(this.boundsBuffer=A.createVertexBuffer(this._boundsArray,bt.members)),this.boundsSegments||(this.boundsSegments=r.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new oe(A,this.image,O.RGBA),this.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE));let C=!1;for(const L in this.tiles){const B=this.tiles[L];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture,C=!0)}C&&this.fire(new r.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=o,this.dispatcher=g,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=d}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new r.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(o){this.coordinates=o;const d=o.map(r.U.fromLngLat);this.tileID=function(v){let A=1/0,O=1/0,C=-1/0,L=-1/0;for(const ee of v)A=Math.min(A,ee.x),O=Math.min(O,ee.y),C=Math.max(C,ee.x),L=Math.max(L,ee.y);const B=Math.max(C-A,L-O),U=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),j=Math.pow(2,U);return new r.W(U,Math.floor((A+C)/2*j),Math.floor((O+L)/2*j))}(d),this.minzoom=this.maxzoom=this.tileID.z;const g=d.map(v=>this.tileID.getTilePoint(v)._round());return this._boundsArray=new r.V,this._boundsArray.emplaceBack(g[0].x,g[0].y,0,0),this._boundsArray.emplaceBack(g[1].x,g[1].y,r.N,0),this._boundsArray.emplaceBack(g[3].x,g[3].y,0,r.N),this._boundsArray.emplaceBack(g[2].x,g[2].y,r.N,r.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new r.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(o,d){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},d(null)):(o.state="errored",d(null))}hasTransition(){return!1}}class $t extends ze{constructor(o,d,g,v){super(o,d,g,v),this.load=()=>{this._loaded=!1;const A=this.options;this.urls=[];for(const O of A.urls)this.urls.push(this.map._requestManager.transformRequest(O,H.Source).url);r.X(this.urls,(O,C)=>{this._loaded=!0,O?this.fire(new r.j(O)):C&&(this.video=C,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const A=this.map.painter.context,O=A.gl;this.boundsBuffer||(this.boundsBuffer=A.createVertexBuffer(this._boundsArray,bt.members)),this.boundsSegments||(this.boundsSegments=r.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE),O.texSubImage2D(O.TEXTURE_2D,0,0,0,O.RGBA,O.UNSIGNED_BYTE,this.video)):(this.texture=new oe(A,this.video,O.RGBA),this.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE));let C=!1;for(const L in this.tiles){const B=this.tiles[L];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture,C=!0)}C&&this.fire(new r.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=d}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const d=this.video.seekable;o<d.start(0)||o>d.end(0)?this.fire(new r.j(new r.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class dt extends ze{constructor(o,d,g,v){super(o,d,g,v),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let A=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,A=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,A=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const O=this.map.painter.context,C=O.gl;this.boundsBuffer||(this.boundsBuffer=O.createVertexBuffer(this._boundsArray,bt.members)),this.boundsSegments||(this.boundsSegments=r.S.simpleSegment(0,0,4,2)),this.texture?(A||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new oe(O,this.canvas,C.RGBA,{premultiply:!0});let L=!1;for(const B in this.tiles){const U=this.tiles[B];U.state!=="loaded"&&(U.state="loaded",U.texture=this.texture,L=!0)}L&&this.fire(new r.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(A=>!Array.isArray(A)||A.length!==2||A.some(O=>typeof O!="number"))||this.fire(new r.j(new r.Y(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.j(new r.Y(`sources.${o}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new r.j(new r.Y(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new r.j(new r.Y(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.j(new r.Y(`sources.${o}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const _t={},ni=x=>{switch(x){case"geojson":return Mi;case"image":return ze;case"raster":return lt;case"raster-dem":return Gt;case"vector":return Ht;case"video":return $t;case"canvas":return dt}return _t[x]};function Wi(x,o){const d=r.Z();return r.$(d,d,[1,1,0]),r.a0(d,d,[.5*x.width,.5*x.height,1]),r.a1(d,d,x.calculatePosMatrix(o.toUnwrapped()))}function ct(x,o,d,g,v,A){const O=function(j,ee,me){if(j)for(const fe of j){const be=ee[fe];if(be&&be.source===me&&be.type==="fill-extrusion")return!0}else for(const fe in ee){const be=ee[fe];if(be.source===me&&be.type==="fill-extrusion")return!0}return!1}(v&&v.layers,o,x.id),C=A.maxPitchScaleFactor(),L=x.tilesIn(g,C,O);L.sort(et);const B=[];for(const j of L)B.push({wrappedTileID:j.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(o,d,x._state,j.queryGeometry,j.cameraQueryGeometry,j.scale,v,A,C,Wi(x.transform,j.tileID))});const U=function(j){const ee={},me={};for(const fe of j){const be=fe.queryResults,he=fe.wrappedTileID,Pe=me[he]=me[he]||{};for(const Je in be){const Ee=be[Je],Fe=Pe[Je]=Pe[Je]||{},it=ee[Je]=ee[Je]||[];for(const at of Ee)Fe[at.featureIndex]||(Fe[at.featureIndex]=!0,it.push(at))}}return ee}(B);for(const j in U)U[j].forEach(ee=>{const me=ee.feature,fe=x.getFeatureState(me.layer["source-layer"],me.id);me.source=me.layer.source,me.layer["source-layer"]&&(me.sourceLayer=me.layer["source-layer"]),me.state=fe});return U}function et(x,o){const d=x.tileID,g=o.tileID;return d.overscaledZ-g.overscaledZ||d.canonical.y-g.canonical.y||d.wrap-g.wrap||d.canonical.x-g.canonical.x}class zi{constructor(o,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=r.a2(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const d=o+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,d,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(v,A){const O={};if(!A)return O;for(const C of v){const L=C.layerIds.map(B=>A.getLayer(B)).filter(Boolean);if(L.length!==0){C.layers=L,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(B=>L.filter(U=>U.id===B)[0]));for(const B of L)O[B.id]=C}}return O}(o.buckets,d.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const A=this.buckets[v];if(A instanceof r.a4){if(this.hasSymbolBuckets=!0,!g)break;A.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const A=this.buckets[v];if(A instanceof r.a4&&A.hasRTLText){this.hasRTLText=!0,r.a5();break}}this.queryPadding=0;for(const v in this.buckets){const A=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(v).queryRadius(A))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new r.a3}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const g in this.buckets){const v=this.buckets[g];v.uploadPending()&&v.upload(o)}const d=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new oe(o,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new oe(o,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,d,g,v,A,O,C,L,B,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:A,scale:O,tileSize:this.tileSize,pixelPosMatrix:U,transform:L,params:C,queryPadding:this.queryPadding*B},o,d,g):{}}querySourceFeatures(o,d){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const v=g.loadVTLayers(),A=d&&d.sourceLayer?d.sourceLayer:"",O=v._geojsonTileLayer||v[A];if(!O)return;const C=r.a6(d&&d.filter),{z:L,x:B,y:U}=this.tileID.canonical,j={z:L,x:B,y:U};for(let ee=0;ee<O.length;ee++){const me=O.feature(ee);if(C.needGeometry){const he=r.a7(me,!0);if(!C.filter(new r.a8(this.tileID.overscaledZ),he,this.tileID.canonical))continue}else if(!C.filter(new r.a8(this.tileID.overscaledZ),me))continue;const fe=g.getId(me,A),be=new r.a9(me,L,B,U,fe);be.tile=j,o.push(be)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const d=this.expirationTime;if(o.cacheControl){const g=r.aa(o.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const g=Date.now();let v=!1;if(this.expirationTime>g)v=!1;else if(d)if(this.expirationTime<d)v=!0;else{const A=this.expirationTime-d;A?this.expirationTime=g+Math.max(A,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!d.style.hasLayer(v))continue;const A=this.buckets[v],O=A.layers[0].sourceLayer||"_geojsonTileLayer",C=g[O],L=o[O];if(!C||!L||Object.keys(L).length===0)continue;A.update(L,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const B=d&&d.style&&d.style.getLayer(v);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(A)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<r.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=r.h.now()+o}setDependencies(o,d){const g={};for(const v of d)g[v]=!0;this.dependencies[o]=g}hasDependency(o,d){for(const g of o){const v=this.dependencies[g];if(v){for(const A of d)if(v[A])return!0}}return!1}}class zn{constructor(o,d){this.max=o,this.onRemove=d,this.reset()}reset(){for(const o in this.data)for(const d of this.data[o])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(o,d,g){const v=o.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const A={value:d,timeout:void 0};if(g!==void 0&&(A.timeout=setTimeout(()=>{this.remove(o,A)},g)),this.data[v].push(A),this.order.push(v),this.order.length>this.max){const O=this._getAndRemoveByKey(this.order[0]);O&&this.onRemove(O)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const d=this.data[o].shift();return d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),d.value}getByKey(o){const d=this.data[o];return d?d[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,d){if(!this.has(o))return this;const g=o.wrapped().key,v=d===void 0?0:this.data[g].indexOf(d),A=this.data[g][v];return this.data[g].splice(v,1),A.timeout&&clearTimeout(A.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(A.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(o){const d=[];for(const g in this.data)for(const v of this.data[g])o(v.value)||d.push(v);for(const g of d)this.remove(g.value.tileID,g)}}class Xe{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,d,g){const v=String(d);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][v]=this.stateChanges[o][v]||{},r.e(this.stateChanges[o][v],g),this.deletedStates[o]===null){this.deletedStates[o]={};for(const A in this.state[o])A!==v&&(this.deletedStates[o][A]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][v]===null){this.deletedStates[o][v]={};for(const A in this.state[o][v])g[A]||(this.deletedStates[o][v][A]=null)}else for(const A in g)this.deletedStates[o]&&this.deletedStates[o][v]&&this.deletedStates[o][v][A]===null&&delete this.deletedStates[o][v][A]}removeFeatureState(o,d,g){if(this.deletedStates[o]===null)return;const v=String(d);if(this.deletedStates[o]=this.deletedStates[o]||{},g&&d!==void 0)this.deletedStates[o][v]!==null&&(this.deletedStates[o][v]=this.deletedStates[o][v]||{},this.deletedStates[o][v][g]=null);else if(d!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][v])for(g in this.deletedStates[o][v]={},this.stateChanges[o][v])this.deletedStates[o][v][g]=null;else this.deletedStates[o][v]=null;else this.deletedStates[o]=null}getState(o,d){const g=String(d),v=r.e({},(this.state[o]||{})[g],(this.stateChanges[o]||{})[g]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const A=this.deletedStates[o][d];if(A===null)return{};for(const O in A)delete v[O]}return v}initializeTileState(o,d){o.setFeatureState(this.state,d)}coalesceChanges(o,d){const g={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const A={};for(const O in this.stateChanges[v])this.state[v][O]||(this.state[v][O]={}),r.e(this.state[v][O],this.stateChanges[v][O]),A[O]=this.state[v][O];g[v]=A}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const A={};if(this.deletedStates[v]===null)for(const O in this.state[v])A[O]={},this.state[v][O]={};else for(const O in this.deletedStates[v]){if(this.deletedStates[v][O]===null)this.state[v][O]={};else for(const C of Object.keys(this.deletedStates[v][O]))delete this.state[v][O][C];A[O]=this.state[v][O]}g[v]=g[v]||{},r.e(g[v],A)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const v in o)o[v].setFeatureState(g,d)}}class On extends r.E{constructor(o,d,g){super(),this.id=o,this.dispatcher=g,this.on("data",v=>{v.dataType==="source"&&v.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&v.dataType==="source"&&v.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((v,A,O,C)=>{const L=new(ni(A.type))(v,A,O,C);if(L.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${L.id}`);return L})(o,d,g,this),this._tiles={},this._cache=new zn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Xe,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const d=this._tiles[o];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,d){return this._source.loadTile(o,d)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new r.k("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const g=this._tiles[d];g.upload(o),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Rt).map(o=>o.key)}getRenderableIds(o){const d=[];for(const g in this._tiles)this._isIdRenderable(g,o)&&d.push(this._tiles[g]);return o?d.sort((g,v)=>{const A=g.tileID,O=v.tileID,C=new r.P(A.canonical.x,A.canonical.y)._rotate(this.transform.angle),L=new r.P(O.canonical.x,O.canonical.y)._rotate(this.transform.angle);return A.overscaledZ-O.overscaledZ||L.y-C.y||L.x-C.x}).map(g=>g.tileID.key):d.map(g=>g.tileID).sort(Rt).map(g=>g.key)}hasRenderableParent(o){const d=this.findLoadedParent(o,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(o,d){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(d||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,d){const g=this._tiles[o];g&&(g.state!=="loading"&&(g.state=d),this._loadTile(g,this._tileLoaded.bind(this,g,o,d)))}_tileLoaded(o,d,g,v){if(v)return o.state="errored",void(v.status!==404?this._source.fire(new r.j(v,{tile:o})):this.update(this.transform,this.terrain));o.timeAdded=r.h.now(),g==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(d,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new r.k("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const d=this.getRenderableIds();for(let v=0;v<d.length;v++){const A=d[v];if(o.neighboringTiles&&o.neighboringTiles[A]){const O=this.getTileByID(A);g(o,O),g(O,o)}}function g(v,A){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let O=A.tileID.canonical.x-v.tileID.canonical.x;const C=A.tileID.canonical.y-v.tileID.canonical.y,L=Math.pow(2,v.tileID.canonical.z),B=A.tileID.key;O===0&&C===0||Math.abs(C)>1||(Math.abs(O)>1&&(Math.abs(O+L)===1?O+=L:Math.abs(O-L)===1&&(O-=L)),A.dem&&v.dem&&(v.dem.backfillBorder(A.dem,O,C),v.neighboringTiles&&v.neighboringTiles[B]&&(v.neighboringTiles[B].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,d,g,v){for(const A in this._tiles){let O=this._tiles[A];if(v[A]||!O.hasData()||O.tileID.overscaledZ<=d||O.tileID.overscaledZ>g)continue;let C=O.tileID;for(;O&&O.tileID.overscaledZ>d+1;){const B=O.tileID.scaledTo(O.tileID.overscaledZ-1);O=this._tiles[B.key],O&&O.hasData()&&(C=B)}let L=C;for(;L.overscaledZ>d;)if(L=L.scaledTo(L.overscaledZ-1),o[L.key]){v[C.key]=C;break}}}findLoadedParent(o,d){if(o.key in this._loadedParentTiles){const g=this._loadedParentTiles[o.key];return g&&g.tileID.overscaledZ>=d?g:null}for(let g=o.overscaledZ-1;g>=d;g--){const v=o.scaledTo(g),A=this._getLoadedTile(v);if(A)return A}}_getLoadedTile(o){const d=this._tiles[o.key];return d&&d.hasData()?d:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const d=Math.ceil(o.width/this._source.tileSize)+1,g=Math.ceil(o.height/this._source.tileSize)+1,v=Math.floor(d*g*(this._maxTileCacheZoomLevels===null?r.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),A=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(A)}handleWrapJump(o){const d=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,d){const g={};for(const v in this._tiles){const A=this._tiles[v];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+d),g[A.tileID.key]=A}this._tiles=g;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}update(o,d){if(this.transform=o,this.terrain=d,!this._sourceLoaded||this._paused)return;let g;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new r.O(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y)):(g=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(g=g.filter(U=>this._source.hasTile(U)))):g=[];const v=o.coveringZoomLevel(this._source),A=Math.max(v-On.maxOverzooming,this._source.minzoom),O=Math.max(v+On.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const U={};for(const j of g)if(j.canonical.z>this._source.minzoom){const ee=j.scaledTo(j.canonical.z-1);U[ee.key]=ee;const me=j.scaledTo(Math.max(this._source.minzoom,Math.min(j.canonical.z,5)));U[me.key]=me}g=g.concat(Object.values(U))}const C=g.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new r.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const L=this._updateRetainedTiles(g,v);if(Xi(this._source.type)){const U={},j={},ee=Object.keys(L),me=r.h.now();for(const fe of ee){const be=L[fe],he=this._tiles[fe];if(!he||he.fadeEndTime!==0&&he.fadeEndTime<=me)continue;const Pe=this.findLoadedParent(be,A);Pe&&(this._addTile(Pe.tileID),U[Pe.tileID.key]=Pe.tileID),j[fe]=be}this._retainLoadedChildren(j,v,O,L);for(const fe in U)L[fe]||(this._coveredTiles[fe]=!0,L[fe]=U[fe]);if(d){const fe={},be={};for(const he of g)this._tiles[he.key].hasData()?fe[he.key]=he:be[he.key]=he;for(const he in be){const Pe=be[he].children(this._source.maxzoom);this._tiles[Pe[0].key]&&this._tiles[Pe[1].key]&&this._tiles[Pe[2].key]&&this._tiles[Pe[3].key]&&(fe[Pe[0].key]=L[Pe[0].key]=Pe[0],fe[Pe[1].key]=L[Pe[1].key]=Pe[1],fe[Pe[2].key]=L[Pe[2].key]=Pe[2],fe[Pe[3].key]=L[Pe[3].key]=Pe[3],delete be[he])}for(const he in be){const Pe=this.findLoadedParent(be[he],this._source.minzoom);if(Pe){fe[Pe.tileID.key]=L[Pe.tileID.key]=Pe.tileID;for(const Je in fe)fe[Je].isChildOf(Pe.tileID)&&delete fe[Je]}}for(const he in this._tiles)fe[he]||(this._coveredTiles[he]=!0)}}for(const U in L)this._tiles[U].clearFadeHold();const B=r.ab(this._tiles,L);for(const U of B){const j=this._tiles[U];j.hasSymbolBuckets&&!j.holdingForFade()?j.setHoldDuration(this.map._fadeDuration):j.hasSymbolBuckets&&!j.symbolFadeFinished()||this._removeTile(U)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,d){const g={},v={},A=Math.max(d-On.maxOverzooming,this._source.minzoom),O=Math.max(d+On.maxUnderzooming,this._source.minzoom),C={};for(const L of o){const B=this._addTile(L);g[L.key]=L,B.hasData()||d<this._source.maxzoom&&(C[L.key]=L)}this._retainLoadedChildren(C,d,O,g);for(const L of o){let B=this._tiles[L.key];if(B.hasData())continue;if(d+1>this._source.maxzoom){const j=L.children(this._source.maxzoom)[0],ee=this.getTile(j);if(ee&&ee.hasData()){g[j.key]=j;continue}}else{const j=L.children(this._source.maxzoom);if(g[j[0].key]&&g[j[1].key]&&g[j[2].key]&&g[j[3].key])continue}let U=B.wasRequested();for(let j=L.overscaledZ-1;j>=A;--j){const ee=L.scaledTo(j);if(v[ee.key])break;if(v[ee.key]=!0,B=this.getTile(ee),!B&&U&&(B=this._addTile(ee)),B){const me=B.hasData();if((U||me)&&(g[ee.key]=ee),U=B.wasRequested(),me)break}}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const d=[];let g,v=this._tiles[o].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){g=this._loadedParentTiles[v.key];break}d.push(v.key);const A=v.scaledTo(v.overscaledZ-1);if(g=this._getLoadedTile(A),g)break;v=A}for(const A of d)this._loadedParentTiles[A]=g}}_addTile(o){let d=this._tiles[o.key];if(d)return d;d=this._cache.getAndRemove(o),d&&(this._setTileReloadTimer(o.key,d),d.tileID=o,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,d)));const g=d;return d||(d=new zi(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,o.key,d.state))),d.uses++,this._tiles[o.key]=d,g||this._source.fire(new r.k("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(o,d){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const g=d.getExpiryTimeout();g&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},g))}_removeTile(o){const d=this._tiles[o];d&&(d.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,d,g){const v=[],A=this.transform;if(!A)return v;const O=g?A.getCameraQueryGeometry(o):o,C=o.map(fe=>A.pointCoordinate(fe,this.terrain)),L=O.map(fe=>A.pointCoordinate(fe,this.terrain)),B=this.getIds();let U=1/0,j=1/0,ee=-1/0,me=-1/0;for(const fe of L)U=Math.min(U,fe.x),j=Math.min(j,fe.y),ee=Math.max(ee,fe.x),me=Math.max(me,fe.y);for(let fe=0;fe<B.length;fe++){const be=this._tiles[B[fe]];if(be.holdingForFade())continue;const he=be.tileID,Pe=Math.pow(2,A.zoom-be.tileID.overscaledZ),Je=d*be.queryPadding*r.N/be.tileSize/Pe,Ee=[he.getTilePoint(new r.U(U,j)),he.getTilePoint(new r.U(ee,me))];if(Ee[0].x-Je<r.N&&Ee[0].y-Je<r.N&&Ee[1].x+Je>=0&&Ee[1].y+Je>=0){const Fe=C.map(at=>he.getTilePoint(at)),it=L.map(at=>he.getTilePoint(at));v.push({tile:be,tileID:he,queryGeometry:Fe,cameraQueryGeometry:it,scale:Pe})}}return v}getVisibleCoordinates(o){const d=this.getRenderableIds(o).map(g=>this._tiles[g].tileID);for(const g of d)g.posMatrix=this.transform.calculatePosMatrix(g.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(Xi(this._source.type)){const o=r.h.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=o)return!0}return!1}setFeatureState(o,d,g){this._state.updateState(o=o||"_geojsonTileLayer",d,g)}removeFeatureState(o,d,g){this._state.removeFeatureState(o=o||"_geojsonTileLayer",d,g)}getFeatureState(o,d){return this._state.getState(o=o||"_geojsonTileLayer",d)}setDependencies(o,d,g){const v=this._tiles[o];v&&v.setDependencies(d,g)}reloadTilesForDependencies(o,d){for(const g in this._tiles)this._tiles[g].hasDependency(o,d)&&this._reloadTile(g,"reloading");this._cache.filter(g=>!g.hasDependency(o,d))}}function Rt(x,o){const d=Math.abs(2*x.wrap)-+(x.wrap<0),g=Math.abs(2*o.wrap)-+(o.wrap<0);return x.overscaledZ-o.overscaledZ||g-d||o.canonical.y-x.canonical.y||o.canonical.x-x.canonical.x}function Xi(x){return x==="raster"||x==="image"||x==="video"}On.maxOverzooming=10,On.maxUnderzooming=3;const Ui="mapboxgl_preloaded_worker_pool";class Gn{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Gn.workerCount;)this.workers.push(new Worker(r.c.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ui]}numActive(){return Object.keys(this.active).length}}const mr=Math.floor(r.h.hardwareConcurrency/2);let vr;function jr(){return vr||(vr=new Gn),vr}Gn.workerCount=r.ac(globalThis)?Math.max(Math.min(mr,3),1):1;class Cr{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=r.ad(o,0,1);let d=1,g=this._distances[d];const v=o*this.paddedLength+this.padding;for(;g<v&&d<this._distances.length;)g=this._distances[++d];const A=d-1,O=this._distances[A],C=g-O,L=C>0?(v-O)/C:0;return this.points[A].mult(1-L).add(this.points[d].mult(L))}}function lr(x,o){let d=!0;return x==="always"||x!=="never"&&o!=="never"||(d=!1),d}class Hn{constructor(o,d,g){const v=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(o/g),this.yCellCount=Math.ceil(d/g);for(let O=0;O<this.xCellCount*this.yCellCount;O++)v.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,g,v,A){this._forEachCell(d,g,v,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(v),this.bboxes.push(A)}insertCircle(o,d,g,v){this._forEachCell(d-v,g-v,d+v,g+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(g),this.circles.push(v)}_insertBoxCell(o,d,g,v,A,O){this.boxCells[A].push(O)}_insertCircleCell(o,d,g,v,A,O){this.circleCells[A].push(O)}_query(o,d,g,v,A,O,C){if(g<0||o>this.width||v<0||d>this.height)return[];const L=[];if(o<=0&&d<=0&&this.width<=g&&this.height<=v){if(A)return[{key:null,x1:o,y1:d,x2:g,y2:v}];for(let B=0;B<this.boxKeys.length;B++)L.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const U=this.circles[3*B],j=this.circles[3*B+1],ee=this.circles[3*B+2];L.push({key:this.circleKeys[B],x1:U-ee,y1:j-ee,x2:U+ee,y2:j+ee})}}else this._forEachCell(o,d,g,v,this._queryCell,L,{hitTest:A,overlapMode:O,seenUids:{box:{},circle:{}}},C);return L}query(o,d,g,v){return this._query(o,d,g,v,!1,null)}hitTest(o,d,g,v,A,O){return this._query(o,d,g,v,!0,A,O).length>0}hitTestCircle(o,d,g,v,A){const O=o-g,C=o+g,L=d-g,B=d+g;if(C<0||O>this.width||B<0||L>this.height)return!1;const U=[];return this._forEachCell(O,L,C,B,this._queryCellCircle,U,{hitTest:!0,overlapMode:v,circle:{x:o,y:d,radius:g},seenUids:{box:{},circle:{}}},A),U.length>0}_queryCell(o,d,g,v,A,O,C,L){const{seenUids:B,hitTest:U,overlapMode:j}=C,ee=this.boxCells[A];if(ee!==null){const fe=this.bboxes;for(const be of ee)if(!B.box[be]){B.box[be]=!0;const he=4*be,Pe=this.boxKeys[be];if(o<=fe[he+2]&&d<=fe[he+3]&&g>=fe[he+0]&&v>=fe[he+1]&&(!L||L(Pe))&&(!U||!lr(j,Pe.overlapMode))&&(O.push({key:Pe,x1:fe[he],y1:fe[he+1],x2:fe[he+2],y2:fe[he+3]}),U))return!0}}const me=this.circleCells[A];if(me!==null){const fe=this.circles;for(const be of me)if(!B.circle[be]){B.circle[be]=!0;const he=3*be,Pe=this.circleKeys[be];if(this._circleAndRectCollide(fe[he],fe[he+1],fe[he+2],o,d,g,v)&&(!L||L(Pe))&&(!U||!lr(j,Pe.overlapMode))){const Je=fe[he],Ee=fe[he+1],Fe=fe[he+2];if(O.push({key:Pe,x1:Je-Fe,y1:Ee-Fe,x2:Je+Fe,y2:Ee+Fe}),U)return!0}}}return!1}_queryCellCircle(o,d,g,v,A,O,C,L){const{circle:B,seenUids:U,overlapMode:j}=C,ee=this.boxCells[A];if(ee!==null){const fe=this.bboxes;for(const be of ee)if(!U.box[be]){U.box[be]=!0;const he=4*be,Pe=this.boxKeys[be];if(this._circleAndRectCollide(B.x,B.y,B.radius,fe[he+0],fe[he+1],fe[he+2],fe[he+3])&&(!L||L(Pe))&&!lr(j,Pe.overlapMode))return O.push(!0),!0}}const me=this.circleCells[A];if(me!==null){const fe=this.circles;for(const be of me)if(!U.circle[be]){U.circle[be]=!0;const he=3*be,Pe=this.circleKeys[be];if(this._circlesCollide(fe[he],fe[he+1],fe[he+2],B.x,B.y,B.radius)&&(!L||L(Pe))&&!lr(j,Pe.overlapMode))return O.push(!0),!0}}}_forEachCell(o,d,g,v,A,O,C,L){const B=this._convertToXCellCoord(o),U=this._convertToYCellCoord(d),j=this._convertToXCellCoord(g),ee=this._convertToYCellCoord(v);for(let me=B;me<=j;me++)for(let fe=U;fe<=ee;fe++)if(A.call(this,o,d,g,v,this.xCellCount*fe+me,O,C,L))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,g,v,A,O){const C=v-o,L=A-d,B=g+O;return B*B>C*C+L*L}_circleAndRectCollide(o,d,g,v,A,O,C){const L=(O-v)/2,B=Math.abs(o-(v+L));if(B>L+g)return!1;const U=(C-A)/2,j=Math.abs(d-(A+U));if(j>U+g)return!1;if(B<=L||j<=U)return!0;const ee=B-L,me=j-U;return ee*ee+me*me<=g*g}}function Nt(x,o,d,g,v){const A=r.Z();return o?(r.a0(A,A,[1/v,1/v,1]),d||r.ae(A,A,g.angle)):r.a1(A,g.labelPlaneMatrix,x),A}function Qi(x,o,d,g,v){if(o){const A=r.af(x);return r.a0(A,A,[v,v,1]),d||r.ae(A,A,-g.angle),A}return g.glCoordMatrix}function Qe(x,o,d){let g;d?(g=[x.x,x.y,d(x.x,x.y),1],r.ag(g,g,o)):(g=[x.x,x.y,0,1],le(g,g,o));const v=g[3];return{point:new r.P(g[0]/v,g[1]/v),signedDistanceFromCamera:v}}function Ki(x,o){return .5+x/o*.5}function Gi(x,o){const d=x[0]/x[3],g=x[1]/x[3];return d>=-o[0]&&d<=o[0]&&g>=-o[1]&&g<=o[1]}function Lt(x,o,d,g,v,A,O,C,L,B){const U=g?x.textSizeData:x.iconSizeData,j=r.ah(U,d.transform.zoom),ee=[256/d.width*2+1,256/d.height*2+1],me=g?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;me.clear();const fe=x.lineVertexArray,be=g?x.text.placedSymbolArray:x.icon.placedSymbolArray,he=d.transform.width/d.transform.height;let Pe=!1;for(let Je=0;Je<be.length;Je++){const Ee=be.get(Je);if(Ee.hidden||Ee.writingMode===r.ai.vertical&&!Pe){J(Ee.numGlyphs,me);continue}let Fe;if(Pe=!1,B?(Fe=[Ee.anchorX,Ee.anchorY,B(Ee.anchorX,Ee.anchorY),1],r.ag(Fe,Fe,o)):(Fe=[Ee.anchorX,Ee.anchorY,0,1],le(Fe,Fe,o)),!Gi(Fe,ee)){J(Ee.numGlyphs,me);continue}const it=Ki(d.transform.cameraToCenterDistance,Fe[3]),at=r.aj(U,j,Ee),xt=O?at/it:at*it,Vt=new r.P(Ee.anchorX,Ee.anchorY),kt=Qe(Vt,v,B).point,qt={projections:{},offsets:{}},vi=Bn(Ee,xt,!1,C,o,v,A,x.glyphOffsetArray,fe,me,kt,Vt,qt,he,L,B);Pe=vi.useVertical,(vi.notEnoughRoom||Pe||vi.needsFlipping&&Bn(Ee,xt,!0,C,o,v,A,x.glyphOffsetArray,fe,me,kt,Vt,qt,he,L,B).notEnoughRoom)&&J(Ee.numGlyphs,me)}g?x.text.dynamicLayoutVertexBuffer.updateData(me):x.icon.dynamicLayoutVertexBuffer.updateData(me)}function Bi(x,o,d,g,v,A,O,C,L,B,U,j,ee){const me=C.glyphStartIndex+C.numGlyphs,fe=C.lineStartIndex,be=C.lineStartIndex+C.lineLength,he=o.getoffsetX(C.glyphStartIndex),Pe=o.getoffsetX(me-1),Je=V(x*he,d,g,v,A,O,C.segment,fe,be,L,B,U,j,ee);if(!Je)return null;const Ee=V(x*Pe,d,g,v,A,O,C.segment,fe,be,L,B,U,j,ee);return Ee?{first:Je,last:Ee}:null}function ii(x,o,d,g){return x===r.ai.horizontal&&Math.abs(d.y-o.y)>Math.abs(d.x-o.x)*g?{useVertical:!0}:(x===r.ai.vertical?o.y<d.y:o.x>d.x)?{needsFlipping:!0}:null}function Bn(x,o,d,g,v,A,O,C,L,B,U,j,ee,me,fe,be){const he=o/24,Pe=x.lineOffsetX*he,Je=x.lineOffsetY*he;let Ee;if(x.numGlyphs>1){const Fe=x.glyphStartIndex+x.numGlyphs,it=x.lineStartIndex,at=x.lineStartIndex+x.lineLength,xt=Bi(he,C,Pe,Je,d,U,j,x,L,A,ee,fe,be);if(!xt)return{notEnoughRoom:!0};const Vt=Qe(xt.first.point,O,be).point,kt=Qe(xt.last.point,O,be).point;if(g&&!d){const qt=ii(x.writingMode,Vt,kt,me);if(qt)return qt}Ee=[xt.first];for(let qt=x.glyphStartIndex+1;qt<Fe-1;qt++)Ee.push(V(he*C.getoffsetX(qt),Pe,Je,d,U,j,x.segment,it,at,L,A,ee,fe,be));Ee.push(xt.last)}else{if(g&&!d){const it=Qe(j,v,be).point,at=x.lineStartIndex+x.segment+1,xt=new r.P(L.getx(at),L.gety(at)),Vt=Qe(xt,v,be),kt=Vt.signedDistanceFromCamera>0?Vt.point:st(j,xt,it,1,v,be),qt=ii(x.writingMode,it,kt,me);if(qt)return qt}const Fe=V(he*C.getoffsetX(x.glyphStartIndex),Pe,Je,d,U,j,x.segment,x.lineStartIndex,x.lineStartIndex+x.lineLength,L,A,ee,fe,be);if(!Fe)return{notEnoughRoom:!0};Ee=[Fe]}for(const Fe of Ee)r.ak(B,Fe.point,Fe.angle);return{}}function st(x,o,d,g,v,A){const O=Qe(x.add(x.sub(o)._unit()),v,A).point,C=d.sub(O);return d.add(C._mult(g/C.mag()))}function Q(x,o){const{projectionCache:d,lineVertexArray:g,labelPlaneMatrix:v,tileAnchorPoint:A,distanceFromAnchor:O,getElevation:C,previousVertex:L,direction:B,absOffsetX:U}=o;if(d.projections[x])return d.projections[x];const j=new r.P(g.getx(x),g.gety(x)),ee=Qe(j,v,C);if(ee.signedDistanceFromCamera>0)return d.projections[x]=ee.point,ee.point;const me=x-B;return st(O===0?A:new r.P(g.getx(me),g.gety(me)),j,L,U-O+1,v,C)}function ge(x,o,d){return x._unit()._perp()._mult(o*d)}function Z(x,o,d,g,v,A,O,C){const{projectionCache:L,direction:B}=C;if(L.offsets[x])return L.offsets[x];const U=d.add(o);if(x+B<g||x+B>=v)return L.offsets[x]=U,U;const j=Q(x+B,C),ee=ge(j.sub(d),O,B),me=d.add(ee),fe=j.add(ee);return L.offsets[x]=r.al(A,U,me,fe)||U,L.offsets[x]}function V(x,o,d,g,v,A,O,C,L,B,U,j,ee,me){const fe=g?x-o:x+o;let be=fe>0?1:-1,he=0;g&&(be*=-1,he=Math.PI),be<0&&(he+=Math.PI);let Pe,Je,Ee=be>0?C+O:C+O+1,Fe=v,it=v,at=0,xt=0;const Vt=Math.abs(fe),kt=[];let qt;for(;at+xt<=Vt;){if(Ee+=be,Ee<C||Ee>=L)return null;at+=xt,it=Fe,Je=Pe;const ei={projectionCache:j,lineVertexArray:B,labelPlaneMatrix:U,tileAnchorPoint:A,distanceFromAnchor:at,getElevation:me,previousVertex:it,direction:be,absOffsetX:Vt};if(Fe=Q(Ee,ei),d===0)kt.push(it),qt=Fe.sub(it);else{let Fi;const wi=Fe.sub(it);Fi=wi.mag()===0?ge(Q(Ee+be,ei).sub(Fe),d,be):ge(wi,d,be),Je||(Je=it.add(Fi)),Pe=Z(Ee,Fi,Fe,C,L,Je,d,ei),kt.push(Je),qt=Pe.sub(Je)}xt=qt.mag()}const vi=qt._mult((Vt-at)/xt)._add(Je||it),un=he+Math.atan2(Fe.y-it.y,Fe.x-it.x);return kt.push(vi),{point:vi,angle:ee?un:0,path:kt}}const q=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function J(x,o){for(let d=0;d<x;d++){const g=o.length;o.resize(g+4),o.float32.set(q,3*g)}}function le(x,o,d){const g=o[0],v=o[1];return x[0]=d[0]*g+d[4]*v+d[12],x[1]=d[1]*g+d[5]*v+d[13],x[3]=d[3]*g+d[7]*v+d[15],x}const ce=100;class Oe{constructor(o,d=new Hn(o.width+200,o.height+200,25),g=new Hn(o.width+200,o.height+200,25)){this.transform=o,this.grid=d,this.ignoredGrid=g,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+ce,this.screenBottomBoundary=o.height+ce,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,d,g,v,A,O){const C=this.projectAndGetPerspectiveRatio(v,o.anchorPointX,o.anchorPointY,O),L=g*C.perspectiveRatio,B=o.x1*L+C.point.x,U=o.y1*L+C.point.y,j=o.x2*L+C.point.x,ee=o.y2*L+C.point.y;return!this.isInsideGrid(B,U,j,ee)||d!=="always"&&this.grid.hitTest(B,U,j,ee,d,A)||C.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[B,U,j,ee],offscreen:this.isOffscreen(B,U,j,ee)}}placeCollisionCircles(o,d,g,v,A,O,C,L,B,U,j,ee,me,fe){const be=[],he=new r.P(d.anchorX,d.anchorY),Pe=Qe(he,O,fe),Je=Ki(this.transform.cameraToCenterDistance,Pe.signedDistanceFromCamera),Ee=(U?A/Je:A*Je)/r.ap,Fe=Qe(he,C,fe).point,it=Bi(Ee,v,d.lineOffsetX*Ee,d.lineOffsetY*Ee,!1,Fe,he,d,g,C,{projections:{},offsets:{}},!1,fe);let at=!1,xt=!1,Vt=!0;if(it){const kt=.5*ee*Je+me,qt=new r.P(-100,-100),vi=new r.P(this.screenRightBoundary,this.screenBottomBoundary),un=new Cr,ei=it.first,Fi=it.last;let wi=[];for(let rn=ei.path.length-1;rn>=1;rn--)wi.push(ei.path[rn]);for(let rn=1;rn<Fi.path.length;rn++)wi.push(Fi.path[rn]);const Rn=2.5*kt;if(L){const rn=wi.map(hn=>Qe(hn,L,fe));wi=rn.some(hn=>hn.signedDistanceFromCamera<=0)?[]:rn.map(hn=>hn.point)}let ln=[];if(wi.length>0){const rn=wi[0].clone(),hn=wi[0].clone();for(let Ir=1;Ir<wi.length;Ir++)rn.x=Math.min(rn.x,wi[Ir].x),rn.y=Math.min(rn.y,wi[Ir].y),hn.x=Math.max(hn.x,wi[Ir].x),hn.y=Math.max(hn.y,wi[Ir].y);ln=rn.x>=qt.x&&hn.x<=vi.x&&rn.y>=qt.y&&hn.y<=vi.y?[wi]:hn.x<qt.x||rn.x>vi.x||hn.y<qt.y||rn.y>vi.y?[]:r.am([wi],qt.x,qt.y,vi.x,vi.y)}for(const rn of ln){un.reset(rn,.25*kt);let hn=0;hn=un.length<=.5*kt?1:Math.ceil(un.paddedLength/Rn)+1;for(let Ir=0;Ir<hn;Ir++){const Xn=Ir/Math.max(hn-1,1),rs=un.lerp(Xn),Hr=rs.x+ce,Rr=rs.y+ce;be.push(Hr,Rr,kt,0);const ta=Hr-kt,ar=Rr-kt,Ja=Hr+kt,Xa=Rr+kt;if(Vt=Vt&&this.isOffscreen(ta,ar,Ja,Xa),xt=xt||this.isInsideGrid(ta,ar,Ja,Xa),o!=="always"&&this.grid.hitTestCircle(Hr,Rr,kt,o,j)&&(at=!0,!B))return{circles:[],offscreen:!1,collisionDetected:at}}}}return{circles:!B&&at||!xt||Je<this.perspectiveRatioCutoff?[]:be,offscreen:Vt,collisionDetected:at}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let g=1/0,v=1/0,A=-1/0,O=-1/0;for(const U of o){const j=new r.P(U.x+ce,U.y+ce);g=Math.min(g,j.x),v=Math.min(v,j.y),A=Math.max(A,j.x),O=Math.max(O,j.y),d.push(j)}const C=this.grid.query(g,v,A,O).concat(this.ignoredGrid.query(g,v,A,O)),L={},B={};for(const U of C){const j=U.key;if(L[j.bucketInstanceId]===void 0&&(L[j.bucketInstanceId]={}),L[j.bucketInstanceId][j.featureIndex])continue;const ee=[new r.P(U.x1,U.y1),new r.P(U.x2,U.y1),new r.P(U.x2,U.y2),new r.P(U.x1,U.y2)];r.an(d,ee)&&(L[j.bucketInstanceId][j.featureIndex]=!0,B[j.bucketInstanceId]===void 0&&(B[j.bucketInstanceId]=[]),B[j.bucketInstanceId].push(j.featureIndex))}return B}insertCollisionBox(o,d,g,v,A,O){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:A,collisionGroupID:O,overlapMode:d},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,g,v,A,O){const C=g?this.ignoredGrid:this.grid,L={bucketInstanceId:v,featureIndex:A,collisionGroupID:O,overlapMode:d};for(let B=0;B<o.length;B+=4)C.insertCircle(L,o[B],o[B+1],o[B+2])}projectAndGetPerspectiveRatio(o,d,g,v){let A;return v?(A=[d,g,v(d,g),1],r.ag(A,A,o)):(A=[d,g,0,1],le(A,A,o)),{point:new r.P((A[0]/A[3]+1)/2*this.transform.width+ce,(-A[1]/A[3]+1)/2*this.transform.height+ce),perspectiveRatio:.5+this.transform.cameraToCenterDistance/A[3]*.5}}isOffscreen(o,d,g,v){return g<ce||o>=this.screenRightBoundary||v<ce||d>this.screenBottomBoundary}isInsideGrid(o,d,g,v){return g>=0&&o<this.gridRightBoundary&&v>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=r.ao([]);return r.$(o,o,[-100,-100,0]),o}}function Ae(x,o,d){return o*(r.N/(x.tileSize*Math.pow(2,d-x.tileID.overscaledZ)))}class ye{constructor(o,d,g,v){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):v&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Ce{constructor(o,d,g,v,A){this.text=new ye(o?o.text:null,d,g,A),this.icon=new ye(o?o.icon:null,d,v,A)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ot{constructor(o,d,g){this.text=o,this.icon=d,this.skipFade=g}}class gt{constructor(){this.invProjMatrix=r.Z(),this.viewportMatrix=r.Z(),this.circles=[]}}class ht{constructor(o,d,g,v,A){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=g,this.bucketIndex=v,this.tileID=A}}class di{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:g=>g.collisionGroupID===d}}return this.collisionGroups[o]}}function Oi(x,o,d,g,v){const{horizontalAlign:A,verticalAlign:O}=r.au(x);return new r.P(-(A-.5)*o+g[0]*v,-(O-.5)*d+g[1]*v)}function ai(x,o,d,g,v,A){const{x1:O,x2:C,y1:L,y2:B,anchorPointX:U,anchorPointY:j}=x,ee=new r.P(o,d);return g&&ee._rotate(v?A:-A),{x1:O+ee.x,y1:L+ee.y,x2:C+ee.x,y2:B+ee.y,anchorPointX:U,anchorPointY:j}}class _i{constructor(o,d,g,v,A){this.transform=o.clone(),this.terrain=d,this.collisionIndex=new Oe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new di(v),this.collisionCircleArrays={},this.prevPlacement=A,A&&(A.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,d,g,v){const A=g.getBucket(d),O=g.latestFeatureIndex;if(!A||!O||d.id!==A.layerIds[0])return;const C=g.collisionBoxArray,L=A.layers[0].layout,B=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),U=g.tileSize/r.N,j=this.transform.calculatePosMatrix(g.tileID.toUnwrapped()),ee=L.get("text-pitch-alignment")==="map",me=L.get("text-rotation-alignment")==="map",fe=Ae(g,1,this.transform.zoom),be=Nt(j,ee,me,this.transform,fe);let he=null;if(ee){const Je=Qi(j,ee,me,this.transform,fe);he=r.a1([],this.transform.labelPlaneMatrix,Je)}this.retainedQueryData[A.bucketInstanceId]=new ht(A.bucketInstanceId,O,A.sourceLayerIndex,A.index,g.tileID);const Pe={bucket:A,layout:L,posMatrix:j,textLabelPlaneMatrix:be,labelToScreenMatrix:he,scale:B,textPixelRatio:U,holdingForFade:g.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:r.ah(A.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(A.sourceID)};if(v)for(const Je of A.sortKeyRanges){const{sortKey:Ee,symbolInstanceStart:Fe,symbolInstanceEnd:it}=Je;o.push({sortKey:Ee,symbolInstanceStart:Fe,symbolInstanceEnd:it,parameters:Pe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:Pe})}attemptAnchorPlacement(o,d,g,v,A,O,C,L,B,U,j,ee,me,fe,be,he){const Pe=r.aq[o.textAnchor],Je=[o.textOffset0,o.textOffset1],Ee=Oi(Pe,g,v,Je,A),Fe=this.collisionIndex.placeCollisionBox(ai(d,Ee.x,Ee.y,O,C,this.transform.angle),j,L,B,U.predicate,he);if((!be||this.collisionIndex.placeCollisionBox(ai(be,Ee.x,Ee.y,O,C,this.transform.angle),j,L,B,U.predicate,he).box.length!==0)&&Fe.box.length>0){let it;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID].text&&(it=this.prevPlacement.variableOffsets[ee.crossTileID].anchor),ee.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ee.crossTileID]={textOffset:Je,width:g,height:v,anchor:Pe,textBoxScale:A,prevAnchor:it},this.markUsedJustification(me,Pe,ee,fe),me.allowVerticalPlacement&&(this.markUsedOrientation(me,fe,ee),this.placedOrientations[ee.crossTileID]=fe),{shift:Ee,placedGlyphBoxes:Fe}}}placeLayerBucketPart(o,d,g){const{bucket:v,layout:A,posMatrix:O,textLabelPlaneMatrix:C,labelToScreenMatrix:L,textPixelRatio:B,holdingForFade:U,collisionBoxArray:j,partiallyEvaluatedTextSize:ee,collisionGroup:me}=o.parameters,fe=A.get("text-optional"),be=A.get("icon-optional"),he=r.ar(A,"text-overlap","text-allow-overlap"),Pe=he==="always",Je=r.ar(A,"icon-overlap","icon-allow-overlap"),Ee=Je==="always",Fe=A.get("text-rotation-alignment")==="map",it=A.get("text-pitch-alignment")==="map",at=A.get("icon-text-fit")!=="none",xt=A.get("symbol-z-order")==="viewport-y",Vt=Pe&&(Ee||!v.hasIconData()||be),kt=Ee&&(Pe||!v.hasTextData()||fe);!v.collisionArrays&&j&&v.deserializeCollisionBoxes(j);const qt=this.retainedQueryData[v.bucketInstanceId].tileID,vi=this.terrain?(ei,Fi)=>this.terrain.getElevation(qt,ei,Fi):null,un=(ei,Fi)=>{var wi,Rn;if(d[ei.crossTileID])return;if(U)return void(this.placements[ei.crossTileID]=new ot(!1,!1,!1));let ln=!1,rn=!1,hn=!0,Ir=null,Xn={box:null,offscreen:null},rs={box:null,offscreen:null},Hr=null,Rr=null,ta=null,ar=0,Ja=0,Xa=0;Fi.textFeatureIndex?ar=Fi.textFeatureIndex:ei.useRuntimeCollisionCircles&&(ar=ei.featureIndex),Fi.verticalTextFeatureIndex&&(Ja=Fi.verticalTextFeatureIndex);const Ko=Fi.textBox;if(Ko){const ms=kr=>{let Kr=r.ai.horizontal;if(v.allowVerticalPlacement&&!kr&&this.prevPlacement){const Ls=this.prevPlacement.placedOrientations[ei.crossTileID];Ls&&(this.placedOrientations[ei.crossTileID]=Ls,Kr=Ls,this.markUsedOrientation(v,Kr,ei))}return Kr},ss=(kr,Kr)=>{if(v.allowVerticalPlacement&&ei.numVerticalGlyphVertices>0&&Fi.verticalTextBox){for(const Ls of v.writingModes)if(Ls===r.ai.vertical?(Xn=Kr(),rs=Xn):Xn=kr(),Xn&&Xn.box&&Xn.box.length)break}else Xn=kr()},As=ei.textAnchorOffsetStartIndex,_l=ei.textAnchorOffsetEndIndex;if(_l===As){const kr=(Kr,Ls)=>{const Or=this.collisionIndex.placeCollisionBox(Kr,he,B,O,me.predicate,vi);return Or&&Or.box&&Or.box.length&&(this.markUsedOrientation(v,Ls,ei),this.placedOrientations[ei.crossTileID]=Ls),Or};ss(()=>kr(Ko,r.ai.horizontal),()=>{const Kr=Fi.verticalTextBox;return v.allowVerticalPlacement&&ei.numVerticalGlyphVertices>0&&Kr?kr(Kr,r.ai.vertical):{box:null,offscreen:null}}),ms(Xn&&Xn.box&&Xn.box.length)}else{let kr=r.aq[(Rn=(wi=this.prevPlacement)===null||wi===void 0?void 0:wi.variableOffsets[ei.crossTileID])===null||Rn===void 0?void 0:Rn.anchor];const Kr=(Or,yl,Cu)=>{const kf=Or.x2-Or.x1,Of=Or.y2-Or.y1,Up=ei.textBoxScale,$h=at&&Je==="never"?yl:null;let Qa={box:[],offscreen:!1},vl=he==="never"?1:2,$a="never";kr&&vl++;for(let ga=0;ga<vl;ga++){for(let eo=As;eo<_l;eo++){const ed=v.textAnchorOffsets.get(eo);if(kr&&ed.textAnchor!==kr)continue;const _o=this.attemptAnchorPlacement(ed,Or,kf,Of,Up,Fe,it,B,O,me,$a,ei,v,Cu,$h,vi);if(_o&&(Qa=_o.placedGlyphBoxes,Qa&&Qa.box&&Qa.box.length))return ln=!0,Ir=_o.shift,Qa}kr?kr=null:$a=he}return Qa};ss(()=>Kr(Ko,Fi.iconBox,r.ai.horizontal),()=>{const Or=Fi.verticalTextBox;return v.allowVerticalPlacement&&!(Xn&&Xn.box&&Xn.box.length)&&ei.numVerticalGlyphVertices>0&&Or?Kr(Or,Fi.verticalIconBox,r.ai.vertical):{box:null,offscreen:null}}),Xn&&(ln=Xn.box,hn=Xn.offscreen);const Ls=ms(Xn&&Xn.box);if(!ln&&this.prevPlacement){const Or=this.prevPlacement.variableOffsets[ei.crossTileID];Or&&(this.variableOffsets[ei.crossTileID]=Or,this.markUsedJustification(v,Or.anchor,ei,Ls))}}}if(Hr=Xn,ln=Hr&&Hr.box&&Hr.box.length>0,hn=Hr&&Hr.offscreen,ei.useRuntimeCollisionCircles){const ms=v.text.placedSymbolArray.get(ei.centerJustifiedTextSymbolIndex),ss=r.aj(v.textSizeData,ee,ms),As=A.get("text-padding");Rr=this.collisionIndex.placeCollisionCircles(he,ms,v.lineVertexArray,v.glyphOffsetArray,ss,O,C,L,g,it,me.predicate,ei.collisionCircleDiameter,As,vi),Rr.circles.length&&Rr.collisionDetected&&!g&&r.w("Collisions detected, but collision boxes are not shown"),ln=Pe||Rr.circles.length>0&&!Rr.collisionDetected,hn=hn&&Rr.offscreen}if(Fi.iconFeatureIndex&&(Xa=Fi.iconFeatureIndex),Fi.iconBox){const ms=ss=>{const As=at&&Ir?ai(ss,Ir.x,Ir.y,Fe,it,this.transform.angle):ss;return this.collisionIndex.placeCollisionBox(As,Je,B,O,me.predicate,vi)};rs&&rs.box&&rs.box.length&&Fi.verticalIconBox?(ta=ms(Fi.verticalIconBox),rn=ta.box.length>0):(ta=ms(Fi.iconBox),rn=ta.box.length>0),hn=hn&&ta.offscreen}const gl=fe||ei.numHorizontalGlyphVertices===0&&ei.numVerticalGlyphVertices===0,hc=be||ei.numIconVertices===0;if(gl||hc?hc?gl||(rn=rn&&ln):ln=rn&&ln:rn=ln=rn&&ln,ln&&Hr&&Hr.box&&this.collisionIndex.insertCollisionBox(Hr.box,he,A.get("text-ignore-placement"),v.bucketInstanceId,rs&&rs.box&&Ja?Ja:ar,me.ID),rn&&ta&&this.collisionIndex.insertCollisionBox(ta.box,Je,A.get("icon-ignore-placement"),v.bucketInstanceId,Xa,me.ID),Rr&&(ln&&this.collisionIndex.insertCollisionCircles(Rr.circles,he,A.get("text-ignore-placement"),v.bucketInstanceId,ar,me.ID),g)){const ms=v.bucketInstanceId;let ss=this.collisionCircleArrays[ms];ss===void 0&&(ss=this.collisionCircleArrays[ms]=new gt);for(let As=0;As<Rr.circles.length;As+=4)ss.circles.push(Rr.circles[As+0]),ss.circles.push(Rr.circles[As+1]),ss.circles.push(Rr.circles[As+2]),ss.circles.push(Rr.collisionDetected?1:0)}if(ei.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ei.crossTileID]=new ot(ln||Vt,rn||kt,hn||v.justReloaded),d[ei.crossTileID]=!0};if(xt){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ei=v.getSortedSymbolIndexes(this.transform.angle);for(let Fi=ei.length-1;Fi>=0;--Fi){const wi=ei[Fi];un(v.symbolInstances.get(wi),v.collisionArrays[wi])}}else for(let ei=o.symbolInstanceStart;ei<o.symbolInstanceEnd;ei++)un(v.symbolInstances.get(ei),v.collisionArrays[ei]);if(g&&v.bucketInstanceId in this.collisionCircleArrays){const ei=this.collisionCircleArrays[v.bucketInstanceId];r.as(ei.invProjMatrix,O),ei.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}markUsedJustification(o,d,g,v){let A;A=v===r.ai.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[r.at(d)];const O=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const C of O)C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=A>=0&&C!==A?0:g.crossTileID)}markUsedOrientation(o,d,g){const v=d===r.ai.horizontal||d===r.ai.horizontalOnly?d:0,A=d===r.ai.vertical?d:0,O=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const C of O)o.text.placedSymbolArray.get(C).placedOrientation=v;g.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=A)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let g=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const v=d?d.symbolFadeChange(o):1,A=d?d.opacities:{},O=d?d.variableOffsets:{},C=d?d.placedOrientations:{};for(const L in this.placements){const B=this.placements[L],U=A[L];U?(this.opacities[L]=new Ce(U,v,B.text,B.icon),g=g||B.text!==U.text.placed||B.icon!==U.icon.placed):(this.opacities[L]=new Ce(null,v,B.text,B.icon,B.skipFade),g=g||B.text||B.icon)}for(const L in A){const B=A[L];if(!this.opacities[L]){const U=new Ce(B,v,!1,!1);U.isHidden()||(this.opacities[L]=U,g=g||B.text.placed||B.icon.placed)}}for(const L in O)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=O[L]);for(const L in C)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=C[L]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d){const g={};for(const v of d){const A=v.getBucket(o);A&&v.latestFeatureIndex&&o.id===A.layerIds[0]&&this.updateBucketOpacities(A,g,v.collisionBoxArray)}}updateBucketOpacities(o,d,g){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const v=o.layers[0],A=v.layout,O=new Ce(null,0,!1,!1,!0),C=A.get("text-allow-overlap"),L=A.get("icon-allow-overlap"),B=v._unevaluatedLayout.hasValue("text-variable-anchor")||v._unevaluatedLayout.hasValue("text-variable-anchor-offset"),U=A.get("text-rotation-alignment")==="map",j=A.get("text-pitch-alignment")==="map",ee=A.get("icon-text-fit")!=="none",me=new Ce(null,0,C&&(L||!o.hasIconData()||A.get("icon-optional")),L&&(C||!o.hasTextData()||A.get("text-optional")),!0);!o.collisionArrays&&g&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(g);const fe=(be,he,Pe)=>{for(let Je=0;Je<he/4;Je++)be.opacityVertexArray.emplaceBack(Pe);be.hasVisibleVertices=be.hasVisibleVertices||Pe!==cr};for(let be=0;be<o.symbolInstances.length;be++){const he=o.symbolInstances.get(be),{numHorizontalGlyphVertices:Pe,numVerticalGlyphVertices:Je,crossTileID:Ee}=he;let Fe=this.opacities[Ee];d[Ee]?Fe=O:Fe||(Fe=me,this.opacities[Ee]=Fe),d[Ee]=!0;const it=he.numIconVertices>0,at=this.placedOrientations[he.crossTileID],xt=at===r.ai.vertical,Vt=at===r.ai.horizontal||at===r.ai.horizontalOnly;if(Pe>0||Je>0){const kt=Cn(Fe.text);fe(o.text,Pe,xt?cr:kt),fe(o.text,Je,Vt?cr:kt);const qt=Fe.text.isHidden();[he.rightJustifiedTextSymbolIndex,he.centerJustifiedTextSymbolIndex,he.leftJustifiedTextSymbolIndex].forEach(ei=>{ei>=0&&(o.text.placedSymbolArray.get(ei).hidden=qt||xt?1:0)}),he.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(he.verticalPlacedTextSymbolIndex).hidden=qt||Vt?1:0);const vi=this.variableOffsets[he.crossTileID];vi&&this.markUsedJustification(o,vi.anchor,he,at);const un=this.placedOrientations[he.crossTileID];un&&(this.markUsedJustification(o,"left",he,un),this.markUsedOrientation(o,un,he))}if(it){const kt=Cn(Fe.icon),qt=!(ee&&he.verticalPlacedIconSymbolIndex&&xt);he.placedIconSymbolIndex>=0&&(fe(o.icon,he.numIconVertices,qt?kt:cr),o.icon.placedSymbolArray.get(he.placedIconSymbolIndex).hidden=Fe.icon.isHidden()),he.verticalPlacedIconSymbolIndex>=0&&(fe(o.icon,he.numVerticalIconVertices,qt?cr:kt),o.icon.placedSymbolArray.get(he.verticalPlacedIconSymbolIndex).hidden=Fe.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const kt=o.collisionArrays[be];if(kt){let qt=new r.P(0,0);if(kt.textBox||kt.verticalTextBox){let un=!0;if(B){const ei=this.variableOffsets[Ee];ei?(qt=Oi(ei.anchor,ei.width,ei.height,ei.textOffset,ei.textBoxScale),U&&qt._rotate(j?this.transform.angle:-this.transform.angle)):un=!1}kt.textBox&&ji(o.textCollisionBox.collisionVertexArray,Fe.text.placed,!un||xt,qt.x,qt.y),kt.verticalTextBox&&ji(o.textCollisionBox.collisionVertexArray,Fe.text.placed,!un||Vt,qt.x,qt.y)}const vi=!!(!Vt&&kt.verticalIconBox);kt.iconBox&&ji(o.iconCollisionBox.collisionVertexArray,Fe.icon.placed,vi,ee?qt.x:0,ee?qt.y:0),kt.verticalIconBox&&ji(o.iconCollisionBox.collisionVertexArray,Fe.icon.placed,!vi,ee?qt.x:0,ee?qt.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const be=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=be.invProjMatrix,o.placementViewportMatrix=be.viewportMatrix,o.collisionCircleArray=be.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const g=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*g>o}setStale(){this.stale=!0}}function ji(x,o,d,g,v){x.emplaceBack(o?1:0,d?1:0,g||0,v||0),x.emplaceBack(o?1:0,d?1:0,g||0,v||0),x.emplaceBack(o?1:0,d?1:0,g||0,v||0),x.emplaceBack(o?1:0,d?1:0,g||0,v||0)}const ke=Math.pow(2,25),Dt=Math.pow(2,24),It=Math.pow(2,17),yi=Math.pow(2,16),gn=Math.pow(2,9),Zi=Math.pow(2,8),In=Math.pow(2,1);function Cn(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;const o=x.placed?1:0,d=Math.floor(127*x.opacity);return d*ke+o*Dt+d*It+o*yi+d*gn+o*Zi+d*In+o}const cr=0;class Er{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,d,g,v,A){const O=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(O,v,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort((C,L)=>C.sortKey-L.sortKey));this._currentPartIndex<O.length;)if(d.placeLayerBucketPart(O[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,A())return!0;return!1}}class Ws{constructor(o,d,g,v,A,O,C,L){this.placement=new _i(o,d,O,C,L),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=A,this._done=!1}isDone(){return this._done}continuePlacement(o,d,g){const v=r.h.now(),A=()=>!this._forceFullPlacement&&r.h.now()-v>2;for(;this._currentPlacementIndex>=0;){const O=d[o[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=C)&&(!O.maxzoom||O.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Er(O)),this._inProgressLayer.continuePlacement(g[O.source],this.placement,this._showCollisionBoxes,O,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const la=512/r.N/2;class Mr{constructor(o,d,g){this.tileID=o,this.bucketInstanceId=g,this._symbolsByKey={};const v=new Map;for(let A=0;A<d.length;A++){const O=d.get(A),C=O.key,L=v.get(C);L?L.push(O):v.set(C,[O])}for(const[A,O]of v){const C={positions:O.map(L=>({x:Math.floor(L.anchorX*la),y:Math.floor(L.anchorY*la)})),crossTileIDs:O.map(L=>L.crossTileID)};if(C.positions.length>128){const L=new r.av(C.positions.length,16,Uint16Array);for(const{x:B,y:U}of C.positions)L.add(B,U);L.finish(),delete C.positions,C.index=L}this._symbolsByKey[A]=C}}getScaledCoordinates(o,d){const{x:g,y:v,z:A}=this.tileID.canonical,{x:O,y:C,z:L}=d.canonical,B=la/Math.pow(2,L-A),U=(C*r.N+o.anchorY)*B,j=v*r.N*la;return{x:Math.floor((O*r.N+o.anchorX)*B-g*r.N*la),y:Math.floor(U-j)}}findMatches(o,d,g){const v=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let A=0;A<o.length;A++){const O=o.get(A);if(O.crossTileID)continue;const C=this._symbolsByKey[O.key];if(!C)continue;const L=this.getScaledCoordinates(O,d);if(C.index){const B=C.index.range(L.x-v,L.y-v,L.x+v,L.y+v).sort();for(const U of B){const j=C.crossTileIDs[U];if(!g[j]){g[j]=!0,O.crossTileID=j;break}}}else if(C.positions)for(let B=0;B<C.positions.length;B++){const U=C.positions[B],j=C.crossTileIDs[B];if(Math.abs(U.x-L.x)<=v&&Math.abs(U.y-L.y)<=v&&!g[j]){g[j]=!0,O.crossTileID=j;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class xn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Vl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const g in this.indexes){const v=this.indexes[g],A={};for(const O in v){const C=v[O];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+d),A[C.tileID.key]=C}this.indexes[g]=A}this.lng=o}addBucket(o,d,g){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let A=0;A<d.symbolInstances.length;A++)d.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const v=this.usedCrossTileIDs[o.overscaledZ];for(const A in this.indexes){const O=this.indexes[A];if(Number(A)>o.overscaledZ)for(const C in O){const L=O[C];L.tileID.isChildOf(o)&&L.findMatches(d.symbolInstances,o,v)}else{const C=O[o.scaledTo(Number(A)).key];C&&C.findMatches(d.symbolInstances,o,v)}}for(let A=0;A<d.symbolInstances.length;A++){const O=d.symbolInstances.get(A);O.crossTileID||(O.crossTileID=g.generate(),v[O.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Mr(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const g of d.getCrossTileIDsLists())for(const v of g)delete this.usedCrossTileIDs[o][v]}removeStaleBuckets(o){let d=!1;for(const g in this.indexes){const v=this.indexes[g];for(const A in v)o[v[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,v[A]),delete v[A],d=!0)}return d}}class Ys{constructor(){this.layerIndexes={},this.crossTileIDs=new xn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,g){let v=this.layerIndexes[o.id];v===void 0&&(v=this.layerIndexes[o.id]=new Vl);let A=!1;const O={};v.handleWrapJump(g);for(const C of d){const L=C.getBucket(o);L&&o.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(C.tileID,L,this.crossTileIDs)&&(A=!0),O[L.bucketInstanceId]=!0)}return v.removeStaleBuckets(O)&&(A=!0),A}pruneUnusedLayers(o){const d={};o.forEach(g=>{d[g]=!0});for(const g in this.layerIndexes)d[g]||delete this.layerIndexes[g]}}const Jn=(x,o)=>r.x(x,o&&o.filter(d=>d.identifier!=="source.canvas")),$r=r.F(r.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),uo=r.F(r.ax,["setCenter","setZoom","setBearing","setPitch"]),zr=r.aw();class Br extends r.E{constructor(o,d={}){super(),this.map=o,this.dispatcher=new vt(jr(),this,o._getMapId()),this.imageManager=new mt,this.imageManager.setEventedParent(this),this.glyphManager=new We(o._requestManager,d.localIdeographFontFamily),this.lineAtlas=new mi(256,512),this.crossTileSymbolIndex=new Ys,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new r.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",r.az());const g=this;this._rtlTextPluginCallback=Br.registerForPluginStateChange(v=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(A,O)=>{if(r.aA(A),O&&O.every(C=>C))for(const C in g.sourceCaches){const L=g.sourceCaches[C].getSource().type;L!=="vector"&&L!=="geojson"||g.sourceCaches[C].reload()}})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const A=this.sourceCaches[v.sourceId];if(!A)return;const O=A.getSource();if(O&&O.vectorLayerIds)for(const C in this._layers){const L=this._layers[C];L.source===O.id&&this._validateLayer(L)}})}loadURL(o,d={},g){this.fire(new r.k("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const v=this.map._requestManager.transformRequest(o,H.Style);this._request=r.f(v,(A,O)=>{this._request=null,A?this.fire(new r.j(A)):O&&this._load(O,d,g)})}loadJSON(o,d={},g){this.fire(new r.k("dataloading",{dataType:"style"})),this._request=r.h.frame(()=>{this._request=null,d.validate=d.validate!==!1,this._load(o,d,g)})}loadEmpty(){this.fire(new r.k("dataloading",{dataType:"style"})),this._load(zr,{validate:!1})}_load(o,d,g){var v;const A=d.transformStyle?d.transformStyle(g,o):o;if(!d.validate||!Jn(this,r.y(A))){this._loaded=!0,this.stylesheet=A;for(const O in A.sources)this.addSource(O,A.sources[O],{validate:!1});A.sprite?this._loadSprite(A.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(A.glyphs),this._createLayers(),this.light=new zt(this.stylesheet.light),this.map.setTerrain((v=this.stylesheet.terrain)!==null&&v!==void 0?v:null),this.fire(new r.k("data",{dataType:"style"})),this.fire(new r.k("style.load"))}}_createLayers(){const o=r.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",o),this._order=o.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of o){const g=r.aC(d);g.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=g}}_loadSprite(o,d=!1,g=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(v,A,O,C){const L=ve(v),B=L.length,U=O>1?"@2x":"",j={},ee={},me={};for(const{id:fe,url:be}of L){const he=A.transformRequest(A.normalizeSpriteURL(be,U,".json"),H.SpriteJSON),Pe=`${fe}_${he.url}`;j[Pe]=r.f(he,(Fe,it)=>{delete j[Pe],ee[fe]=it,_e(C,ee,me,Fe,B)});const Je=A.transformRequest(A.normalizeSpriteURL(be,U,".png"),H.SpriteImage),Ee=`${fe}_${Je.url}`;j[Ee]=z.getImage(Je,(Fe,it)=>{delete j[Ee],me[fe]=it,_e(C,ee,me,Fe,B)})}return{cancel(){for(const fe of Object.values(j))fe.cancel()}}}(o,this.map._requestManager,this.map.getPixelRatio(),(v,A)=>{if(this._spriteRequest=null,v)this.fire(new r.j(v));else if(A)for(const O in A){this._spritesImagesIds[O]=[];const C=this._spritesImagesIds[O]?this._spritesImagesIds[O].filter(L=>!(L in A)):[];for(const L of C)this.imageManager.removeImage(L),this._changedImages[L]=!0;for(const L in A[O]){const B=O==="default"?L:`${O}:${L}`;this._spritesImagesIds[O].push(B),B in this.imageManager.images?this.imageManager.updateImage(B,A[O][L],!1):this.imageManager.addImage(B,A[O][L]),d&&(this._changedImages[B]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new r.k("data",{dataType:"style"})),g&&g(v)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new r.k("data",{dataType:"style"}))}_validateLayer(o){const d=this.sourceCaches[o.source];if(!d)return;const g=o.sourceLayer;if(!g)return;const v=d.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(g)===-1)&&this.fire(new r.j(new Error(`Source layer "${g}" does not exist on source "${v.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o){const d=this._serializedAllLayers();if(!o||o.length===0)return Object.values(d);const g=[];for(const v of o)d[v]&&g.push(d[v]);return g}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const d=Object.keys(this._layers);for(const g of d){const v=this._layers[g];v.type!=="custom"&&(o[g]=v.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const d=this._changed;if(this._changed){const v=Object.keys(this._updatedLayers),A=Object.keys(this._removedLayers);(v.length||A.length)&&this._updateWorkerLayers(v,A);for(const O in this._updatedSources){const C=this._updatedSources[O];if(C==="reload")this._reloadSource(O);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(O)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const O in this._updatedPaintProps)this._layers[O].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const g={};for(const v in this.sourceCaches){const A=this.sourceCaches[v];g[v]=A.used,A.used=!1}for(const v of this._order){const A=this._layers[v];A.recalculate(o,this._availableImages),!A.isHidden(o.zoom)&&A.source&&(this.sourceCaches[A.source].used=!0)}for(const v in g){const A=this.sourceCaches[v];g[v]!==A.used&&A.fire(new r.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(o),this.z=o.zoom,d&&this.fire(new r.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(o),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,d={}){this._checkLoaded();const g=this.serialize();if(o=d.transformStyle?d.transformStyle(g,o):o,Jn(this,r.y(o)))return!1;(o=r.aD(o)).layers=r.aB(o.layers);const v=r.aE(g,o).filter(O=>!(O.command in uo));if(v.length===0)return!1;const A=v.filter(O=>!(O.command in $r));if(A.length>0)throw new Error(`Unimplemented: ${A.map(O=>O.command).join(", ")}.`);for(const O of v)O.command!=="setTransition"&&this[O.command].apply(this,O.args);return this.stylesheet=o,this._serializedLayers=null,!0}addImage(o,d){if(this.getImage(o))return this.fire(new r.j(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,d),this._afterImageUpdated(o)}updateImage(o,d){this.imageManager.updateImage(o,d)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new r.j(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new r.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,d,g={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(r.y.source,`sources.${o}`,d,null,g))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const v=this.sourceCaches[o]=new On(o,d,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:o})),v.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===o)return this.fire(new r.j(new Error(`Source "${o}" cannot be removed while layer "${g}" is using it.`)));const d=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],d.fire(new r.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,d){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const g=this.sourceCaches[o].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(d),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,d,g={}){this._checkLoaded();const v=o.id;if(this.getLayer(v))return void this.fire(new r.j(new Error(`Layer "${v}" already exists on this map.`)));let A;if(o.type==="custom"){if(Jn(this,r.aF(o)))return;A=r.aC(o)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(v,o.source),o=r.aD(o),o=r.e(o,{source:v})),this._validate(r.y.layer,`layers.${v}`,o,{arrayIndex:-1},g))return;A=r.aC(o),this._validateLayer(A),A.setEventedParent(this,{layer:{id:v}})}const O=d?this._order.indexOf(d):this._order.length;if(d&&O===-1)this.fire(new r.j(new Error(`Cannot add layer "${v}" before non-existing layer "${d}".`)));else{if(this._order.splice(O,0,v),this._layerOrderChanged=!0,this._layers[v]=A,this._removedLayers[v]&&A.source&&A.type!=="custom"){const C=this._removedLayers[v];delete this._removedLayers[v],C.type!==A.type?this._updatedSources[A.source]="clear":(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map)}}moveLayer(o,d){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new r.j(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===d)return;const g=this._order.indexOf(o);this._order.splice(g,1);const v=d?this._order.indexOf(d):this._order.length;d&&v===-1?this.fire(new r.j(new Error(`Cannot move layer "${o}" before non-existing layer "${d}".`))):(this._order.splice(v,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const d=this._layers[o];if(!d)return void this.fire(new r.j(new Error(`Cannot remove non-existing layer "${o}".`)));d.setEventedParent(null);const g=this._order.indexOf(o);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=d,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],d.onRemove&&d.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,d,g){this._checkLoaded();const v=this.getLayer(o);v?v.minzoom===d&&v.maxzoom===g||(d!=null&&(v.minzoom=d),g!=null&&(v.maxzoom=g),this._updateLayer(v)):this.fire(new r.j(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,d,g={}){this._checkLoaded();const v=this.getLayer(o);if(v){if(!r.aG(v.filter,d))return d==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(r.y.filter,`layers.${v.id}.filter`,d,null,g)||(v.filter=r.aD(d),this._updateLayer(v)))}else this.fire(new r.j(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return r.aD(this.getLayer(o).filter)}setLayoutProperty(o,d,g,v={}){this._checkLoaded();const A=this.getLayer(o);A?r.aG(A.getLayoutProperty(d),g)||(A.setLayoutProperty(d,g,v),this._updateLayer(A)):this.fire(new r.j(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,d){const g=this.getLayer(o);if(g)return g.getLayoutProperty(d);this.fire(new r.j(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,d,g,v={}){this._checkLoaded();const A=this.getLayer(o);A?r.aG(A.getPaintProperty(d),g)||(A.setPaintProperty(d,g,v)&&this._updateLayer(A),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new r.j(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,d){return this.getLayer(o).getPaintProperty(d)}setFeatureState(o,d){this._checkLoaded();const g=o.source,v=o.sourceLayer,A=this.sourceCaches[g];if(A===void 0)return void this.fire(new r.j(new Error(`The source '${g}' does not exist in the map's style.`)));const O=A.getSource().type;O==="geojson"&&v?this.fire(new r.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):O!=="vector"||v?(o.id===void 0&&this.fire(new r.j(new Error("The feature id parameter must be provided."))),A.setFeatureState(v,o.id,d)):this.fire(new r.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,d){this._checkLoaded();const g=o.source,v=this.sourceCaches[g];if(v===void 0)return void this.fire(new r.j(new Error(`The source '${g}' does not exist in the map's style.`)));const A=v.getSource().type,O=A==="vector"?o.sourceLayer:void 0;A!=="vector"||O?d&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new r.j(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(O,o.id,d):this.fire(new r.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const d=o.source,g=o.sourceLayer,v=this.sourceCaches[d];if(v!==void 0)return v.getSource().type!=="vector"||g?(o.id===void 0&&this.fire(new r.j(new Error("The feature id parameter must be provided."))),v.getFeatureState(g,o.id)):void this.fire(new r.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new r.j(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return r.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=r.aH(this.sourceCaches,A=>A.serialize()),d=this._serializeByIds(this._order),g=this.map.getTerrain()||void 0,v=this.stylesheet;return r.aI({version:v.version,name:v.name,metadata:v.metadata,light:v.light,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,sources:o,layers:d,terrain:g},A=>A!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const d=O=>this._layers[O].type==="fill-extrusion",g={},v=[];for(let O=this._order.length-1;O>=0;O--){const C=this._order[O];if(d(C)){g[C]=O;for(const L of o){const B=L[C];if(B)for(const U of B)v.push(U)}}}v.sort((O,C)=>C.intersectionZ-O.intersectionZ);const A=[];for(let O=this._order.length-1;O>=0;O--){const C=this._order[O];if(d(C))for(let L=v.length-1;L>=0;L--){const B=v[L].feature;if(g[B.layer.id]<O)break;A.push(B),v.pop()}else for(const L of o){const B=L[C];if(B)for(const U of B)A.push(U.feature)}}return A}queryRenderedFeatures(o,d,g){d&&d.filter&&this._validate(r.y.filter,"queryRenderedFeatures.filter",d.filter,null,d);const v={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new r.j(new Error("parameters.layers must be an Array."))),[];for(const C of d.layers){const L=this._layers[C];if(!L)return this.fire(new r.j(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];v[L.source]=!0}}const A=[];d.availableImages=this._availableImages;const O=this._serializedAllLayers();for(const C in this.sourceCaches)d.layers&&!v[C]||A.push(ct(this.sourceCaches[C],this._layers,O,o,d,g));return this.placement&&A.push(function(C,L,B,U,j,ee,me){const fe={},be=ee.queryRenderedSymbols(U),he=[];for(const Pe of Object.keys(be).map(Number))he.push(me[Pe]);he.sort(et);for(const Pe of he){const Je=Pe.featureIndex.lookupSymbolFeatures(be[Pe.bucketInstanceId],L,Pe.bucketIndex,Pe.sourceLayerIndex,j.filter,j.layers,j.availableImages,C);for(const Ee in Je){const Fe=fe[Ee]=fe[Ee]||[],it=Je[Ee];it.sort((at,xt)=>{const Vt=Pe.featureSortOrder;if(Vt){const kt=Vt.indexOf(at.featureIndex);return Vt.indexOf(xt.featureIndex)-kt}return xt.featureIndex-at.featureIndex});for(const at of it)Fe.push(at)}}for(const Pe in fe)fe[Pe].forEach(Je=>{const Ee=Je.feature,Fe=B[C[Pe].source].getFeatureState(Ee.layer["source-layer"],Ee.id);Ee.source=Ee.layer.source,Ee.layer["source-layer"]&&(Ee.sourceLayer=Ee.layer["source-layer"]),Ee.state=Fe});return fe}(this._layers,O,this.sourceCaches,o,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(A)}querySourceFeatures(o,d){d&&d.filter&&this._validate(r.y.filter,"querySourceFeatures.filter",d.filter,null,d);const g=this.sourceCaches[o];return g?function(v,A){const O=v.getRenderableIds().map(B=>v.getTileByID(B)),C=[],L={};for(let B=0;B<O.length;B++){const U=O[B],j=U.tileID.canonical.key;L[j]||(L[j]=!0,U.querySourceFeatures(C,A))}return C}(g,d):[]}addSourceType(o,d,g){return ni(o)?g(new Error(`A source type called "${o}" already exists.`)):(((v,A)=>{_t[v]=A})(o,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:d.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(o,d={}){this._checkLoaded();const g=this.light.getLight();let v=!1;for(const O in o)if(!r.aG(o[O],g[O])){v=!0;break}if(!v)return;const A={now:r.h.now(),transition:r.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,d),this.light.updateTransitions(A)}_validate(o,d,g,v,A={}){return(!A||A.validate!==!1)&&Jn(this,o.call(r.y,r.e({key:d,style:this.serialize(),value:g,styleSpec:r.v},v)))}_remove(o=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const g=this.sourceCaches[d];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const d in this.sourceCaches)this.sourceCaches[d].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,d,g,v,A=!1){let O=!1,C=!1;const L={};for(const B of this._order){const U=this._layers[B];if(U.type!=="symbol")continue;if(!L[U.source]){const ee=this.sourceCaches[U.source];L[U.source]=ee.getRenderableIds(!0).map(me=>ee.getTileByID(me)).sort((me,fe)=>fe.tileID.overscaledZ-me.tileID.overscaledZ||(me.tileID.isLessThan(fe.tileID)?-1:1))}const j=this.crossTileSymbolIndex.addLayer(U,L[U.source],o.center.lng);O=O||j}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((A=A||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.h.now(),o.zoom))&&(this.pauseablePlacement=new Ws(o,this.map.terrain,this._order,A,d,g,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.h.now()),C=!0),O&&this.pauseablePlacement.placement.setStale()),C||O)for(const B of this._order){const U=this._layers[B];U.type==="symbol"&&this.placement.updateLayerOpacities(U,L[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.h.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,d,g){this.imageManager.getImages(d.icons,g),this._updateTilesForChangedImages();const v=this.sourceCaches[d.source];v&&v.setDependencies(d.tileID.key,d.type,d.icons)}getGlyphs(o,d,g){this.glyphManager.getGlyphs(d.stacks,g);const v=this.sourceCaches[d.source];v&&v.setDependencies(d.tileID.key,d.type,[""])}getResource(o,d,g){return r.m(d,g)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,d={}){this._checkLoaded(),o&&this._validate(r.y.glyphs,"glyphs",o,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,d,g={},v){this._checkLoaded();const A=[{id:o,url:d}],O=[...ve(this.stylesheet.sprite),...A];this._validate(r.y.sprite,"sprite",O,null,g)||(this.stylesheet.sprite=O,this._loadSprite(A,!0,v))}removeSprite(o){this._checkLoaded();const d=ve(this.stylesheet.sprite);if(d.find(g=>g.id===o)){if(this._spritesImagesIds[o])for(const g of this._spritesImagesIds[o])this.imageManager.removeImage(g),this._changedImages[g]=!0;d.splice(d.findIndex(g=>g.id===o),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new r.k("data",{dataType:"style"}))}else this.fire(new r.j(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return ve(this.stylesheet.sprite)}setSprite(o,d={},g){this._checkLoaded(),o&&this._validate(r.y.sprite,"sprite",o,null,d)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,g):(this._unloadSprite(),g&&g(null)))}}Br.registerForPluginStateChange=r.aK;var Fl=r.Q([{name:"a_pos",type:"Int16",components:2}]),Lo="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const $n={prelude:_n(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:_n(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:_n(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:_n(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:_n("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:_n(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:_n(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:_n("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:_n("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:_n("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:_n(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:_n(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:_n(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:_n(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:_n(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:_n(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:_n(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:_n(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:_n(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:_n(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:_n(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:_n(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:_n(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:_n(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:_n(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:_n(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:_n("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Lo),terrainDepth:_n("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Lo),terrainCoords:_n("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Lo)};function _n(x,o){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=o.match(/attribute ([\w]+) ([\w]+)/g),v=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=A?A.concat(v):v,C={};return{fragmentSource:x=x.replace(d,(L,B,U,j,ee)=>(C[ee]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
varying ${U} ${j} ${ee};
#else
uniform ${U} ${j} u_${ee};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ee}
    ${U} ${j} ${ee} = u_${ee};
#endif
`)),vertexSource:o=o.replace(d,(L,B,U,j,ee)=>{const me=j==="float"?"vec2":"vec4",fe=ee.match(/color/)?"color":me;return C[ee]?B==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
attribute ${U} ${me} a_${ee};
varying ${U} ${j} ${ee};
#else
uniform ${U} ${j} u_${ee};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = a_${ee};
#else
    ${U} ${j} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = unpack_mix_${fe}(a_${ee}, u_${ee}_t);
#else
    ${U} ${j} ${ee} = u_${ee};
#endif
`:B==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
attribute ${U} ${me} a_${ee};
#else
uniform ${U} ${j} u_${ee};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${U} ${j} ${ee} = a_${ee};
#else
    ${U} ${j} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${U} ${j} ${ee} = unpack_mix_${fe}(a_${ee}, u_${ee}_t);
#else
    ${U} ${j} ${ee} = u_${ee};
#endif
`}),staticAttributes:g,staticUniforms:O}}class Aa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,d,g,v,A,O,C,L,B){this.context=o;let U=this.boundPaintVertexBuffers.length!==v.length;for(let j=0;!U&&j<v.length;j++)this.boundPaintVertexBuffers[j]!==v[j]&&(U=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==g||U||this.boundIndexBuffer!==A||this.boundVertexOffset!==O||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==L||this.boundDynamicVertexBuffer3!==B?this.freshBind(d,g,v,A,O,C,L,B):(o.bindVertexArray.set(this.vao),C&&C.bind(),A&&A.dynamicDraw&&A.bind(),L&&L.bind(),B&&B.bind())}freshBind(o,d,g,v,A,O,C,L){const B=o.numAttributes,U=this.context,j=U.gl;this.vao&&this.destroy(),this.vao=U.createVertexArray(),U.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=v,this.boundVertexOffset=A,this.boundDynamicVertexBuffer=O,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=L,d.enableAttributes(j,o);for(const ee of g)ee.enableAttributes(j,o);O&&O.enableAttributes(j,o),C&&C.enableAttributes(j,o),L&&L.enableAttributes(j,o),d.bind(),d.setVertexAttribPointers(j,o,A);for(const ee of g)ee.bind(),ee.setVertexAttribPointers(j,o,A);O&&(O.bind(),O.setVertexAttribPointers(j,o,A)),v&&v.bind(),C&&(C.bind(),C.setVertexAttribPointers(j,o,A)),L&&(L.bind(),L.setVertexAttribPointers(j,o,A)),U.currentNumAttributes=B}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function er(x){const o=[];for(let d=0;d<x.length;d++){if(x[d]===null)continue;const g=x[d].split(" ");o.push(g.pop())}return o}class el{constructor(o,d,g,v,A,O){const C=o.gl;this.program=C.createProgram();const L=er(d.staticAttributes),B=g?g.getBinderAttributes():[],U=L.concat(B),j=$n.prelude.staticUniforms?er($n.prelude.staticUniforms):[],ee=d.staticUniforms?er(d.staticUniforms):[],me=g?g.getBinderUniforms():[],fe=j.concat(ee).concat(me),be=[];for(const at of fe)be.indexOf(at)<0&&be.push(at);const he=g?g.defines():[];A&&he.push("#define OVERDRAW_INSPECTOR;"),O&&he.push("#define TERRAIN3D;");const Pe=he.concat($n.prelude.fragmentSource,d.fragmentSource).join(`
`),Je=he.concat($n.prelude.vertexSource,d.vertexSource).join(`
`),Ee=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(Ee,Pe),C.compileShader(Ee),!C.getShaderParameter(Ee,C.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${C.getShaderInfoLog(Ee)}`);C.attachShader(this.program,Ee);const Fe=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(Fe,Je),C.compileShader(Fe),!C.getShaderParameter(Fe,C.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${C.getShaderInfoLog(Fe)}`);C.attachShader(this.program,Fe),this.attributes={};const it={};this.numAttributes=U.length;for(let at=0;at<this.numAttributes;at++)U[at]&&(C.bindAttribLocation(this.program,at,U[at]),this.attributes[U[at]]=at);if(C.linkProgram(this.program),!C.getProgramParameter(this.program,C.LINK_STATUS))throw new Error(`Program failed to link: ${C.getProgramInfoLog(this.program)}`);C.deleteShader(Fe),C.deleteShader(Ee);for(let at=0;at<be.length;at++){const xt=be[at];if(xt&&!it[xt]){const Vt=C.getUniformLocation(this.program,xt);Vt&&(it[xt]=Vt)}}this.fixedUniforms=v(o,it),this.terrainUniforms=((at,xt)=>({u_depth:new r.aL(at,xt.u_depth),u_terrain:new r.aL(at,xt.u_terrain),u_terrain_dim:new r.aM(at,xt.u_terrain_dim),u_terrain_matrix:new r.aN(at,xt.u_terrain_matrix),u_terrain_unpack:new r.aO(at,xt.u_terrain_unpack),u_terrain_exaggeration:new r.aM(at,xt.u_terrain_exaggeration)}))(o,it),this.binderUniforms=g?g.getUniforms(o,it):[]}draw(o,d,g,v,A,O,C,L,B,U,j,ee,me,fe,be,he,Pe,Je){const Ee=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(g),o.setStencilMode(v),o.setColorMode(A),o.setCullFace(O),L){o.activeTexture.set(Ee.TEXTURE2),Ee.bindTexture(Ee.TEXTURE_2D,L.depthTexture),o.activeTexture.set(Ee.TEXTURE3),Ee.bindTexture(Ee.TEXTURE_2D,L.texture);for(const it in this.terrainUniforms)this.terrainUniforms[it].set(L[it])}for(const it in this.fixedUniforms)this.fixedUniforms[it].set(C[it]);be&&be.setUniforms(o,this.binderUniforms,me,{zoom:fe});let Fe=0;switch(d){case Ee.LINES:Fe=2;break;case Ee.TRIANGLES:Fe=3;break;case Ee.LINE_STRIP:Fe=1}for(const it of ee.get()){const at=it.vaos||(it.vaos={});(at[B]||(at[B]=new Aa)).bind(o,this,U,be?be.getPaintVertexBuffers():[],j,it.vertexOffset,he,Pe,Je),Ee.drawElements(d,it.primitiveLength*Fe,Ee.UNSIGNED_SHORT,it.primitiveOffset*Fe*2)}}}function Ms(x,o,d){const g=1/Ae(d,1,o.transform.tileZoom),v=Math.pow(2,d.tileID.overscaledZ),A=d.tileSize*Math.pow(2,o.transform.tileZoom)/v,O=A*(d.tileID.canonical.x+d.tileID.wrap*v),C=A*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[g,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[O>>16,C>>16],u_pixel_coord_lower:[65535&O,65535&C]}}const Sc=(x,o,d,g)=>{const v=o.style.light,A=v.properties.get("position"),O=[A.x,A.y,A.z],C=function(){var B=new r.A(9);return r.A!=Float32Array&&(B[1]=0,B[2]=0,B[3]=0,B[5]=0,B[6]=0,B[7]=0),B[0]=1,B[4]=1,B[8]=1,B}();v.properties.get("anchor")==="viewport"&&function(B,U){var j=Math.sin(U),ee=Math.cos(U);B[0]=ee,B[1]=j,B[2]=0,B[3]=-j,B[4]=ee,B[5]=0,B[6]=0,B[7]=0,B[8]=1}(C,-o.transform.angle),function(B,U,j){var ee=U[0],me=U[1],fe=U[2];B[0]=ee*j[0]+me*j[3]+fe*j[6],B[1]=ee*j[1]+me*j[4]+fe*j[7],B[2]=ee*j[2]+me*j[5]+fe*j[8]}(O,O,C);const L=v.properties.get("color");return{u_matrix:x,u_lightpos:O,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[L.r,L.g,L.b],u_vertical_gradient:+d,u_opacity:g}},ja=(x,o,d,g,v,A,O)=>r.e(Sc(x,o,d,g),Ms(A,o,O),{u_height_factor:-Math.pow(2,v.overscaledZ)/O.tileSize/8}),tl=x=>({u_matrix:x}),I=(x,o,d,g)=>r.e(tl(x),Ms(d,o,g)),N=(x,o)=>({u_matrix:x,u_world:o}),te=(x,o,d,g,v)=>r.e(I(x,o,d,g),{u_world:v}),xe=(x,o,d,g)=>{const v=x.transform;let A,O;if(g.paint.get("circle-pitch-alignment")==="map"){const C=Ae(d,1,v.zoom);A=!0,O=[C,C]}else A=!1,O=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_matrix:x.translatePosMatrix(o.posMatrix,d,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+A,u_device_pixel_ratio:x.pixelRatio,u_extrude_scale:O}},De=(x,o,d)=>{const g=Ae(d,1,o.zoom),v=Math.pow(2,o.zoom-d.tileID.overscaledZ),A=d.tileID.overscaleFactor();return{u_matrix:x,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[o.pixelsToGLUnits[0]/(g*v),o.pixelsToGLUnits[1]/(g*v)],u_overscale_factor:A}},Re=(x,o,d=1)=>({u_matrix:x,u_color:o,u_overlay:0,u_overlay_scale:d}),Ke=x=>({u_matrix:x}),Bt=(x,o,d,g)=>({u_matrix:x,u_extrude_scale:Ae(o,1,d),u_intensity:g});function Kt(x,o){const d=Math.pow(2,o.canonical.z),g=o.canonical.y;return[new r.U(0,g/d).toLngLat().lat,new r.U(0,(g+1)/d).toLngLat().lat]}const si=(x,o,d,g)=>{const v=x.transform;return{u_matrix:Yi(x,o,d,g),u_ratio:1/Ae(o,1,v.zoom),u_device_pixel_ratio:x.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},oi=(x,o,d,g,v)=>r.e(si(x,o,d,v),{u_image:0,u_image_height:g}),Xt=(x,o,d,g,v)=>{const A=x.transform,O=tr(o,A);return{u_matrix:Yi(x,o,d,v),u_texsize:o.imageAtlasTexture.size,u_ratio:1/Ae(o,1,A.zoom),u_device_pixel_ratio:x.pixelRatio,u_image:0,u_scale:[O,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]]}},qi=(x,o,d,g,v,A)=>{const O=x.lineAtlas,C=tr(o,x.transform),L=d.layout.get("line-cap")==="round",B=O.getDash(g.from,L),U=O.getDash(g.to,L),j=B.width*v.fromScale,ee=U.width*v.toScale;return r.e(si(x,o,d,A),{u_patternscale_a:[C/j,-B.height/2],u_patternscale_b:[C/ee,-U.height/2],u_sdfgamma:O.width/(256*Math.min(j,ee)*x.pixelRatio)/2,u_image:0,u_tex_y_a:B.y,u_tex_y_b:U.y,u_mix:v.t})};function tr(x,o){return 1/Ae(x,1,o.tileZoom)}function Yi(x,o,d,g){return x.translatePosMatrix(g?g.posMatrix:o.tileID.posMatrix,o,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const br=(x,o,d,g,v)=>{return{u_matrix:x,u_tl_parent:o,u_scale_parent:d,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(O=v.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(A=v.paint.get("raster-contrast"),A>0?1/(1-A):1+A),u_spin_weights:Tt(v.paint.get("raster-hue-rotate"))};var A,O};function Tt(x){x*=Math.PI/180;const o=Math.sin(x),d=Math.cos(x);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const xi=(x,o,d,g,v,A,O,C,L,B)=>{const U=v.transform;return{u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:U.cameraToCenterDistance,u_pitch:U.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:U.width/U.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:O,u_coord_matrix:C,u_is_text:+L,u_pitch_with_map:+g,u_texsize:B,u_texture:0}},wn=(x,o,d,g,v,A,O,C,L,B,U)=>{const j=v.transform;return r.e(xi(x,o,d,g,v,A,O,C,L,B),{u_gamma_scale:g?Math.cos(j._pitch)*j.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:+U})},ir=(x,o,d,g,v,A,O,C,L,B)=>r.e(wn(x,o,d,g,v,A,O,C,!0,L,!0),{u_texsize_icon:B,u_texture_icon:1}),ur=(x,o,d)=>({u_matrix:x,u_opacity:o,u_color:d}),cs=(x,o,d,g,v,A)=>r.e(function(O,C,L,B){const U=L.imageManager.getPattern(O.from.toString()),j=L.imageManager.getPattern(O.to.toString()),{width:ee,height:me}=L.imageManager.getPixelSize(),fe=Math.pow(2,B.tileID.overscaledZ),be=B.tileSize*Math.pow(2,L.transform.tileZoom)/fe,he=be*(B.tileID.canonical.x+B.tileID.wrap*fe),Pe=be*B.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:U.tl,u_pattern_br_a:U.br,u_pattern_tl_b:j.tl,u_pattern_br_b:j.br,u_texsize:[ee,me],u_mix:C.t,u_pattern_size_a:U.displaySize,u_pattern_size_b:j.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/Ae(B,1,L.transform.tileZoom),u_pixel_coord_upper:[he>>16,Pe>>16],u_pixel_coord_lower:[65535&he,65535&Pe]}}(g,A,d,v),{u_matrix:x,u_opacity:o}),Ul={fillExtrusion:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_lightpos:new r.aP(x,o.u_lightpos),u_lightintensity:new r.aM(x,o.u_lightintensity),u_lightcolor:new r.aP(x,o.u_lightcolor),u_vertical_gradient:new r.aM(x,o.u_vertical_gradient),u_opacity:new r.aM(x,o.u_opacity)}),fillExtrusionPattern:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_lightpos:new r.aP(x,o.u_lightpos),u_lightintensity:new r.aM(x,o.u_lightintensity),u_lightcolor:new r.aP(x,o.u_lightcolor),u_vertical_gradient:new r.aM(x,o.u_vertical_gradient),u_height_factor:new r.aM(x,o.u_height_factor),u_image:new r.aL(x,o.u_image),u_texsize:new r.aQ(x,o.u_texsize),u_pixel_coord_upper:new r.aQ(x,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.aQ(x,o.u_pixel_coord_lower),u_scale:new r.aP(x,o.u_scale),u_fade:new r.aM(x,o.u_fade),u_opacity:new r.aM(x,o.u_opacity)}),fill:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix)}),fillPattern:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_image:new r.aL(x,o.u_image),u_texsize:new r.aQ(x,o.u_texsize),u_pixel_coord_upper:new r.aQ(x,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.aQ(x,o.u_pixel_coord_lower),u_scale:new r.aP(x,o.u_scale),u_fade:new r.aM(x,o.u_fade)}),fillOutline:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_world:new r.aQ(x,o.u_world)}),fillOutlinePattern:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_world:new r.aQ(x,o.u_world),u_image:new r.aL(x,o.u_image),u_texsize:new r.aQ(x,o.u_texsize),u_pixel_coord_upper:new r.aQ(x,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.aQ(x,o.u_pixel_coord_lower),u_scale:new r.aP(x,o.u_scale),u_fade:new r.aM(x,o.u_fade)}),circle:(x,o)=>({u_camera_to_center_distance:new r.aM(x,o.u_camera_to_center_distance),u_scale_with_map:new r.aL(x,o.u_scale_with_map),u_pitch_with_map:new r.aL(x,o.u_pitch_with_map),u_extrude_scale:new r.aQ(x,o.u_extrude_scale),u_device_pixel_ratio:new r.aM(x,o.u_device_pixel_ratio),u_matrix:new r.aN(x,o.u_matrix)}),collisionBox:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_camera_to_center_distance:new r.aM(x,o.u_camera_to_center_distance),u_pixels_to_tile_units:new r.aM(x,o.u_pixels_to_tile_units),u_extrude_scale:new r.aQ(x,o.u_extrude_scale),u_overscale_factor:new r.aM(x,o.u_overscale_factor)}),collisionCircle:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_inv_matrix:new r.aN(x,o.u_inv_matrix),u_camera_to_center_distance:new r.aM(x,o.u_camera_to_center_distance),u_viewport_size:new r.aQ(x,o.u_viewport_size)}),debug:(x,o)=>({u_color:new r.aR(x,o.u_color),u_matrix:new r.aN(x,o.u_matrix),u_overlay:new r.aL(x,o.u_overlay),u_overlay_scale:new r.aM(x,o.u_overlay_scale)}),clippingMask:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix)}),heatmap:(x,o)=>({u_extrude_scale:new r.aM(x,o.u_extrude_scale),u_intensity:new r.aM(x,o.u_intensity),u_matrix:new r.aN(x,o.u_matrix)}),heatmapTexture:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_world:new r.aQ(x,o.u_world),u_image:new r.aL(x,o.u_image),u_color_ramp:new r.aL(x,o.u_color_ramp),u_opacity:new r.aM(x,o.u_opacity)}),hillshade:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_image:new r.aL(x,o.u_image),u_latrange:new r.aQ(x,o.u_latrange),u_light:new r.aQ(x,o.u_light),u_shadow:new r.aR(x,o.u_shadow),u_highlight:new r.aR(x,o.u_highlight),u_accent:new r.aR(x,o.u_accent)}),hillshadePrepare:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_image:new r.aL(x,o.u_image),u_dimension:new r.aQ(x,o.u_dimension),u_zoom:new r.aM(x,o.u_zoom),u_unpack:new r.aO(x,o.u_unpack)}),line:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_ratio:new r.aM(x,o.u_ratio),u_device_pixel_ratio:new r.aM(x,o.u_device_pixel_ratio),u_units_to_pixels:new r.aQ(x,o.u_units_to_pixels)}),lineGradient:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_ratio:new r.aM(x,o.u_ratio),u_device_pixel_ratio:new r.aM(x,o.u_device_pixel_ratio),u_units_to_pixels:new r.aQ(x,o.u_units_to_pixels),u_image:new r.aL(x,o.u_image),u_image_height:new r.aM(x,o.u_image_height)}),linePattern:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_texsize:new r.aQ(x,o.u_texsize),u_ratio:new r.aM(x,o.u_ratio),u_device_pixel_ratio:new r.aM(x,o.u_device_pixel_ratio),u_image:new r.aL(x,o.u_image),u_units_to_pixels:new r.aQ(x,o.u_units_to_pixels),u_scale:new r.aP(x,o.u_scale),u_fade:new r.aM(x,o.u_fade)}),lineSDF:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_ratio:new r.aM(x,o.u_ratio),u_device_pixel_ratio:new r.aM(x,o.u_device_pixel_ratio),u_units_to_pixels:new r.aQ(x,o.u_units_to_pixels),u_patternscale_a:new r.aQ(x,o.u_patternscale_a),u_patternscale_b:new r.aQ(x,o.u_patternscale_b),u_sdfgamma:new r.aM(x,o.u_sdfgamma),u_image:new r.aL(x,o.u_image),u_tex_y_a:new r.aM(x,o.u_tex_y_a),u_tex_y_b:new r.aM(x,o.u_tex_y_b),u_mix:new r.aM(x,o.u_mix)}),raster:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_tl_parent:new r.aQ(x,o.u_tl_parent),u_scale_parent:new r.aM(x,o.u_scale_parent),u_buffer_scale:new r.aM(x,o.u_buffer_scale),u_fade_t:new r.aM(x,o.u_fade_t),u_opacity:new r.aM(x,o.u_opacity),u_image0:new r.aL(x,o.u_image0),u_image1:new r.aL(x,o.u_image1),u_brightness_low:new r.aM(x,o.u_brightness_low),u_brightness_high:new r.aM(x,o.u_brightness_high),u_saturation_factor:new r.aM(x,o.u_saturation_factor),u_contrast_factor:new r.aM(x,o.u_contrast_factor),u_spin_weights:new r.aP(x,o.u_spin_weights)}),symbolIcon:(x,o)=>({u_is_size_zoom_constant:new r.aL(x,o.u_is_size_zoom_constant),u_is_size_feature_constant:new r.aL(x,o.u_is_size_feature_constant),u_size_t:new r.aM(x,o.u_size_t),u_size:new r.aM(x,o.u_size),u_camera_to_center_distance:new r.aM(x,o.u_camera_to_center_distance),u_pitch:new r.aM(x,o.u_pitch),u_rotate_symbol:new r.aL(x,o.u_rotate_symbol),u_aspect_ratio:new r.aM(x,o.u_aspect_ratio),u_fade_change:new r.aM(x,o.u_fade_change),u_matrix:new r.aN(x,o.u_matrix),u_label_plane_matrix:new r.aN(x,o.u_label_plane_matrix),u_coord_matrix:new r.aN(x,o.u_coord_matrix),u_is_text:new r.aL(x,o.u_is_text),u_pitch_with_map:new r.aL(x,o.u_pitch_with_map),u_texsize:new r.aQ(x,o.u_texsize),u_texture:new r.aL(x,o.u_texture)}),symbolSDF:(x,o)=>({u_is_size_zoom_constant:new r.aL(x,o.u_is_size_zoom_constant),u_is_size_feature_constant:new r.aL(x,o.u_is_size_feature_constant),u_size_t:new r.aM(x,o.u_size_t),u_size:new r.aM(x,o.u_size),u_camera_to_center_distance:new r.aM(x,o.u_camera_to_center_distance),u_pitch:new r.aM(x,o.u_pitch),u_rotate_symbol:new r.aL(x,o.u_rotate_symbol),u_aspect_ratio:new r.aM(x,o.u_aspect_ratio),u_fade_change:new r.aM(x,o.u_fade_change),u_matrix:new r.aN(x,o.u_matrix),u_label_plane_matrix:new r.aN(x,o.u_label_plane_matrix),u_coord_matrix:new r.aN(x,o.u_coord_matrix),u_is_text:new r.aL(x,o.u_is_text),u_pitch_with_map:new r.aL(x,o.u_pitch_with_map),u_texsize:new r.aQ(x,o.u_texsize),u_texture:new r.aL(x,o.u_texture),u_gamma_scale:new r.aM(x,o.u_gamma_scale),u_device_pixel_ratio:new r.aM(x,o.u_device_pixel_ratio),u_is_halo:new r.aL(x,o.u_is_halo)}),symbolTextAndIcon:(x,o)=>({u_is_size_zoom_constant:new r.aL(x,o.u_is_size_zoom_constant),u_is_size_feature_constant:new r.aL(x,o.u_is_size_feature_constant),u_size_t:new r.aM(x,o.u_size_t),u_size:new r.aM(x,o.u_size),u_camera_to_center_distance:new r.aM(x,o.u_camera_to_center_distance),u_pitch:new r.aM(x,o.u_pitch),u_rotate_symbol:new r.aL(x,o.u_rotate_symbol),u_aspect_ratio:new r.aM(x,o.u_aspect_ratio),u_fade_change:new r.aM(x,o.u_fade_change),u_matrix:new r.aN(x,o.u_matrix),u_label_plane_matrix:new r.aN(x,o.u_label_plane_matrix),u_coord_matrix:new r.aN(x,o.u_coord_matrix),u_is_text:new r.aL(x,o.u_is_text),u_pitch_with_map:new r.aL(x,o.u_pitch_with_map),u_texsize:new r.aQ(x,o.u_texsize),u_texsize_icon:new r.aQ(x,o.u_texsize_icon),u_texture:new r.aL(x,o.u_texture),u_texture_icon:new r.aL(x,o.u_texture_icon),u_gamma_scale:new r.aM(x,o.u_gamma_scale),u_device_pixel_ratio:new r.aM(x,o.u_device_pixel_ratio),u_is_halo:new r.aL(x,o.u_is_halo)}),background:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_opacity:new r.aM(x,o.u_opacity),u_color:new r.aR(x,o.u_color)}),backgroundPattern:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_opacity:new r.aM(x,o.u_opacity),u_image:new r.aL(x,o.u_image),u_pattern_tl_a:new r.aQ(x,o.u_pattern_tl_a),u_pattern_br_a:new r.aQ(x,o.u_pattern_br_a),u_pattern_tl_b:new r.aQ(x,o.u_pattern_tl_b),u_pattern_br_b:new r.aQ(x,o.u_pattern_br_b),u_texsize:new r.aQ(x,o.u_texsize),u_mix:new r.aM(x,o.u_mix),u_pattern_size_a:new r.aQ(x,o.u_pattern_size_a),u_pattern_size_b:new r.aQ(x,o.u_pattern_size_b),u_scale_a:new r.aM(x,o.u_scale_a),u_scale_b:new r.aM(x,o.u_scale_b),u_pixel_coord_upper:new r.aQ(x,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.aQ(x,o.u_pixel_coord_lower),u_tile_units_to_pixels:new r.aM(x,o.u_tile_units_to_pixels)}),terrain:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_texture:new r.aL(x,o.u_texture),u_ele_delta:new r.aM(x,o.u_ele_delta)}),terrainDepth:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_ele_delta:new r.aM(x,o.u_ele_delta)}),terrainCoords:(x,o)=>({u_matrix:new r.aN(x,o.u_matrix),u_texture:new r.aL(x,o.u_texture),u_terrain_coords_id:new r.aM(x,o.u_terrain_coords_id),u_ele_delta:new r.aM(x,o.u_ele_delta)})};class Dn{constructor(o,d,g){this.context=o;const v=o.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Po={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class jl{constructor(o,d,g,v){this.length=d.length,this.attributes=g,this.itemSize=d.bytesPerElement,this.dynamicDraw=v,this.context=o;const A=o.gl;this.buffer=A.createBuffer(),o.bindVertexBuffer.set(this.buffer),A.bufferData(A.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let g=0;g<this.attributes.length;g++){const v=d.attributes[this.attributes[g].name];v!==void 0&&o.enableVertexAttribArray(v)}}setVertexAttribPointers(o,d,g){for(let v=0;v<this.attributes.length;v++){const A=this.attributes[v],O=d.attributes[A.name];O!==void 0&&o.vertexAttribPointer(O,A.components,o[Po[A.type]],!1,this.itemSize,A.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const us=new WeakMap;function Ea(x){var o;if(us.has(x))return us.get(x);{const d=(o=x.getParameter(x.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return us.set(x,d),d}}class on{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class il extends on{getDefault(){return r.aT.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class is extends on{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class hs extends on{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Gl extends on{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Hl extends on{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Kl extends on{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Ic extends on{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class ql extends on{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class nl extends on{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class Zl extends on{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class kc extends on{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class Wl extends on{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class rl extends on{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class Yl extends on{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class ho extends on{getDefault(){return r.aT.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class ca extends on{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class xu extends on{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class wu extends on{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class zh extends on{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Au extends on{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Jl extends on{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Xl extends on{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class sl extends on{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Oc extends on{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ta extends on{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class fo extends on{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Eu extends on{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Tu extends on{getDefault(){return null}set(o){var d;if(o===this.current&&!this.dirty)return;const g=this.gl;Ea(g)?g.bindVertexArray(o):(d=g.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class al extends on{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Js extends on{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Ql extends on{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class ua extends on{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class Ga extends ua{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class No extends ua{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Cc extends ua{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class yn{constructor(o,d,g,v,A){this.context=o,this.width=d,this.height=g;const O=o.gl,C=this.framebuffer=O.createFramebuffer();if(this.colorAttachment=new Ga(o,C),v)this.depthAttachment=A?new Cc(o,C):new No(o,C);else if(A)throw new Error("Stencil cannot be setted without depth");if(O.checkFramebufferStatus(O.FRAMEBUFFER)!==O.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,d=this.colorAttachment.get();if(d&&o.deleteTexture(d),this.depthAttachment){const g=this.depthAttachment.get();g&&o.deleteRenderbuffer(g)}o.deleteFramebuffer(this.framebuffer)}}class nr{constructor(o,d,g){this.blendFunction=o,this.blendColor=d,this.mask=g}}nr.Replace=[1,0],nr.disabled=new nr(nr.Replace,r.aT.transparent,[!1,!1,!1,!1]),nr.unblended=new nr(nr.Replace,r.aT.transparent,[!0,!0,!0,!0]),nr.alphaBlended=new nr([1,771],r.aT.transparent,[!0,!0,!0,!0]);class Bh{constructor(o){var d,g;if(this.gl=o,this.clearColor=new il(this),this.clearDepth=new is(this),this.clearStencil=new hs(this),this.colorMask=new Gl(this),this.depthMask=new Hl(this),this.stencilMask=new Kl(this),this.stencilFunc=new Ic(this),this.stencilOp=new ql(this),this.stencilTest=new nl(this),this.depthRange=new Zl(this),this.depthTest=new kc(this),this.depthFunc=new Wl(this),this.blend=new rl(this),this.blendFunc=new Yl(this),this.blendColor=new ho(this),this.blendEquation=new ca(this),this.cullFace=new xu(this),this.cullFaceSide=new wu(this),this.frontFace=new zh(this),this.program=new Au(this),this.activeTexture=new Jl(this),this.viewport=new Xl(this),this.bindFramebuffer=new sl(this),this.bindRenderbuffer=new Oc(this),this.bindTexture=new Ta(this),this.bindVertexBuffer=new fo(this),this.bindElementBuffer=new Eu(this),this.bindVertexArray=new Tu(this),this.pixelStoreUnpack=new al(this),this.pixelStoreUnpackPremultiplyAlpha=new Js(this),this.pixelStoreUnpackFlipY=new Ql(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),Ea(o)){this.HALF_FLOAT=o.HALF_FLOAT;const v=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=o.RGBA16F)!==null&&d!==void 0?d:v==null?void 0:v.RGBA16F_EXT,this.RGB16F=(g=o.RGB16F)!==null&&g!==void 0?g:v==null?void 0:v.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const v=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=v==null?void 0:v.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d){return new Dn(this,o,d)}createVertexBuffer(o,d,g){return new jl(this,o,d,g)}createRenderbuffer(o,d,g){const v=this.gl,A=v.createRenderbuffer();return this.bindRenderbuffer.set(A),v.renderbufferStorage(v.RENDERBUFFER,o,d,g),this.bindRenderbuffer.set(null),A}createFramebuffer(o,d,g,v){return new yn(this,o,d,g,v)}clear({color:o,depth:d,stencil:g}){const v=this.gl;let A=0;o&&(A|=v.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(A|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),g!==void 0&&(A|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),v.clear(A)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){r.aG(o.blendFunction,nr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return Ea(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var d;return Ea(this.gl)?this.gl.deleteVertexArray(o):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class cn{constructor(o,d,g){this.func=o,this.mask=d,this.range=g}}cn.ReadOnly=!1,cn.ReadWrite=!0,cn.disabled=new cn(519,cn.ReadOnly,[0,1]);const Ha=7680;class Kn{constructor(o,d,g,v,A,O){this.test=o,this.ref=d,this.mask=g,this.fail=v,this.depthFail=A,this.pass=O}}Kn.disabled=new Kn({func:519,mask:0},0,0,Ha,Ha,Ha);class An{constructor(o,d,g){this.enable=o,this.mode=d,this.frontFace=g}}let bs;function Ka(x,o,d,g,v,A,O){const C=x.context,L=C.gl,B=x.useProgram("collisionBox"),U=[];let j=0,ee=0;for(let Ee=0;Ee<g.length;Ee++){const Fe=g[Ee],it=o.getTile(Fe),at=it.getBucket(d);if(!at)continue;let xt=Fe.posMatrix;v[0]===0&&v[1]===0||(xt=x.translatePosMatrix(Fe.posMatrix,it,v,A));const Vt=O?at.textCollisionBox:at.iconCollisionBox,kt=at.collisionCircleArray;if(kt.length>0){const qt=r.Z(),vi=xt;r.aU(qt,at.placementInvProjMatrix,x.transform.glCoordMatrix),r.aU(qt,qt,at.placementViewportMatrix),U.push({circleArray:kt,circleOffset:ee,transform:vi,invTransform:qt,coord:Fe}),j+=kt.length/4,ee=j}Vt&&B.draw(C,L.LINES,cn.disabled,Kn.disabled,x.colorModeForRenderPass(),An.disabled,De(xt,x.transform,it),x.style.map.terrain&&x.style.map.terrain.getTerrainData(Fe),d.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Vt.segments,null,x.transform.zoom,null,null,Vt.collisionVertexBuffer)}if(!O||!U.length)return;const me=x.useProgram("collisionCircle"),fe=new r.aV;fe.resize(4*j),fe._trim();let be=0;for(const Ee of U)for(let Fe=0;Fe<Ee.circleArray.length/4;Fe++){const it=4*Fe,at=Ee.circleArray[it+0],xt=Ee.circleArray[it+1],Vt=Ee.circleArray[it+2],kt=Ee.circleArray[it+3];fe.emplace(be++,at,xt,Vt,kt,0),fe.emplace(be++,at,xt,Vt,kt,1),fe.emplace(be++,at,xt,Vt,kt,2),fe.emplace(be++,at,xt,Vt,kt,3)}(!bs||bs.length<2*j)&&(bs=function(Ee){const Fe=2*Ee,it=new r.aX;it.resize(Fe),it._trim();for(let at=0;at<Fe;at++){const xt=6*at;it.uint16[xt+0]=4*at+0,it.uint16[xt+1]=4*at+1,it.uint16[xt+2]=4*at+2,it.uint16[xt+3]=4*at+2,it.uint16[xt+4]=4*at+3,it.uint16[xt+5]=4*at+0}return it}(j));const he=C.createIndexBuffer(bs,!0),Pe=C.createVertexBuffer(fe,r.aW.members,!0);for(const Ee of U){const Fe={u_matrix:Ee.transform,u_inv_matrix:Ee.invTransform,u_camera_to_center_distance:(Je=x.transform).cameraToCenterDistance,u_viewport_size:[Je.width,Je.height]};me.draw(C,L.TRIANGLES,cn.disabled,Kn.disabled,x.colorModeForRenderPass(),An.disabled,Fe,x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ee.coord),d.id,Pe,he,r.S.simpleSegment(0,2*Ee.circleOffset,Ee.circleArray.length,Ee.circleArray.length/2),null,x.transform.zoom,null,null,null)}var Je;Pe.destroy(),he.destroy()}An.disabled=new An(!1,1029,2305),An.backCCW=new An(!0,1029,2305);const zo=r.ao(new Float32Array(16));function Xs(x,o,d,g,v,A){const{horizontalAlign:O,verticalAlign:C}=r.au(x);return new r.P((-(O-.5)*o/v+g[0])*A,(-(C-.5)*d/v+g[1])*A)}function $l(x,o,d,g,v,A,O,C,L,B,U){const j=x.text.placedSymbolArray,ee=x.text.dynamicLayoutVertexArray,me=x.icon.dynamicLayoutVertexArray,fe={};ee.clear();for(let be=0;be<j.length;be++){const he=j.get(be),Pe=he.hidden||!he.crossTileID||x.allowVerticalPlacement&&!he.placedOrientation?null:g[he.crossTileID];if(Pe){const Je=new r.P(he.anchorX,he.anchorY),Ee=Qe(Je,d?O:A,U),Fe=Ki(v.cameraToCenterDistance,Ee.signedDistanceFromCamera);let it=r.aj(x.textSizeData,L,he)*Fe/r.ap;d&&(it*=x.tilePixelRatio/C);const{width:at,height:xt,anchor:Vt,textOffset:kt,textBoxScale:qt}=Pe,vi=Xs(Vt,at,xt,kt,qt,it),un=d?Qe(Je.add(vi),A,U).point:Ee.point.add(o?vi.rotate(-v.angle):vi),ei=x.allowVerticalPlacement&&he.placedOrientation===r.ai.vertical?Math.PI/2:0;for(let Fi=0;Fi<he.numGlyphs;Fi++)r.ak(ee,un,ei);B&&he.associatedIconIndex>=0&&(fe[he.associatedIconIndex]={shiftedAnchor:un,angle:ei})}else J(he.numGlyphs,ee)}if(B){me.clear();const be=x.icon.placedSymbolArray;for(let he=0;he<be.length;he++){const Pe=be.get(he);if(Pe.hidden)J(Pe.numGlyphs,me);else{const Je=fe[he];if(Je)for(let Ee=0;Ee<Pe.numGlyphs;Ee++)r.ak(me,Je.shiftedAnchor,Je.angle);else J(Pe.numGlyphs,me)}}x.icon.dynamicLayoutVertexBuffer.updateData(me)}x.text.dynamicLayoutVertexBuffer.updateData(ee)}function Bo(x,o,d){return d.iconsInText&&o?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function qa(x,o,d,g,v,A,O,C,L,B,U,j){const ee=x.context,me=ee.gl,fe=x.transform,be=C==="map",he=L==="map",Pe=C!=="viewport"&&d.layout.get("symbol-placement")!=="point",Je=be&&!he&&!Pe,Ee=!d.layout.get("symbol-sort-key").isConstant();let Fe=!1;const it=x.depthModeForSublayer(0,cn.ReadOnly),at=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),xt=[];for(const Vt of g){const kt=o.getTile(Vt),qt=kt.getBucket(d);if(!qt)continue;const vi=v?qt.text:qt.icon;if(!vi||!vi.segments.get().length||!vi.hasVisibleVertices)continue;const un=vi.programConfigurations.get(d.id),ei=v||qt.sdfIcons,Fi=v?qt.textSizeData:qt.iconSizeData,wi=he||fe.pitch!==0,Rn=x.useProgram(Bo(ei,v,qt),un),ln=r.ah(Fi,fe.zoom),rn=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Vt);let hn,Ir,Xn,rs,Hr=[0,0],Rr=null;if(v)Ir=kt.glyphAtlasTexture,Xn=me.LINEAR,hn=kt.glyphAtlasTexture.size,qt.iconsInText&&(Hr=kt.imageAtlasTexture.size,Rr=kt.imageAtlasTexture,rs=wi||x.options.rotating||x.options.zooming||Fi.kind==="composite"||Fi.kind==="camera"?me.LINEAR:me.NEAREST);else{const kr=d.layout.get("icon-size").constantOr(0)!==1||qt.iconsNeedLinear;Ir=kt.imageAtlasTexture,Xn=ei||x.options.rotating||x.options.zooming||kr||wi?me.LINEAR:me.NEAREST,hn=kt.imageAtlasTexture.size}const ta=Ae(kt,1,x.transform.zoom),ar=Nt(Vt.posMatrix,he,be,x.transform,ta),Ja=Qi(Vt.posMatrix,he,be,x.transform,ta),Xa=at&&qt.hasTextData(),Ko=d.layout.get("icon-text-fit")!=="none"&&Xa&&qt.hasIconData();if(Pe){const kr=x.style.map.terrain?(Ls,Or)=>x.style.map.terrain.getElevation(Vt,Ls,Or):null,Kr=d.layout.get("text-rotation-alignment")==="map";Lt(qt,Vt.posMatrix,x,v,ar,Ja,he,B,Kr,kr)}const gl=x.translatePosMatrix(Vt.posMatrix,kt,A,O),hc=Pe||v&&at||Ko?zo:ar,ms=x.translatePosMatrix(Ja,kt,A,O,!0),ss=ei&&d.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let As;As=ei?qt.iconsInText?ir(Fi.kind,ln,Je,he,x,gl,hc,ms,hn,Hr):wn(Fi.kind,ln,Je,he,x,gl,hc,ms,v,hn,!0):xi(Fi.kind,ln,Je,he,x,gl,hc,ms,v,hn);const _l={program:Rn,buffers:vi,uniformValues:As,atlasTexture:Ir,atlasTextureIcon:Rr,atlasInterpolation:Xn,atlasInterpolationIcon:rs,isSDF:ei,hasHalo:ss};if(Ee&&qt.canOverlap){Fe=!0;const kr=vi.segments.get();for(const Kr of kr)xt.push({segments:new r.S([Kr]),sortKey:Kr.sortKey,state:_l,terrainData:rn})}else xt.push({segments:vi.segments,sortKey:0,state:_l,terrainData:rn})}Fe&&xt.sort((Vt,kt)=>Vt.sortKey-kt.sortKey);for(const Vt of xt){const kt=Vt.state;if(ee.activeTexture.set(me.TEXTURE0),kt.atlasTexture.bind(kt.atlasInterpolation,me.CLAMP_TO_EDGE),kt.atlasTextureIcon&&(ee.activeTexture.set(me.TEXTURE1),kt.atlasTextureIcon&&kt.atlasTextureIcon.bind(kt.atlasInterpolationIcon,me.CLAMP_TO_EDGE)),kt.isSDF){const qt=kt.uniformValues;kt.hasHalo&&(qt.u_is_halo=1,ec(kt.buffers,Vt.segments,d,x,kt.program,it,U,j,qt,Vt.terrainData)),qt.u_is_halo=0}ec(kt.buffers,Vt.segments,d,x,kt.program,it,U,j,kt.uniformValues,Vt.terrainData)}}function ec(x,o,d,g,v,A,O,C,L,B){const U=g.context;v.draw(U,U.gl.TRIANGLES,A,O,C,An.disabled,L,B,d.id,x.layoutVertexBuffer,x.indexBuffer,o,d.paint,g.transform.zoom,x.programConfigurations.get(d.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function Vo(x,o,d,g,v){if(!d||!g||!g.imageAtlas)return;const A=g.imageAtlas.patternPositions;let O=A[d.to.toString()],C=A[d.from.toString()];if(!O&&C&&(O=C),!C&&O&&(C=O),!O||!C){const L=v.getPaintProperty(o);O=A[L],C=A[L]}O&&C&&x.setConstantPatternPositions(O,C)}function ol(x,o,d,g,v,A,O){const C=x.context.gl,L="fill-pattern",B=d.paint.get(L),U=B&&B.constantOr(1),j=d.getCrossfadeParameters();let ee,me,fe,be,he;O?(me=U&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ee=C.LINES):(me=U?"fillPattern":"fill",ee=C.TRIANGLES);const Pe=B.constantOr(null);for(const Je of g){const Ee=o.getTile(Je);if(U&&!Ee.patternsLoaded())continue;const Fe=Ee.getBucket(d);if(!Fe)continue;const it=Fe.programConfigurations.get(d.id),at=x.useProgram(me,it),xt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Je);U&&(x.context.activeTexture.set(C.TEXTURE0),Ee.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),it.updatePaintBuffers(j)),Vo(it,L,Pe,Ee,d);const Vt=xt?Je:null,kt=x.translatePosMatrix(Vt?Vt.posMatrix:Je.posMatrix,Ee,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(O){be=Fe.indexBuffer2,he=Fe.segments2;const qt=[C.drawingBufferWidth,C.drawingBufferHeight];fe=me==="fillOutlinePattern"&&U?te(kt,x,j,Ee,qt):N(kt,qt)}else be=Fe.indexBuffer,he=Fe.segments,fe=U?I(kt,x,j,Ee):tl(kt);at.draw(x.context,ee,v,x.stencilModeForClipping(Je),A,An.disabled,fe,xt,d.id,Fe.layoutVertexBuffer,be,he,d.paint,x.transform.zoom,it)}}function ll(x,o,d,g,v,A,O){const C=x.context,L=C.gl,B="fill-extrusion-pattern",U=d.paint.get(B),j=U.constantOr(1),ee=d.getCrossfadeParameters(),me=d.paint.get("fill-extrusion-opacity"),fe=U.constantOr(null);for(const be of g){const he=o.getTile(be),Pe=he.getBucket(d);if(!Pe)continue;const Je=x.style.map.terrain&&x.style.map.terrain.getTerrainData(be),Ee=Pe.programConfigurations.get(d.id),Fe=x.useProgram(j?"fillExtrusionPattern":"fillExtrusion",Ee);j&&(x.context.activeTexture.set(L.TEXTURE0),he.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),Ee.updatePaintBuffers(ee)),Vo(Ee,B,fe,he,d);const it=x.translatePosMatrix(be.posMatrix,he,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),at=d.paint.get("fill-extrusion-vertical-gradient"),xt=j?ja(it,x,at,me,be,ee,he):Sc(it,x,at,me);Fe.draw(C,C.gl.TRIANGLES,v,A,O,An.backCCW,xt,Je,d.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,d.paint,x.transform.zoom,Ee,x.style.map.terrain&&Pe.centroidVertexBuffer)}}function Su(x,o,d,g,v,A,O){const C=x.context,L=C.gl,B=d.fbo;if(!B)return;const U=x.useProgram("hillshade"),j=x.style.map.terrain&&x.style.map.terrain.getTerrainData(o);C.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,B.colorAttachment.get()),U.draw(C,L.TRIANGLES,v,A,O,An.disabled,((ee,me,fe,be)=>{const he=fe.paint.get("hillshade-shadow-color"),Pe=fe.paint.get("hillshade-highlight-color"),Je=fe.paint.get("hillshade-accent-color");let Ee=fe.paint.get("hillshade-illumination-direction")*(Math.PI/180);fe.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ee-=ee.transform.angle);const Fe=!ee.options.moving;return{u_matrix:be?be.posMatrix:ee.transform.calculatePosMatrix(me.tileID.toUnwrapped(),Fe),u_image:0,u_latrange:Kt(0,me.tileID),u_light:[fe.paint.get("hillshade-exaggeration"),Ee],u_shadow:he,u_highlight:Pe,u_accent:Je}})(x,d,g,j?o:null),j,g.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}function tc(x,o,d,g,v,A){const O=x.context,C=O.gl,L=o.dem;if(L&&L.data){const B=L.dim,U=L.stride,j=L.getPixels();if(O.activeTexture.set(C.TEXTURE1),O.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||x.getTileTexture(U),o.demTexture){const me=o.demTexture;me.update(j,{premultiply:!1}),me.bind(C.NEAREST,C.CLAMP_TO_EDGE)}else o.demTexture=new oe(O,j,C.RGBA,{premultiply:!1}),o.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);O.activeTexture.set(C.TEXTURE0);let ee=o.fbo;if(!ee){const me=new oe(O,{width:B,height:B,data:null},C.RGBA);me.bind(C.LINEAR,C.CLAMP_TO_EDGE),ee=o.fbo=O.createFramebuffer(B,B,!0,!1),ee.colorAttachment.set(me.texture)}O.bindFramebuffer.set(ee.framebuffer),O.viewport.set([0,0,B,B]),x.useProgram("hillshadePrepare").draw(O,C.TRIANGLES,g,v,A,An.disabled,((me,fe)=>{const be=fe.stride,he=r.Z();return r.aS(he,0,r.N,-r.N,0,0,1),r.$(he,he,[0,-r.N,0]),{u_matrix:he,u_image:1,u_dimension:[be,be],u_zoom:me.overscaledZ,u_unpack:fe.getUnpackVector()}})(o.tileID,L),null,d.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function ic(x,o,d,g,v,A){const O=g.paint.get("raster-fade-duration");if(!A&&O>0){const C=r.h.now(),L=(C-x.timeAdded)/O,B=o?(C-o.timeAdded)/O:-1,U=d.getSource(),j=v.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),ee=!o||Math.abs(o.tileID.overscaledZ-j)>Math.abs(x.tileID.overscaledZ-j),me=ee&&x.refreshedUponExpiration?1:r.ad(ee?L:1-B,0,1);return x.refreshedUponExpiration&&L>=1&&(x.refreshedUponExpiration=!1),o?{opacity:1,mix:1-me}:{opacity:me,mix:0}}return{opacity:1,mix:0}}const mo=new r.aT(1,0,0,1),nc=new r.aT(0,1,0,1),ha=new r.aT(0,0,1,1),Iu=new r.aT(1,0,1,1),Za=new r.aT(0,1,1,1);function Fo(x,o,d,g){po(x,0,o+d/2,x.transform.width,d,g)}function rc(x,o,d,g){po(x,o-d/2,0,d,x.transform.height,g)}function po(x,o,d,g,v,A){const O=x.context,C=O.gl;C.enable(C.SCISSOR_TEST),C.scissor(o*x.pixelRatio,d*x.pixelRatio,g*x.pixelRatio,v*x.pixelRatio),O.clear({color:A}),C.disable(C.SCISSOR_TEST)}function sc(x,o,d){const g=x.context,v=g.gl,A=d.posMatrix,O=x.useProgram("debug"),C=cn.disabled,L=Kn.disabled,B=x.colorModeForRenderPass(),U="$debug",j=x.style.map.terrain&&x.style.map.terrain.getTerrainData(d);g.activeTexture.set(v.TEXTURE0);const ee=o.getTileByID(d.key).latestRawTileData,me=Math.floor((ee&&ee.byteLength||0)/1024),fe=o.getTile(d).tileSize,be=512/Math.min(fe,512)*(d.overscaledZ/x.transform.zoom)*.5;let he=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(he+=` => ${d.overscaledZ}`),function(Pe,Je){Pe.initDebugOverlayCanvas();const Ee=Pe.debugOverlayCanvas,Fe=Pe.context.gl,it=Pe.debugOverlayCanvas.getContext("2d");it.clearRect(0,0,Ee.width,Ee.height),it.shadowColor="white",it.shadowBlur=2,it.lineWidth=1.5,it.strokeStyle="white",it.textBaseline="top",it.font="bold 36px Open Sans, sans-serif",it.fillText(Je,5,5),it.strokeText(Je,5,5),Pe.debugOverlayTexture.update(Ee),Pe.debugOverlayTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE)}(x,`${he} ${me}kB`),O.draw(g,v.TRIANGLES,C,L,nr.alphaBlended,An.disabled,Re(A,r.aT.transparent,be),null,U,x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments),O.draw(g,v.LINE_STRIP,C,L,B,An.disabled,Re(A,r.aT.red),j,U,x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments)}function rr(x,o,d){const g=x.context,v=g.gl,A=x.colorModeForRenderPass(),O=new cn(v.LEQUAL,cn.ReadWrite,x.depthRangeFor3D),C=x.useProgram("terrain"),L=o.getTerrainMesh();g.bindFramebuffer.set(null),g.viewport.set([0,0,x.width,x.height]);for(const B of d){const U=x.renderToTexture.getTexture(B),j=o.getTerrainData(B.tileID);g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,U.texture);const ee={u_matrix:x.transform.calculatePosMatrix(B.tileID.toUnwrapped()),u_texture:0,u_ele_delta:o.getMeshFrameDelta(x.transform.zoom)};C.draw(g,v.TRIANGLES,O,Kn.disabled,A,An.backCCW,ee,j,"terrain",L.vertexBuffer,L.indexBuffer,L.segments)}}class Wa{constructor(o,d){this.context=new Bh(o),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:r.Z(),renderTime:0},this.setup(),this.numSublayers=On.maxUnderzooming+On.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ys}resize(o,d,g){if(this.width=Math.floor(o*g),this.height=Math.floor(d*g),this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const o=this.context,d=new r.a_;d.emplaceBack(0,0),d.emplaceBack(r.N,0),d.emplaceBack(0,r.N),d.emplaceBack(r.N,r.N),this.tileExtentBuffer=o.createVertexBuffer(d,Fl.members),this.tileExtentSegments=r.S.simpleSegment(0,0,4,2);const g=new r.a_;g.emplaceBack(0,0),g.emplaceBack(r.N,0),g.emplaceBack(0,r.N),g.emplaceBack(r.N,r.N),this.debugBuffer=o.createVertexBuffer(g,Fl.members),this.debugSegments=r.S.simpleSegment(0,0,4,5);const v=new r.V;v.emplaceBack(0,0,0,0),v.emplaceBack(r.N,0,r.N,0),v.emplaceBack(0,r.N,0,r.N),v.emplaceBack(r.N,r.N,r.N,r.N),this.rasterBoundsBuffer=o.createVertexBuffer(v,bt.members),this.rasterBoundsSegments=r.S.simpleSegment(0,0,4,2);const A=new r.a_;A.emplaceBack(0,0),A.emplaceBack(1,0),A.emplaceBack(0,1),A.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(A,Fl.members),this.viewportSegments=r.S.simpleSegment(0,0,4,2);const O=new r.a$;O.emplaceBack(0),O.emplaceBack(1),O.emplaceBack(3),O.emplaceBack(2),O.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(O);const C=new r.b0;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(C);const L=this.context.gl;this.stencilClearMode=new Kn({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO)}clearStencil(){const o=this.context,d=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=r.Z();r.aS(g,0,this.width,this.height,0,0,1),r.a0(g,g,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,d.TRIANGLES,cn.disabled,this.stencilClearMode,nr.disabled,An.disabled,Ke(g),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,d){if(this.currentStencilSource===o.source||!o.isTileClipped()||!d||!d.length)return;this.currentStencilSource=o.source;const g=this.context,v=g.gl;this.nextStencilID+d.length>256&&this.clearStencil(),g.setColorMode(nr.disabled),g.setDepthMode(cn.disabled);const A=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of d){const C=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,L=this.style.map.terrain&&this.style.map.terrain.getTerrainData(O);A.draw(g,v.TRIANGLES,cn.disabled,new Kn({func:v.ALWAYS,mask:0},C,255,v.KEEP,v.KEEP,v.REPLACE),nr.disabled,An.disabled,Ke(O.posMatrix),L,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new Kn({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){const d=this.context.gl;return new Kn({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,g=o.sort((O,C)=>C.overscaledZ-O.overscaledZ),v=g[g.length-1].overscaledZ,A=g[0].overscaledZ-v+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const O={};for(let C=0;C<A;C++)O[C+v]=new Kn({func:d.GEQUAL,mask:255},C+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=A,[O,g]}return[{[v]:Kn.disabled},g]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new nr([o.CONSTANT_COLOR,o.ONE],new r.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?nr.unblended:nr.alphaBlended}depthModeForSublayer(o,d,g){if(!this.opaquePassEnabledForLayer())return cn.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new cn(g||this.context.gl.LEQUAL,d,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,d){this.style=o,this.options=d,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(r.h.now()),this.imageManager.beginFrame();const g=this.style._order,v=this.style.sourceCaches,A={},O={},C={};for(const L in v){const B=v[L];B.used&&B.prepare(this.context),A[L]=B.getVisibleCoordinates(),O[L]=A[L].slice().reverse(),C[L]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<g.length;L++)if(this.style._layers[g[L]].is3D()){this.opaquePassCutoff=L;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const L=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!r.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||L.length)&&(r.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,U){const j=B.context,ee=j.gl,me=nr.unblended,fe=new cn(ee.LEQUAL,cn.ReadWrite,[0,1]),be=U.getTerrainMesh(),he=U.sourceCache.getRenderableTiles(),Pe=B.useProgram("terrainDepth");j.bindFramebuffer.set(U.getFramebuffer("depth").framebuffer),j.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),j.clear({color:r.aT.transparent,depth:1});for(const Je of he){const Ee=U.getTerrainData(Je.tileID),Fe={u_matrix:B.transform.calculatePosMatrix(Je.tileID.toUnwrapped()),u_ele_delta:U.getMeshFrameDelta(B.transform.zoom)};Pe.draw(j,ee.TRIANGLES,fe,Kn.disabled,me,An.backCCW,Fe,Ee,"terrain",be.vertexBuffer,be.indexBuffer,be.segments)}j.bindFramebuffer.set(null),j.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain),function(B,U){const j=B.context,ee=j.gl,me=nr.unblended,fe=new cn(ee.LEQUAL,cn.ReadWrite,[0,1]),be=U.getTerrainMesh(),he=U.getCoordsTexture(),Pe=U.sourceCache.getRenderableTiles(),Je=B.useProgram("terrainCoords");j.bindFramebuffer.set(U.getFramebuffer("coords").framebuffer),j.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),j.clear({color:r.aT.transparent,depth:1}),U.coordsIndex=[];for(const Ee of Pe){const Fe=U.getTerrainData(Ee.tileID);j.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_2D,he.texture);const it={u_matrix:B.transform.calculatePosMatrix(Ee.tileID.toUnwrapped()),u_terrain_coords_id:(255-U.coordsIndex.length)/255,u_texture:0,u_ele_delta:U.getMeshFrameDelta(B.transform.zoom)};Je.draw(j,ee.TRIANGLES,fe,Kn.disabled,me,An.backCCW,it,Fe,"terrain",be.vertexBuffer,be.indexBuffer,be.segments),U.coordsIndex.push(Ee.tileID.key)}j.bindFramebuffer.set(null),j.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const L of g){const B=this.style._layers[L];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const U=O[B.source];(B.type==="custom"||U.length)&&this.renderLayer(this,v[B.source],B,U)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?r.aT.black:r.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[g[this.currentLayer]],B=v[L.source],U=A[L.source];this._renderTileClippingMasks(L,U),this.renderLayer(this,B,L,U)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const L=this.style._layers[g[this.currentLayer]],B=v[L.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(L))continue;const U=(L.type==="symbol"?C:O)[L.source];this._renderTileClippingMasks(L,A[L.source]),this.renderLayer(this,B,L,U)}if(this.options.showTileBoundaries){const L=function(B,U){let j=null;const ee=Object.values(B._layers).flatMap(he=>he.source&&!he.isHidden(U)?[B.sourceCaches[he.source]]:[]),me=ee.filter(he=>he.getSource().type==="vector"),fe=ee.filter(he=>he.getSource().type!=="vector"),be=he=>{(!j||j.getSource().maxzoom<he.getSource().maxzoom)&&(j=he)};return me.forEach(he=>be(he)),j||fe.forEach(he=>be(he)),j}(this.style,this.transform.zoom);L&&function(B,U,j){for(let ee=0;ee<j.length;ee++)sc(B,U,j[ee])}(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const B=L.transform.padding;Fo(L,L.transform.height-(B.top||0),3,mo),Fo(L,B.bottom||0,3,nc),rc(L,B.left||0,3,ha),rc(L,L.transform.width-(B.right||0),3,Iu);const U=L.transform.centerPoint;(function(j,ee,me,fe){po(j,ee-1,me-10,2,20,fe),po(j,ee-10,me-1,20,2,fe)})(L,U.x,L.transform.height-U.y,Za)}(this),this.context.setDefault()}renderLayer(o,d,g,v){if(!g.isHidden(this.transform.zoom)&&(g.type==="background"||g.type==="custom"||(v||[]).length))switch(this.id=g.id,g.type){case"symbol":(function(A,O,C,L,B){if(A.renderPass!=="translucent")return;const U=Kn.disabled,j=A.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ee,me,fe,be,he,Pe,Je){const Ee=me.transform,Fe=he==="map",it=Pe==="map";for(const at of ee){const xt=be.getTile(at),Vt=xt.getBucket(fe);if(!Vt||!Vt.text||!Vt.text.segments.get().length)continue;const kt=r.ah(Vt.textSizeData,Ee.zoom),qt=Ae(xt,1,me.transform.zoom),vi=Nt(at.posMatrix,it,Fe,me.transform,qt),un=fe.layout.get("icon-text-fit")!=="none"&&Vt.hasIconData();if(kt){const ei=Math.pow(2,Ee.zoom-xt.tileID.overscaledZ);$l(Vt,Fe,it,Je,Ee,vi,at.posMatrix,ei,kt,un,me.style.map.terrain?(Fi,wi)=>me.style.map.terrain.getElevation(at,Fi,wi):null)}}}(L,A,C,O,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),B),C.paint.get("icon-opacity").constantOr(1)!==0&&qa(A,O,C,L,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),U,j),C.paint.get("text-opacity").constantOr(1)!==0&&qa(A,O,C,L,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),U,j),O.map.showCollisionBoxes&&(Ka(A,O,C,L,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),!0),Ka(A,O,C,L,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),!1))})(o,d,g,v,this.style.placement.variableOffsets);break;case"circle":(function(A,O,C,L){if(A.renderPass!=="translucent")return;const B=C.paint.get("circle-opacity"),U=C.paint.get("circle-stroke-width"),j=C.paint.get("circle-stroke-opacity"),ee=!C.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&(U.constantOr(1)===0||j.constantOr(1)===0))return;const me=A.context,fe=me.gl,be=A.depthModeForSublayer(0,cn.ReadOnly),he=Kn.disabled,Pe=A.colorModeForRenderPass(),Je=[];for(let Ee=0;Ee<L.length;Ee++){const Fe=L[Ee],it=O.getTile(Fe),at=it.getBucket(C);if(!at)continue;const xt=at.programConfigurations.get(C.id),Vt=A.useProgram("circle",xt),kt=at.layoutVertexBuffer,qt=at.indexBuffer,vi=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Fe),un={programConfiguration:xt,program:Vt,layoutVertexBuffer:kt,indexBuffer:qt,uniformValues:xe(A,Fe,it,C),terrainData:vi};if(ee){const ei=at.segments.get();for(const Fi of ei)Je.push({segments:new r.S([Fi]),sortKey:Fi.sortKey,state:un})}else Je.push({segments:at.segments,sortKey:0,state:un})}ee&&Je.sort((Ee,Fe)=>Ee.sortKey-Fe.sortKey);for(const Ee of Je){const{programConfiguration:Fe,program:it,layoutVertexBuffer:at,indexBuffer:xt,uniformValues:Vt,terrainData:kt}=Ee.state;it.draw(me,fe.TRIANGLES,be,he,Pe,An.disabled,Vt,kt,C.id,at,xt,Ee.segments,C.paint,A.transform.zoom,Fe)}})(o,d,g,v);break;case"heatmap":(function(A,O,C,L){if(C.paint.get("heatmap-opacity")!==0)if(A.renderPass==="offscreen"){const B=A.context,U=B.gl,j=Kn.disabled,ee=new nr([U.ONE,U.ONE],r.aT.transparent,[!0,!0,!0,!0]);(function(me,fe,be){const he=me.gl;me.activeTexture.set(he.TEXTURE1),me.viewport.set([0,0,fe.width/4,fe.height/4]);let Pe=be.heatmapFbo;if(Pe)he.bindTexture(he.TEXTURE_2D,Pe.colorAttachment.get()),me.bindFramebuffer.set(Pe.framebuffer);else{const Je=he.createTexture();he.bindTexture(he.TEXTURE_2D,Je),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MAG_FILTER,he.LINEAR),Pe=be.heatmapFbo=me.createFramebuffer(fe.width/4,fe.height/4,!1,!1),function(Ee,Fe,it,at){var xt,Vt;const kt=Ee.gl,qt=(xt=Ee.HALF_FLOAT)!==null&&xt!==void 0?xt:kt.UNSIGNED_BYTE,vi=(Vt=Ee.RGBA16F)!==null&&Vt!==void 0?Vt:kt.RGBA;kt.texImage2D(kt.TEXTURE_2D,0,vi,Fe.width/4,Fe.height/4,0,kt.RGBA,qt,null),at.colorAttachment.set(it)}(me,fe,Je,Pe)}})(B,A,C),B.clear({color:r.aT.transparent});for(let me=0;me<L.length;me++){const fe=L[me];if(O.hasRenderableParent(fe))continue;const be=O.getTile(fe),he=be.getBucket(C);if(!he)continue;const Pe=he.programConfigurations.get(C.id),Je=A.useProgram("heatmap",Pe),{zoom:Ee}=A.transform;Je.draw(B,U.TRIANGLES,cn.disabled,j,ee,An.disabled,Bt(fe.posMatrix,be,Ee,C.paint.get("heatmap-intensity")),null,C.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,C.paint,A.transform.zoom,Pe)}B.viewport.set([0,0,A.width,A.height])}else A.renderPass==="translucent"&&(A.context.setColorMode(A.colorModeForRenderPass()),function(B,U){const j=B.context,ee=j.gl,me=U.heatmapFbo;if(!me)return;j.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_2D,me.colorAttachment.get()),j.activeTexture.set(ee.TEXTURE1);let fe=U.colorRampTexture;fe||(fe=U.colorRampTexture=new oe(j,U.colorRamp,ee.RGBA)),fe.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),B.useProgram("heatmapTexture").draw(j,ee.TRIANGLES,cn.disabled,Kn.disabled,B.colorModeForRenderPass(),An.disabled,((be,he,Pe,Je)=>{const Ee=r.Z();r.aS(Ee,0,be.width,be.height,0,0,1);const Fe=be.context.gl;return{u_matrix:Ee,u_world:[Fe.drawingBufferWidth,Fe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:he.paint.get("heatmap-opacity")}})(B,U),null,U.id,B.viewportBuffer,B.quadTriangleIndexBuffer,B.viewportSegments,U.paint,B.transform.zoom)}(A,C))})(o,d,g,v);break;case"line":(function(A,O,C,L){if(A.renderPass!=="translucent")return;const B=C.paint.get("line-opacity"),U=C.paint.get("line-width");if(B.constantOr(1)===0||U.constantOr(1)===0)return;const j=A.depthModeForSublayer(0,cn.ReadOnly),ee=A.colorModeForRenderPass(),me=C.paint.get("line-dasharray"),fe=C.paint.get("line-pattern"),be=fe.constantOr(1),he=C.paint.get("line-gradient"),Pe=C.getCrossfadeParameters(),Je=be?"linePattern":me?"lineSDF":he?"lineGradient":"line",Ee=A.context,Fe=Ee.gl;let it=!0;for(const at of L){const xt=O.getTile(at);if(be&&!xt.patternsLoaded())continue;const Vt=xt.getBucket(C);if(!Vt)continue;const kt=Vt.programConfigurations.get(C.id),qt=A.context.program.get(),vi=A.useProgram(Je,kt),un=it||vi.program!==qt,ei=A.style.map.terrain&&A.style.map.terrain.getTerrainData(at),Fi=fe.constantOr(null);if(Fi&&xt.imageAtlas){const ln=xt.imageAtlas,rn=ln.patternPositions[Fi.to.toString()],hn=ln.patternPositions[Fi.from.toString()];rn&&hn&&kt.setConstantPatternPositions(rn,hn)}const wi=ei?at:null,Rn=be?Xt(A,xt,C,Pe,wi):me?qi(A,xt,C,me,Pe,wi):he?oi(A,xt,C,Vt.lineClipsArray.length,wi):si(A,xt,C,wi);if(be)Ee.activeTexture.set(Fe.TEXTURE0),xt.imageAtlasTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE),kt.updatePaintBuffers(Pe);else if(me&&(un||A.lineAtlas.dirty))Ee.activeTexture.set(Fe.TEXTURE0),A.lineAtlas.bind(Ee);else if(he){const ln=Vt.gradients[C.id];let rn=ln.texture;if(C.gradientVersion!==ln.version){let hn=256;if(C.stepInterpolant){const Ir=O.getSource().maxzoom,Xn=at.canonical.z===Ir?Math.ceil(1<<A.transform.maxZoom-at.canonical.z):1;hn=r.ad(r.aY(Vt.maxLineLength/r.N*1024*Xn),256,Ee.maxTextureSize)}ln.gradient=r.aZ({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:hn,image:ln.gradient||void 0,clips:Vt.lineClipsArray}),ln.texture?ln.texture.update(ln.gradient):ln.texture=new oe(Ee,ln.gradient,Fe.RGBA),ln.version=C.gradientVersion,rn=ln.texture}Ee.activeTexture.set(Fe.TEXTURE0),rn.bind(C.stepInterpolant?Fe.NEAREST:Fe.LINEAR,Fe.CLAMP_TO_EDGE)}vi.draw(Ee,Fe.TRIANGLES,j,A.stencilModeForClipping(at),ee,An.disabled,Rn,ei,C.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Vt.segments,C.paint,A.transform.zoom,kt,Vt.layoutVertexBuffer2),it=!1}})(o,d,g,v);break;case"fill":(function(A,O,C,L){const B=C.paint.get("fill-color"),U=C.paint.get("fill-opacity");if(U.constantOr(1)===0)return;const j=A.colorModeForRenderPass(),ee=C.paint.get("fill-pattern"),me=A.opaquePassEnabledForLayer()&&!ee.constantOr(1)&&B.constantOr(r.aT.transparent).a===1&&U.constantOr(0)===1?"opaque":"translucent";if(A.renderPass===me){const fe=A.depthModeForSublayer(1,A.renderPass==="opaque"?cn.ReadWrite:cn.ReadOnly);ol(A,O,C,L,fe,j,!1)}if(A.renderPass==="translucent"&&C.paint.get("fill-antialias")){const fe=A.depthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,cn.ReadOnly);ol(A,O,C,L,fe,j,!0)}})(o,d,g,v);break;case"fill-extrusion":(function(A,O,C,L){const B=C.paint.get("fill-extrusion-opacity");if(B!==0&&A.renderPass==="translucent"){const U=new cn(A.context.gl.LEQUAL,cn.ReadWrite,A.depthRangeFor3D);if(B!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))ll(A,O,C,L,U,Kn.disabled,nr.disabled),ll(A,O,C,L,U,A.stencilModeFor3D(),A.colorModeForRenderPass());else{const j=A.colorModeForRenderPass();ll(A,O,C,L,U,Kn.disabled,j)}}})(o,d,g,v);break;case"hillshade":(function(A,O,C,L){if(A.renderPass!=="offscreen"&&A.renderPass!=="translucent")return;const B=A.context,U=A.depthModeForSublayer(0,cn.ReadOnly),j=A.colorModeForRenderPass(),[ee,me]=A.renderPass==="translucent"?A.stencilConfigForOverlap(L):[{},L];for(const fe of me){const be=O.getTile(fe);be.needsHillshadePrepare!==void 0&&be.needsHillshadePrepare&&A.renderPass==="offscreen"?tc(A,be,C,U,Kn.disabled,j):A.renderPass==="translucent"&&Su(A,fe,be,C,U,ee[fe.overscaledZ],j)}B.viewport.set([0,0,A.width,A.height])})(o,d,g,v);break;case"raster":(function(A,O,C,L){if(A.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!L.length)return;const B=A.context,U=B.gl,j=O.getSource(),ee=A.useProgram("raster"),me=A.colorModeForRenderPass(),[fe,be]=j instanceof ze?[{},L]:A.stencilConfigForOverlap(L),he=be[be.length-1].overscaledZ,Pe=!A.options.moving;for(const Je of be){const Ee=A.depthModeForSublayer(Je.overscaledZ-he,C.paint.get("raster-opacity")===1?cn.ReadWrite:cn.ReadOnly,U.LESS),Fe=O.getTile(Je);Fe.registerFadeDuration(C.paint.get("raster-fade-duration"));const it=O.findLoadedParent(Je,0),at=ic(Fe,it,O,C,A.transform,A.style.map.terrain);let xt,Vt;const kt=C.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;B.activeTexture.set(U.TEXTURE0),Fe.texture.bind(kt,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(U.TEXTURE1),it?(it.texture.bind(kt,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),xt=Math.pow(2,it.tileID.overscaledZ-Fe.tileID.overscaledZ),Vt=[Fe.tileID.canonical.x*xt%1,Fe.tileID.canonical.y*xt%1]):Fe.texture.bind(kt,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST);const qt=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Je),vi=qt?Je:null,un=vi?vi.posMatrix:A.transform.calculatePosMatrix(Je.toUnwrapped(),Pe),ei=br(un,Vt||[0,0],xt||1,at,C);j instanceof ze?ee.draw(B,U.TRIANGLES,Ee,Kn.disabled,me,An.disabled,ei,qt,C.id,j.boundsBuffer,A.quadTriangleIndexBuffer,j.boundsSegments):ee.draw(B,U.TRIANGLES,Ee,fe[Je.overscaledZ],me,An.disabled,ei,qt,C.id,A.rasterBoundsBuffer,A.quadTriangleIndexBuffer,A.rasterBoundsSegments)}})(o,d,g,v);break;case"background":(function(A,O,C,L){const B=C.paint.get("background-color"),U=C.paint.get("background-opacity");if(U===0)return;const j=A.context,ee=j.gl,me=A.transform,fe=me.tileSize,be=C.paint.get("background-pattern");if(A.isPatternMissing(be))return;const he=!be&&B.a===1&&U===1&&A.opaquePassEnabledForLayer()?"opaque":"translucent";if(A.renderPass!==he)return;const Pe=Kn.disabled,Je=A.depthModeForSublayer(0,he==="opaque"?cn.ReadWrite:cn.ReadOnly),Ee=A.colorModeForRenderPass(),Fe=A.useProgram(be?"backgroundPattern":"background"),it=L||me.coveringTiles({tileSize:fe,terrain:A.style.map.terrain});be&&(j.activeTexture.set(ee.TEXTURE0),A.imageManager.bind(A.context));const at=C.getCrossfadeParameters();for(const xt of it){const Vt=L?xt.posMatrix:A.transform.calculatePosMatrix(xt.toUnwrapped()),kt=be?cs(Vt,U,A,be,{tileID:xt,tileSize:fe},at):ur(Vt,U,B),qt=A.style.map.terrain&&A.style.map.terrain.getTerrainData(xt);Fe.draw(j,ee.TRIANGLES,Je,Pe,Ee,An.disabled,kt,qt,C.id,A.tileExtentBuffer,A.quadTriangleIndexBuffer,A.tileExtentSegments)}})(o,0,g,v);break;case"custom":(function(A,O,C){const L=A.context,B=C.implementation;if(A.renderPass==="offscreen"){const U=B.prerender;U&&(A.setCustomLayerDefaults(),L.setColorMode(A.colorModeForRenderPass()),U.call(B,L.gl,A.transform.customLayerMatrix()),L.setDirty(),A.setBaseState())}else if(A.renderPass==="translucent"){A.setCustomLayerDefaults(),L.setColorMode(A.colorModeForRenderPass()),L.setStencilMode(Kn.disabled);const U=B.renderingMode==="3d"?new cn(A.context.gl.LEQUAL,cn.ReadWrite,A.depthRangeFor3D):A.depthModeForSublayer(0,cn.ReadOnly);L.setDepthMode(U),B.render(L.gl,A.transform.customLayerMatrix()),L.setDirty(),A.setBaseState(),L.bindFramebuffer.set(null)}})(o,0,g)}}translatePosMatrix(o,d,g,v,A){if(!g[0]&&!g[1])return o;const O=A?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(O){const B=Math.sin(O),U=Math.cos(O);g=[g[0]*U-g[1]*B,g[0]*B+g[1]*U]}const C=[A?g[0]:Ae(d,g[0],this.transform.zoom),A?g[1]:Ae(d,g[1],this.transform.zoom),0],L=new Float32Array(16);return r.$(L,o,C),L}saveTileTexture(o){const d=this._tileTextures[o.size[0]];d?d.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const d=this.imageManager.getPattern(o.from.toString()),g=this.imageManager.getPattern(o.to.toString());return!d||!g}useProgram(o,d){this.cache=this.cache||{};const g=o+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[g]||(this.cache[g]=new el(this.context,$n[o],d,Ul[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[g]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new oe(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:d}=this.context.gl;return this.width!==o||this.height!==d}}class ns{constructor(o,d){this.points=o,this.planes=d}static fromInvProjectionMatrix(o,d,g){const v=Math.pow(2,g),A=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const L=1/(C=r.ag([],C,o))[3]/d*v;return r.b3(C,C,[L,L,1/C[3],L])}),O=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const L=function(ee,me){var fe=me[0],be=me[1],he=me[2],Pe=fe*fe+be*be+he*he;return Pe>0&&(Pe=1/Math.sqrt(Pe)),ee[0]=me[0]*Pe,ee[1]=me[1]*Pe,ee[2]=me[2]*Pe,ee}([],function(ee,me,fe){var be=me[0],he=me[1],Pe=me[2],Je=fe[0],Ee=fe[1],Fe=fe[2];return ee[0]=he*Fe-Pe*Ee,ee[1]=Pe*Je-be*Fe,ee[2]=be*Ee-he*Je,ee}([],ne([],A[C[0]],A[C[1]]),ne([],A[C[2]],A[C[1]]))),B=-((U=L)[0]*(j=A[C[1]])[0]+U[1]*j[1]+U[2]*j[2]);var U,j;return L.concat(B)});return new ns(A,O)}}class da{constructor(o,d){this.min=o,this.max=d,this.center=function(g,v,A){return g[0]=.5*v[0],g[1]=.5*v[1],g[2]=.5*v[2],g}([],function(g,v,A){return g[0]=v[0]+A[0],g[1]=v[1]+A[1],g[2]=v[2]+A[2],g}([],this.min,this.max))}quadrant(o){const d=[o%2==0,o<2],g=se(this.min),v=se(this.max);for(let A=0;A<d.length;A++)g[A]=d[A]?this.min[A]:this.center[A],v[A]=d[A]?this.center[A]:this.max[A];return v[2]=this.max[2],new da(g,v)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let g=!0;for(let v=0;v<o.planes.length;v++){const A=o.planes[v];let O=0;for(let C=0;C<d.length;C++)r.b4(A,d[C])>=0&&O++;if(O===0)return 0;O!==d.length&&(g=!1)}if(g)return 2;for(let v=0;v<3;v++){let A=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(let C=0;C<o.points.length;C++){const L=o.points[C][v]-this.min[v];A=Math.min(A,L),O=Math.max(O,L)}if(O<0||A>this.max[v]-this.min[v])return 0}return 1}}class Uo{constructor(o=0,d=0,g=0,v=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(g)||g<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=g,this.right=v}interpolate(o,d,g){return d.top!=null&&o.top!=null&&(this.top=r.B.number(o.top,d.top,g)),d.bottom!=null&&o.bottom!=null&&(this.bottom=r.B.number(o.bottom,d.bottom,g)),d.left!=null&&o.left!=null&&(this.left=r.B.number(o.left,d.left,g)),d.right!=null&&o.right!=null&&(this.right=r.B.number(o.right,d.right,g)),this}getCenter(o,d){const g=r.ad((this.left+o-this.right)/2,0,o),v=r.ad((this.top+d-this.bottom)/2,0,d);return new r.P(g,v)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Uo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class ac{constructor(o,d,g,v,A){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=A===void 0||!!A,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=g??0,this._maxPitch=v??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new r.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Uo,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const o=new ac(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this._minEleveationForCurrentTile=o._minEleveationForCurrentTile,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const d=-r.b5(o,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var g=new r.A(4);return r.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g}(),function(g,v,A){var O=v[0],C=v[1],L=v[2],B=v[3],U=Math.sin(A),j=Math.cos(A);g[0]=O*j+L*U,g[1]=C*j+B*U,g[2]=O*-U+L*j,g[3]=C*-U+B*j}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=r.ad(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,g){this._unmodified=!1,this._edgeInsets.interpolate(o,d,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new r.b6(0,o)];if(this._renderWorldCopies){const g=this.pointCoordinate(new r.P(0,0)),v=this.pointCoordinate(new r.P(this.width,0)),A=this.pointCoordinate(new r.P(this.width,this.height)),O=this.pointCoordinate(new r.P(0,this.height)),C=Math.floor(Math.min(g.x,v.x,A.x,O.x)),L=Math.floor(Math.max(g.x,v.x,A.x,O.x)),B=1;for(let U=C-B;U<=L+B;U++)U!==0&&d.push(new r.b6(U,o))}return d}coveringTiles(o){var d,g;let v=this.coveringZoomLevel(o);const A=v;if(o.minzoom!==void 0&&v<o.minzoom)return[];o.maxzoom!==void 0&&v>o.maxzoom&&(v=o.maxzoom);const O=this.pointCoordinate(this.getCameraPoint()),C=r.U.fromLngLat(this.center),L=Math.pow(2,v),B=[L*O.x,L*O.y,0],U=[L*C.x,L*C.y,0],j=ns.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,v);let ee=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ee=v);const me=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,fe=Ee=>({aabb:new da([Ee*L,0,0],[(Ee+1)*L,L,0]),zoom:0,x:0,y:0,wrap:Ee,fullyVisible:!1}),be=[],he=[],Pe=v,Je=o.reparseOverscaled?A:v;if(this._renderWorldCopies)for(let Ee=1;Ee<=3;Ee++)be.push(fe(-Ee)),be.push(fe(Ee));for(be.push(fe(0));be.length>0;){const Ee=be.pop(),Fe=Ee.x,it=Ee.y;let at=Ee.fullyVisible;if(!at){const vi=Ee.aabb.intersects(j);if(vi===0)continue;at=vi===2}const xt=o.terrain?B:U,Vt=Ee.aabb.distanceX(xt),kt=Ee.aabb.distanceY(xt),qt=Math.max(Math.abs(Vt),Math.abs(kt));if(Ee.zoom===Pe||qt>me+(1<<Pe-Ee.zoom)-2&&Ee.zoom>=ee){const vi=Pe-Ee.zoom,un=B[0]-.5-(Fe<<vi),ei=B[1]-.5-(it<<vi);he.push({tileID:new r.O(Ee.zoom===Pe?Je:Ee.zoom,Ee.wrap,Ee.zoom,Fe,it),distanceSq:ue([U[0]-.5-Fe,U[1]-.5-it]),tileDistanceToCamera:Math.sqrt(un*un+ei*ei)})}else for(let vi=0;vi<4;vi++){const un=(Fe<<1)+vi%2,ei=(it<<1)+(vi>>1),Fi=Ee.zoom+1;let wi=Ee.aabb.quadrant(vi);if(o.terrain){const Rn=new r.O(Fi,Ee.wrap,Fi,un,ei),ln=o.terrain.getMinMaxElevation(Rn),rn=(d=ln.minElevation)!==null&&d!==void 0?d:this.elevation,hn=(g=ln.maxElevation)!==null&&g!==void 0?g:this.elevation;wi=new da([wi.min[0],wi.min[1],rn],[wi.max[0],wi.max[1],hn])}be.push({aabb:wi,zoom:Fi,x:un,y:ei,wrap:Ee.wrap,fullyVisible:at})}}return he.sort((Ee,Fe)=>Ee.distanceSq-Fe.distanceSq).map(Ee=>Ee.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const d=r.ad(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new r.P(r.G(o.lng)*this.worldSize,r.H(d)*this.worldSize)}unproject(o){return new r.U(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const d=this.pointLocation(this.centerPoint,o),g=o.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-g))return;const v=this.getCameraPosition(),A=r.U.fromLngLat(v.lngLat,v.altitude),O=r.U.fromLngLat(d,g),C=A.x-O.x,L=A.y-O.y,B=A.z-O.z,U=Math.sqrt(C*C+L*L+B*B),j=this.scaleZoom(this.cameraToCenterDistance/U/this.tileSize);this._elevation=g,this._center=d,this.zoom=j}setLocationAtPoint(o,d){const g=this.pointCoordinate(d),v=this.pointCoordinate(this.centerPoint),A=this.locationCoordinate(o),O=new r.U(A.x-(g.x-v.x),A.y-(g.y-v.y));this.center=this.coordinateLocation(O),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,d){return d?this.coordinatePoint(this.locationCoordinate(o),d.getElevationForLngLatZoom(o,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,d){return this.coordinateLocation(this.pointCoordinate(o,d))}locationCoordinate(o){return r.U.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,d){if(d){const ee=d.pointCoordinate(o);if(ee!=null)return ee}const g=[o.x,o.y,0,1],v=[o.x,o.y,1,1];r.ag(g,g,this.pixelMatrixInverse),r.ag(v,v,this.pixelMatrixInverse);const A=g[3],O=v[3],C=g[1]/A,L=v[1]/O,B=g[2]/A,U=v[2]/O,j=B===U?0:(0-B)/(U-B);return new r.U(r.B.number(g[0]/A,v[0]/O,j)/this.worldSize,r.B.number(C,L,j)/this.worldSize)}coordinatePoint(o,d=0,g=this.pixelMatrix){const v=[o.x*this.worldSize,o.y*this.worldSize,d,1];return r.ag(v,v,g),new r.P(v[0]/v[3],v[1]/v[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return new Pt().extend(this.pointLocation(new r.P(0,o))).extend(this.pointLocation(new r.P(this.width,o))).extend(this.pointLocation(new r.P(this.width,this.height))).extend(this.pointLocation(new r.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Pt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,d=!1){const g=o.key,v=d?this._alignedPosMatrixCache:this._posMatrixCache;if(v[g])return v[g];const A=o.canonical,O=this.worldSize/this.zoomScale(A.z),C=A.x+Math.pow(2,A.z)*o.wrap,L=r.ao(new Float64Array(16));return r.$(L,L,[C*O,A.y*O,0]),r.a0(L,L,[O/r.N,O/r.N,1]),r.a1(L,d?this.alignedProjMatrix:this.projMatrix,L),v[g]=new Float32Array(L),v[g]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,d,g,v,A=-90,O=90,C=-180,L=180;const B=this.size,U=this._unmodified;if(this.latRange){const me=this.latRange;A=r.H(me[1])*this.worldSize,O=r.H(me[0])*this.worldSize,o=O-A<B.y?B.y/(O-A):0}if(this.lngRange){const me=this.lngRange;C=r.b5(r.G(me[0])*this.worldSize,0,this.worldSize),L=r.b5(r.G(me[1])*this.worldSize,0,this.worldSize),L<C&&(L+=this.worldSize),d=L-C<B.x?B.x/(L-C):0}const j=this.point,ee=Math.max(d||0,o||0);if(ee)return this.center=this.unproject(new r.P(d?(L+C)/2:j.x,o?(O+A)/2:j.y)),this.zoom+=this.scaleZoom(ee),this._unmodified=U,void(this._constraining=!1);if(this.latRange){const me=j.y,fe=B.y/2;me-fe<A&&(v=A+fe),me+fe>O&&(v=O-fe)}if(this.lngRange){const me=(C+L)/2,fe=r.b5(j.x,me-this.worldSize/2,me+this.worldSize/2),be=B.x/2;fe-be<C&&(g=C+be),fe+be>L&&(g=L-be)}g===void 0&&v===void 0||(this.center=this.unproject(new r.P(g!==void 0?g:j.x,v!==void 0?v:j.y)).wrap()),this._unmodified=U,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,d=this.point.x,g=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=r.b7(1,this.center.lat)*this.worldSize;let v=r.ao(new Float64Array(16));r.a0(v,v,[this.width/2,-this.height/2,1]),r.$(v,v,[1,-1,0]),this.labelPlaneMatrix=v,v=r.ao(new Float64Array(16)),r.a0(v,v,[1,-1,1]),r.$(v,v,[-1,-1,0]),r.a0(v,v,[2/this.width,2/this.height,1]),this.glCoordMatrix=v;const A=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),O=Math.min(this.elevation,this._minEleveationForCurrentTile),C=A-O*this._pixelPerMeter/Math.cos(this._pitch),L=O<0?C:A,B=Math.PI/2+this._pitch,U=this._fov*(.5+o.y/this.height),j=Math.sin(U)*L/Math.sin(r.ad(Math.PI-B-U,.01,Math.PI-.01)),ee=this.getHorizon(),me=2*Math.atan(ee/this.cameraToCenterDistance)*(.5+o.y/(2*ee)),fe=Math.sin(me)*L/Math.sin(r.ad(Math.PI-B-me,.01,Math.PI-.01)),be=Math.min(j,fe),he=1.01*(Math.cos(Math.PI/2-this._pitch)*be+L),Pe=this.height/50;v=new Float64Array(16),r.b8(v,this._fov,this.width/this.height,Pe,he),v[8]=2*-o.x/this.width,v[9]=2*o.y/this.height,r.a0(v,v,[1,-1,1]),r.$(v,v,[0,0,-this.cameraToCenterDistance]),r.b9(v,v,this._pitch),r.ae(v,v,this.angle),r.$(v,v,[-d,-g,0]),this.mercatorMatrix=r.a0([],v,[this.worldSize,this.worldSize,this.worldSize]),r.a0(v,v,[1,1,this._pixelPerMeter]),this.pixelMatrix=r.a1(new Float64Array(16),this.labelPlaneMatrix,v),r.$(v,v,[0,0,-this.elevation]),this.projMatrix=v,this.invProjMatrix=r.as([],v),this.pixelMatrix3D=r.a1(new Float64Array(16),this.labelPlaneMatrix,v);const Je=this.width%2/2,Ee=this.height%2/2,Fe=Math.cos(this.angle),it=Math.sin(this.angle),at=d-Math.round(d)+Fe*Je+it*Ee,xt=g-Math.round(g)+Fe*Ee+it*Je,Vt=new Float64Array(v);if(r.$(Vt,Vt,[at>.5?at-1:at,xt>.5?xt-1:xt,0]),this.alignedProjMatrix=Vt,v=r.as(new Float64Array(16),this.pixelMatrix),!v)throw new Error("failed to invert matrix");this.pixelMatrixInverse=v,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new r.P(0,0)),d=[o.x*this.worldSize,o.y*this.worldSize,0,1];return r.ag(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,o))}getCameraQueryGeometry(o){const d=this.getCameraPoint();if(o.length===1)return[o[0],d];{let g=d.x,v=d.y,A=d.x,O=d.y;for(const C of o)g=Math.min(g,C.x),v=Math.min(v,C.y),A=Math.max(A,C.x),O=Math.max(O,C.y);return[new r.P(g,v),new r.P(A,v),new r.P(A,O),new r.P(g,O),new r.P(g,v)]}}}function Ge(x,o){let d,g=!1,v=null,A=null;const O=()=>{v=null,g&&(x.apply(A,d),v=setTimeout(O,o),g=!1)};return(...C)=>(g=!0,A=this,d=C,v||O(),v)}class ft{constructor(o){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let g;return d.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(g=v)}),(g&&g[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(g=>isNaN(g))){const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:g,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=Ge(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const d=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,v=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,v),O=Math.round(d.lng*A)/A,C=Math.round(d.lat*A)/A,L=this._map.getBearing(),B=this._map.getPitch();let U="";if(U+=o?`/${O}/${C}/${g}`:`${g}/${C}/${O}`,(L||B)&&(U+="/"+Math.round(10*L)/10),B&&(U+=`/${Math.round(B)}`),this._hashName){const j=this._hashName;let ee=!1;const me=window.location.hash.slice(1).split("&").map(fe=>{const be=fe.split("=")[0];return be===j?(ee=!0,`${be}=${U}`):fe}).filter(fe=>fe);return ee||me.push(`${j}=${U}`),`#${me.join("&")}`}return`#${U}`}}const Qt={linearity:.3,easing:r.ba(0,0,.3,1)},Pi=r.e({deceleration:2500,maxSpeed:1400},Qt),qn=r.e({deceleration:20,maxSpeed:1400},Qt),dn=r.e({deceleration:1e3,maxSpeed:360},Qt),hr=r.e({deceleration:1e3,maxSpeed:90},Qt);class xr{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.h.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=r.h.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)d.zoom+=A.zoomDelta||0,d.bearing+=A.bearingDelta||0,d.pitch+=A.pitchDelta||0,A.panDelta&&d.pan._add(A.panDelta),A.around&&(d.around=A.around),A.pinchAround&&(d.pinchAround=A.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(d.pan.mag()){const A=dr(d.pan.mag(),g,r.e({},Pi,o||{}));v.offset=d.pan.mult(A.amount/d.pan.mag()),v.center=this._map.transform.center,Tr(v,A)}if(d.zoom){const A=dr(d.zoom,g,qn);v.zoom=this._map.transform.zoom+A.amount,Tr(v,A)}if(d.bearing){const A=dr(d.bearing,g,dn);v.bearing=this._map.transform.bearing+r.ad(A.amount,-179,179),Tr(v,A)}if(d.pitch){const A=dr(d.pitch,g,hr);v.pitch=this._map.transform.pitch+A.amount,Tr(v,A)}if(v.zoom||v.bearing){const A=d.pinchAround===void 0?d.around:d.pinchAround;v.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),r.e(v,{noMoveStart:!0})}}function Tr(x,o){(!x.duration||x.duration<o.duration)&&(x.duration=o.duration,x.easing=o.easing)}function dr(x,o,d){const{maxSpeed:g,linearity:v,deceleration:A}=d,O=r.ad(x*v/(o/1e3),-g,g),C=Math.abs(O)/(A*v);return{easing:d.easing,duration:1e3*C,amount:O*(C/2)}}class En extends r.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,g,v={}){const A=m.mousePos(d.getCanvasContainer(),g),O=d.unproject(A);super(o,r.e({point:A,lngLat:O,originalEvent:g},v)),this._defaultPrevented=!1,this.target=d}}class ds extends r.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,g){const v=o==="touchend"?g.changedTouches:g.touches,A=m.touchPos(d.getCanvasContainer(),v),O=A.map(L=>d.unproject(L)),C=A.reduce((L,B,U,j)=>L.add(B.div(j.length)),new r.P(0,0));super(o,{points:A,point:C,lngLats:O,lngLat:d.unproject(C),originalEvent:g}),this._defaultPrevented=!1}}class fa extends r.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,g){super(o,{originalEvent:g}),this._defaultPrevented=!1}}class es{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new fa(o.type,this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new En(o.type,this._map,o))}mouseup(o){this._map.fire(new En(o.type,this._map,o))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new En(o.type,this._map,o))}dblclick(o){return this._firePreventable(new En(o.type,this._map,o))}mouseover(o){this._map.fire(new En(o.type,this._map,o))}mouseout(o){this._map.fire(new En(o.type,this._map,o))}touchstart(o){return this._firePreventable(new ds(o.type,this._map,o))}touchmove(o){this._map.fire(new ds(o.type,this._map,o))}touchend(o){this._map.fire(new ds(o.type,this._map,o))}touchcancel(o){this._map.fire(new ds(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ma{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new En(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new En("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new En(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class fs{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(r.P.convert(o),this._map.terrain)}}class cl{constructor(o,d){this._map=o,this._tr=new fs(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(m.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const g=d;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=g,this._box||(this._box=m.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const A=Math.min(v.x,g.x),O=Math.max(v.x,g.x),C=Math.min(v.y,g.y),L=Math.max(v.y,g.y);m.setTransform(this._box,`translate(${A}px,${C}px)`),this._box.style.width=O-A+"px",this._box.style.height=L-C+"px"}mouseupWindow(o,d){if(!this._active||o.button!==0)return;const g=this._startPos,v=d;if(this.reset(),m.suppressClick(),g.x!==v.x||g.y!==v.y)return this._map.fire(new r.k("boxzoomend",{originalEvent:o})),{cameraAnimation:A=>A.fitScreenCoordinates(g,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(m.remove(this._box),this._box=null),m.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new r.k(o,{originalEvent:d}))}}function Gr(x,o){if(x.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${x.length}, points ${o.length}`);const d={};for(let g=0;g<x.length;g++)d[x[g].identifier]=o[g];return d}class xs{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,d,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),g.length===this.numTouches&&(this.centroid=function(v){const A=new r.P(0,0);for(const O of v)A._add(O);return A.div(v.length)}(d),this.touches=Gr(g,d)))}touchmove(o,d,g){if(this.aborted||!this.centroid)return;const v=Gr(g,d);for(const A in this.touches){const O=v[A];(!O||O.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(o,d,g){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class ul{constructor(o){this.singleTap=new xs(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,d,g){this.singleTap.touchstart(o,d,g)}touchmove(o,d,g){this.singleTap.touchmove(o,d,g)}touchend(o,d,g){const v=this.singleTap.touchend(o,d,g);if(v){const A=o.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(v)<30;if(A&&O||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class Sa{constructor(o){this._tr=new fs(o),this._zoomIn=new ul({numTouches:1,numTaps:2}),this._zoomOut=new ul({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,g){this._zoomIn.touchstart(o,d,g),this._zoomOut.touchstart(o,d,g)}touchmove(o,d,g){this._zoomIn.touchmove(o,d,g),this._zoomOut.touchmove(o,d,g)}touchend(o,d,g){const v=this._zoomIn.touchend(o,d,g),A=this._zoomOut.touchend(o,d,g),O=this._tr;return v?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:O.zoom+1,around:O.unproject(v)},{originalEvent:o})}):A?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:O.zoom-1,around:O.unproject(A)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ia{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const d=this._moveFunction(...o);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(o,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,d){if(!this.isEnabled())return;const g=this._lastPoint;if(!g)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const v=d.length?d[0]:d;return!this._moved&&v.dist(g)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(g,v))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&m.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Vn={0:1,2:2};class Tn{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const d=m.mouseButton(o);this._eventButton=d}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(d,g){const v=Vn[g];return d.buttons===void 0||(d.buttons&v)!==v}(o,this._eventButton)}isValidEndEvent(o){return m.mouseButton(o)===this._eventButton}}class hl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const Qs=x=>{x.mousedown=x.dragStart,x.mousemoveWindow=x.dragMove,x.mouseup=x.dragEnd,x.contextmenu=function(o){o.preventDefault()}},Ya=({enable:x,clickTolerance:o,bearingDegreesPerPixelMoved:d=.8})=>{const g=new Tn({checkCorrectEvent:v=>m.mouseButton(v)===0&&v.ctrlKey||m.mouseButton(v)===2});return new Ia({clickTolerance:o,move:(v,A)=>({bearingDelta:(A.x-v.x)*d}),moveStateManager:g,enable:x,assignEvents:Qs})},Sr=({enable:x,clickTolerance:o,pitchDegreesPerPixelMoved:d=-.5})=>{const g=new Tn({checkCorrectEvent:v=>m.mouseButton(v)===0&&v.ctrlKey||m.mouseButton(v)===2});return new Ia({clickTolerance:o,move:(v,A)=>({pitchDelta:(A.y-v.y)*d}),moveStateManager:g,enable:x,assignEvents:Qs})};class ri{constructor(o,d){this._minTouches=o.cooperativeGestures?2:1,this._clickTolerance=o.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(o,d,g){return this._calculateTransform(o,d,g)}touchmove(o,d,g){if(this._map._cooperativeGestures&&(this._minTouches===2&&g.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(o,!1,g.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(g.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,d,g)}touchend(o,d,g){this._calculateTransform(o,d,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,g){g.length>0&&(this._active=!0);const v=Gr(g,d),A=new r.P(0,0),O=new r.P(0,0);let C=0;for(const B in v){const U=v[B],j=this._touches[B];j&&(A._add(U),O._add(U.sub(j)),C++,v[B]=U)}if(this._touches=v,C<this._minTouches||!O.mag())return;const L=O.div(C);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(C),panDelta:L}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $s{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,d,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,g){if(!this._firstTwoTouches)return;o.preventDefault();const[v,A]=this._firstTwoTouches,O=Ds(g,d,v),C=Ds(g,d,A);if(!O||!C)return;const L=this._aroundCenter?null:O.add(C).div(2);return this._move([O,C],L,o)}touchend(o,d,g){if(!this._firstTwoTouches)return;const[v,A]=this._firstTwoTouches,O=Ds(g,d,v),C=Ds(g,d,A);O&&C||(this._active&&m.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ds(x,o,d){for(let g=0;g<x.length;g++)if(x[g].identifier===d)return o[g]}function ka(x,o){return Math.log(x/o)/Math.LN2}class go extends $s{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const g=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(ka(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ka(this._distance,g),pinchAround:d}}}function Wt(x,o){return 180*x.angleWith(o)/Math.PI}class oc extends $s{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d){const g=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Wt(this._vector,g),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,g=Wt(o,this._startVector);return Math.abs(g)<d}}function jo(x){return Math.abs(x.y)>Math.abs(x.x)}class Mc extends $s{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,d,g){super.touchstart(o,d,g),this._currentTouchCount=g.length}_start(o){this._lastPoints=o,jo(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,g){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const v=o[0].sub(this._lastPoints[0]),A=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,A,g.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(v.y+A.y)/2*-.5}):void 0}gestureBeginsVertically(o,d,g){if(this._valid!==void 0)return this._valid;const v=o.mag()>=2,A=d.mag()>=2;if(!v&&!A)return;if(!v||!A)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const O=o.y>0==d.y>0;return jo(o)&&jo(d)&&O}}const Go={panStep:100,bearingStep:15,pitchStep:10};class dl{constructor(o){this._tr=new fs(o);const d=Go;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,g=0,v=0,A=0,O=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?g=-1:(o.preventDefault(),A=-1);break;case 39:o.shiftKey?g=1:(o.preventDefault(),A=1);break;case 38:o.shiftKey?v=1:(o.preventDefault(),O=-1);break;case 40:o.shiftKey?v=-1:(o.preventDefault(),O=1);break;default:return}return this._rotationDisabled&&(g=0,v=0),{cameraAnimation:C=>{const L=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:Dc,zoom:d?Math.round(L.zoom)+d*(o.shiftKey?2:1):L.zoom,bearing:L.bearing+g*this._bearingStep,pitch:L.pitch+v*this._pitchStep,offset:[-A*this._panStep,-O*this._panStep],center:L.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Dc(x){return x*(2-x)}const fl=4.000244140625;class lc{constructor(o,d){this._onTimeout=g=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(g)},this._map=o,this._tr=new fs(o),this._el=o.getCanvasContainer(),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!o[this._map._metaKey])return;o.preventDefault()}let d=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const g=r.h.now(),v=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,d!==0&&d%fl==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(v*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=m.mousePos(this._el,o),g=this._tr;this._around=r.L.convert(this._aroundCenter?g.center:g.unproject(d)),this._aroundPoint=g.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>fl?this._wheelZoomRate:this._defaultZoomRate;let L=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&L!==0&&(L=1/L);const B=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(B*L))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,g=this._startZoom,v=this._easing;let A,O=!1;if(this._type==="wheel"&&g&&v){const C=Math.min((r.h.now()-this._lastWheelEventTime)/200,1),L=v(C);A=r.B.number(g,d,L),C<1?this._frameId||(this._frameId=!0):O=!0}else A=d,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:A-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=r.bb;if(this._prevEase){const g=this._prevEase,v=(r.h.now()-g.start)/g.duration,A=g.easing(v+.01)-g.easing(v),O=.27/Math.sqrt(A*A+1e-4)*.01,C=Math.sqrt(.0729-O*O);d=r.ba(O,C,.25,1)}return this._prevEase={start:r.h.now(),duration:o,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Vh{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Fh{constructor(o){this._tr=new fs(o),this.reset()}reset(){this._active=!1}dblclick(o,d){return o.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Uh{constructor(){this._tap=new ul({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,d,g){if(!this._swipePoint)if(this._tapTime){const v=d[0],A=o.timeStamp-this._tapTime<500,O=this._tapPoint.dist(v)<30;A&&O?g.length>0&&(this._swipePoint=v,this._swipeTouch=g[0].identifier):this.reset()}else this._tap.touchstart(o,d,g)}touchmove(o,d,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const v=d[0],A=v.y-this._swipePoint.y;return this._swipePoint=v,o.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(o,d,g)}touchend(o,d,g){if(this._tapTime)this._swipePoint&&g.length===0&&this.reset();else{const v=this._tap.touchend(o,d,g);v&&(this._tapTime=o.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jh{constructor(o,d,g){this._el=o,this._mousePan=d,this._touchPan=g}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Rs{constructor(o,d,g){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ho{constructor(o,d,g,v){this._el=o,this._touchZoom=d,this._touchRotate=g,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Rc=x=>x.zoom||x.drag||x.pitch||x.rotate;class Gh extends r.k{}function Lc(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}class Hh{constructor(o,d){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,A)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const O=v.type==="renderFrame"?void 0:v,C={needsRenderFrame:!1},L={},B={},U=v.touches,j=U?this._getMapTouches(U):void 0,ee=j?m.touchPos(this._el,j):m.mousePos(this._el,v);for(const{handlerName:be,handler:he,allowed:Pe}of this._handlers){if(!he.isEnabled())continue;let Je;this._blockedByActive(B,Pe,be)?he.reset():he[A||v.type]&&(Je=he[A||v.type](v,ee,j),this.mergeHandlerResult(C,L,Je,be,O),Je&&Je.needsRenderFrame&&this._triggerRenderFrame()),(Je||he.isActive())&&(B[be]=he)}const me={};for(const be in this._previousActiveHandlers)B[be]||(me[be]=O);this._previousActiveHandlers=B,(Object.keys(me).length||Lc(C))&&(this._changes.push([C,L,me]),this._triggerRenderFrame()),(Object.keys(B).length||Lc(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:fe}=C;fe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],fe(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xr(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,A,O]of this._listeners)m.addEventListener(v,A,v===document?this.handleWindowEvent:this.handleEvent,O)}destroy(){for(const[o,d,g]of this._listeners)m.removeEventListener(o,d,o===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(o){const d=this._map,g=d.getCanvasContainer();this._add("mapEvent",new es(d,o));const v=d.boxZoom=new cl(d,o);this._add("boxZoom",v),o.interactive&&o.boxZoom&&v.enable();const A=new Sa(d),O=new Fh(d);d.doubleClickZoom=new Vh(O,A),this._add("tapZoom",A),this._add("clickZoom",O),o.interactive&&o.doubleClickZoom&&d.doubleClickZoom.enable();const C=new Uh;this._add("tapDragZoom",C);const L=d.touchPitch=new Mc(d);this._add("touchPitch",L),o.interactive&&o.touchPitch&&d.touchPitch.enable(o.touchPitch);const B=Ya(o),U=Sr(o);d.dragRotate=new Rs(o,B,U),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",U,["mouseRotate"]),o.interactive&&o.dragRotate&&d.dragRotate.enable();const j=(({enable:Pe,clickTolerance:Je})=>{const Ee=new Tn({checkCorrectEvent:Fe=>m.mouseButton(Fe)===0&&!Fe.ctrlKey});return new Ia({clickTolerance:Je,move:(Fe,it)=>({around:it,panDelta:it.sub(Fe)}),activateOnStart:!0,moveStateManager:Ee,enable:Pe,assignEvents:Qs})})(o),ee=new ri(o,d);d.dragPan=new jh(g,j,ee),this._add("mousePan",j),this._add("touchPan",ee,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&d.dragPan.enable(o.dragPan);const me=new oc,fe=new go;d.touchZoomRotate=new Ho(g,fe,me,C),this._add("touchRotate",me,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&d.touchZoomRotate.enable(o.touchZoomRotate);const be=d.scrollZoom=new lc(d,()=>this._triggerRenderFrame());this._add("scrollZoom",be,["mousePan"]),o.interactive&&o.scrollZoom&&d.scrollZoom.enable(o.scrollZoom);const he=d.keyboard=new dl(d);this._add("keyboard",he),o.interactive&&o.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new ma(d))}_add(o,d,g){this._handlers.push({handlerName:o,handler:d,allowed:g}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Rc(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,d,g){for(const v in o)if(v!==g&&(!d||d.indexOf(v)<0))return!0;return!1}_getMapTouches(o){const d=[];for(const g of o)this._el.contains(g.target)&&d.push(g);return d}mergeHandlerResult(o,d,g,v,A){if(!g)return;r.e(o,g);const O={handlerName:v,originalEvent:g.originalEvent||A};g.zoomDelta!==void 0&&(d.zoom=O),g.panDelta!==void 0&&(d.drag=O),g.pitchDelta!==void 0&&(d.pitch=O),g.bearingDelta!==void 0&&(d.rotate=O)}_applyChanges(){const o={},d={},g={};for(const[v,A,O]of this._changes)v.panDelta&&(o.panDelta=(o.panDelta||new r.P(0,0))._add(v.panDelta)),v.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(o.around=v.around),v.pinchAround!==void 0&&(o.pinchAround=v.pinchAround),v.noInertia&&(o.noInertia=v.noInertia),r.e(d,A),r.e(g,O);this._updateMapTransform(o,d,g),this._changes=[]}_updateMapTransform(o,d,g){const v=this._map,A=v._getTransformForUpdate(),O=v.terrain;if(!(Lc(o)||O&&this._terrainMovement))return this._fireEvents(d,g,!0);let{panDelta:C,zoomDelta:L,bearingDelta:B,pitchDelta:U,around:j,pinchAround:ee}=o;ee!==void 0&&(j=ee),v._stop(!0),j=j||v.transform.centerPoint;const me=A.pointLocation(C?j.sub(C):j);B&&(A.bearing+=B),U&&(A.pitch+=U),L&&(A.zoom+=L),O?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?A.center=A.pointLocation(A.centerPoint.sub(C)):A.setLocationAtPoint(me,j):(this._terrainMovement=!0,this._map._elevationFreeze=!0,A.setLocationAtPoint(me,j),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,A.recalculateZoom(v.terrain)})):A.setLocationAtPoint(me,j),v._applyUpdatedTransform(A),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,g,!0)}_fireEvents(o,d,g){const v=Rc(this._eventsInProgress),A=Rc(o),O={};for(const U in o){const{originalEvent:j}=o[U];this._eventsInProgress[U]||(O[`${U}start`]=j),this._eventsInProgress[U]=o[U]}!v&&A&&this._fireEvent("movestart",A.originalEvent);for(const U in O)this._fireEvent(U,O[U]);A&&this._fireEvent("move",A.originalEvent);for(const U in o){const{originalEvent:j}=o[U];this._fireEvent(U,j)}const C={};let L;for(const U in this._eventsInProgress){const{handlerName:j,originalEvent:ee}=this._eventsInProgress[U];this._handlersById[j].isActive()||(delete this._eventsInProgress[U],L=d[j]||ee,C[`${U}end`]=L)}for(const U in C)this._fireEvent(U,C[U]);const B=Rc(this._eventsInProgress);if(g&&(v||A)&&!B){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=ee=>ee!==0&&-this._bearingSnap<ee&&ee<this._bearingSnap;!U||!U.essential&&r.h.prefersReducedMotion?(this._map.fire(new r.k("moveend",{originalEvent:L})),j(this._map.getBearing())&&this._map.resetNorth()):(j(U.bearing||this._map.getBearing())&&(U.bearing=0),U.freezeElevation=!0,this._map.easeTo(U,{originalEvent:L})),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new r.k(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Gh("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Af extends r.E{constructor(o,d){super(),this._renderFrameCallback=()=>{const g=Math.min((r.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new r.L(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,g){return o=r.P.convert(o).mult(-1),this.panTo(this.transform.center,r.e({offset:o},d),g)}panTo(o,d,g){return this.easeTo(r.e({center:o},d),g)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,g){return this.easeTo(r.e({zoom:o},d),g)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,g){return this.easeTo(r.e({bearing:o},d),g)}resetNorth(o,d){return this.rotateTo(0,r.e({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(r.e({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=Pt.convert(o);const g=d&&d.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),g,d)}_cameraForBoxAndBearing(o,d,g,v){const A={top:0,bottom:0,right:0,left:0};if(typeof(v=r.e({padding:A,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const it=v.padding;v.padding={top:it,bottom:it,right:it,left:it}}v.padding=r.e(A,v.padding);const O=this.transform,C=O.padding,L=O.project(r.L.convert(o)),B=O.project(r.L.convert(d)),U=L.rotate(-g*Math.PI/180),j=B.rotate(-g*Math.PI/180),ee=new r.P(Math.max(U.x,j.x),Math.max(U.y,j.y)),me=new r.P(Math.min(U.x,j.x),Math.min(U.y,j.y)),fe=ee.sub(me),be=(O.width-(C.left+C.right+v.padding.left+v.padding.right))/fe.x,he=(O.height-(C.top+C.bottom+v.padding.top+v.padding.bottom))/fe.y;if(he<0||be<0)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Pe=Math.min(O.scaleZoom(O.scale*Math.min(be,he)),v.maxZoom),Je=r.P.convert(v.offset),Ee=new r.P((v.padding.left-v.padding.right)/2,(v.padding.top-v.padding.bottom)/2).rotate(g*Math.PI/180),Fe=Je.add(Ee).mult(O.scale/O.zoomScale(Pe));return{center:O.unproject(L.add(B).div(2).sub(Fe)),zoom:Pe,bearing:g}}fitBounds(o,d,g){return this._fitInternal(this.cameraForBounds(o,d),d,g)}fitScreenCoordinates(o,d,g,v,A){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(r.P.convert(o)),this.transform.pointLocation(r.P.convert(d)),g,v),v,A)}_fitInternal(o,d,g){return o?(delete(d=r.e(o,d)).padding,d.linear?this.easeTo(d,g):this.flyTo(d,g)):this}jumpTo(o,d){this.stop();const g=this._getTransformForUpdate();let v=!1,A=!1,O=!1;return"zoom"in o&&g.zoom!==+o.zoom&&(v=!0,g.zoom=+o.zoom),o.center!==void 0&&(g.center=r.L.convert(o.center)),"bearing"in o&&g.bearing!==+o.bearing&&(A=!0,g.bearing=+o.bearing),"pitch"in o&&g.pitch!==+o.pitch&&(O=!0,g.pitch=+o.pitch),o.padding==null||g.isPaddingEqual(o.padding)||(g.padding=o.padding),this._applyUpdatedTransform(g),this.fire(new r.k("movestart",d)).fire(new r.k("move",d)),v&&this.fire(new r.k("zoomstart",d)).fire(new r.k("zoom",d)).fire(new r.k("zoomend",d)),A&&this.fire(new r.k("rotatestart",d)).fire(new r.k("rotate",d)).fire(new r.k("rotateend",d)),O&&this.fire(new r.k("pitchstart",d)).fire(new r.k("pitch",d)).fire(new r.k("pitchend",d)),this.fire(new r.k("moveend",d))}calculateCameraOptionsFromTo(o,d,g,v=0){const A=r.U.fromLngLat(o,d),O=r.U.fromLngLat(g,v),C=O.x-A.x,L=O.y-A.y,B=O.z-A.z,U=Math.hypot(C,L,B);if(U===0)throw new Error("Can't calculate camera options with same From and To");const j=Math.hypot(C,L),ee=this.transform.scaleZoom(this.transform.cameraToCenterDistance/U/this.transform.tileSize),me=180*Math.atan2(C,-L)/Math.PI;let fe=180*Math.acos(j/U)/Math.PI;return fe=B<0?90-fe:90+fe,{center:O.toLngLat(),zoom:ee,pitch:fe,bearing:me}}easeTo(o,d){this._stop(!1,o.easeId),((o=r.e({offset:[0,0],duration:500,easing:r.bb},o)).animate===!1||!o.essential&&r.h.prefersReducedMotion)&&(o.duration=0);const g=this._getTransformForUpdate(),v=this.getZoom(),A=this.getBearing(),O=this.getPitch(),C=this.getPadding(),L="zoom"in o?+o.zoom:v,B="bearing"in o?this._normalizeBearing(o.bearing,A):A,U="pitch"in o?+o.pitch:O,j="padding"in o?o.padding:g.padding,ee=r.P.convert(o.offset);let me=g.centerPoint.add(ee);const fe=g.pointLocation(me),be=r.L.convert(o.center||fe);this._normalizeCenter(be);const he=g.project(fe),Pe=g.project(be).sub(he),Je=g.zoomScale(L-v);let Ee,Fe;o.around&&(Ee=r.L.convert(o.around),Fe=g.locationPoint(Ee));const it={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||L!==v,this._rotating=this._rotating||A!==B,this._pitching=this._pitching||U!==O,this._padding=!g.isPaddingEqual(j),this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,it),this.terrain&&this._prepareElevation(be),this._ease(at=>{if(this._zooming&&(g.zoom=r.B.number(v,L,at)),this._rotating&&(g.bearing=r.B.number(A,B,at)),this._pitching&&(g.pitch=r.B.number(O,U,at)),this._padding&&(g.interpolatePadding(C,j,at),me=g.centerPoint.add(ee)),this.terrain&&!o.freezeElevation&&this._updateElevation(at),Ee)g.setLocationAtPoint(Ee,Fe);else{const xt=g.zoomScale(g.zoom-v),Vt=L>v?Math.min(2,Je):Math.max(.5,Je),kt=Math.pow(Vt,1-at),qt=g.unproject(he.add(Pe.mult(at*kt)).mult(xt));g.setLocationAtPoint(g.renderWorldCopies?qt.wrap():qt,me)}this._applyUpdatedTransform(g),this._fireMoveEvents(d)},at=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,at)},o),this}_prepareEase(o,d,g={}){this._moving=!0,d||g.moving||this.fire(new r.k("movestart",o)),this._zooming&&!g.zooming&&this.fire(new r.k("zoomstart",o)),this._rotating&&!g.rotating&&this.fire(new r.k("rotatestart",o)),this._pitching&&!g.pitching&&this.fire(new r.k("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&d!==this._elevationTarget){const g=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(g-(d-(g*o+this._elevationStart))/(1-o)),this._elevationTarget=d}this.transform.elevation=r.B.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(o){if(!this.transformCameraUpdate)return;const d=o.clone(),{center:g,zoom:v,pitch:A,bearing:O,elevation:C}=this.transformCameraUpdate(d);g&&(d.center=g),v!==void 0&&(d.zoom=v),A!==void 0&&(d.pitch=A),O!==void 0&&(d.bearing=O),C!==void 0&&(d.elevation=C),this.transform.apply(d)}_fireMoveEvents(o){this.fire(new r.k("move",o)),this._zooming&&this.fire(new r.k("zoom",o)),this._rotating&&this.fire(new r.k("rotate",o)),this._pitching&&this.fire(new r.k("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const g=this._zooming,v=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new r.k("zoomend",o)),v&&this.fire(new r.k("rotateend",o)),A&&this.fire(new r.k("pitchend",o)),this.fire(new r.k("moveend",o))}flyTo(o,d){if(!o.essential&&r.h.prefersReducedMotion){const wi=r.F(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(wi,d)}this.stop(),o=r.e({offset:[0,0],speed:1.2,curve:1.42,easing:r.bb},o);const g=this._getTransformForUpdate(),v=this.getZoom(),A=this.getBearing(),O=this.getPitch(),C=this.getPadding(),L="zoom"in o?r.ad(+o.zoom,g.minZoom,g.maxZoom):v,B="bearing"in o?this._normalizeBearing(o.bearing,A):A,U="pitch"in o?+o.pitch:O,j="padding"in o?o.padding:g.padding,ee=g.zoomScale(L-v),me=r.P.convert(o.offset);let fe=g.centerPoint.add(me);const be=g.pointLocation(fe),he=r.L.convert(o.center||be);this._normalizeCenter(he);const Pe=g.project(be),Je=g.project(he).sub(Pe);let Ee=o.curve;const Fe=Math.max(g.width,g.height),it=Fe/ee,at=Je.mag();if("minZoom"in o){const wi=r.ad(Math.min(o.minZoom,v,L),g.minZoom,g.maxZoom),Rn=Fe/g.zoomScale(wi-v);Ee=Math.sqrt(Rn/at*2)}const xt=Ee*Ee;function Vt(wi){const Rn=(it*it-Fe*Fe+(wi?-1:1)*xt*xt*at*at)/(2*(wi?it:Fe)*xt*at);return Math.log(Math.sqrt(Rn*Rn+1)-Rn)}function kt(wi){return(Math.exp(wi)-Math.exp(-wi))/2}function qt(wi){return(Math.exp(wi)+Math.exp(-wi))/2}const vi=Vt(!1);let un=function(wi){return qt(vi)/qt(vi+Ee*wi)},ei=function(wi){return Fe*((qt(vi)*(kt(Rn=vi+Ee*wi)/qt(Rn))-kt(vi))/xt)/at;var Rn},Fi=(Vt(!0)-vi)/Ee;if(Math.abs(at)<1e-6||!isFinite(Fi)){if(Math.abs(Fe-it)<1e-6)return this.easeTo(o,d);const wi=it<Fe?-1:1;Fi=Math.abs(Math.log(it/Fe))/Ee,ei=function(){return 0},un=function(Rn){return Math.exp(wi*Ee*Rn)}}return o.duration="duration"in o?+o.duration:1e3*Fi/("screenSpeed"in o?+o.screenSpeed/Ee:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=A!==B,this._pitching=U!==O,this._padding=!g.isPaddingEqual(j),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(he),this._ease(wi=>{const Rn=wi*Fi,ln=1/un(Rn);g.zoom=wi===1?L:v+g.scaleZoom(ln),this._rotating&&(g.bearing=r.B.number(A,B,wi)),this._pitching&&(g.pitch=r.B.number(O,U,wi)),this._padding&&(g.interpolatePadding(C,j,wi),fe=g.centerPoint.add(me)),this.terrain&&!o.freezeElevation&&this._updateElevation(wi);const rn=wi===1?he:g.unproject(Pe.add(Je.mult(ei(Rn))).mult(ln));g.setLocationAtPoint(g.renderWorldCopies?rn.wrap():rn,fe),this._applyUpdatedTransform(g),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,d)}if(!o){const g=this.handlers;g&&g.stop(!1)}return this}_ease(o,d,g){g.animate===!1||g.duration===0?(o(1),d()):(this._easeStart=r.h.now(),this._easeOptions=g,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,d){o=r.b5(o,-180,180);const g=Math.abs(o-d);return Math.abs(o-360-d)<g&&(o-=360),Math.abs(o+360-d)<g&&(o+=360),o}_normalizeCenter(o){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const g=o.lng-d.center.lng;o.lng+=g>180?-360:g<-180?360:0}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(r.L.convert(o),this.transform.tileZoom)-this.transform.elevation:null}}class ea{constructor(o={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=m.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=m.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=m.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){m.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,d){const g=this._map._getUIString(`AttributionControl.${d}`);o.title=g,o.setAttribute("aria-label",g)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const d=this._map.style.sourceCaches;for(const v in d){const A=d[v];if(A.used||A.usedForTerrain){const O=A.getSource();O.attribution&&o.indexOf(O.attribution)<0&&o.push(O.attribution)}}o=o.filter(v=>String(v).trim()),o.sort((v,A)=>v.length-A.length),o=o.filter((v,A)=>{for(let O=A+1;O<o.length;O++)if(o[O].indexOf(v)>=0)return!1;return!0});const g=o.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,o.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class sr{constructor(o={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const g=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact"):g.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=m.create("div","maplibregl-ctrl");const d=m.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){m.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ku{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,g=d?this._queue.concat(d):this._queue;for(const v of g)if(v.id===o)return void(v.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const g of d)if(!g.cancelled&&(g.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Kh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Ef=r.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Tf extends r.E{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,d){this.sourceCache.update(o,d),this._renderableTilesKeys=[];const g={};for(const v of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))g[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.posMatrix=new Float64Array(16),r.aS(v.posMatrix,0,r.N,0,r.N,0,1),this._tiles[v.key]=new zi(v,this.tileSize));for(const v in this._tiles)g[v]||delete this._tiles[v]}freeRtt(o){for(const d in this._tiles){const g=this._tiles[d];(!o||g.tileID.equals(o)||g.tileID.isChildOf(o)||o.isChildOf(g.tileID))&&(g.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const d={};for(const g of this._renderableTilesKeys){const v=this._tiles[g].tileID;if(v.canonical.equals(o.canonical)){const A=o.clone();A.posMatrix=new Float64Array(16),r.aS(A.posMatrix,0,r.N,0,r.N,0,1),d[g]=A}else if(v.canonical.isChildOf(o.canonical)){const A=o.clone();A.posMatrix=new Float64Array(16);const O=v.canonical.z-o.canonical.z,C=v.canonical.x-(v.canonical.x>>O<<O),L=v.canonical.y-(v.canonical.y>>O<<O),B=r.N>>O;r.aS(A.posMatrix,0,B,0,B,0,1),r.$(A.posMatrix,A.posMatrix,[-C*B,-L*B,0]),d[g]=A}else if(o.canonical.isChildOf(v.canonical)){const A=o.clone();A.posMatrix=new Float64Array(16);const O=o.canonical.z-v.canonical.z,C=o.canonical.x-(o.canonical.x>>O<<O),L=o.canonical.y-(o.canonical.y>>O<<O),B=r.N>>O;r.aS(A.posMatrix,0,r.N,0,r.N,0,1),r.$(A.posMatrix,A.posMatrix,[C*B,L*B,0]),r.a0(A.posMatrix,A.posMatrix,[1/2**O,1/2**O,0]),d[g]=A}}return d}getSourceTile(o,d){const g=this.sourceCache._source;let v=o.overscaledZ-this.deltaZoom;if(v>g.maxzoom&&(v=g.maxzoom),v<g.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(v).key);let A=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!A||!A.dem)&&d)for(;v>=g.minzoom&&(!A||!A.dem);)A=this.sourceCache.getTileByID(o.scaledTo(v--).key);return A}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=o)}}class Sf{constructor(o,d,g){this.painter=o,this.sourceCache=new Tf(d),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,d,g,v=r.N){var A;if(!(d>=0&&d<v&&g>=0&&g<v))return 0;const O=this.getTerrainData(o),C=(A=O.tile)===null||A===void 0?void 0:A.dem;if(!C)return 0;const L=function(fe,be,he){var Pe=be[0],Je=be[1];return fe[0]=he[0]*Pe+he[4]*Je+he[12],fe[1]=he[1]*Pe+he[5]*Je+he[13],fe}([],[d/v*r.N,g/v*r.N],O.u_terrain_matrix),B=[L[0]*C.dim,L[1]*C.dim],U=Math.floor(B[0]),j=Math.floor(B[1]),ee=B[0]-U,me=B[1]-j;return C.get(U,j)*(1-ee)*(1-me)+C.get(U+1,j)*ee*(1-me)+C.get(U,j+1)*(1-ee)*me+C.get(U+1,j+1)*ee*me}getElevationForLngLatZoom(o,d){const{tileID:g,mercatorX:v,mercatorY:A}=this._getOverscaledTileIDFromLngLatZoom(o,d);return this.getElevation(g,v%r.N,A%r.N,r.N)}getElevation(o,d,g,v=r.N){return this.getDEMElevation(o,d,g,v)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const v=this.painter.context,A=new r.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new oe(v,A,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new oe(v,new r.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=r.ao([])}const d=this.sourceCache.getSourceTile(o,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const v=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new oe(v,d.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),d.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const g=d&&d+d.tileID.key+o.key;if(g&&!this._demMatrixCache[g]){const v=this.sourceCache.sourceCache._source.maxzoom;let A=o.canonical.z-d.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=v?A=o.canonical.z-v:r.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const O=o.canonical.x-(o.canonical.x>>A<<A),C=o.canonical.y-(o.canonical.y>>A<<A),L=r.bc(new Float64Array(16),[1/(r.N<<A),1/(r.N<<A),0]);r.$(L,L,[O*r.N,C*r.N,0]),this._demMatrixCache[o.key]={matrix:L,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(o){const d=this.painter,g=d.width/devicePixelRatio,v=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new oe(d.context,{width:g,height:v,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new oe(d.context,{width:g,height:v,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(g,v,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,g,v))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let A=0,O=0;A<this._coordsTextureSize;A++)for(let C=0;C<this._coordsTextureSize;C++,O+=4)d[O+0]=255&C,d[O+1]=255&A,d[O+2]=C>>8<<4|A>>8,d[O+3]=0;const g=new r.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),v=new oe(o,g,o.gl.RGBA,{premultiply:!1});return v.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(o){const d=new Uint8Array(4),g=this.painter.context,v=g.gl;g.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,d),g.bindFramebuffer.set(null);const A=d[0]+(d[2]>>4<<8),O=d[1]+((15&d[2])<<8),C=this.coordsIndex[255-d[3]],L=C&&this.sourceCache.getTileByID(C);if(!L)return null;const B=this._coordsTextureSize,U=(1<<L.tileID.canonical.z)*B;return new r.U(this._allowMercatorOverflow(o,(L.tileID.canonical.x*B+A)/U),(L.tileID.canonical.y*B+O)/U,this.getElevation(L.tileID,A,O,B))}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,d=new r.bd,g=new r.b0,v=this.meshSize,A=r.N/v,O=v*v;for(let j=0;j<=v;j++)for(let ee=0;ee<=v;ee++)d.emplaceBack(ee*A,j*A,0);for(let j=0;j<O;j+=v+1)for(let ee=0;ee<v;ee++)g.emplaceBack(ee+j,v+ee+j+1,v+ee+j+2),g.emplaceBack(ee+j,v+ee+j+2,ee+j+1);const C=d.length,L=C+2*(v+1);for(const j of[0,1])for(let ee=0;ee<=v;ee++)for(const me of[0,1])d.emplaceBack(ee*A,j*r.N,me);for(let j=0;j<2*v;j+=2)g.emplaceBack(L+j,L+j+1,L+j+3),g.emplaceBack(L+j,L+j+3,L+j+2),g.emplaceBack(C+j,C+j+3,C+j+1),g.emplaceBack(C+j,C+j+2,C+j+3);const B=d.length,U=B+2*(v+1);for(const j of[0,1])for(let ee=0;ee<=v;ee++)for(const me of[0,1])d.emplaceBack(j*r.N,ee*A,me);for(let j=0;j<2*v;j+=2)g.emplaceBack(B+j,B+j+1,B+j+3),g.emplaceBack(B+j,B+j+3,B+j+2),g.emplaceBack(U+j,U+j+3,U+j+1),g.emplaceBack(U+j,U+j+2,U+j+3);return this._mesh={indexBuffer:o.createIndexBuffer(g),vertexBuffer:o.createVertexBuffer(d,Ef.members),segments:r.S.simpleSegment(0,0,d.length,g.length)},this._mesh}getMeshFrameDelta(o){return 2*Math.PI*r.be/Math.pow(2,o)/5}getMinTileElevationForLngLatZoom(o,d){var g;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(o,d);return(g=this.getMinMaxElevation(v).minElevation)!==null&&g!==void 0?g:0}getMinMaxElevation(o){const d=this.getTerrainData(o).tile,g={minElevation:null,maxElevation:null};return d&&d.dem&&(g.minElevation=d.dem.min*this.exaggeration,g.maxElevation=d.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(o,d){const g=r.U.fromLngLat(o.wrap()),v=(1<<d)*r.N,A=g.x*v,O=g.y*v,C=Math.floor(A/r.N),L=Math.floor(O/r.N);return{tileID:new r.O(d,0,d,C,L),mercatorX:A,mercatorY:O}}_allowMercatorOverflow(o,d){const g=o.x<this.painter.width/2;let v=r.bf(d);const A=this.painter.transform.center.lng;return g&&Math.sign(v)>0&&Math.sign(A)<0||!g&&Math.sign(v)<0&&Math.sign(A)>0?(v=360*Math.sign(A)+v,r.G(v)):d}}class Fp{constructor(o,d,g){this._context=o,this._size=d,this._tileSize=g,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),g=new oe(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return g.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(g.texture),{id:o,fbo:d,texture:g,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>o.id!==d),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const ws={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ou{constructor(o,d){this.painter=o,this.terrain=d,this.pool=new Fp(o.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(g=>!o._layers[g].isHidden(d)),this._coordsDescendingInv={};for(const g in o.sourceCaches){this._coordsDescendingInv[g]={};const v=o.sourceCaches[g].getVisibleCoordinates();for(const A of v){const O=this.terrain.sourceCache.getTerrainCoords(A);for(const C in O)this._coordsDescendingInv[g][C]||(this._coordsDescendingInv[g][C]=[]),this._coordsDescendingInv[g][C].push(O[C])}}this._coordsDescendingInvStr={};for(const g of o._order){const v=o._layers[g],A=v.source;if(ws[v.type]&&!this._coordsDescendingInvStr[A]){this._coordsDescendingInvStr[A]={};for(const O in this._coordsDescendingInv[A])this._coordsDescendingInvStr[A][O]=this._coordsDescendingInv[A][O].map(C=>C.key).sort().join()}}for(const g of this._renderableTiles)for(const v in this._coordsDescendingInvStr){const A=this._coordsDescendingInvStr[v][g.tileID.key];A&&A!==g.rttCoords[v]&&(g.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const d=o.type,g=this.painter,v=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(ws[d]&&(this._prevType&&ws[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(o.id),!v))return!0;if(ws[this._prevType]||ws[d]&&v){this._prevType=d;const A=this._stacks.length-1,O=this._stacks[A]||[];for(const C of this._renderableTiles){if(this.pool.isFull()&&(rr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(C),C.rtt[A]){const B=this.pool.getObjectForId(C.rtt[A].id);if(B.stamp===C.rtt[A].stamp){this.pool.useObject(B);continue}}const L=this.pool.getOrCreateFreeObject();this.pool.useObject(L),this.pool.stampObject(L),C.rtt[A]={id:L.id,stamp:L.stamp},g.context.bindFramebuffer.set(L.fbo.framebuffer),g.context.clear({color:r.aT.transparent,stencil:0}),g.currentStencilSource=void 0;for(let B=0;B<O.length;B++){const U=g.style._layers[O[B]],j=U.source?this._coordsDescendingInv[U.source][C.tileID.key]:[C.tileID];g.context.viewport.set([0,0,L.fbo.width,L.fbo.height]),g._renderTileClippingMasks(U,j),g.renderLayer(g,g.style.sourceCaches[U.source],U,j),U.source&&(C.rttCoords[U.source]=this._coordsDescendingInvStr[U.source][C.tileID.key])}}return rr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ws[d]}return!1}}const Ii=f,Vi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:r.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Pc=x=>{x.touchstart=x.dragStart,x.touchmoveWindow=x.dragMove,x.touchend=x.dragEnd},qh={showCompass:!0,showZoom:!0,visualizePitch:!1};class Zh{constructor(o,d,g=!1){this.mousedown=O=>{this.startMouse(r.e({},O,{ctrlKey:!0,preventDefault:()=>O.preventDefault()}),m.mousePos(this.element,O)),m.addEventListener(window,"mousemove",this.mousemove),m.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=O=>{this.moveMouse(O,m.mousePos(this.element,O))},this.mouseup=O=>{this.mouseRotate.dragEnd(O),this.mousePitch&&this.mousePitch.dragEnd(O),this.offTemp()},this.touchstart=O=>{O.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=m.touchPos(this.element,O.targetTouches)[0],this.startTouch(O,this._startPos),m.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),m.addEventListener(window,"touchend",this.touchend))},this.touchmove=O=>{O.targetTouches.length!==1?this.reset():(this._lastPos=m.touchPos(this.element,O.targetTouches)[0],this.moveTouch(O,this._lastPos))},this.touchend=O=>{O.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const v=o.dragRotate._mouseRotate.getClickTolerance(),A=o.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=Ya({clickTolerance:v,enable:!0}),this.touchRotate=(({enable:O,clickTolerance:C,bearingDegreesPerPixelMoved:L=.8})=>{const B=new hl;return new Ia({clickTolerance:C,move:(U,j)=>({bearingDelta:(j.x-U.x)*L}),moveStateManager:B,enable:O,assignEvents:Pc})})({clickTolerance:v,enable:!0}),this.map=o,g&&(this.mousePitch=Sr({clickTolerance:A,enable:!0}),this.touchPitch=(({enable:O,clickTolerance:C,pitchDegreesPerPixelMoved:L=-.5})=>{const B=new hl;return new Ia({clickTolerance:C,move:(U,j)=>({pitchDelta:(j.y-U.y)*L}),moveStateManager:B,enable:O,assignEvents:Pc})})({clickTolerance:A,enable:!0})),m.addEventListener(d,"mousedown",this.mousedown),m.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),m.addEventListener(d,"touchcancel",this.reset)}startMouse(o,d){this.mouseRotate.dragStart(o,d),this.mousePitch&&this.mousePitch.dragStart(o,d),m.disableDrag()}startTouch(o,d){this.touchRotate.dragStart(o,d),this.touchPitch&&this.touchPitch.dragStart(o,d),m.disableDrag()}moveMouse(o,d){const g=this.map,{bearingDelta:v}=this.mouseRotate.dragMove(o,d)||{};if(v&&g.setBearing(g.getBearing()+v),this.mousePitch){const{pitchDelta:A}=this.mousePitch.dragMove(o,d)||{};A&&g.setPitch(g.getPitch()+A)}}moveTouch(o,d){const g=this.map,{bearingDelta:v}=this.touchRotate.dragMove(o,d)||{};if(v&&g.setBearing(g.getBearing()+v),this.touchPitch){const{pitchDelta:A}=this.touchPitch.dragMove(o,d)||{};A&&g.setPitch(g.getPitch()+A)}}off(){const o=this.element;m.removeEventListener(o,"mousedown",this.mousedown),m.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),m.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),m.removeEventListener(window,"touchend",this.touchend),m.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){m.enableDrag(),m.removeEventListener(window,"mousemove",this.mousemove),m.removeEventListener(window,"mouseup",this.mouseup),m.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),m.removeEventListener(window,"touchend",this.touchend)}}let Dr;function Wh(x,o,d){if(x=new r.L(x.lng,x.lat),o){const g=new r.L(x.lng-360,x.lat),v=new r.L(x.lng+360,x.lat),A=d.locationPoint(x).distSqr(o);d.locationPoint(g).distSqr(o)<A?x=g:d.locationPoint(v).distSqr(o)<A&&(x=v)}for(;Math.abs(x.lng-d.center.lng)>180;){const g=d.locationPoint(x);if(g.x>=0&&g.y>=0&&g.x<=d.width&&g.y<=d.height)break;x.lng>d.center.lng?x.lng-=360:x.lng+=360}return x}const pa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function If(x,o,d){const g=x.classList;for(const v in pa)g.remove(`maplibregl-${d}-anchor-${v}`);g.add(`maplibregl-${d}-anchor-${o}`)}class ml extends r.E{constructor(o){if(super(),this._onKeyPress=d=>{const g=d.code,v=d.charCode||d.keyCode;g!=="Space"&&g!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=d=>{const g=d.originalEvent.target,v=this._element;this._popup&&(g===v||v.contains(g))&&this.togglePopup()},this._update=d=>{if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!g)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Wh(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let A="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?A="rotateX(0deg)":this._pitchAlignment==="map"&&(A=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),m.setTransform(this._element,`${pa[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${A} ${v}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const O=this._map.unproject(this._pos),C=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=O.distanceTo(this._lngLat)>20*C?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=d=>{if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.k("dragstart"))),this.fire(new r.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new r.k("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=r.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=m.create("div"),this._element.setAttribute("aria-label","Map marker");const d=m.createNS("http://www.w3.org/2000/svg","svg"),g=41,v=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${g}px`),d.setAttributeNS(null,"width",`${v}px`),d.setAttributeNS(null,"viewBox",`0 0 ${v} ${g}`);const A=m.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"stroke","none"),A.setAttributeNS(null,"stroke-width","1"),A.setAttributeNS(null,"fill","none"),A.setAttributeNS(null,"fill-rule","evenodd");const O=m.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill-rule","nonzero");const C=m.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Pe of L){const Je=m.createNS("http://www.w3.org/2000/svg","ellipse");Je.setAttributeNS(null,"opacity","0.04"),Je.setAttributeNS(null,"cx","10.5"),Je.setAttributeNS(null,"cy","5.80029008"),Je.setAttributeNS(null,"rx",Pe.rx),Je.setAttributeNS(null,"ry",Pe.ry),C.appendChild(Je)}const B=m.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const U=m.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(U);const j=m.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const ee=m.createNS("http://www.w3.org/2000/svg","path");ee.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild(ee);const me=m.createNS("http://www.w3.org/2000/svg","g");me.setAttributeNS(null,"transform","translate(6.0, 7.0)"),me.setAttributeNS(null,"fill","#FFFFFF");const fe=m.createNS("http://www.w3.org/2000/svg","g");fe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const be=m.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#000000"),be.setAttributeNS(null,"opacity","0.25"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962");const he=m.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#FFFFFF"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962"),fe.appendChild(be),fe.appendChild(he),O.appendChild(C),O.appendChild(B),O.appendChild(j),O.appendChild(me),O.appendChild(fe),d.appendChild(O),d.setAttributeNS(null,"height",g*this._scale+"px"),d.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(d),this._offset=r.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),If(this._element,this._anchor,"marker"),o&&o.className)for(const d of o.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),m.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=r.L.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const v=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(o){return this._offset=r.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const wr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let pr=0,cc=!1;const Nc={maxWidth:100,unit:"metric"};function zc(x,o,d){const g=d&&d.maxWidth||100,v=x._container.clientHeight/2,A=x.unproject([0,v]),O=x.unproject([g,v]),C=A.distanceTo(O);if(d&&d.unit==="imperial"){const L=3.2808*C;L>5280?pl(o,g,L/5280,x._getUIString("ScaleControl.Miles")):pl(o,g,L,x._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?pl(o,g,C/1852,x._getUIString("ScaleControl.NauticalMiles")):C>=1e3?pl(o,g,C/1e3,x._getUIString("ScaleControl.Kilometers")):pl(o,g,C,x._getUIString("ScaleControl.Meters"))}function pl(x,o,d,g){const v=function(A){const O=Math.pow(10,`${Math.floor(A)}`.length-1);let C=A/O;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(L){const B=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*B)/B}(C),O*C}(d);x.style.width=o*(v/d)+"px",x.innerHTML=`${v}&nbsp;${g}`}const Yh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Jh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function uc(x){if(x){if(typeof x=="number"){const o=Math.round(Math.abs(x)/Math.SQRT2);return{center:new r.P(0,0),top:new r.P(0,x),"top-left":new r.P(o,o),"top-right":new r.P(-o,o),bottom:new r.P(0,-x),"bottom-left":new r.P(o,-o),"bottom-right":new r.P(-o,-o),left:new r.P(x,0),right:new r.P(-x,0)}}if(x instanceof r.P||Array.isArray(x)){const o=r.P.convert(x);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:r.P.convert(x.center||[0,0]),top:r.P.convert(x.top||[0,0]),"top-left":r.P.convert(x["top-left"]||[0,0]),"top-right":r.P.convert(x["top-right"]||[0,0]),bottom:r.P.convert(x.bottom||[0,0]),"bottom-left":r.P.convert(x["bottom-left"]||[0,0]),"bottom-right":r.P.convert(x["bottom-right"]||[0,0]),left:r.P.convert(x.left||[0,0]),right:r.P.convert(x.right||[0,0])}}return uc(new r.P(0,0))}const Xh={extend:(x,...o)=>r.e(x,...o),run(x){x()},logToElement(x,o=!1,d="log"){const g=window.document.getElementById(d);g&&(o&&(g.innerHTML=""),g.innerHTML+=`<br>${x}`)}},Qh=f;class Sn{static get version(){return Qh}static get workerCount(){return Gn.workerCount}static set workerCount(o){Gn.workerCount=o}static get maxParallelImageRequests(){return r.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(o){r.c.MAX_PARALLEL_IMAGE_REQUESTS=o}static get workerUrl(){return r.c.WORKER_URL}static set workerUrl(o){r.c.WORKER_URL=o}static addProtocol(o,d){r.c.REGISTERED_PROTOCOLS[o]=d}static removeProtocol(o){delete r.c.REGISTERED_PROTOCOLS[o]}}return Sn.Map=class extends Af{constructor(x){if(r.bg.mark(r.bh.create),(x=r.e({},Vi,x)).minZoom!=null&&x.maxZoom!=null&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(x.minPitch!=null&&x.maxPitch!=null&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(x.minPitch!=null&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(x.maxPitch!=null&&x.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ac(x.minZoom,x.maxZoom,x.minPitch,x.maxPitch,x.renderWorldCopies),{bearingSnap:x.bearingSnap}),this._cooperativeGesturesOnWheel=o=>{this._onCooperativeGesture(o,o[this._metaKey],1)},this._contextLost=o=>{o.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.k("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new r.k("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=x.interactive,this._cooperativeGestures=x.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=x.maxTileCacheSize,this._maxTileCacheZoomLevels=x.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=x.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=x.preserveDrawingBuffer,this._antialias=x.antialias,this._trackResize=x.trackResize,this._bearingSnap=x.bearingSnap,this._refreshExpiredTiles=x.refreshExpiredTiles,this._fadeDuration=x.fadeDuration,this._crossSourceCollisions=x.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=x.collectResourceTiming,this._renderTaskQueue=new ku,this._controls=[],this._mapId=r.a2(),this._locale=r.e({},Kh,x.locale),this._clickTolerance=x.clickTolerance,this._overridePixelRatio=x.pixelRatio,this._maxCanvasSize=x.maxCanvasSize,this.transformCameraUpdate=x.transformCameraUpdate,this._imageQueueHandle=z.addThrottleControl(()=>this.isMoving()),this._requestManager=new K(x.transformRequest),typeof x.container=="string"){if(this._container=document.getElementById(x.container),!this._container)throw new Error(`Container '${x.container}' not found.`)}else{if(!(x.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(x.maxBounds&&this.setMaxBounds(x.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const d=Ge(g=>{this._trackResize&&!this._removed&&this.resize(g)._update()},50);this._resizeObserver=new ResizeObserver(g=>{o?d(g):o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Hh(this,x),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=x.hash&&new ft(typeof x.hash=="string"&&x.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch}),x.bounds&&(this.resize(),this.fitBounds(x.bounds,r.e({},x.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=x.localIdeographFontFamily,this._validateStyle=x.validateStyle,x.style&&this.setStyle(x.style,{localIdeographFontFamily:x.localIdeographFontFamily}),x.attributionControl&&this.addControl(new ea({customAttribution:x.customAttribution})),x.maplibreLogo&&this.addControl(new sr,x.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new r.k(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new r.k(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new r.k("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(x,o){if(o===void 0&&(o=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new r.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=x.onAdd(this);this._controls.push(x);const g=this._controlPositions[o];return o.indexOf("bottom")!==-1?g.insertBefore(d,g.firstChild):g.appendChild(d),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new r.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(x);return o>-1&&this._controls.splice(o,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}calculateCameraOptionsFromTo(x,o,d,g){return g==null&&this.terrain&&(g=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(x,o,d,g)}resize(x){var o;const d=this._containerDimensions(),g=d[0],v=d[1],A=this._getClampedPixelRatio(g,v);if(this._resizeCanvas(g,v,A),this.painter.resize(g,v,A),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const L=this._getClampedPixelRatio(g,v);this._resizeCanvas(g,v,L),this.painter.resize(g,v,L)}this.transform.resize(g,v),(o=this._requestedCameraState)===null||o===void 0||o.resize(g,v);const O=!this._moving;return O&&(this.stop(),this.fire(new r.k("movestart",x)).fire(new r.k("move",x))),this.fire(new r.k("resize",x)),O&&this.fire(new r.k("moveend",x)),this}_getClampedPixelRatio(x,o){const{0:d,1:g}=this._maxCanvasSize,v=this.getPixelRatio(),A=x*v,O=o*v;return Math.min(A>d?d/A:1,O>g?g/O:1)*v}getPixelRatio(){var x;return(x=this._overridePixelRatio)!==null&&x!==void 0?x:devicePixelRatio}setPixelRatio(x){this._overridePixelRatio=x,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(x){return this.transform.setMaxBounds(Pt.convert(x)),this._update()}setMinZoom(x){if((x=x??-2)>=-2&&x<=this.transform.maxZoom)return this.transform.minZoom=x,this._update(),this.getZoom()<x&&this.setZoom(x),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=x??22)>=this.transform.minZoom)return this.transform.maxZoom=x,this._update(),this.getZoom()>x&&this.setZoom(x),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=x??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.minPitch=x,this._update(),this.getPitch()<x&&this.setPitch(x),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=x??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(x>=this.transform.minPitch)return this.transform.maxPitch=x,this._update(),this.getPitch()>x&&this.setPitch(x),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.renderWorldCopies=x,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(x){return this._cooperativeGestures=x,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(x){return this.transform.locationPoint(r.L.convert(x),this.style&&this.terrain)}unproject(x){return this.transform.pointLocation(r.P.convert(x),this.terrain)}isMoving(){var x;return this._moving||((x=this.handlers)===null||x===void 0?void 0:x.isMoving())}isZooming(){var x;return this._zooming||((x=this.handlers)===null||x===void 0?void 0:x.isZooming())}isRotating(){var x;return this._rotating||((x=this.handlers)===null||x===void 0?void 0:x.isRotating())}_createDelegatedListener(x,o,d){if(x==="mouseenter"||x==="mouseover"){let g=!1;return{layer:o,listener:d,delegates:{mousemove:A=>{const O=this.getLayer(o)?this.queryRenderedFeatures(A.point,{layers:[o]}):[];O.length?g||(g=!0,d.call(this,new En(x,this,A.originalEvent,{features:O}))):g=!1},mouseout:()=>{g=!1}}}}if(x==="mouseleave"||x==="mouseout"){let g=!1;return{layer:o,listener:d,delegates:{mousemove:O=>{(this.getLayer(o)?this.queryRenderedFeatures(O.point,{layers:[o]}):[]).length?g=!0:g&&(g=!1,d.call(this,new En(x,this,O.originalEvent)))},mouseout:O=>{g&&(g=!1,d.call(this,new En(x,this,O.originalEvent)))}}}}{const g=v=>{const A=this.getLayer(o)?this.queryRenderedFeatures(v.point,{layers:[o]}):[];A.length&&(v.features=A,d.call(this,v),delete v.features)};return{layer:o,listener:d,delegates:{[x]:g}}}}on(x,o,d){if(d===void 0)return super.on(x,o);const g=this._createDelegatedListener(x,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(g);for(const v in g.delegates)this.on(v,g.delegates[v]);return this}once(x,o,d){if(d===void 0)return super.once(x,o);const g=this._createDelegatedListener(x,o,d);for(const v in g.delegates)this.once(v,g.delegates[v]);return this}off(x,o,d){return d===void 0?super.off(x,o):(this._delegatedListeners&&this._delegatedListeners[x]&&(g=>{const v=this._delegatedListeners[x];for(let A=0;A<v.length;A++){const O=v[A];if(O.layer===o&&O.listener===d){for(const C in O.delegates)this.off(C,O.delegates[C]);return v.splice(A,1),this}}})(),this)}queryRenderedFeatures(x,o){if(!this.style)return[];let d;const g=x instanceof r.P||Array.isArray(x),v=g?x:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(g?{}:x)||{},v instanceof r.P||typeof v[0]=="number")d=[r.P.convert(v)];else{const A=r.P.convert(v[0]),O=r.P.convert(v[1]);d=[A,new r.P(O.x,A.y),O,new r.P(A.x,O.y),A]}return this.style.queryRenderedFeatures(d,o,this.transform)}querySourceFeatures(x,o){return this.style.querySourceFeatures(x,o)}setStyle(x,o){return(o=r.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&x?(this._diffStyle(x,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(x,o))}setTransformRequest(x){return this._requestManager.setTransformRequest(x),this}_getUIString(x){const o=this._locale[x];if(o==null)throw new Error(`Missing UI string '${x}'`);return o}_updateStyle(x,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(x,o));const d=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!x)),x?(this.style=new Br(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof x=="string"?this.style.loadURL(x,o,d):this.style.loadJSON(x,o,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Br(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(x,o){if(typeof x=="string"){const d=this._requestManager.transformRequest(x,H.Style);r.f(d,(g,v)=>{g?this.fire(new r.j(g)):v&&this._updateDiff(v,o)})}else typeof x=="object"&&this._updateDiff(x,o)}_updateDiff(x,o){try{this.style.setState(x,o)&&this._update(!0)}catch(d){r.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(x,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():r.w("There is no style added to the map.")}addSource(x,o){return this._lazyInitEmptyStyle(),this.style.addSource(x,o),this._update(!0)}isSourceLoaded(x){const o=this.style&&this.style.sourceCaches[x];if(o!==void 0)return o.loaded();this.fire(new r.j(new Error(`There is no source with ID '${x}'`)))}setTerrain(x){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),x){const o=this.style.sourceCaches[x.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${x.source}`);for(const d in this.style._layers){const g=this.style._layers[d];g.type==="hillshade"&&g.source===x.source&&r.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Sf(this.painter,o,x),this.painter.renderToTexture=new Ou(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==x.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new r.k("terrain",{terrain:x})),this}getTerrain(){var x,o;return(o=(x=this.terrain)===null||x===void 0?void 0:x.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const x=this.style&&this.style.sourceCaches;for(const o in x){const d=x[o]._tiles;for(const g in d){const v=d[g];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}addSourceType(x,o,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(x,o,d)}removeSource(x){return this.style.removeSource(x),this._update(!0)}getSource(x){return this.style.getSource(x)}addImage(x,o,d={}){const{pixelRatio:g=1,sdf:v=!1,stretchX:A,stretchY:O,content:C}=d;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||r.a(o))){if(o.width===void 0||o.height===void 0)return this.fire(new r.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:L,height:B,data:U}=o,j=o;return this.style.addImage(x,{data:new r.R({width:L,height:B},new Uint8Array(U)),pixelRatio:g,stretchX:A,stretchY:O,content:C,sdf:v,version:0,userImage:j}),j.onAdd&&j.onAdd(this,x),this}}{const{width:L,height:B,data:U}=r.h.getImageData(o);this.style.addImage(x,{data:new r.R({width:L,height:B},U),pixelRatio:g,stretchX:A,stretchY:O,content:C,sdf:v,version:0})}}updateImage(x,o){const d=this.style.getImage(x);if(!d)return this.fire(new r.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=o instanceof HTMLImageElement||r.a(o)?r.h.getImageData(o):o,{width:v,height:A,data:O}=g;if(v===void 0||A===void 0)return this.fire(new r.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==d.data.width||A!==d.data.height)return this.fire(new r.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(o instanceof HTMLImageElement||r.a(o));return d.data.replace(O,C),this.style.updateImage(x,d),this}getImage(x){return this.style.getImage(x)}hasImage(x){return x?!!this.style.getImage(x):(this.fire(new r.j(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(x)}loadImage(x,o){z.getImage(this._requestManager.transformRequest(x,H.Image),o)}listImages(){return this.style.listImages()}addLayer(x,o){return this._lazyInitEmptyStyle(),this.style.addLayer(x,o),this._update(!0)}moveLayer(x,o){return this.style.moveLayer(x,o),this._update(!0)}removeLayer(x){return this.style.removeLayer(x),this._update(!0)}getLayer(x){return this.style.getLayer(x)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(x,o,d){return this.style.setLayerZoomRange(x,o,d),this._update(!0)}setFilter(x,o,d={}){return this.style.setFilter(x,o,d),this._update(!0)}getFilter(x){return this.style.getFilter(x)}setPaintProperty(x,o,d,g={}){return this.style.setPaintProperty(x,o,d,g),this._update(!0)}getPaintProperty(x,o){return this.style.getPaintProperty(x,o)}setLayoutProperty(x,o,d,g={}){return this.style.setLayoutProperty(x,o,d,g),this._update(!0)}getLayoutProperty(x,o){return this.style.getLayoutProperty(x,o)}setGlyphs(x,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(x,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(x,o,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(x,o,d,g=>{g||this._update(!0)}),this}removeSprite(x){return this._lazyInitEmptyStyle(),this.style.removeSprite(x),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(x,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(x,o,d=>{d||this._update(!0)}),this}setLight(x,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(x,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(x,o){return this.style.setFeatureState(x,o),this._update()}removeFeatureState(x,o){return this.style.removeFeatureState(x,o),this._update()}getFeatureState(x){return this.style.getFeatureState(x)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let x=0,o=0;return this._container&&(x=this._container.clientWidth||400,o=this._container.clientHeight||300),[x,o]}_setupContainer(){const x=this._container;x.classList.add("maplibregl-map");const o=this._canvasContainer=m.create("div","maplibregl-canvas-container",x);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=m.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),g=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],g);const v=this._controlContainer=m.create("div","maplibregl-control-container",x),A=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(O=>{A[O]=m.create("div",`maplibregl-ctrl-${O} `,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=m.create("div","maplibregl-cooperative-gesture-screen",this._container);let x=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(x=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${x}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){m.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(x,o,d){this._canvas.width=Math.floor(d*x),this._canvas.height=Math.floor(d*o),this._canvas.style.width=`${x}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const x={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",g=>{o={requestedAttributes:x},g&&(o.statusMessage=g.statusMessage,o.type=g.type)},{once:!0});const d=this._canvas.getContext("webgl2",x)||this._canvas.getContext("webgl",x);if(!d){const g="Failed to initialize WebGL";throw o?(o.message=g,new Error(JSON.stringify(o))):new Error(g)}this.painter=new Wa(d,this.transform),y.testSupport(d)}_onCooperativeGesture(x,o,d){return!o&&d<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(x){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_render(x){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(x),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,A=r.h.now();this.style.zoomHistory.update(v,A);const O=new r.a8(v,{now:A,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),C=O.crossFadingFactor();C===1&&C===this._crossFadingFactor||(d=!0,this._crossFadingFactor=C),this.style.update(O)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new r.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,r.bg.mark(r.bh.load),this.fire(new r.k("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const g=this._sourcesDirty||this._styleDirty||this._placementDirty;return g||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new r.k("idle")),!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,r.bg.mark(r.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var x;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),z.removeThrottleControl(this._imageQueueHandle),(x=this._resizeObserver)===null||x===void 0||x.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),m.remove(this._canvasContainer),m.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),r.bg.clearMetrics(),this._removed=!0,this.fire(new r.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=r.h.frame(x=>{r.bg.frame(x),this._frame=null,this._render(x)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}get version(){return Ii}getCameraTargetElevation(){return this.transform.elevation}},Sn.NavigationControl=class{constructor(x){this._updateZoomButtons=()=>{const o=this._map.getZoom(),d=o===this._map.getMaxZoom(),g=o===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,d)=>{const g=this._map._getUIString(`NavigationControl.${d}`);o.title=g,o.setAttribute("aria-label",g)},this.options=r.e({},qh,x),this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),m.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),m.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=m.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Zh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){m.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(x,o){const d=m.create("button",x,this._container);return d.type="button",d.addEventListener("click",o),d}},Sn.GeolocateControl=class extends r.E{constructor(x){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new r.k("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new r.k("geolocate",o)),this._finish()}},this._updateCamera=o=>{const d=new r.L(o.coords.longitude,o.coords.latitude),g=o.coords.accuracy,v=this._map.getBearing(),A=r.e({bearing:v},this.options.fitBoundsOptions),O=Pt.fromLngLat(d,g);this._map.fitBounds(O,A,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const d=new r.L(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&cc)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new r.k("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=o=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=m.create("button","maplibregl-ctrl-geolocate",this._container),m.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",o===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=m.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ml({element:this._dotElement}),this._circleElement=m.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ml({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new r.k("trackuserlocationend")))})}},this.options=r.e({},wr,x)}onAdd(x){return this._map=x,this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(o,d=!1){Dr===void 0||d?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(g=>{Dr=g.state!=="denied",o(Dr)}).catch(()=>{Dr=!!window.navigator.geolocation,o(Dr)}):(Dr=!!window.navigator.geolocation,o(Dr)):o(Dr)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),m.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,pr=0,cc=!1}_isOutOfMapMaxBounds(x){const o=this._map.getMaxBounds(),d=x.coords;return o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const x=this._map.getBounds(),o=x.getSouthEast(),d=x.getNorthEast(),g=o.distanceTo(d),v=Math.ceil(this._accuracy/(g/this._map._container.clientHeight)*2);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":pr--,cc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new r.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let x;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),pr++,pr>1?(x={maximumAge:6e5,timeout:0},cc=!0):(x=this.options.positionOptions,cc=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,x)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Sn.AttributionControl=ea,Sn.LogoControl=sr,Sn.ScaleControl=class{constructor(x){this._onMove=()=>{zc(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,zc(this._map,this._container,this.options)},this.options=r.e({},Nc,x)}getDefaultPosition(){return"bottom-left"}onAdd(x){return this._map=x,this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){m.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Sn.FullscreenControl=class extends r.E{constructor(x={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,x&&x.container&&(x.container instanceof HTMLElement?this._container=x.container:r.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){m.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const x=this._fullscreenButton=m.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);m.create("span","maplibregl-ctrl-icon",x).setAttribute("aria-hidden","true"),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.title=x}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new r.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new r.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Sn.TerrainControl=class{constructor(x){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=x}onAdd(x){return this._map=x,this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=m.create("button","maplibregl-ctrl-terrain",this._container),m.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){m.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Sn.Popup=class extends r.E{constructor(x){super(),this.remove=()=>(this._content&&m.remove(this._content),this._container&&(m.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new r.k("close")),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=m.create("div","maplibregl-popup",this._map.getContainer()),this._tip=m.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const O of this.options.className.split(" "))this._container.classList.add(O);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Wh(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!o)return;const d=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);let g=this.options.anchor;const v=uc(this.options.offset);if(!g){const O=this._container.offsetWidth,C=this._container.offsetHeight;let L;L=d.y+v.bottom.y<C?["top"]:d.y>this._map.transform.height-C?["bottom"]:[],d.x<O/2?L.push("left"):d.x>this._map.transform.width-O/2&&L.push("right"),g=L.length===0?"bottom":L.join("-")}const A=d.add(v[g]).round();m.setTransform(this._container,`${pa[g]} translate(${A.x}px,${A.y}px)`),If(this._container,g,"popup")},this._onClose=()=>{this.remove()},this.options=r.e(Object.create(Yh),x)}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new r.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(x){return this._lngLat=r.L.convert(x),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(document.createTextNode(x))}setHTML(x){const o=document.createDocumentFragment(),d=document.createElement("body");let g;for(d.innerHTML=x;g=d.firstChild,g;)o.appendChild(g);return this.setDOMContent(o)}getMaxWidth(){var x;return(x=this._container)===null||x===void 0?void 0:x.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=m.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(x),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(x){this._container&&this._container.classList.add(x)}removeClassName(x){this._container&&this._container.classList.remove(x)}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){if(this._container)return this._container.classList.toggle(x)}_createCloseButton(){this.options.closeButton&&(this._closeButton=m.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(Jh);x&&x.focus()}},Sn.Marker=ml,Sn.Style=Br,Sn.LngLat=r.L,Sn.LngLatBounds=Pt,Sn.Point=r.P,Sn.MercatorCoordinate=r.U,Sn.Evented=r.E,Sn.AJAXError=r.bi,Sn.config=r.c,Sn.CanvasSource=dt,Sn.GeoJSONSource=Mi,Sn.ImageSource=ze,Sn.RasterDEMTileSource=Gt,Sn.RasterTileSource=lt,Sn.VectorTileSource=Ht,Sn.VideoSource=$t,Sn.setRTLTextPlugin=r.bj,Sn.getRTLTextPluginStatus=r.bk,Sn.prewarm=function(){jr().acquire(Ui)},Sn.clearPrewarmedResources=function(){const x=vr;x&&(x.isPreloaded()&&x.numActive()===1?(x.release(Ui),vr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Xh.extend(Sn,{isSafari:r.ac,getPerformanceMetrics:r.bg.getPerformanceMetrics}),Sn});var c=s;return c})})(mI);var yZ=mI.exports,gI={exports:{}};(function(t,e){(function(i,n){t.exports=n()})(Jc,function(){var i=function(I,N){var te={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},xe={on:function(Re,Ke,Bt){if(te[Re]===void 0)throw new Error("Invalid event type: "+Re);te[Re].push({selector:Ke,fn:Bt})},render:function(Re){N.store.featureChanged(Re)}},De=function(Re,Ke){for(var Bt=te[Re],Kt=Bt.length;Kt--;){var si=Bt[Kt];if(si.selector(Ke)){si.fn.call(xe,Ke)||N.store.render(),N.ui.updateMapClasses();break}}};return I.start.call(xe),{render:I.render,stop:function(){I.stop&&I.stop()},trash:function(){I.trash&&(I.trash(),N.store.render())},combineFeatures:function(){I.combineFeatures&&I.combineFeatures()},uncombineFeatures:function(){I.uncombineFeatures&&I.uncombineFeatures()},drag:function(Re){De("drag",Re)},click:function(Re){De("click",Re)},mousemove:function(Re){De("mousemove",Re)},mousedown:function(Re){De("mousedown",Re)},mouseup:function(Re){De("mouseup",Re)},mouseout:function(Re){De("mouseout",Re)},keydown:function(Re){De("keydown",Re)},keyup:function(Re){De("keyup",Re)},touchstart:function(Re){De("touchstart",Re)},touchmove:function(Re){De("touchmove",Re)},touchend:function(Re){De("touchend",Re)},tap:function(Re){De("tap",Re)}}};function n(I){return I&&I.__esModule&&Object.prototype.hasOwnProperty.call(I,"default")?I.default:I}function s(I){if(I.__esModule)return I;var N=I.default;if(typeof N=="function"){var te=function xe(){if(this instanceof xe){var De=[null];De.push.apply(De,arguments);var Re=Function.bind.apply(N,De);return new Re}return N.apply(this,arguments)};te.prototype=N.prototype}else te={};return Object.defineProperty(te,"__esModule",{value:!0}),Object.keys(I).forEach(function(xe){var De=Object.getOwnPropertyDescriptor(I,xe);Object.defineProperty(te,xe,De.get?De:{enumerable:!0,get:function(){return I[xe]}})}),te}var l={},c={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},r=c;function f(I){var N=0;if(I&&I.length>0){N+=Math.abs(m(I[0]));for(var te=1;te<I.length;te++)N-=Math.abs(m(I[te]))}return N}function m(I){var N,te,xe,De,Re,Ke,Bt=0,Kt=I.length;if(Kt>2){for(Ke=0;Ke<Kt;Ke++)Ke===Kt-2?(xe=Kt-2,De=Kt-1,Re=0):Ke===Kt-1?(xe=Kt-1,De=0,Re=1):(xe=Ke,De=Ke+1,Re=Ke+2),N=I[xe],te=I[De],Bt+=(y(I[Re][0])-y(N[0]))*Math.sin(y(te[1]));Bt=Bt*r.RADIUS*r.RADIUS/2}return Bt}function y(I){return I*Math.PI/180}l.geometry=function I(N){var te,xe=0;switch(N.type){case"Polygon":return f(N.coordinates);case"MultiPolygon":for(te=0;te<N.coordinates.length;te++)xe+=f(N.coordinates[te]);return xe;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(te=0;te<N.geometries.length;te++)xe+=I(N.geometries[te]);return xe}},l.ring=m;var b={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},E={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},S={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},D={POLYGON:"polygon",LINE:"line_string",POINT:"point"},R={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},z={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},H={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},K={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},W={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},se={ACTIVE:"true",INACTIVE:"false"},Y=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],ne=-85,ue=Object.freeze({__proto__:null,classes:b,sources:E,cursors:S,types:D,geojsonTypes:R,modes:z,events:H,updateActions:K,meta:W,activeStates:se,interactions:Y,LAT_MIN:-90,LAT_RENDERED_MIN:ne,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),ve={Point:0,LineString:1,MultiLineString:1,Polygon:2};function _e(I,N){var te=ve[I.geometry.type]-ve[N.geometry.type];return te===0&&I.geometry.type===R.POLYGON?I.area-N.area:te}function oe(I){return I.map(function(N){return N.geometry.type===R.POLYGON&&(N.area=l.geometry({type:R.FEATURE,property:{},geometry:N.geometry})),N}).sort(_e).map(function(N){return delete N.area,N})}function Be(I,N){return N===void 0&&(N=0),[[I.point.x-N,I.point.y-N],[I.point.x+N,I.point.y+N]]}function mt(I){if(this._items={},this._nums={},this._length=I?I.length:0,I)for(var N=0,te=I.length;N<te;N++)this.add(I[N]),I[N]!==void 0&&(typeof I[N]=="string"?this._items[I[N]]=N:this._nums[I[N]]=N)}mt.prototype.add=function(I){return this.has(I)||(this._length++,typeof I=="string"?this._items[I]=this._length:this._nums[I]=this._length),this},mt.prototype.delete=function(I){return this.has(I)===!1||(this._length--,delete this._items[I],delete this._nums[I]),this},mt.prototype.has=function(I){return(typeof I=="string"||typeof I=="number")&&(this._items[I]!==void 0||this._nums[I]!==void 0)},mt.prototype.values=function(){var I=this,N=[];return Object.keys(this._items).forEach(function(te){N.push({k:te,v:I._items[te]})}),Object.keys(this._nums).forEach(function(te){N.push({k:JSON.parse(te),v:I._nums[te]})}),N.sort(function(te,xe){return te.v-xe.v}).map(function(te){return te.k})},mt.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Le=[W.FEATURE,W.MIDPOINT,W.VERTEX],rt={click:function(I,N,te){return tt(I,N,te,te.options.clickBuffer)},touch:function(I,N,te){return tt(I,N,te,te.options.touchBuffer)}};function tt(I,N,te,xe){if(te.map===null)return[];var De=I?Be(I,xe):N,Re={};te.options.styles&&(Re.layers=te.options.styles.map(function(si){return si.id}).filter(function(si){return te.map.getLayer(si)!=null}));var Ke=te.map.queryRenderedFeatures(De,Re).filter(function(si){return Le.indexOf(si.properties.meta)!==-1}),Bt=new mt,Kt=[];return Ke.forEach(function(si){var oi=si.properties.id;Bt.has(oi)||(Bt.add(oi),Kt.push(si))}),oe(Kt)}function We(I,N){var te=rt.click(I,null,N),xe={mouse:S.NONE};return te[0]&&(xe.mouse=te[0].properties.active===se.ACTIVE?S.MOVE:S.POINTER,xe.feature=te[0].properties.meta),N.events.currentModeName().indexOf("draw")!==-1&&(xe.mouse=S.ADD),N.ui.queueMapClasses(xe),N.ui.updateMapClasses(),te[0]}function Ve(I,N){var te=I.x-N.x,xe=I.y-N.y;return Math.sqrt(te*te+xe*xe)}function St(I,N,te){te===void 0&&(te={});var xe=te.fineTolerance!=null?te.fineTolerance:4,De=te.grossTolerance!=null?te.grossTolerance:12,Re=te.interval!=null?te.interval:500;I.point=I.point||N.point,I.time=I.time||N.time;var Ke=Ve(I.point,N.point);return Ke<xe||Ke<De&&N.time-I.time<Re}function zt(I,N,te){te===void 0&&(te={});var xe=te.tolerance!=null?te.tolerance:25,De=te.interval!=null?te.interval:250;return I.point=I.point||N.point,I.time=I.time||N.time,Ve(I.point,N.point)<xe&&N.time-I.time<De}var mi={exports:{}},vt=mi.exports=function(I,N){if(N||(N=16),I===void 0&&(I=128),I<=0)return"0";for(var te=Math.log(Math.pow(2,I))/Math.log(N),xe=2;te===1/0;xe*=2)te=Math.log(Math.pow(2,I/xe))/Math.log(N)*xe;var De=te-Math.floor(te),Re="";for(xe=0;xe<Math.floor(te);xe++)Re=Math.floor(Math.random()*N).toString(N)+Re;if(De){var Ke=Math.pow(N,De);Re=Math.floor(Math.random()*Ke).toString(N)+Re}var Bt=parseInt(Re,N);return Bt!==1/0&&Bt>=Math.pow(2,I)?vt(I,N):Re};vt.rack=function(I,N,te){var xe=function(Re){var Ke=0;do{if(Ke++>10){if(!te)throw new Error("too many ID collisions, use more bits");I+=te}var Bt=vt(I,N)}while(Object.hasOwnProperty.call(De,Bt));return De[Bt]=Re,Bt},De=xe.hats={};return xe.get=function(Re){return xe.hats[Re]},xe.set=function(Re,Ke){return xe.hats[Re]=Ke,xe},xe.bits=I||128,xe.base=N||16,xe};var pt=n(mi.exports),Pt=function(I,N){this.ctx=I,this.properties=N.properties||{},this.coordinates=N.geometry.coordinates,this.id=N.id||pt(),this.type=N.geometry.type};Pt.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Pt.prototype.incomingCoords=function(I){this.setCoordinates(I)},Pt.prototype.setCoordinates=function(I){this.coordinates=I,this.changed()},Pt.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Pt.prototype.setProperty=function(I,N){this.properties[I]=N},Pt.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:R.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Pt.prototype.internal=function(I){var N={id:this.id,meta:W.FEATURE,"meta:type":this.type,active:se.INACTIVE,mode:I};if(this.ctx.options.userProperties)for(var te in this.properties)N["user_"+te]=this.properties[te];return{type:R.FEATURE,properties:N,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var qe=function(I,N){Pt.call(this,I,N)};(qe.prototype=Object.create(Pt.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},qe.prototype.updateCoordinate=function(I,N,te){this.coordinates=arguments.length===3?[N,te]:[I,N],this.changed()},qe.prototype.getCoordinate=function(){return this.getCoordinates()};var Ht=function(I,N){Pt.call(this,I,N)};(Ht.prototype=Object.create(Pt.prototype)).isValid=function(){return this.coordinates.length>1},Ht.prototype.addCoordinate=function(I,N,te){this.changed();var xe=parseInt(I,10);this.coordinates.splice(xe,0,[N,te])},Ht.prototype.getCoordinate=function(I){var N=parseInt(I,10);return JSON.parse(JSON.stringify(this.coordinates[N]))},Ht.prototype.removeCoordinate=function(I){this.changed(),this.coordinates.splice(parseInt(I,10),1)},Ht.prototype.updateCoordinate=function(I,N,te){var xe=parseInt(I,10);this.coordinates[xe]=[N,te],this.changed()};var lt=function(I,N){Pt.call(this,I,N),this.coordinates=this.coordinates.map(function(te){return te.slice(0,-1)})};(lt.prototype=Object.create(Pt.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(I){return I.length>2})},lt.prototype.incomingCoords=function(I){this.coordinates=I.map(function(N){return N.slice(0,-1)}),this.changed()},lt.prototype.setCoordinates=function(I){this.coordinates=I,this.changed()},lt.prototype.addCoordinate=function(I,N,te){this.changed();var xe=I.split(".").map(function(De){return parseInt(De,10)});this.coordinates[xe[0]].splice(xe[1],0,[N,te])},lt.prototype.removeCoordinate=function(I){this.changed();var N=I.split(".").map(function(xe){return parseInt(xe,10)}),te=this.coordinates[N[0]];te&&(te.splice(N[1],1),te.length<3&&this.coordinates.splice(N[0],1))},lt.prototype.getCoordinate=function(I){var N=I.split(".").map(function(xe){return parseInt(xe,10)}),te=this.coordinates[N[0]];return JSON.parse(JSON.stringify(te[N[1]]))},lt.prototype.getCoordinates=function(){return this.coordinates.map(function(I){return I.concat([I[0]])})},lt.prototype.updateCoordinate=function(I,N,te){this.changed();var xe=I.split("."),De=parseInt(xe[0],10),Re=parseInt(xe[1],10);this.coordinates[De]===void 0&&(this.coordinates[De]=[]),this.coordinates[De][Re]=[N,te]};var Gt={MultiPoint:qe,MultiLineString:Ht,MultiPolygon:lt},Mi=function(I,N,te,xe,De){var Re=te.split("."),Ke=parseInt(Re[0],10),Bt=Re[1]?Re.slice(1).join("."):null;return I[Ke][N](Bt,xe,De)},bt=function(I,N){if(Pt.call(this,I,N),delete this.coordinates,this.model=Gt[N.geometry.type],this.model===void 0)throw new TypeError(N.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(N.geometry.coordinates)};function ze(I){this.map=I.map,this.drawConfig=JSON.parse(JSON.stringify(I.options||{})),this._ctx=I}(bt.prototype=Object.create(Pt.prototype))._coordinatesToFeatures=function(I){var N=this,te=this.model.bind(this);return I.map(function(xe){return new te(N.ctx,{id:pt(),type:R.FEATURE,properties:{},geometry:{coordinates:xe,type:N.type.replace("Multi","")}})})},bt.prototype.isValid=function(){return this.features.every(function(I){return I.isValid()})},bt.prototype.setCoordinates=function(I){this.features=this._coordinatesToFeatures(I),this.changed()},bt.prototype.getCoordinate=function(I){return Mi(this.features,"getCoordinate",I)},bt.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(I){return I.type===R.POLYGON?I.getCoordinates():I.coordinates})))},bt.prototype.updateCoordinate=function(I,N,te){Mi(this.features,"updateCoordinate",I,N,te),this.changed()},bt.prototype.addCoordinate=function(I,N,te){Mi(this.features,"addCoordinate",I,N,te),this.changed()},bt.prototype.removeCoordinate=function(I){Mi(this.features,"removeCoordinate",I),this.changed()},bt.prototype.getFeatures=function(){return this.features},ze.prototype.setSelected=function(I){return this._ctx.store.setSelected(I)},ze.prototype.setSelectedCoordinates=function(I){var N=this;this._ctx.store.setSelectedCoordinates(I),I.reduce(function(te,xe){return te[xe.feature_id]===void 0&&(te[xe.feature_id]=!0,N._ctx.store.get(xe.feature_id).changed()),te},{})},ze.prototype.getSelected=function(){return this._ctx.store.getSelected()},ze.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},ze.prototype.isSelected=function(I){return this._ctx.store.isSelected(I)},ze.prototype.getFeature=function(I){return this._ctx.store.get(I)},ze.prototype.select=function(I){return this._ctx.store.select(I)},ze.prototype.deselect=function(I){return this._ctx.store.deselect(I)},ze.prototype.deleteFeature=function(I,N){return N===void 0&&(N={}),this._ctx.store.delete(I,N)},ze.prototype.addFeature=function(I){return this._ctx.store.add(I)},ze.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},ze.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},ze.prototype.setActionableState=function(I){I===void 0&&(I={});var N={trash:I.trash||!1,combineFeatures:I.combineFeatures||!1,uncombineFeatures:I.uncombineFeatures||!1};return this._ctx.events.actionable(N)},ze.prototype.changeMode=function(I,N,te){return N===void 0&&(N={}),te===void 0&&(te={}),this._ctx.events.changeMode(I,N,te)},ze.prototype.updateUIClasses=function(I){return this._ctx.ui.queueMapClasses(I)},ze.prototype.activateUIButton=function(I){return this._ctx.ui.setActiveButton(I)},ze.prototype.featuresAt=function(I,N,te){if(te===void 0&&(te="click"),te!=="click"&&te!=="touch")throw new Error("invalid buffer type");return rt[te](I,N,this._ctx)},ze.prototype.newFeature=function(I){var N=I.geometry.type;return N===R.POINT?new qe(this._ctx,I):N===R.LINE_STRING?new Ht(this._ctx,I):N===R.POLYGON?new lt(this._ctx,I):new bt(this._ctx,I)},ze.prototype.isInstanceOf=function(I,N){if(I===R.POINT)return N instanceof qe;if(I===R.LINE_STRING)return N instanceof Ht;if(I===R.POLYGON)return N instanceof lt;if(I==="MultiFeature")return N instanceof bt;throw new Error("Unknown feature class: "+I)},ze.prototype.doRender=function(I){return this._ctx.store.featureChanged(I)},ze.prototype.onSetup=function(){},ze.prototype.onDrag=function(){},ze.prototype.onClick=function(){},ze.prototype.onMouseMove=function(){},ze.prototype.onMouseDown=function(){},ze.prototype.onMouseUp=function(){},ze.prototype.onMouseOut=function(){},ze.prototype.onKeyUp=function(){},ze.prototype.onKeyDown=function(){},ze.prototype.onTouchStart=function(){},ze.prototype.onTouchMove=function(){},ze.prototype.onTouchEnd=function(){},ze.prototype.onTap=function(){},ze.prototype.onStop=function(){},ze.prototype.onTrash=function(){},ze.prototype.onCombineFeature=function(){},ze.prototype.onUncombineFeature=function(){},ze.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var $t={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},dt=Object.keys($t);function _t(I){var N=Object.keys(I);return function(te,xe){xe===void 0&&(xe={});var De={},Re=N.reduce(function(Ke,Bt){return Ke[Bt]=I[Bt],Ke},new ze(te));return{start:function(){var Ke=this;De=Re.onSetup(xe),dt.forEach(function(Bt){var Kt,si=$t[Bt],oi=function(){return!1};I[si]&&(oi=function(){return!0}),Ke.on(Bt,oi,(Kt=si,function(Xt){return Re[Kt](De,Xt)}))})},stop:function(){Re.onStop(De)},trash:function(){Re.onTrash(De)},combineFeatures:function(){Re.onCombineFeatures(De)},uncombineFeatures:function(){Re.onUncombineFeatures(De)},render:function(Ke,Bt){Re.toDisplayFeatures(De,Ke,Bt)}}}}function ni(I){return[].concat(I).filter(function(N){return N!==void 0})}function Wi(){var I=this;if(!(I.ctx.map&&I.ctx.map.getSource(E.HOT)!==void 0))return Kt();var N=I.ctx.events.currentModeName();I.ctx.ui.queueMapClasses({mode:N});var te=[],xe=[];I.isDirty?xe=I.getAllIds():(te=I.getChangedIds().filter(function(si){return I.get(si)!==void 0}),xe=I.sources.hot.filter(function(si){return si.properties.id&&te.indexOf(si.properties.id)===-1&&I.get(si.properties.id)!==void 0}).map(function(si){return si.properties.id})),I.sources.hot=[];var De=I.sources.cold.length;I.sources.cold=I.isDirty?[]:I.sources.cold.filter(function(si){var oi=si.properties.id||si.properties.parent;return te.indexOf(oi)===-1});var Re=De!==I.sources.cold.length||xe.length>0;function Ke(si,oi){var Xt=I.get(si).internal(N);I.ctx.events.currentModeRender(Xt,function(qi){I.sources[oi].push(qi)})}if(te.forEach(function(si){return Ke(si,"hot")}),xe.forEach(function(si){return Ke(si,"cold")}),Re&&I.ctx.map.getSource(E.COLD).setData({type:R.FEATURE_COLLECTION,features:I.sources.cold}),I.ctx.map.getSource(E.HOT).setData({type:R.FEATURE_COLLECTION,features:I.sources.hot}),I._emitSelectionChange&&(I.ctx.map.fire(H.SELECTION_CHANGE,{features:I.getSelected().map(function(si){return si.toGeoJSON()}),points:I.getSelectedCoordinates().map(function(si){return{type:R.FEATURE,properties:{},geometry:{type:R.POINT,coordinates:si.coordinates}}})}),I._emitSelectionChange=!1),I._deletedFeaturesToEmit.length){var Bt=I._deletedFeaturesToEmit.map(function(si){return si.toGeoJSON()});I._deletedFeaturesToEmit=[],I.ctx.map.fire(H.DELETE,{features:Bt})}function Kt(){I.isDirty=!1,I.clearChangedIds()}Kt(),I.ctx.map.fire(H.RENDER,{})}function ct(I){var N,te=this;this._features={},this._featureIds=new mt,this._selectedFeatureIds=new mt,this._selectedCoordinates=[],this._changedFeatureIds=new mt,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=I,this.sources={hot:[],cold:[]},this.render=function(){N||(N=requestAnimationFrame(function(){N=null,Wi.call(te)}))},this.isDirty=!1}function et(I,N){var te=I._selectedCoordinates.filter(function(xe){return I._selectedFeatureIds.has(xe.feature_id)});I._selectedCoordinates.length===te.length||N.silent||(I._emitSelectionChange=!0),I._selectedCoordinates=te}ct.prototype.createRenderBatch=function(){var I=this,N=this.render,te=0;return this.render=function(){te++},function(){I.render=N,te>0&&I.render()}},ct.prototype.setDirty=function(){return this.isDirty=!0,this},ct.prototype.featureChanged=function(I){return this._changedFeatureIds.add(I),this},ct.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},ct.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},ct.prototype.getAllIds=function(){return this._featureIds.values()},ct.prototype.add=function(I){return this.featureChanged(I.id),this._features[I.id]=I,this._featureIds.add(I.id),this},ct.prototype.delete=function(I,N){var te=this;return N===void 0&&(N={}),ni(I).forEach(function(xe){te._featureIds.has(xe)&&(te._featureIds.delete(xe),te._selectedFeatureIds.delete(xe),N.silent||te._deletedFeaturesToEmit.indexOf(te._features[xe])===-1&&te._deletedFeaturesToEmit.push(te._features[xe]),delete te._features[xe],te.isDirty=!0)}),et(this,N),this},ct.prototype.get=function(I){return this._features[I]},ct.prototype.getAll=function(){var I=this;return Object.keys(this._features).map(function(N){return I._features[N]})},ct.prototype.select=function(I,N){var te=this;return N===void 0&&(N={}),ni(I).forEach(function(xe){te._selectedFeatureIds.has(xe)||(te._selectedFeatureIds.add(xe),te._changedFeatureIds.add(xe),N.silent||(te._emitSelectionChange=!0))}),this},ct.prototype.deselect=function(I,N){var te=this;return N===void 0&&(N={}),ni(I).forEach(function(xe){te._selectedFeatureIds.has(xe)&&(te._selectedFeatureIds.delete(xe),te._changedFeatureIds.add(xe),N.silent||(te._emitSelectionChange=!0))}),et(this,N),this},ct.prototype.clearSelected=function(I){return I===void 0&&(I={}),this.deselect(this._selectedFeatureIds.values(),{silent:I.silent}),this},ct.prototype.setSelected=function(I,N){var te=this;return N===void 0&&(N={}),I=ni(I),this.deselect(this._selectedFeatureIds.values().filter(function(xe){return I.indexOf(xe)===-1}),{silent:N.silent}),this.select(I.filter(function(xe){return!te._selectedFeatureIds.has(xe)}),{silent:N.silent}),this},ct.prototype.setSelectedCoordinates=function(I){return this._selectedCoordinates=I,this._emitSelectionChange=!0,this},ct.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},ct.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},ct.prototype.getSelected=function(){var I=this;return this._selectedFeatureIds.values().map(function(N){return I.get(N)})},ct.prototype.getSelectedCoordinates=function(){var I=this;return this._selectedCoordinates.map(function(N){return{coordinates:I.get(N.feature_id).getCoordinate(N.coord_path)}})},ct.prototype.isSelected=function(I){return this._selectedFeatureIds.has(I)},ct.prototype.setFeatureProperty=function(I,N,te){this.get(I).setProperty(N,te),this.featureChanged(I)},ct.prototype.storeMapConfig=function(){var I=this;Y.forEach(function(N){I.ctx.map[N]&&(I._mapInitialConfig[N]=I.ctx.map[N].isEnabled())})},ct.prototype.restoreMapConfig=function(){var I=this;Object.keys(this._mapInitialConfig).forEach(function(N){I._mapInitialConfig[N]?I.ctx.map[N].enable():I.ctx.map[N].disable()})},ct.prototype.getInitialConfigValue=function(I){return this._mapInitialConfig[I]===void 0||this._mapInitialConfig[I]};var zi=function(){for(var I=arguments,N={},te=0;te<arguments.length;te++){var xe=I[te];for(var De in xe)zn.call(xe,De)&&(N[De]=xe[De])}return N},zn=Object.prototype.hasOwnProperty,Xe=n(zi),On=["mode","feature","mouse"];function Rt(I){var N=null,te=null,xe={onRemove:function(){return I.map.off("load",xe.connect),clearInterval(te),xe.removeLayers(),I.store.restoreMapConfig(),I.ui.removeButtons(),I.events.removeEventListeners(),I.ui.clearMapClasses(),I.boxZoomInitial&&I.map.boxZoom.enable(),I.map=null,I.container=null,I.store=null,N&&N.parentNode&&N.parentNode.removeChild(N),N=null,this},connect:function(){I.map.off("load",xe.connect),clearInterval(te),xe.addLayers(),I.store.storeMapConfig(),I.events.addEventListeners()},onAdd:function(De){var Re=De.fire;return De.fire=function(Ke,Bt){var Kt=arguments;return Re.length===1&&arguments.length!==1&&(Kt=[Xe({},{type:Ke},Bt)]),Re.apply(De,Kt)},I.map=De,I.events=function(Ke){var Bt=Object.keys(Ke.options.modes).reduce(function(Tt,xi){return Tt[xi]=_t(Ke.options.modes[xi]),Tt},{}),Kt={},si={},oi={},Xt=null,qi=null;oi.drag=function(Tt,xi){xi({point:Tt.point,time:new Date().getTime()})?(Ke.ui.queueMapClasses({mouse:S.DRAG}),qi.drag(Tt)):Tt.originalEvent.stopPropagation()},oi.mousedrag=function(Tt){oi.drag(Tt,function(xi){return!St(Kt,xi)})},oi.touchdrag=function(Tt){oi.drag(Tt,function(xi){return!zt(si,xi)})},oi.mousemove=function(Tt){if((Tt.originalEvent.buttons!==void 0?Tt.originalEvent.buttons:Tt.originalEvent.which)===1)return oi.mousedrag(Tt);var xi=We(Tt,Ke);Tt.featureTarget=xi,qi.mousemove(Tt)},oi.mousedown=function(Tt){Kt={time:new Date().getTime(),point:Tt.point};var xi=We(Tt,Ke);Tt.featureTarget=xi,qi.mousedown(Tt)},oi.mouseup=function(Tt){var xi=We(Tt,Ke);Tt.featureTarget=xi,St(Kt,{point:Tt.point,time:new Date().getTime()})?qi.click(Tt):qi.mouseup(Tt)},oi.mouseout=function(Tt){qi.mouseout(Tt)},oi.touchstart=function(Tt){if(Ke.options.touchEnabled){si={time:new Date().getTime(),point:Tt.point};var xi=rt.touch(Tt,null,Ke)[0];Tt.featureTarget=xi,qi.touchstart(Tt)}},oi.touchmove=function(Tt){if(Ke.options.touchEnabled)return qi.touchmove(Tt),oi.touchdrag(Tt)},oi.touchend=function(Tt){if(Tt.originalEvent.preventDefault(),Ke.options.touchEnabled){var xi=rt.touch(Tt,null,Ke)[0];Tt.featureTarget=xi,zt(si,{time:new Date().getTime(),point:Tt.point})?qi.tap(Tt):qi.touchend(Tt)}};var tr=function(Tt){return!(Tt===8||Tt===46||Tt>=48&&Tt<=57)};function Yi(Tt,xi,wn){wn===void 0&&(wn={}),qi.stop();var ir=Bt[Tt];if(ir===void 0)throw new Error(Tt+" is not valid");Xt=Tt;var ur=ir(Ke,xi);qi=i(ur,Ke),wn.silent||Ke.map.fire(H.MODE_CHANGE,{mode:Tt}),Ke.store.setDirty(),Ke.store.render()}oi.keydown=function(Tt){(Tt.srcElement||Tt.target).classList.contains("mapboxgl-canvas")&&(Tt.keyCode!==8&&Tt.keyCode!==46||!Ke.options.controls.trash?tr(Tt.keyCode)?qi.keydown(Tt):Tt.keyCode===49&&Ke.options.controls.point?Yi(z.DRAW_POINT):Tt.keyCode===50&&Ke.options.controls.line_string?Yi(z.DRAW_LINE_STRING):Tt.keyCode===51&&Ke.options.controls.polygon&&Yi(z.DRAW_POLYGON):(Tt.preventDefault(),qi.trash()))},oi.keyup=function(Tt){tr(Tt.keyCode)&&qi.keyup(Tt)},oi.zoomend=function(){Ke.store.changeZoom()},oi.data=function(Tt){if(Tt.dataType==="style"){var xi=Ke.setup,wn=Ke.map,ir=Ke.options,ur=Ke.store;ir.styles.some(function(cs){return wn.getLayer(cs.id)})||(xi.addLayers(),ur.setDirty(),ur.render())}};var br={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){Xt=Ke.options.defaultMode,qi=i(Bt[Xt](Ke),Ke)},changeMode:Yi,actionable:function(Tt){var xi=!1;Object.keys(Tt).forEach(function(wn){if(br[wn]===void 0)throw new Error("Invalid action type");br[wn]!==Tt[wn]&&(xi=!0),br[wn]=Tt[wn]}),xi&&Ke.map.fire(H.ACTIONABLE,{actions:br})},currentModeName:function(){return Xt},currentModeRender:function(Tt,xi){return qi.render(Tt,xi)},fire:function(Tt,xi){oi[Tt]&&oi[Tt](xi)},addEventListeners:function(){Ke.map.on("mousemove",oi.mousemove),Ke.map.on("mousedown",oi.mousedown),Ke.map.on("mouseup",oi.mouseup),Ke.map.on("data",oi.data),Ke.map.on("touchmove",oi.touchmove),Ke.map.on("touchstart",oi.touchstart),Ke.map.on("touchend",oi.touchend),Ke.container.addEventListener("mouseout",oi.mouseout),Ke.options.keybindings&&(Ke.container.addEventListener("keydown",oi.keydown),Ke.container.addEventListener("keyup",oi.keyup))},removeEventListeners:function(){Ke.map.off("mousemove",oi.mousemove),Ke.map.off("mousedown",oi.mousedown),Ke.map.off("mouseup",oi.mouseup),Ke.map.off("data",oi.data),Ke.map.off("touchmove",oi.touchmove),Ke.map.off("touchstart",oi.touchstart),Ke.map.off("touchend",oi.touchend),Ke.container.removeEventListener("mouseout",oi.mouseout),Ke.options.keybindings&&(Ke.container.removeEventListener("keydown",oi.keydown),Ke.container.removeEventListener("keyup",oi.keyup))},trash:function(Tt){qi.trash(Tt)},combineFeatures:function(){qi.combineFeatures()},uncombineFeatures:function(){qi.uncombineFeatures()},getMode:function(){return Xt}}}(I),I.ui=function(Ke){var Bt={},Kt=null,si={mode:null,feature:null,mouse:null},oi={mode:null,feature:null,mouse:null};function Xt(Tt){oi=Xe(oi,Tt)}function qi(){var Tt,xi;if(Ke.container){var wn=[],ir=[];On.forEach(function(ur){oi[ur]!==si[ur]&&(wn.push(ur+"-"+si[ur]),oi[ur]!==null&&ir.push(ur+"-"+oi[ur]))}),wn.length>0&&(Tt=Ke.container.classList).remove.apply(Tt,wn),ir.length>0&&(xi=Ke.container.classList).add.apply(xi,ir),si=Xe(si,oi)}}function tr(Tt,xi){xi===void 0&&(xi={});var wn=document.createElement("button");return wn.className=b.CONTROL_BUTTON+" "+xi.className,wn.setAttribute("title",xi.title),xi.container.appendChild(wn),wn.addEventListener("click",function(ir){if(ir.preventDefault(),ir.stopPropagation(),ir.target===Kt)return Yi(),void xi.onDeactivate();br(Tt),xi.onActivate()},!0),wn}function Yi(){Kt&&(Kt.classList.remove(b.ACTIVE_BUTTON),Kt=null)}function br(Tt){Yi();var xi=Bt[Tt];xi&&xi&&Tt!=="trash"&&(xi.classList.add(b.ACTIVE_BUTTON),Kt=xi)}return{setActiveButton:br,queueMapClasses:Xt,updateMapClasses:qi,clearMapClasses:function(){Xt({mode:null,feature:null,mouse:null}),qi()},addButtons:function(){var Tt=Ke.options.controls,xi=document.createElement("div");return xi.className=b.CONTROL_GROUP+" "+b.CONTROL_BASE,Tt&&(Tt[D.LINE]&&(Bt[D.LINE]=tr(D.LINE,{container:xi,className:b.CONTROL_BUTTON_LINE,title:"LineString tool "+(Ke.options.keybindings?"(l)":""),onActivate:function(){return Ke.events.changeMode(z.DRAW_LINE_STRING)},onDeactivate:function(){return Ke.events.trash()}})),Tt[D.POLYGON]&&(Bt[D.POLYGON]=tr(D.POLYGON,{container:xi,className:b.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(Ke.options.keybindings?"(p)":""),onActivate:function(){return Ke.events.changeMode(z.DRAW_POLYGON)},onDeactivate:function(){return Ke.events.trash()}})),Tt[D.POINT]&&(Bt[D.POINT]=tr(D.POINT,{container:xi,className:b.CONTROL_BUTTON_POINT,title:"Marker tool "+(Ke.options.keybindings?"(m)":""),onActivate:function(){return Ke.events.changeMode(z.DRAW_POINT)},onDeactivate:function(){return Ke.events.trash()}})),Tt.trash&&(Bt.trash=tr("trash",{container:xi,className:b.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){Ke.events.trash()}})),Tt.combine_features&&(Bt.combine_features=tr("combineFeatures",{container:xi,className:b.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){Ke.events.combineFeatures()}})),Tt.uncombine_features&&(Bt.uncombine_features=tr("uncombineFeatures",{container:xi,className:b.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){Ke.events.uncombineFeatures()}}))),xi},removeButtons:function(){Object.keys(Bt).forEach(function(Tt){var xi=Bt[Tt];xi.parentNode&&xi.parentNode.removeChild(xi),delete Bt[Tt]})}}}(I),I.container=De.getContainer(),I.store=new ct(I),N=I.ui.addButtons(),I.options.boxSelect&&(I.boxZoomInitial=De.boxZoom.isEnabled(),De.boxZoom.disable(),De.dragPan.disable(),De.dragPan.enable()),De.loaded()?xe.connect():(De.on("load",xe.connect),te=setInterval(function(){De.loaded()&&xe.connect()},16)),I.events.start(),N},addLayers:function(){I.map.addSource(E.COLD,{data:{type:R.FEATURE_COLLECTION,features:[]},type:"geojson"}),I.map.addSource(E.HOT,{data:{type:R.FEATURE_COLLECTION,features:[]},type:"geojson"}),I.options.styles.forEach(function(De){I.map.addLayer(De)}),I.store.setDirty(!0),I.store.render()},removeLayers:function(){I.options.styles.forEach(function(De){I.map.getLayer(De.id)&&I.map.removeLayer(De.id)}),I.map.getSource(E.COLD)&&I.map.removeSource(E.COLD),I.map.getSource(E.HOT)&&I.map.removeSource(E.HOT)}};return I.setup=xe,xe}var Xi=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Ui(I){return function(N){var te=N.featureTarget;return!!te&&!!te.properties&&te.properties.meta===I}}function Gn(I){return!!I.originalEvent&&!!I.originalEvent.shiftKey&&I.originalEvent.button===0}function mr(I){return!!I.featureTarget&&!!I.featureTarget.properties&&I.featureTarget.properties.active===se.ACTIVE&&I.featureTarget.properties.meta===W.FEATURE}function vr(I){return!!I.featureTarget&&!!I.featureTarget.properties&&I.featureTarget.properties.active===se.INACTIVE&&I.featureTarget.properties.meta===W.FEATURE}function jr(I){return I.featureTarget===void 0}function Cr(I){return!!I.featureTarget&&!!I.featureTarget.properties&&I.featureTarget.properties.meta===W.FEATURE}function lr(I){var N=I.featureTarget;return!!N&&!!N.properties&&N.properties.meta===W.VERTEX}function Hn(I){return!!I.originalEvent&&I.originalEvent.shiftKey===!0}function Nt(I){return I.keyCode===27}function Qi(I){return I.keyCode===13}var Qe=Object.freeze({__proto__:null,isOfMetaType:Ui,isShiftMousedown:Gn,isActiveFeature:mr,isInactiveFeature:vr,noTarget:jr,isFeature:Cr,isVertex:lr,isShiftDown:Hn,isEscapeKey:Nt,isEnterKey:Qi,isTrue:function(){return!0}}),Ki=Gi;function Gi(I,N){this.x=I,this.y=N}Gi.prototype={clone:function(){return new Gi(this.x,this.y)},add:function(I){return this.clone()._add(I)},sub:function(I){return this.clone()._sub(I)},multByPoint:function(I){return this.clone()._multByPoint(I)},divByPoint:function(I){return this.clone()._divByPoint(I)},mult:function(I){return this.clone()._mult(I)},div:function(I){return this.clone()._div(I)},rotate:function(I){return this.clone()._rotate(I)},rotateAround:function(I,N){return this.clone()._rotateAround(I,N)},matMult:function(I){return this.clone()._matMult(I)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(I){return this.x===I.x&&this.y===I.y},dist:function(I){return Math.sqrt(this.distSqr(I))},distSqr:function(I){var N=I.x-this.x,te=I.y-this.y;return N*N+te*te},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(I){return Math.atan2(this.y-I.y,this.x-I.x)},angleWith:function(I){return this.angleWithSep(I.x,I.y)},angleWithSep:function(I,N){return Math.atan2(this.x*N-this.y*I,this.x*I+this.y*N)},_matMult:function(I){var N=I[0]*this.x+I[1]*this.y,te=I[2]*this.x+I[3]*this.y;return this.x=N,this.y=te,this},_add:function(I){return this.x+=I.x,this.y+=I.y,this},_sub:function(I){return this.x-=I.x,this.y-=I.y,this},_mult:function(I){return this.x*=I,this.y*=I,this},_div:function(I){return this.x/=I,this.y/=I,this},_multByPoint:function(I){return this.x*=I.x,this.y*=I.y,this},_divByPoint:function(I){return this.x/=I.x,this.y/=I.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var I=this.y;return this.y=this.x,this.x=-I,this},_rotate:function(I){var N=Math.cos(I),te=Math.sin(I),xe=N*this.x-te*this.y,De=te*this.x+N*this.y;return this.x=xe,this.y=De,this},_rotateAround:function(I,N){var te=Math.cos(I),xe=Math.sin(I),De=N.x+te*(this.x-N.x)-xe*(this.y-N.y),Re=N.y+xe*(this.x-N.x)+te*(this.y-N.y);return this.x=De,this.y=Re,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Gi.convert=function(I){return I instanceof Gi?I:Array.isArray(I)?new Gi(I[0],I[1]):I};var Lt=n(Ki);function Bi(I,N){var te=N.getBoundingClientRect();return new Lt(I.clientX-te.left-(N.clientLeft||0),I.clientY-te.top-(N.clientTop||0))}function ii(I,N,te,xe){return{type:R.FEATURE,properties:{meta:W.VERTEX,parent:I,coord_path:te,active:xe?se.ACTIVE:se.INACTIVE},geometry:{type:R.POINT,coordinates:N}}}function Bn(I,N,te){var xe=N.geometry.coordinates,De=te.geometry.coordinates;if(xe[1]>85||xe[1]<ne||De[1]>85||De[1]<ne)return null;var Re={lng:(xe[0]+De[0])/2,lat:(xe[1]+De[1])/2};return{type:R.FEATURE,properties:{meta:W.MIDPOINT,parent:I,lng:Re.lng,lat:Re.lat,coord_path:te.properties.coord_path},geometry:{type:R.POINT,coordinates:[Re.lng,Re.lat]}}}function st(I,N,te){N===void 0&&(N={}),te===void 0&&(te=null);var xe,De=I.geometry,Re=De.type,Ke=De.coordinates,Bt=I.properties&&I.properties.id,Kt=[];function si(Xt,qi){var tr="",Yi=null;Xt.forEach(function(br,Tt){var xi=qi!=null?qi+"."+Tt:String(Tt),wn=ii(Bt,br,xi,oi(xi));if(N.midpoints&&Yi){var ir=Bn(Bt,Yi,wn);ir&&Kt.push(ir)}Yi=wn;var ur=JSON.stringify(br);tr!==ur&&Kt.push(wn),Tt===0&&(tr=ur)})}function oi(Xt){return!!N.selectedPaths&&N.selectedPaths.indexOf(Xt)!==-1}return Re===R.POINT?Kt.push(ii(Bt,Ke,te,oi(te))):Re===R.POLYGON?Ke.forEach(function(Xt,qi){si(Xt,te!==null?te+"."+qi:String(qi))}):Re===R.LINE_STRING?si(Ke,te):Re.indexOf(R.MULTI_PREFIX)===0&&(xe=Re.replace(R.MULTI_PREFIX,""),Ke.forEach(function(Xt,qi){var tr={type:R.FEATURE,properties:I.properties,geometry:{type:xe,coordinates:Xt}};Kt=Kt.concat(st(tr,N,qi))})),Kt}var Q={enable:function(I){setTimeout(function(){I.map&&I.map.doubleClickZoom&&I._ctx&&I._ctx.store&&I._ctx.store.getInitialConfigValue&&I._ctx.store.getInitialConfigValue("doubleClickZoom")&&I.map.doubleClickZoom.enable()},0)},disable:function(I){setTimeout(function(){I.map&&I.map.doubleClickZoom&&I.map.doubleClickZoom.disable()},0)}},ge={exports:{}},Z=function(I){if(!I||!I.type)return null;var N=V[I.type];if(!N)return null;if(N==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:I}]};if(N==="feature")return{type:"FeatureCollection",features:[I]};if(N==="featurecollection")return I},V={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},q=n(Z),J=Object.freeze({__proto__:null,default:function I(N){switch(N&&N.type||null){case"FeatureCollection":return N.features=N.features.reduce(function(te,xe){return te.concat(I(xe))},[]),N;case"Feature":return N.geometry?I(N.geometry).map(function(te){var xe={type:"Feature",properties:JSON.parse(JSON.stringify(N.properties)),geometry:te};return N.id!==void 0&&(xe.id=N.id),xe}):[N];case"MultiPoint":return N.coordinates.map(function(te){return{type:"Point",coordinates:te}});case"MultiPolygon":return N.coordinates.map(function(te){return{type:"Polygon",coordinates:te}});case"MultiLineString":return N.coordinates.map(function(te){return{type:"LineString",coordinates:te}});case"GeometryCollection":return N.geometries.map(I).reduce(function(te,xe){return te.concat(xe)},[]);case"Point":case"Polygon":case"LineString":return[N]}}}),le=Z,ce=s(J),Oe=function(I){return function N(te){return Array.isArray(te)&&te.length&&typeof te[0]=="number"?[te]:te.reduce(function(xe,De){return Array.isArray(De)&&Array.isArray(De[0])?xe.concat(N(De)):(xe.push(De),xe)},[])}(I)};ce instanceof Function||(ce=ce.default);var Ae={exports:{}},ye=Ae.exports=function(I){return new Ce(I)};function Ce(I){this.value=I}function ot(I,N,te){var xe=[],De=[],Re=!0;return function Ke(Bt){var Kt=te?gt(Bt):Bt,si={},oi=!0,Xt={node:Kt,node_:Bt,path:[].concat(xe),parent:De[De.length-1],parents:De,key:xe.slice(-1)[0],isRoot:xe.length===0,level:xe.length,circular:null,update:function(Yi,br){Xt.isRoot||(Xt.parent.node[Xt.key]=Yi),Xt.node=Yi,br&&(oi=!1)},delete:function(Yi){delete Xt.parent.node[Xt.key],Yi&&(oi=!1)},remove:function(Yi){Oi(Xt.parent.node)?Xt.parent.node.splice(Xt.key,1):delete Xt.parent.node[Xt.key],Yi&&(oi=!1)},keys:null,before:function(Yi){si.before=Yi},after:function(Yi){si.after=Yi},pre:function(Yi){si.pre=Yi},post:function(Yi){si.post=Yi},stop:function(){Re=!1},block:function(){oi=!1}};if(!Re)return Xt;function qi(){if(typeof Xt.node=="object"&&Xt.node!==null){Xt.keys&&Xt.node_===Xt.node||(Xt.keys=ht(Xt.node)),Xt.isLeaf=Xt.keys.length==0;for(var Yi=0;Yi<De.length;Yi++)if(De[Yi].node_===Bt){Xt.circular=De[Yi];break}}else Xt.isLeaf=!0,Xt.keys=null;Xt.notLeaf=!Xt.isLeaf,Xt.notRoot=!Xt.isRoot}qi();var tr=N.call(Xt,Xt.node);return tr!==void 0&&Xt.update&&Xt.update(tr),si.before&&si.before.call(Xt,Xt.node),oi&&(typeof Xt.node!="object"||Xt.node===null||Xt.circular||(De.push(Xt),qi(),ai(Xt.keys,function(Yi,br){xe.push(Yi),si.pre&&si.pre.call(Xt,Xt.node[Yi],Yi);var Tt=Ke(Xt.node[Yi]);te&&_i.call(Xt.node,Yi)&&(Xt.node[Yi]=Tt.node),Tt.isLast=br==Xt.keys.length-1,Tt.isFirst=br==0,si.post&&si.post.call(Xt,Tt),xe.pop()}),De.pop()),si.after&&si.after.call(Xt,Xt.node)),Xt}(I).node}function gt(I){if(typeof I=="object"&&I!==null){var N;if(Oi(I))N=[];else if(di(I)==="[object Date]")N=new Date(I.getTime?I.getTime():I);else if(function(De){return di(De)==="[object RegExp]"}(I))N=new RegExp(I);else if(function(De){return di(De)==="[object Error]"}(I))N={message:I.message};else if(function(De){return di(De)==="[object Boolean]"}(I))N=new Boolean(I);else if(function(De){return di(De)==="[object Number]"}(I))N=new Number(I);else if(function(De){return di(De)==="[object String]"}(I))N=new String(I);else if(Object.create&&Object.getPrototypeOf)N=Object.create(Object.getPrototypeOf(I));else if(I.constructor===Object)N={};else{var te=I.constructor&&I.constructor.prototype||I.__proto__||{},xe=function(){};xe.prototype=te,N=new xe}return ai(ht(I),function(De){N[De]=I[De]}),N}return I}Ce.prototype.get=function(I){for(var N=this.value,te=0;te<I.length;te++){var xe=I[te];if(!N||!_i.call(N,xe)){N=void 0;break}N=N[xe]}return N},Ce.prototype.has=function(I){for(var N=this.value,te=0;te<I.length;te++){var xe=I[te];if(!N||!_i.call(N,xe))return!1;N=N[xe]}return!0},Ce.prototype.set=function(I,N){for(var te=this.value,xe=0;xe<I.length-1;xe++){var De=I[xe];_i.call(te,De)||(te[De]={}),te=te[De]}return te[I[xe]]=N,N},Ce.prototype.map=function(I){return ot(this.value,I,!0)},Ce.prototype.forEach=function(I){return this.value=ot(this.value,I,!1),this.value},Ce.prototype.reduce=function(I,N){var te=arguments.length===1,xe=te?this.value:N;return this.forEach(function(De){this.isRoot&&te||(xe=I.call(this,xe,De))}),xe},Ce.prototype.paths=function(){var I=[];return this.forEach(function(N){I.push(this.path)}),I},Ce.prototype.nodes=function(){var I=[];return this.forEach(function(N){I.push(this.node)}),I},Ce.prototype.clone=function(){var I=[],N=[];return function te(xe){for(var De=0;De<I.length;De++)if(I[De]===xe)return N[De];if(typeof xe=="object"&&xe!==null){var Re=gt(xe);return I.push(xe),N.push(Re),ai(ht(xe),function(Ke){Re[Ke]=te(xe[Ke])}),I.pop(),N.pop(),Re}return xe}(this.value)};var ht=Object.keys||function(I){var N=[];for(var te in I)N.push(te);return N};function di(I){return Object.prototype.toString.call(I)}var Oi=Array.isArray||function(I){return Object.prototype.toString.call(I)==="[object Array]"},ai=function(I,N){if(I.forEach)return I.forEach(N);for(var te=0;te<I.length;te++)N(I[te],te,I)};ai(ht(Ce.prototype),function(I){ye[I]=function(N){var te=[].slice.call(arguments,1),xe=new Ce(N);return xe[I].apply(xe,te)}});var _i=Object.hasOwnProperty||function(I,N){return N in I},ji=Ae.exports,ke=Dt;function Dt(I){if(!(this instanceof Dt))return new Dt(I);this._bbox=I||[1/0,1/0,-1/0,-1/0],this._valid=!!I}Dt.prototype.include=function(I){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],I[0]),this._bbox[1]=Math.min(this._bbox[1],I[1]),this._bbox[2]=Math.max(this._bbox[2],I[0]),this._bbox[3]=Math.max(this._bbox[3],I[1]),this},Dt.prototype.equals=function(I){var N;return N=I instanceof Dt?I.bbox():I,this._bbox[0]==N[0]&&this._bbox[1]==N[1]&&this._bbox[2]==N[2]&&this._bbox[3]==N[3]},Dt.prototype.center=function(I){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Dt.prototype.union=function(I){var N;return this._valid=!0,N=I instanceof Dt?I.bbox():I,this._bbox[0]=Math.min(this._bbox[0],N[0]),this._bbox[1]=Math.min(this._bbox[1],N[1]),this._bbox[2]=Math.max(this._bbox[2],N[2]),this._bbox[3]=Math.max(this._bbox[3],N[3]),this},Dt.prototype.bbox=function(){return this._valid?this._bbox:null},Dt.prototype.contains=function(I){if(!I)return this._fastContains();if(!this._valid)return null;var N=I[0],te=I[1];return this._bbox[0]<=N&&this._bbox[1]<=te&&this._bbox[2]>=N&&this._bbox[3]>=te},Dt.prototype.intersect=function(I){return this._valid?(N=I instanceof Dt?I.bbox():I,!(this._bbox[0]>N[2]||this._bbox[2]<N[0]||this._bbox[3]<N[1]||this._bbox[1]>N[3])):null;var N},Dt.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var I="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",I)},Dt.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var It=function(I){if(!I)return[];var N=ce(le(I)),te=[];return N.features.forEach(function(xe){xe.geometry&&(te=te.concat(Oe(xe.geometry.coordinates)))}),te},yi=ji,gn=ke,Zi={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},In=Object.keys(Zi);function Cn(I){for(var N=gn(),te=It(I),xe=0;xe<te.length;xe++)N.include(te[xe]);return N}ge.exports=function(I){return Cn(I).bbox()},ge.exports.polygon=function(I){return Cn(I).polygon()},ge.exports.bboxify=function(I){return yi(I).map(function(N){N&&In.some(function(te){return!!N[te]&&Zi[te].indexOf(N.type)!==-1})&&(N.bbox=Cn(N).bbox(),this.update(N))})};var cr=n(ge.exports),Er=-90;function Ws(I,N){var te=Er,xe=90,De=Er,Re=90,Ke=270,Bt=-270;I.forEach(function(si){var oi=cr(si),Xt=oi[1],qi=oi[3],tr=oi[0],Yi=oi[2];Xt>te&&(te=Xt),qi<xe&&(xe=qi),qi>De&&(De=qi),Xt<Re&&(Re=Xt),tr<Ke&&(Ke=tr),Yi>Bt&&(Bt=Yi)});var Kt=N;return te+Kt.lat>85&&(Kt.lat=85-te),De+Kt.lat>90&&(Kt.lat=90-De),xe+Kt.lat<-85&&(Kt.lat=-85-xe),Re+Kt.lat<Er&&(Kt.lat=Er-Re),Ke+Kt.lng<=-270&&(Kt.lng+=360*Math.ceil(Math.abs(Kt.lng)/360)),Bt+Kt.lng>=270&&(Kt.lng-=360*Math.ceil(Math.abs(Kt.lng)/360)),Kt}function la(I,N){var te=Ws(I.map(function(xe){return xe.toGeoJSON()}),N);I.forEach(function(xe){var De,Re=xe.getCoordinates(),Ke=function(Kt){var si={lng:Kt[0]+te.lng,lat:Kt[1]+te.lat};return[si.lng,si.lat]},Bt=function(Kt){return Kt.map(function(si){return Ke(si)})};xe.type===R.POINT?De=Ke(Re):xe.type===R.LINE_STRING||xe.type===R.MULTI_POINT?De=Re.map(Ke):xe.type===R.POLYGON||xe.type===R.MULTI_LINE_STRING?De=Re.map(Bt):xe.type===R.MULTI_POLYGON&&(De=Re.map(function(Kt){return Kt.map(function(si){return Bt(si)})})),xe.incomingCoords(De)})}var Mr={onSetup:function(I){var N=this,te={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:I.featureIds||[]};return this.setSelected(te.initiallySelectedFeatureIds.filter(function(xe){return N.getFeature(xe)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),te},fireUpdate:function(){this.map.fire(H.UPDATE,{action:K.MOVE,features:this.getSelected().map(function(I){return I.toGeoJSON()})})},fireActionable:function(){var I=this,N=this.getSelected(),te=N.filter(function(Bt){return I.isInstanceOf("MultiFeature",Bt)}),xe=!1;if(N.length>1){xe=!0;var De=N[0].type.replace("Multi","");N.forEach(function(Bt){Bt.type.replace("Multi","")!==De&&(xe=!1)})}var Re=te.length>0,Ke=N.length>0;this.setActionableState({combineFeatures:xe,uncombineFeatures:Re,trash:Ke})},getUniqueIds:function(I){return I.length?I.map(function(N){return N.properties.id}).filter(function(N){return N!==void 0}).reduce(function(N,te){return N.add(te),N},new mt).values():[]},stopExtendedInteractions:function(I){I.boxSelectElement&&(I.boxSelectElement.parentNode&&I.boxSelectElement.parentNode.removeChild(I.boxSelectElement),I.boxSelectElement=null),this.map.dragPan.enable(),I.boxSelecting=!1,I.canBoxSelect=!1,I.dragMoving=!1,I.canDragMove=!1},onStop:function(){Q.enable(this)},onMouseMove:function(I,N){return Cr(N)&&I.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(I),!0},onMouseOut:function(I){return!I.dragMoving||this.fireUpdate()}};Mr.onTap=Mr.onClick=function(I,N){return jr(N)?this.clickAnywhere(I,N):Ui(W.VERTEX)(N)?this.clickOnVertex(I,N):Cr(N)?this.clickOnFeature(I,N):void 0},Mr.clickAnywhere=function(I){var N=this,te=this.getSelectedIds();te.length&&(this.clearSelectedFeatures(),te.forEach(function(xe){return N.doRender(xe)})),Q.enable(this),this.stopExtendedInteractions(I)},Mr.clickOnVertex=function(I,N){this.changeMode(z.DIRECT_SELECT,{featureId:N.featureTarget.properties.parent,coordPath:N.featureTarget.properties.coord_path,startPos:N.lngLat}),this.updateUIClasses({mouse:S.MOVE})},Mr.startOnActiveFeature=function(I,N){this.stopExtendedInteractions(I),this.map.dragPan.disable(),this.doRender(N.featureTarget.properties.id),I.canDragMove=!0,I.dragMoveLocation=N.lngLat},Mr.clickOnFeature=function(I,N){var te=this;Q.disable(this),this.stopExtendedInteractions(I);var xe=Hn(N),De=this.getSelectedIds(),Re=N.featureTarget.properties.id,Ke=this.isSelected(Re);if(!xe&&Ke&&this.getFeature(Re).type!==R.POINT)return this.changeMode(z.DIRECT_SELECT,{featureId:Re});Ke&&xe?(this.deselect(Re),this.updateUIClasses({mouse:S.POINTER}),De.length===1&&Q.enable(this)):!Ke&&xe?(this.select(Re),this.updateUIClasses({mouse:S.MOVE})):Ke||xe||(De.forEach(function(Bt){return te.doRender(Bt)}),this.setSelected(Re),this.updateUIClasses({mouse:S.MOVE})),this.doRender(Re)},Mr.onMouseDown=function(I,N){return mr(N)?this.startOnActiveFeature(I,N):this.drawConfig.boxSelect&&Gn(N)?this.startBoxSelect(I,N):void 0},Mr.startBoxSelect=function(I,N){this.stopExtendedInteractions(I),this.map.dragPan.disable(),I.boxSelectStartLocation=Bi(N.originalEvent,this.map.getContainer()),I.canBoxSelect=!0},Mr.onTouchStart=function(I,N){if(mr(N))return this.startOnActiveFeature(I,N)},Mr.onDrag=function(I,N){return I.canDragMove?this.dragMove(I,N):this.drawConfig.boxSelect&&I.canBoxSelect?this.whileBoxSelect(I,N):void 0},Mr.whileBoxSelect=function(I,N){I.boxSelecting=!0,this.updateUIClasses({mouse:S.ADD}),I.boxSelectElement||(I.boxSelectElement=document.createElement("div"),I.boxSelectElement.classList.add(b.BOX_SELECT),this.map.getContainer().appendChild(I.boxSelectElement));var te=Bi(N.originalEvent,this.map.getContainer()),xe=Math.min(I.boxSelectStartLocation.x,te.x),De=Math.max(I.boxSelectStartLocation.x,te.x),Re=Math.min(I.boxSelectStartLocation.y,te.y),Ke=Math.max(I.boxSelectStartLocation.y,te.y),Bt="translate("+xe+"px, "+Re+"px)";I.boxSelectElement.style.transform=Bt,I.boxSelectElement.style.WebkitTransform=Bt,I.boxSelectElement.style.width=De-xe+"px",I.boxSelectElement.style.height=Ke-Re+"px"},Mr.dragMove=function(I,N){I.dragMoving=!0,N.originalEvent.stopPropagation();var te={lng:N.lngLat.lng-I.dragMoveLocation.lng,lat:N.lngLat.lat-I.dragMoveLocation.lat};la(this.getSelected(),te),I.dragMoveLocation=N.lngLat},Mr.onTouchEnd=Mr.onMouseUp=function(I,N){var te=this;if(I.dragMoving)this.fireUpdate();else if(I.boxSelecting){var xe=[I.boxSelectStartLocation,Bi(N.originalEvent,this.map.getContainer())],De=this.featuresAt(null,xe,"click"),Re=this.getUniqueIds(De).filter(function(Ke){return!te.isSelected(Ke)});Re.length&&(this.select(Re),Re.forEach(function(Ke){return te.doRender(Ke)}),this.updateUIClasses({mouse:S.MOVE}))}this.stopExtendedInteractions(I)},Mr.toDisplayFeatures=function(I,N,te){N.properties.active=this.isSelected(N.properties.id)?se.ACTIVE:se.INACTIVE,te(N),this.fireActionable(),N.properties.active===se.ACTIVE&&N.geometry.type!==R.POINT&&st(N).forEach(te)},Mr.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Mr.onCombineFeatures=function(){var I=this.getSelected();if(!(I.length===0||I.length<2)){for(var N=[],te=[],xe=I[0].type.replace("Multi",""),De=0;De<I.length;De++){var Re=I[De];if(Re.type.replace("Multi","")!==xe)return;Re.type.includes("Multi")?Re.getCoordinates().forEach(function(Bt){N.push(Bt)}):N.push(Re.getCoordinates()),te.push(Re.toGeoJSON())}if(te.length>1){var Ke=this.newFeature({type:R.FEATURE,properties:te[0].properties,geometry:{type:"Multi"+xe,coordinates:N}});this.addFeature(Ke),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([Ke.id]),this.map.fire(H.COMBINE_FEATURES,{createdFeatures:[Ke.toGeoJSON()],deletedFeatures:te})}this.fireActionable()}},Mr.onUncombineFeatures=function(){var I=this,N=this.getSelected();if(N.length!==0){for(var te=[],xe=[],De=function(Ke){var Bt=N[Ke];I.isInstanceOf("MultiFeature",Bt)&&(Bt.getFeatures().forEach(function(Kt){I.addFeature(Kt),Kt.properties=Bt.properties,te.push(Kt.toGeoJSON()),I.select([Kt.id])}),I.deleteFeature(Bt.id,{silent:!0}),xe.push(Bt.toGeoJSON()))},Re=0;Re<N.length;Re++)De(Re);te.length>1&&this.map.fire(H.UNCOMBINE_FEATURES,{createdFeatures:te,deletedFeatures:xe}),this.fireActionable()}};var xn=Ui(W.VERTEX),Vl=Ui(W.MIDPOINT),Ys={fireUpdate:function(){this.map.fire(H.UPDATE,{action:K.CHANGE_COORDINATES,features:this.getSelected().map(function(I){return I.toGeoJSON()})})},fireActionable:function(I){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:I.selectedCoordPaths.length>0})},startDragging:function(I,N){this.map.dragPan.disable(),I.canDragMove=!0,I.dragMoveLocation=N.lngLat},stopDragging:function(I){this.map.dragPan.enable(),I.dragMoving=!1,I.canDragMove=!1,I.dragMoveLocation=null},onVertex:function(I,N){this.startDragging(I,N);var te=N.featureTarget.properties,xe=I.selectedCoordPaths.indexOf(te.coord_path);Hn(N)||xe!==-1?Hn(N)&&xe===-1&&I.selectedCoordPaths.push(te.coord_path):I.selectedCoordPaths=[te.coord_path];var De=this.pathsToCoordinates(I.featureId,I.selectedCoordPaths);this.setSelectedCoordinates(De)},onMidpoint:function(I,N){this.startDragging(I,N);var te=N.featureTarget.properties;I.feature.addCoordinate(te.coord_path,te.lng,te.lat),this.fireUpdate(),I.selectedCoordPaths=[te.coord_path]},pathsToCoordinates:function(I,N){return N.map(function(te){return{feature_id:I,coord_path:te}})},onFeature:function(I,N){I.selectedCoordPaths.length===0?this.startDragging(I,N):this.stopDragging(I)},dragFeature:function(I,N,te){la(this.getSelected(),te),I.dragMoveLocation=N.lngLat},dragVertex:function(I,N,te){for(var xe=I.selectedCoordPaths.map(function(Bt){return I.feature.getCoordinate(Bt)}),De=Ws(xe.map(function(Bt){return{type:R.FEATURE,properties:{},geometry:{type:R.POINT,coordinates:Bt}}}),te),Re=0;Re<xe.length;Re++){var Ke=xe[Re];I.feature.updateCoordinate(I.selectedCoordPaths[Re],Ke[0]+De.lng,Ke[1]+De.lat)}},clickNoTarget:function(){this.changeMode(z.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(z.SIMPLE_SELECT)},clickActiveFeature:function(I){I.selectedCoordPaths=[],this.clearSelectedCoordinates(),I.feature.changed()},onSetup:function(I){var N=I.featureId,te=this.getFeature(N);if(!te)throw new Error("You must provide a featureId to enter direct_select mode");if(te.type===R.POINT)throw new TypeError("direct_select mode doesn't handle point features");var xe={featureId:N,feature:te,dragMoveLocation:I.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:I.coordPath?[I.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(N,xe.selectedCoordPaths)),this.setSelected(N),Q.disable(this),this.setActionableState({trash:!0}),xe},onStop:function(){Q.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(I,N,te){I.featureId===N.properties.id?(N.properties.active=se.ACTIVE,te(N),st(N,{map:this.map,midpoints:!0,selectedPaths:I.selectedCoordPaths}).forEach(te)):(N.properties.active=se.INACTIVE,te(N)),this.fireActionable(I)},onTrash:function(I){I.selectedCoordPaths.sort(function(N,te){return te.localeCompare(N,"en",{numeric:!0})}).forEach(function(N){return I.feature.removeCoordinate(N)}),this.fireUpdate(),I.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(I),I.feature.isValid()===!1&&(this.deleteFeature([I.featureId]),this.changeMode(z.SIMPLE_SELECT,{}))},onMouseMove:function(I,N){var te=mr(N),xe=xn(N),De=Vl(N),Re=I.selectedCoordPaths.length===0;return te&&Re||xe&&!Re?this.updateUIClasses({mouse:S.MOVE}):this.updateUIClasses({mouse:S.NONE}),(xe||te||De)&&I.dragMoving&&this.fireUpdate(),this.stopDragging(I),!0},onMouseOut:function(I){return I.dragMoving&&this.fireUpdate(),!0}};Ys.onTouchStart=Ys.onMouseDown=function(I,N){return xn(N)?this.onVertex(I,N):mr(N)?this.onFeature(I,N):Vl(N)?this.onMidpoint(I,N):void 0},Ys.onDrag=function(I,N){if(I.canDragMove===!0){I.dragMoving=!0,N.originalEvent.stopPropagation();var te={lng:N.lngLat.lng-I.dragMoveLocation.lng,lat:N.lngLat.lat-I.dragMoveLocation.lat};I.selectedCoordPaths.length>0?this.dragVertex(I,N,te):this.dragFeature(I,N,te),I.dragMoveLocation=N.lngLat}},Ys.onClick=function(I,N){return jr(N)?this.clickNoTarget(I,N):mr(N)?this.clickActiveFeature(I,N):vr(N)?this.clickInactive(I,N):void this.stopDragging(I)},Ys.onTap=function(I,N){return jr(N)?this.clickNoTarget(I,N):mr(N)?this.clickActiveFeature(I,N):vr(N)?this.clickInactive(I,N):void 0},Ys.onTouchEnd=Ys.onMouseUp=function(I){I.dragMoving&&this.fireUpdate(),this.stopDragging(I)};var Jn={};function $r(I,N){return!!I.lngLat&&I.lngLat.lng===N[0]&&I.lngLat.lat===N[1]}Jn.onSetup=function(){var I=this.newFeature({type:R.FEATURE,properties:{},geometry:{type:R.POINT,coordinates:[]}});return this.addFeature(I),this.clearSelectedFeatures(),this.updateUIClasses({mouse:S.ADD}),this.activateUIButton(D.POINT),this.setActionableState({trash:!0}),{point:I}},Jn.stopDrawingAndRemove=function(I){this.deleteFeature([I.point.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT)},Jn.onTap=Jn.onClick=function(I,N){this.updateUIClasses({mouse:S.MOVE}),I.point.updateCoordinate("",N.lngLat.lng,N.lngLat.lat),this.map.fire(H.CREATE,{features:[I.point.toGeoJSON()]}),this.changeMode(z.SIMPLE_SELECT,{featureIds:[I.point.id]})},Jn.onStop=function(I){this.activateUIButton(),I.point.getCoordinate().length||this.deleteFeature([I.point.id],{silent:!0})},Jn.toDisplayFeatures=function(I,N,te){var xe=N.properties.id===I.point.id;if(N.properties.active=xe?se.ACTIVE:se.INACTIVE,!xe)return te(N)},Jn.onTrash=Jn.stopDrawingAndRemove,Jn.onKeyUp=function(I,N){if(Nt(N)||Qi(N))return this.stopDrawingAndRemove(I,N)};var uo={onSetup:function(){var I=this.newFeature({type:R.FEATURE,properties:{},geometry:{type:R.POLYGON,coordinates:[[]]}});return this.addFeature(I),this.clearSelectedFeatures(),Q.disable(this),this.updateUIClasses({mouse:S.ADD}),this.activateUIButton(D.POLYGON),this.setActionableState({trash:!0}),{polygon:I,currentVertexPosition:0}},clickAnywhere:function(I,N){if(I.currentVertexPosition>0&&$r(N,I.polygon.coordinates[0][I.currentVertexPosition-1]))return this.changeMode(z.SIMPLE_SELECT,{featureIds:[I.polygon.id]});this.updateUIClasses({mouse:S.ADD}),I.polygon.updateCoordinate("0."+I.currentVertexPosition,N.lngLat.lng,N.lngLat.lat),I.currentVertexPosition++,I.polygon.updateCoordinate("0."+I.currentVertexPosition,N.lngLat.lng,N.lngLat.lat)},clickOnVertex:function(I){return this.changeMode(z.SIMPLE_SELECT,{featureIds:[I.polygon.id]})},onMouseMove:function(I,N){I.polygon.updateCoordinate("0."+I.currentVertexPosition,N.lngLat.lng,N.lngLat.lat),lr(N)&&this.updateUIClasses({mouse:S.POINTER})}};uo.onTap=uo.onClick=function(I,N){return lr(N)?this.clickOnVertex(I,N):this.clickAnywhere(I,N)},uo.onKeyUp=function(I,N){Nt(N)?(this.deleteFeature([I.polygon.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT)):Qi(N)&&this.changeMode(z.SIMPLE_SELECT,{featureIds:[I.polygon.id]})},uo.onStop=function(I){this.updateUIClasses({mouse:S.NONE}),Q.enable(this),this.activateUIButton(),this.getFeature(I.polygon.id)!==void 0&&(I.polygon.removeCoordinate("0."+I.currentVertexPosition),I.polygon.isValid()?this.map.fire(H.CREATE,{features:[I.polygon.toGeoJSON()]}):(this.deleteFeature([I.polygon.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT,{},{silent:!0})))},uo.toDisplayFeatures=function(I,N,te){var xe=N.properties.id===I.polygon.id;if(N.properties.active=xe?se.ACTIVE:se.INACTIVE,!xe)return te(N);if(N.geometry.coordinates.length!==0){var De=N.geometry.coordinates[0].length;if(!(De<3)){if(N.properties.meta=W.FEATURE,te(ii(I.polygon.id,N.geometry.coordinates[0][0],"0.0",!1)),De>3){var Re=N.geometry.coordinates[0].length-3;te(ii(I.polygon.id,N.geometry.coordinates[0][Re],"0."+Re,!1))}if(De<=4){var Ke=[[N.geometry.coordinates[0][0][0],N.geometry.coordinates[0][0][1]],[N.geometry.coordinates[0][1][0],N.geometry.coordinates[0][1][1]]];if(te({type:R.FEATURE,properties:N.properties,geometry:{coordinates:Ke,type:R.LINE_STRING}}),De===3)return}return te(N)}}},uo.onTrash=function(I){this.deleteFeature([I.polygon.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT)};var zr={onSetup:function(I){var N,te,xe=(I=I||{}).featureId,De="forward";if(xe){if(!(N=this.getFeature(xe)))throw new Error("Could not find a feature with the provided featureId");var Re=I.from;if(Re&&Re.type==="Feature"&&Re.geometry&&Re.geometry.type==="Point"&&(Re=Re.geometry),Re&&Re.type==="Point"&&Re.coordinates&&Re.coordinates.length===2&&(Re=Re.coordinates),!Re||!Array.isArray(Re))throw new Error("Please use the `from` property to indicate which point to continue the line from");var Ke=N.coordinates.length-1;if(N.coordinates[Ke][0]===Re[0]&&N.coordinates[Ke][1]===Re[1])te=Ke+1,N.addCoordinate.apply(N,[te].concat(N.coordinates[Ke]));else{if(N.coordinates[0][0]!==Re[0]||N.coordinates[0][1]!==Re[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");De="backwards",te=0,N.addCoordinate.apply(N,[te].concat(N.coordinates[0]))}}else N=this.newFeature({type:R.FEATURE,properties:{},geometry:{type:R.LINE_STRING,coordinates:[]}}),te=0,this.addFeature(N);return this.clearSelectedFeatures(),Q.disable(this),this.updateUIClasses({mouse:S.ADD}),this.activateUIButton(D.LINE),this.setActionableState({trash:!0}),{line:N,currentVertexPosition:te,direction:De}},clickAnywhere:function(I,N){if(I.currentVertexPosition>0&&$r(N,I.line.coordinates[I.currentVertexPosition-1])||I.direction==="backwards"&&$r(N,I.line.coordinates[I.currentVertexPosition+1]))return this.changeMode(z.SIMPLE_SELECT,{featureIds:[I.line.id]});this.updateUIClasses({mouse:S.ADD}),I.line.updateCoordinate(I.currentVertexPosition,N.lngLat.lng,N.lngLat.lat),I.direction==="forward"?(I.currentVertexPosition++,I.line.updateCoordinate(I.currentVertexPosition,N.lngLat.lng,N.lngLat.lat)):I.line.addCoordinate(0,N.lngLat.lng,N.lngLat.lat)},clickOnVertex:function(I){return this.changeMode(z.SIMPLE_SELECT,{featureIds:[I.line.id]})},onMouseMove:function(I,N){I.line.updateCoordinate(I.currentVertexPosition,N.lngLat.lng,N.lngLat.lat),lr(N)&&this.updateUIClasses({mouse:S.POINTER})}};zr.onTap=zr.onClick=function(I,N){if(lr(N))return this.clickOnVertex(I,N);this.clickAnywhere(I,N)},zr.onKeyUp=function(I,N){Qi(N)?this.changeMode(z.SIMPLE_SELECT,{featureIds:[I.line.id]}):Nt(N)&&(this.deleteFeature([I.line.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT))},zr.onStop=function(I){Q.enable(this),this.activateUIButton(),this.getFeature(I.line.id)!==void 0&&(I.line.removeCoordinate(""+I.currentVertexPosition),I.line.isValid()?this.map.fire(H.CREATE,{features:[I.line.toGeoJSON()]}):(this.deleteFeature([I.line.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT,{},{silent:!0})))},zr.onTrash=function(I){this.deleteFeature([I.line.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT)},zr.toDisplayFeatures=function(I,N,te){var xe=N.properties.id===I.line.id;if(N.properties.active=xe?se.ACTIVE:se.INACTIVE,!xe)return te(N);N.geometry.coordinates.length<2||(N.properties.meta=W.FEATURE,te(ii(I.line.id,N.geometry.coordinates[I.direction==="forward"?N.geometry.coordinates.length-2:1],""+(I.direction==="forward"?N.geometry.coordinates.length-2:1),!1)),te(N))};var Br={simple_select:Mr,direct_select:Ys,draw_point:Jn,draw_polygon:uo,draw_line_string:zr},Fl={defaultMode:z.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Xi,modes:Br,controls:{},userProperties:!1},Lo={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},$n={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function _n(I,N){return I.map(function(te){return te.source?te:Xe(te,{id:te.id+"."+N,source:N==="hot"?E.HOT:E.COLD})})}var Aa={exports:{}};(function(I,N){var te="__lodash_hash_undefined__",xe=9007199254740991,De="[object Arguments]",Re="[object Array]",Ke="[object Boolean]",Bt="[object Date]",Kt="[object Error]",si="[object Function]",oi="[object Map]",Xt="[object Number]",qi="[object Object]",tr="[object Promise]",Yi="[object RegExp]",br="[object Set]",Tt="[object String]",xi="[object Symbol]",wn="[object WeakMap]",ir="[object ArrayBuffer]",ur="[object DataView]",cs=/^\[object .+?Constructor\]$/,Ul=/^(?:0|[1-9]\d*)$/,Dn={};Dn["[object Float32Array]"]=Dn["[object Float64Array]"]=Dn["[object Int8Array]"]=Dn["[object Int16Array]"]=Dn["[object Int32Array]"]=Dn["[object Uint8Array]"]=Dn["[object Uint8ClampedArray]"]=Dn["[object Uint16Array]"]=Dn["[object Uint32Array]"]=!0,Dn[De]=Dn[Re]=Dn[ir]=Dn[Ke]=Dn[ur]=Dn[Bt]=Dn[Kt]=Dn[si]=Dn[oi]=Dn[Xt]=Dn[qi]=Dn[Yi]=Dn[br]=Dn[Tt]=Dn[wn]=!1;var Po=typeof Jc=="object"&&Jc&&Jc.Object===Object&&Jc,jl=typeof self=="object"&&self&&self.Object===Object&&self,us=Po||jl||Function("return this")(),Ea=N&&!N.nodeType&&N,on=Ea&&I&&!I.nodeType&&I,il=on&&on.exports===Ea,is=il&&Po.process,hs=function(){try{return is&&is.binding&&is.binding("util")}catch{}}(),Gl=hs&&hs.isTypedArray;function Hl(Ge,ft){for(var Qt=-1,Pi=Ge==null?0:Ge.length;++Qt<Pi;)if(ft(Ge[Qt],Qt,Ge))return!0;return!1}function Kl(Ge){var ft=-1,Qt=Array(Ge.size);return Ge.forEach(function(Pi,qn){Qt[++ft]=[qn,Pi]}),Qt}function Ic(Ge){var ft=-1,Qt=Array(Ge.size);return Ge.forEach(function(Pi){Qt[++ft]=Pi}),Qt}var ql,nl,Zl,kc=Array.prototype,Wl=Function.prototype,rl=Object.prototype,Yl=us["__core-js_shared__"],ho=Wl.toString,ca=rl.hasOwnProperty,xu=(ql=/[^.]+$/.exec(Yl&&Yl.keys&&Yl.keys.IE_PROTO||""))?"Symbol(src)_1."+ql:"",wu=rl.toString,zh=RegExp("^"+ho.call(ca).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Au=il?us.Buffer:void 0,Jl=us.Symbol,Xl=us.Uint8Array,sl=rl.propertyIsEnumerable,Oc=kc.splice,Ta=Jl?Jl.toStringTag:void 0,fo=Object.getOwnPropertySymbols,Eu=Au?Au.isBuffer:void 0,Tu=(nl=Object.keys,Zl=Object,function(Ge){return nl(Zl(Ge))}),al=mo(us,"DataView"),Js=mo(us,"Map"),Ql=mo(us,"Promise"),ua=mo(us,"Set"),Ga=mo(us,"WeakMap"),No=mo(Object,"create"),Cc=Za(al),yn=Za(Js),nr=Za(Ql),Bh=Za(ua),cn=Za(Ga),Ha=Jl?Jl.prototype:void 0,Kn=Ha?Ha.valueOf:void 0;function An(Ge){var ft=-1,Qt=Ge==null?0:Ge.length;for(this.clear();++ft<Qt;){var Pi=Ge[ft];this.set(Pi[0],Pi[1])}}function bs(Ge){var ft=-1,Qt=Ge==null?0:Ge.length;for(this.clear();++ft<Qt;){var Pi=Ge[ft];this.set(Pi[0],Pi[1])}}function Ka(Ge){var ft=-1,Qt=Ge==null?0:Ge.length;for(this.clear();++ft<Qt;){var Pi=Ge[ft];this.set(Pi[0],Pi[1])}}function zo(Ge){var ft=-1,Qt=Ge==null?0:Ge.length;for(this.__data__=new Ka;++ft<Qt;)this.add(Ge[ft])}function Xs(Ge){var ft=this.__data__=new bs(Ge);this.size=ft.size}function $l(Ge,ft){var Qt=po(Ge),Pi=!Qt&&rc(Ge),qn=!Qt&&!Pi&&sc(Ge),dn=!Qt&&!Pi&&!qn&&Uo(Ge),hr=Qt||Pi||qn||dn,xr=hr?function(En,ds){for(var fa=-1,es=Array(En);++fa<En;)es[fa]=ds(fa);return es}(Ge.length,String):[],Tr=xr.length;for(var dr in Ge)!ft&&!ca.call(Ge,dr)||hr&&(dr=="length"||qn&&(dr=="offset"||dr=="parent")||dn&&(dr=="buffer"||dr=="byteLength"||dr=="byteOffset")||Iu(dr,Tr))||xr.push(dr);return xr}function Bo(Ge,ft){for(var Qt=Ge.length;Qt--;)if(Fo(Ge[Qt][0],ft))return Qt;return-1}function qa(Ge){return Ge==null?Ge===void 0?"[object Undefined]":"[object Null]":Ta&&Ta in Object(Ge)?function(ft){var Qt=ca.call(ft,Ta),Pi=ft[Ta];try{ft[Ta]=void 0;var qn=!0}catch{}var dn=wu.call(ft);return qn&&(Qt?ft[Ta]=Pi:delete ft[Ta]),dn}(Ge):function(ft){return wu.call(ft)}(Ge)}function ec(Ge){return da(Ge)&&qa(Ge)==De}function Vo(Ge,ft,Qt,Pi,qn){return Ge===ft||(Ge==null||ft==null||!da(Ge)&&!da(ft)?Ge!=Ge&&ft!=ft:function(dn,hr,xr,Tr,dr,En){var ds=po(dn),fa=po(hr),es=ds?Re:ha(dn),ma=fa?Re:ha(hr),fs=(es=es==De?qi:es)==qi,cl=(ma=ma==De?qi:ma)==qi,Gr=es==ma;if(Gr&&sc(dn)){if(!sc(hr))return!1;ds=!0,fs=!1}if(Gr&&!fs)return En||(En=new Xs),ds||Uo(dn)?Su(dn,hr,xr,Tr,dr,En):function(Vn,Tn,hl,Qs,Ya,Sr,ri){switch(hl){case ur:if(Vn.byteLength!=Tn.byteLength||Vn.byteOffset!=Tn.byteOffset)return!1;Vn=Vn.buffer,Tn=Tn.buffer;case ir:return!(Vn.byteLength!=Tn.byteLength||!Sr(new Xl(Vn),new Xl(Tn)));case Ke:case Bt:case Xt:return Fo(+Vn,+Tn);case Kt:return Vn.name==Tn.name&&Vn.message==Tn.message;case Yi:case Tt:return Vn==Tn+"";case oi:var $s=Kl;case br:var Ds=1&Qs;if($s||($s=Ic),Vn.size!=Tn.size&&!Ds)return!1;var ka=ri.get(Vn);if(ka)return ka==Tn;Qs|=2,ri.set(Vn,Tn);var go=Su($s(Vn),$s(Tn),Qs,Ya,Sr,ri);return ri.delete(Vn),go;case xi:if(Kn)return Kn.call(Vn)==Kn.call(Tn)}return!1}(dn,hr,es,xr,Tr,dr,En);if(!(1&xr)){var xs=fs&&ca.call(dn,"__wrapped__"),ul=cl&&ca.call(hr,"__wrapped__");if(xs||ul){var Sa=xs?dn.value():dn,Ia=ul?hr.value():hr;return En||(En=new Xs),dr(Sa,Ia,xr,Tr,En)}}return Gr?(En||(En=new Xs),function(Vn,Tn,hl,Qs,Ya,Sr){var ri=1&hl,$s=tc(Vn),Ds=$s.length,ka=tc(Tn).length;if(Ds!=ka&&!ri)return!1;for(var go=Ds;go--;){var Wt=$s[go];if(!(ri?Wt in Tn:ca.call(Tn,Wt)))return!1}var oc=Sr.get(Vn);if(oc&&Sr.get(Tn))return oc==Tn;var jo=!0;Sr.set(Vn,Tn),Sr.set(Tn,Vn);for(var Mc=ri;++go<Ds;){var Go=Vn[Wt=$s[go]],dl=Tn[Wt];if(Qs)var Dc=ri?Qs(dl,Go,Wt,Tn,Vn,Sr):Qs(Go,dl,Wt,Vn,Tn,Sr);if(!(Dc===void 0?Go===dl||Ya(Go,dl,hl,Qs,Sr):Dc)){jo=!1;break}Mc||(Mc=Wt=="constructor")}if(jo&&!Mc){var fl=Vn.constructor,lc=Tn.constructor;fl==lc||!("constructor"in Vn)||!("constructor"in Tn)||typeof fl=="function"&&fl instanceof fl&&typeof lc=="function"&&lc instanceof lc||(jo=!1)}return Sr.delete(Vn),Sr.delete(Tn),jo}(dn,hr,xr,Tr,dr,En)):!1}(Ge,ft,Qt,Pi,Vo,qn))}function ol(Ge){return!(!ns(Ge)||function(ft){return!!xu&&xu in ft}(Ge))&&(rr(Ge)?zh:cs).test(Za(Ge))}function ll(Ge){if(Qt=(ft=Ge)&&ft.constructor,Pi=typeof Qt=="function"&&Qt.prototype||rl,ft!==Pi)return Tu(Ge);var ft,Qt,Pi,qn=[];for(var dn in Object(Ge))ca.call(Ge,dn)&&dn!="constructor"&&qn.push(dn);return qn}function Su(Ge,ft,Qt,Pi,qn,dn){var hr=1&Qt,xr=Ge.length,Tr=ft.length;if(xr!=Tr&&!(hr&&Tr>xr))return!1;var dr=dn.get(Ge);if(dr&&dn.get(ft))return dr==ft;var En=-1,ds=!0,fa=2&Qt?new zo:void 0;for(dn.set(Ge,ft),dn.set(ft,Ge);++En<xr;){var es=Ge[En],ma=ft[En];if(Pi)var fs=hr?Pi(ma,es,En,ft,Ge,dn):Pi(es,ma,En,Ge,ft,dn);if(fs!==void 0){if(fs)continue;ds=!1;break}if(fa){if(!Hl(ft,function(cl,Gr){if(xs=Gr,!fa.has(xs)&&(es===cl||qn(es,cl,Qt,Pi,dn)))return fa.push(Gr);var xs})){ds=!1;break}}else if(es!==ma&&!qn(es,ma,Qt,Pi,dn)){ds=!1;break}}return dn.delete(Ge),dn.delete(ft),ds}function tc(Ge){return function(ft,Qt,Pi){var qn=Qt(ft);return po(ft)?qn:function(dn,hr){for(var xr=-1,Tr=hr.length,dr=dn.length;++xr<Tr;)dn[dr+xr]=hr[xr];return dn}(qn,Pi(ft))}(Ge,ac,nc)}function ic(Ge,ft){var Qt,Pi,qn=Ge.__data__;return((Pi=typeof(Qt=ft))=="string"||Pi=="number"||Pi=="symbol"||Pi=="boolean"?Qt!=="__proto__":Qt===null)?qn[typeof ft=="string"?"string":"hash"]:qn.map}function mo(Ge,ft){var Qt=function(Pi,qn){return Pi==null?void 0:Pi[qn]}(Ge,ft);return ol(Qt)?Qt:void 0}An.prototype.clear=function(){this.__data__=No?No(null):{},this.size=0},An.prototype.delete=function(Ge){var ft=this.has(Ge)&&delete this.__data__[Ge];return this.size-=ft?1:0,ft},An.prototype.get=function(Ge){var ft=this.__data__;if(No){var Qt=ft[Ge];return Qt===te?void 0:Qt}return ca.call(ft,Ge)?ft[Ge]:void 0},An.prototype.has=function(Ge){var ft=this.__data__;return No?ft[Ge]!==void 0:ca.call(ft,Ge)},An.prototype.set=function(Ge,ft){var Qt=this.__data__;return this.size+=this.has(Ge)?0:1,Qt[Ge]=No&&ft===void 0?te:ft,this},bs.prototype.clear=function(){this.__data__=[],this.size=0},bs.prototype.delete=function(Ge){var ft=this.__data__,Qt=Bo(ft,Ge);return!(Qt<0)&&(Qt==ft.length-1?ft.pop():Oc.call(ft,Qt,1),--this.size,!0)},bs.prototype.get=function(Ge){var ft=this.__data__,Qt=Bo(ft,Ge);return Qt<0?void 0:ft[Qt][1]},bs.prototype.has=function(Ge){return Bo(this.__data__,Ge)>-1},bs.prototype.set=function(Ge,ft){var Qt=this.__data__,Pi=Bo(Qt,Ge);return Pi<0?(++this.size,Qt.push([Ge,ft])):Qt[Pi][1]=ft,this},Ka.prototype.clear=function(){this.size=0,this.__data__={hash:new An,map:new(Js||bs),string:new An}},Ka.prototype.delete=function(Ge){var ft=ic(this,Ge).delete(Ge);return this.size-=ft?1:0,ft},Ka.prototype.get=function(Ge){return ic(this,Ge).get(Ge)},Ka.prototype.has=function(Ge){return ic(this,Ge).has(Ge)},Ka.prototype.set=function(Ge,ft){var Qt=ic(this,Ge),Pi=Qt.size;return Qt.set(Ge,ft),this.size+=Qt.size==Pi?0:1,this},zo.prototype.add=zo.prototype.push=function(Ge){return this.__data__.set(Ge,te),this},zo.prototype.has=function(Ge){return this.__data__.has(Ge)},Xs.prototype.clear=function(){this.__data__=new bs,this.size=0},Xs.prototype.delete=function(Ge){var ft=this.__data__,Qt=ft.delete(Ge);return this.size=ft.size,Qt},Xs.prototype.get=function(Ge){return this.__data__.get(Ge)},Xs.prototype.has=function(Ge){return this.__data__.has(Ge)},Xs.prototype.set=function(Ge,ft){var Qt=this.__data__;if(Qt instanceof bs){var Pi=Qt.__data__;if(!Js||Pi.length<199)return Pi.push([Ge,ft]),this.size=++Qt.size,this;Qt=this.__data__=new Ka(Pi)}return Qt.set(Ge,ft),this.size=Qt.size,this};var nc=fo?function(Ge){return Ge==null?[]:(Ge=Object(Ge),function(ft,Qt){for(var Pi=-1,qn=ft==null?0:ft.length,dn=0,hr=[];++Pi<qn;){var xr=ft[Pi];Qt(xr,Pi,ft)&&(hr[dn++]=xr)}return hr}(fo(Ge),function(ft){return sl.call(Ge,ft)}))}:function(){return[]},ha=qa;function Iu(Ge,ft){return!!(ft=ft??xe)&&(typeof Ge=="number"||Ul.test(Ge))&&Ge>-1&&Ge%1==0&&Ge<ft}function Za(Ge){if(Ge!=null){try{return ho.call(Ge)}catch{}try{return Ge+""}catch{}}return""}function Fo(Ge,ft){return Ge===ft||Ge!=Ge&&ft!=ft}(al&&ha(new al(new ArrayBuffer(1)))!=ur||Js&&ha(new Js)!=oi||Ql&&ha(Ql.resolve())!=tr||ua&&ha(new ua)!=br||Ga&&ha(new Ga)!=wn)&&(ha=function(Ge){var ft=qa(Ge),Qt=ft==qi?Ge.constructor:void 0,Pi=Qt?Za(Qt):"";if(Pi)switch(Pi){case Cc:return ur;case yn:return oi;case nr:return tr;case Bh:return br;case cn:return wn}return ft});var rc=ec(function(){return arguments}())?ec:function(Ge){return da(Ge)&&ca.call(Ge,"callee")&&!sl.call(Ge,"callee")},po=Array.isArray,sc=Eu||function(){return!1};function rr(Ge){if(!ns(Ge))return!1;var ft=qa(Ge);return ft==si||ft=="[object GeneratorFunction]"||ft=="[object AsyncFunction]"||ft=="[object Proxy]"}function Wa(Ge){return typeof Ge=="number"&&Ge>-1&&Ge%1==0&&Ge<=xe}function ns(Ge){var ft=typeof Ge;return Ge!=null&&(ft=="object"||ft=="function")}function da(Ge){return Ge!=null&&typeof Ge=="object"}var Uo=Gl?function(Ge){return function(ft){return Ge(ft)}}(Gl):function(Ge){return da(Ge)&&Wa(Ge.length)&&!!Dn[qa(Ge)]};function ac(Ge){return(ft=Ge)!=null&&Wa(ft.length)&&!rr(ft)?$l(Ge):ll(Ge);var ft}I.exports=function(Ge,ft){return Vo(Ge,ft)}})(Aa,Aa.exports);var er=n(Aa.exports);function el(I,N){return I.length===N.length&&JSON.stringify(I.map(function(te){return te}).sort())===JSON.stringify(N.map(function(te){return te}).sort())}var Ms={Polygon:lt,LineString:Ht,Point:qe,MultiPolygon:bt,MultiLineString:bt,MultiPoint:bt},Sc=Object.freeze({__proto__:null,CommonSelectors:Qe,constrainFeatureMovement:Ws,createMidPoint:Bn,createSupplementaryPoints:st,createVertex:ii,doubleClickZoom:Q,euclideanDistance:Ve,featuresAt:rt,getFeatureAtAndSetCursors:We,isClick:St,isEventAtCoordinates:$r,isTap:zt,mapEventToBoundingBox:Be,ModeHandler:i,moveFeatures:la,sortFeatures:oe,stringSetsAreEqual:el,StringSet:mt,theme:Xi,toDenseArray:ni}),ja=function(I,N){var te={options:I=function(De){De===void 0&&(De={});var Re=Xe(De);return De.controls||(Re.controls={}),De.displayControlsDefault===!1?Re.controls=Xe($n,De.controls):Re.controls=Xe(Lo,De.controls),(Re=Xe(Fl,Re)).styles=_n(Re.styles,"cold").concat(_n(Re.styles,"hot")),Re}(I)};N=function(De,Re){return Re.modes=z,Re.getFeatureIdsAt=function(Ke){return rt.click({point:Ke},null,De).map(function(Bt){return Bt.properties.id})},Re.getSelectedIds=function(){return De.store.getSelectedIds()},Re.getSelected=function(){return{type:R.FEATURE_COLLECTION,features:De.store.getSelectedIds().map(function(Ke){return De.store.get(Ke)}).map(function(Ke){return Ke.toGeoJSON()})}},Re.getSelectedPoints=function(){return{type:R.FEATURE_COLLECTION,features:De.store.getSelectedCoordinates().map(function(Ke){return{type:R.FEATURE,properties:{},geometry:{type:R.POINT,coordinates:Ke.coordinates}}})}},Re.set=function(Ke){if(Ke.type===void 0||Ke.type!==R.FEATURE_COLLECTION||!Array.isArray(Ke.features))throw new Error("Invalid FeatureCollection");var Bt=De.store.createRenderBatch(),Kt=De.store.getAllIds().slice(),si=Re.add(Ke),oi=new mt(si);return(Kt=Kt.filter(function(Xt){return!oi.has(Xt)})).length&&Re.delete(Kt),Bt(),si},Re.add=function(Ke){var Bt=JSON.parse(JSON.stringify(q(Ke))).features.map(function(Kt){if(Kt.id=Kt.id||pt(),Kt.geometry===null)throw new Error("Invalid geometry: null");if(De.store.get(Kt.id)===void 0||De.store.get(Kt.id).type!==Kt.geometry.type){var si=Ms[Kt.geometry.type];if(si===void 0)throw new Error("Invalid geometry type: "+Kt.geometry.type+".");var oi=new si(De,Kt);De.store.add(oi)}else{var Xt=De.store.get(Kt.id);Xt.properties=Kt.properties,er(Xt.properties,Kt.properties)||De.store.featureChanged(Xt.id),er(Xt.getCoordinates(),Kt.geometry.coordinates)||Xt.incomingCoords(Kt.geometry.coordinates)}return Kt.id});return De.store.render(),Bt},Re.get=function(Ke){var Bt=De.store.get(Ke);if(Bt)return Bt.toGeoJSON()},Re.getAll=function(){return{type:R.FEATURE_COLLECTION,features:De.store.getAll().map(function(Ke){return Ke.toGeoJSON()})}},Re.delete=function(Ke){return De.store.delete(Ke,{silent:!0}),Re.getMode()!==z.DIRECT_SELECT||De.store.getSelectedIds().length?De.store.render():De.events.changeMode(z.SIMPLE_SELECT,void 0,{silent:!0}),Re},Re.deleteAll=function(){return De.store.delete(De.store.getAllIds(),{silent:!0}),Re.getMode()===z.DIRECT_SELECT?De.events.changeMode(z.SIMPLE_SELECT,void 0,{silent:!0}):De.store.render(),Re},Re.changeMode=function(Ke,Bt){return Bt===void 0&&(Bt={}),Ke===z.SIMPLE_SELECT&&Re.getMode()===z.SIMPLE_SELECT?(el(Bt.featureIds||[],De.store.getSelectedIds())||(De.store.setSelected(Bt.featureIds,{silent:!0}),De.store.render()),Re):(Ke===z.DIRECT_SELECT&&Re.getMode()===z.DIRECT_SELECT&&Bt.featureId===De.store.getSelectedIds()[0]||De.events.changeMode(Ke,Bt,{silent:!0}),Re)},Re.getMode=function(){return De.events.getMode()},Re.trash=function(){return De.events.trash({silent:!0}),Re},Re.combineFeatures=function(){return De.events.combineFeatures({silent:!0}),Re},Re.uncombineFeatures=function(){return De.events.uncombineFeatures({silent:!0}),Re},Re.setFeatureProperty=function(Ke,Bt,Kt){return De.store.setFeatureProperty(Ke,Bt,Kt),Re},Re}(te,N),te.api=N;var xe=Rt(te);return N.onAdd=xe.onAdd,N.onRemove=xe.onRemove,N.types=D,N.options=I,N};function tl(I){ja(I,this)}return tl.modes=Br,tl.constants=ue,tl.lib=Sc,tl})})(gI);var vZ=gI.exports;const gm=DR(vZ);function bZ(t){let e,i,n,s;return{c(){e=nt("div"),i=nt("a"),i.innerHTML='<img src="https://api.maptiler.com/resources/logo.svg" alt="MapTiler logo"/>',n=Et(),s=nt("div"),je(i,"href","https://www.maptiler.com"),je(i,"class","watermark svelte-cuoyz4"),je(s,"class","map svelte-cuoyz4"),je(e,"class","map-wrap svelte-cuoyz4")},m(l,c){Se(l,e,c),Ze(e,i),Ze(e,n),Ze(e,s),t[2](s)},p:ki,i:ki,o:ki,d(l){l&&Te(e),t[2](null)}}}const xZ="7zjR0hkkus6Xt5qMNXK1";function wZ(t,e,i){let n,s,{contracts:l}=e;gm.constants.classes.CONTROL_BASE="maplibregl-ctrl",gm.constants.classes.CONTROL_PREFIX="maplibregl-ctrl-",gm.constants.classes.CONTROL_GROUP="maplibregl-ctrl-group",Pl(()=>{const r={lng:139.753,lat:35.6844,zoom:6};n=new yZ.Map({container:s,style:`https://api.maptiler.com/maps/streets-v2/style.json?key=${xZ}`,center:[20.660475672036288,44.27892928219281],zoom:r.zoom});const f=new gm({displayControlsDefault:!1,controls:{polygon:!0,trash:!0}});n.addControl(f),n.on("draw.create",m),n.on("draw.update",m),n.on("draw.delete",()=>zm.set([]));function m(y){let E=f.getAll().features[0].geometry.coordinates[0].map(S=>[S[1],S[0]]).flat();zm.set([E[0],E[1],...E])}}),EA(()=>{n.remove()});function c(r){sn[r?"unshift":"push"](()=>{s=r,i(0,s)})}return t.$$set=r=>{"contracts"in r&&i(1,l=r.contracts)},[s,l,c]}class AZ extends Ri{constructor(e){super(),Di(this,e,wZ,bZ,Ci,{contracts:1})}}function EZ(t,e){let i=[],n=[];return t.end.year==0?(e=e.eq("godina",t.start.year),e=e.eq("mesec",t.start.month)):(e=e.lte("godina",t.start.year),e=e.lte("mesec",t.start.month),e=e.gte("godina",t.end.year),e=e.gte("mesec",t.end.month)),t.ops_id=="*"?(i=Rm.filter(s=>s.id==t.grad_id)[0].opstine.filter(s=>s.id!="*").map(s=>Number(s.id)),e=e.in("opstina_id",i)):e=e.eq("opstina_id",t.ops_id),t.kat_id!="*"&&e.eq("katastar_id",t.kat_id),t.old_housing&&n.push(2),t.new_housing&&n.push(1),e=e.in("tip_gradnje",n),e=e.eq("broj_stanova",1),e=e.gt("stanovi_pov",0),e}function TZ(t){let e,i,n,s,l,c;return e=new zg({props:{text:"Map"}}),e.$on("click",t[5]),n=new zg({props:{text:"Table"}}),n.$on("click",t[6]),l=new zg({props:{text:"Charts"}}),l.$on("click",t[7]),{c(){Mt(e.$$.fragment),i=Et(),Mt(n.$$.fragment),s=Et(),Mt(l.$$.fragment)},m(r,f){Ot(e,r,f),Se(r,i,f),Ot(n,r,f),Se(r,s,f),Ot(l,r,f),c=!0},p:ki,i(r){c||(ae(e.$$.fragment,r),ae(n.$$.fragment,r),ae(l.$$.fragment,r),c=!0)},o(r){pe(e.$$.fragment,r),pe(n.$$.fragment,r),pe(l.$$.fragment,r),c=!1},d(r){r&&(Te(i),Te(s)),Ct(e,r),Ct(n,r),Ct(l,r)}}}function SZ(t){let e,i;return e=new QD({props:{$$slots:{default:[TZ]},$$scope:{ctx:t}}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function IZ(t){let e,i;return e=new mR({}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function kZ(t){let e=Wn.do_search+"",i;return{c(){i=gi(e)},m(n,s){Se(n,i,s)},p:ki,d(n){n&&Te(i)}}}function OZ(t){let e,i,n,s,l,c,r,f,m,y,b,E,S,D,R,z,H,K,W;return n=new kR({}),r=new zK({}),b=new wR({}),R=new TR({}),K=new nu({props:{icon:VA,$$slots:{default:[kZ]},$$scope:{ctx:t}}}),K.$on("click",t[4]),{c(){e=nt("div"),i=nt("div"),Mt(n.$$.fragment),s=Et(),l=nt("p"),l.textContent=`${Wn.location}`,c=Et(),Mt(r.$$.fragment),f=Et(),m=nt("p"),m.textContent=`${Wn.period_from}`,y=Et(),Mt(b.$$.fragment),E=Et(),S=nt("p"),S.textContent=`${Wn.period_to}`,D=Et(),Mt(R.$$.fragment),z=Et(),H=nt("div"),Mt(K.$$.fragment),je(i,"class","py-10 svelte-ad9q1o"),je(l,"class","py-10 svelte-ad9q1o"),je(m,"class","py-10 svelte-ad9q1o"),je(S,"class","py-10 svelte-ad9q1o"),je(H,"class","py-10 svelte-ad9q1o"),je(e,"class","pr-10 svelte-ad9q1o")},m(se,Y){Se(se,e,Y),Ze(e,i),Ot(n,i,null),Ze(e,s),Ze(e,l),Ze(e,c),Ot(r,e,null),Ze(e,f),Ze(e,m),Ze(e,y),Ot(b,e,null),Ze(e,E),Ze(e,S),Ze(e,D),Ot(R,e,null),Ze(e,z),Ze(e,H),Ot(K,H,null),W=!0},p(se,Y){const ne={};Y&65536&&(ne.$$scope={dirty:Y,ctx:se}),K.$set(ne)},i(se){W||(ae(n.$$.fragment,se),ae(r.$$.fragment,se),ae(b.$$.fragment,se),ae(R.$$.fragment,se),ae(K.$$.fragment,se),W=!0)},o(se){pe(n.$$.fragment,se),pe(r.$$.fragment,se),pe(b.$$.fragment,se),pe(R.$$.fragment,se),pe(K.$$.fragment,se),W=!1},d(se){se&&Te(e),Ct(n),Ct(r),Ct(b),Ct(R),Ct(K)}}}function CZ(t){let e,i;return e=new oR({props:{$$slots:{default:[OZ]},$$scope:{ctx:t}}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function vA(t){let e,i;return e=new KR({props:{contracts:t[2]}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s&4&&(l.contracts=n[2]),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function bA(t){let e,i;return e=new LK({}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function xA(t){let e,i;return e=new AZ({props:{contracts:t[3]}}),{c(){Mt(e.$$.fragment)},m(n,s){Ot(e,n,s),i=!0},p(n,s){const l={};s&8&&(l.contracts=n[3]),e.$set(l)},i(n){i||(ae(e.$$.fragment,n),i=!0)},o(n){pe(e.$$.fragment,n),i=!1},d(n){Ct(e,n)}}}function MZ(t){let e,i,n,s,l=t[1]=="Table"&&vA(t),c=t[1]=="Charts"&&bA(),r=t[1]=="Map"&&xA(t);return{c(){l&&l.c(),e=Et(),c&&c.c(),i=Et(),r&&r.c(),n=Mn()},m(f,m){l&&l.m(f,m),Se(f,e,m),c&&c.m(f,m),Se(f,i,m),r&&r.m(f,m),Se(f,n,m),s=!0},p(f,m){f[1]=="Table"?l?(l.p(f,m),m&2&&ae(l,1)):(l=vA(f),l.c(),ae(l,1),l.m(e.parentNode,e)):l&&(Ai(),pe(l,1,1,()=>{l=null}),Ei()),f[1]=="Charts"?c?m&2&&ae(c,1):(c=bA(),c.c(),ae(c,1),c.m(i.parentNode,i)):c&&(Ai(),pe(c,1,1,()=>{c=null}),Ei()),f[1]=="Map"?r?(r.p(f,m),m&2&&ae(r,1)):(r=xA(f),r.c(),ae(r,1),r.m(n.parentNode,n)):r&&(Ai(),pe(r,1,1,()=>{r=null}),Ei())},i(f){s||(ae(l),ae(c),ae(r),s=!0)},o(f){pe(l),pe(c),pe(r),s=!1},d(f){f&&(Te(e),Te(i),Te(n)),l&&l.d(f),c&&c.d(f),r&&r.d(f)}}}function DZ(t){let e,i,n,s,l,c,r,f;function m(S){t[8](S)}let y={company:Wn.headline_turnover,platformName:Wn.headline_properties,persistentHamburgerMenu:!0,iconMenu:VA,$$slots:{"skip-to-content":[IZ],default:[SZ]},$$scope:{ctx:t}};t[0]!==void 0&&(y.isSideNavOpen=t[0]),e=new YD({props:y}),sn.push(()=>Fa(e,"isSideNavOpen",m));function b(S){t[9](S)}let E={$$slots:{default:[CZ]},$$scope:{ctx:t}};return t[0]!==void 0&&(E.isOpen=t[0]),s=new rR({props:E}),sn.push(()=>Fa(s,"isOpen",b)),r=new uR({props:{$$slots:{default:[MZ]},$$scope:{ctx:t}}}),{c(){Mt(e.$$.fragment),n=Et(),Mt(s.$$.fragment),c=Et(),Mt(r.$$.fragment)},m(S,D){Ot(e,S,D),Se(S,n,D),Ot(s,S,D),Se(S,c,D),Ot(r,S,D),f=!0},p(S,[D]){const R={};D&65536&&(R.$$scope={dirty:D,ctx:S}),!i&&D&1&&(i=!0,R.isSideNavOpen=S[0],Va(()=>i=!1)),e.$set(R);const z={};D&65536&&(z.$$scope={dirty:D,ctx:S}),!l&&D&1&&(l=!0,z.isOpen=S[0],Va(()=>l=!1)),s.$set(z);const H={};D&65550&&(H.$$scope={dirty:D,ctx:S}),r.$set(H)},i(S){f||(ae(e.$$.fragment,S),ae(s.$$.fragment,S),ae(r.$$.fragment,S),f=!0)},o(S){pe(e.$$.fragment,S),pe(s.$$.fragment,S),pe(r.$$.fragment,S),f=!1},d(S){S&&(Te(n),Te(c)),Ct(e,S),Ct(s,S),Ct(r,S)}}}const RZ="https://uhwkqtcrjweknpaelpqr.supabase.co",LZ="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVod2txdGNyandla25wYWVscHFyIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODUzNzk3NDQsImV4cCI6MjAwMDk1NTc0NH0.ZBS_LV4mEz2bpdv1oza--7gx7kV1TbFikMrUDZ7NeFE";function PZ(t,e,i){let n;Ln(t,Eo,R=>i(10,n=R)),Ln(t,zm,R=>i(11,R));let s=_Z(RZ,LZ),l=!1,c,r,f;em.subscribe(R=>{i(1,c=R)}),Vx.subscribe(R=>{i(2,r=R)});async function m(){let R=s.from("ugovori").select();R=EZ(n,R);let{data:z,error:H}=await R;for(let K of z)K.cena_kvm=K.cena/K.stanovi_pov,K.cena_kvm=K.cena_kvm.toFixed(2),K.id=K.ugovor_id;Vx.set(z),i(2,r=z)}const y=()=>em.set("Map"),b=()=>em.set("Table"),E=()=>em.set("Charts");function S(R){l=R,i(0,l)}function D(R){l=R,i(0,l)}return[l,c,r,f,m,y,b,E,S,D]}class NZ extends Ri{constructor(e){super(),Di(this,e,PZ,DZ,Ci,{})}}new NZ({target:document.getElementById("app")});export{DR as g};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}